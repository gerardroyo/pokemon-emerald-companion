(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();const x={swampert:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Cascada",type:"Agua",category:"F√≠sico"}],gardevoir:[{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Paz Mental",type:"Ps√≠quico",category:"Estado"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"}],breloom:[{name:"Espora",type:"Planta",category:"Estado"},{name:"Gancho Alto",type:"Lucha",category:"F√≠sico"},{name:"Giga Drenado",type:"Planta",category:"Especial"},{name:"Corpulencia",type:"Lucha",category:"Estado"}],manectric:[{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Mordisco",type:"Siniestro",category:"Especial"},{name:"Onda Trueno",type:"El√©ctrico",category:"Estado"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"}],flygon:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Avalancha",type:"Roca",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Vuelo",type:"Volador",category:"F√≠sico"}],salamence:[{name:"Vuelo",type:"Volador",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"}],blaziken:[{name:"Patada de Fuego",type:"Fuego",category:"F√≠sico"},{name:"Patada Alta",type:"Lucha",category:"F√≠sico"},{name:"Piedra Fr√≠a",type:"Hielo",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"}],metagross:[{name:"Meteoro",type:"Acero",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"}],milotic:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Descanso",type:"Ps√≠quico",category:"Estado"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"}],altaria:[{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Psicocarga",type:"Ps√≠quico",category:"Especial"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Danza Drag√≥n",type:"Drag√≥n",category:"Estado"}],aggron:[{name:"Cabezazo",type:"Acero",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Potencia",type:"Roca",category:"F√≠sico"},{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"}],rayquaza:[{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Avinazo",type:"Volador",category:"F√≠sico"}],groudon:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Sequia",type:"Fuego",category:"Estado"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"}],kyogre:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Lluvia",type:"Agua",category:"Estado"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"}],kingdra:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Lluvia",type:"Agua",category:"Estado"}],gyarados:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Mordedura",type:"Siniestro",category:"F√≠sico"},{name:"Avalancha",type:"Hielo",category:"F√≠sico"},{name:"Vuelo",type:"Volador",category:"F√≠sico"}],sharpedo:[{name:"Mordedura",type:"Siniestro",category:"F√≠sico"},{name:"Pirueta Ictio",type:"Agua",category:"F√≠sico"},{name:"Niebla",type:"Agua",category:"Estado"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}],sceptile:[{name:"Hoja Afilada",type:"Planta",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}]},Km=[{id:"difficulty",name:"Por Objetivo",icon:"üéØ"},{id:"thematic",name:"Por Tem√°tica",icon:"üé®"},{id:"mechanic",name:"Por Mec√°nica",icon:"‚öôÔ∏è"}],Qm={competitive:{id:"competitive",name:"üèÜ Competitivo",description:"Equipo √≥ptimo para derrotar al Alto Mando y ser campe√≥n. Balanceado y potente.",category:"difficulty",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Tanque Mixto / L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:x.swampert},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Atacante Especial",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:x.gardevoir},{name:"Breloom",id:286,types:["Planta","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/286.png",location:"Bosque Petalia (Shroomish)",role:"F√≠sico / Espora",item:"Semilla Milagro",nature:"Firme / Alegre",moves:x.breloom},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad Especial",item:"Im√°n",nature:"Modesta / Miedosa",moves:x.manectric},{name:"Flygon",id:330,types:["Tierra","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/330.png",location:"Ruta 111 (Trapinch)",role:"Atacante F√≠sico",item:"Arena Fina",nature:"Firme / Alegre",moves:x.flygon},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Potencia Bruta",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:x.salamence}]},speedrun:{id:"speedrun",name:"‚ö° Speedrun",description:"Pok√©mon r√°pidos y poderosos para terminar el juego velozmente. M√°xima velocidad y power.",category:"difficulty",pokemon:[{name:"Blaziken",id:257,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/257.png",location:"Inicial (Torchic)",role:"Atacante F√≠sico Veloz",item:"Banda Enfoque",nature:"Alegre / Activa",moves:x.blaziken},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad Especial",item:"Im√°n",nature:"Modesta / Miedosa",moves:x.manectric},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Velocidad Drag√≥n",item:"Capa Suave",nature:"P√≠cara / Ingenua",moves:x.altaria},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Velocidad F√≠sica Explosiva",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:x.salamence},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Atacante Mixto R√°pido",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:x.metagross},{name:"Sharpedo",id:319,types:["Agua","Siniestro"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/319.png",location:"Ruta 110 (Carvanha)",role:"Velocidad F√≠sica Agua",item:"Banda Enfoque",nature:"Alegre / Activa",moves:x.sharpedo}]},nuzlocke:{id:"nuzlocke",name:"üíÄ Nuzlocke",description:"Pok√©mon resistentes para sobrevivir a los ataques del Alto Mando. M√°xima defensa.",category:"difficulty",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Tanque Mixto / L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:x.swampert},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Tanque Especial",item:"Banda Defensiva",nature:"Pl√°cida / Prudente",moves:x.milotic},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Tanque Mixto Volador",item:"Capa Suave",nature:"Pl√°cida / Prudente",moves:x.altaria},{name:"Aggron",id:306,types:["Acero","Roca"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/306.png",location:"Ruta 112 (Aron)",role:"Tanque F√≠sico",item:"Armadura Defensiva",nature:"Pl√°cida / Audaz",moves:x.aggron},{name:"Gyarados",id:130,types:["Agua","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/130.png",location:"Ruta 119 (Magikarp)",role:"Tanque Mixto Volador",item:"Escudo Especial",nature:"Pl√°cida / Prudente",moves:x.gyarados},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Acero Defensivo",item:"Lentes de Precisi√≥n",nature:"Prudente / Pl√°cida",moves:x.metagross}]},favorites:{id:"favorites",name:"üåü Favoritos",description:"Los Pok√©mon m√°s queridos de Hoenn. Equipo sentimental pero competitivo.",category:"difficulty",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Estrella Principal",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:x.swampert},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Favorito Especial",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:x.gardevoir},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Legendario",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:x.salamence},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"M√°quina Legendaria",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:x.metagross},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Belleza del Agua",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:x.milotic},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Nube Voladora",item:"Capa Suave",nature:"Pl√°cida / Prudente",moves:x.altaria}]},balanced_team:{id:"balanced_team",name:"‚öñÔ∏è Equipo Balanceado",description:"Cobertura de tipos perfecta. Equipo vers√°til sin starters legendarios.",category:"thematic",pokemon:[{name:"Sceptile",id:254,types:["Planta"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/254.png",location:"Inicial (Treecko)",role:"Velocidad Planta",item:"Banda Enfoque",nature:"Alegre / Activa",moves:x.sceptile},{name:"Crobat",id:169,types:["Veneno","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/169.png",location:"Ruta 110 (Zubat)",role:"Velocidad Volador",item:"Banda Enfoque",nature:"Alegre / Activa",moves:[{name:"Mordisco",type:"Siniestro",category:"F√≠sico"},{name:"Ara√±azo",type:"Normal",category:"F√≠sico"},{name:"Supers√≥nico",type:"Normal",category:"Estado"},{name:"Polvareda",type:"Normal",category:"Estado"}]},{name:"Gyarados",id:130,types:["Agua","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/130.png",location:"Ruta 119 (Magikarp)",role:"F√≠sico Agua",item:"Escudo Especial",nature:"Firme / Alegre",moves:x.gyarados},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad Especial",item:"Im√°n",nature:"Modesta / Miedosa",moves:x.manectric},{name:"Absol",id:359,types:["Siniestro"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/359.png",location:"Ruta 120 (Absol)",role:"F√≠sico Siniestro",item:"Banda Enfoque",nature:"P√≠cara / Alegre",moves:[{name:"Rayo Oscuro",type:"Siniestro",category:"F√≠sico"},{name:"Garra Met√°lica",type:"Acero",category:"F√≠sico"},{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"}]},{name:"Claydol",id:344,types:["Tierra","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/344.png",location:"Ruta 111 (Baltoy)",role:"Tanque Mixto Tierra",item:"Gema Tierra",nature:"Pl√°cida / Audaz",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Avalancha",type:"Hielo",category:"Especial"}]}]},monotype_water:{id:"monotype_water",name:"üíß Monotype Agua",description:"Equipo 100% tipo Agua. Dominio completo de las aguas de Hoenn.",category:"thematic",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Agua L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:x.swampert},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Agua Especial",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:x.milotic},{name:"Kingdra",id:230,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/230.png",location:"Ruta 119 (Horsea)",role:"Agua Drag√≥n",item:"Gema Agua",nature:"Modesta / T√≠mida",moves:x.kingdra},{name:"Gyarados",id:130,types:["Agua","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/130.png",location:"Ruta 119 (Magikarp)",role:"Agua Volador",item:"Escudo Especial",nature:"Pl√°cida / Prudente",moves:x.gyarados},{name:"Sharpedo",id:319,types:["Agua","Siniestro"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/319.png",location:"Ruta 110 (Carvanha)",role:"Agua F√≠sico",item:"Banda Enfoque",nature:"Alegre / Activa",moves:x.sharpedo},{name:"Wailord",id:321,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/321.png",location:"Ruta 110 (Wailmer)",role:"Agua Tanque",item:"Armadura Defensiva",nature:"Pl√°cida / Prudente",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"},{name:"Avalancha",type:"Hielo",category:"F√≠sico"}]}]},monotype_dragon:{id:"monotype_dragon",name:"üêâ Monotype Drag√≥n",description:"Equipo 100% tipo Drag√≥n. Poder absoluto del tipo Drag√≥n.",category:"thematic",pokemon:[{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n L√≠der",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:x.salamence},{name:"Flygon",id:330,types:["Tierra","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/330.png",location:"Ruta 111 (Trapinch)",role:"Drag√≥n Tierra",item:"Arena Fina",nature:"Firme / Alegre",moves:x.flygon},{name:"Rayquaza",id:384,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/384.png",location:"Cascada Meteoro (Rayquaza)",role:"Drag√≥n Legendario",item:"Vida Orbe",nature:"P√≠cara / Activa",moves:x.rayquaza},{name:"Kingdra",id:230,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/230.png",location:"Ruta 119 (Horsea)",role:"Drag√≥n Agua",item:"Gema Agua",nature:"Modesta / T√≠mida",moves:x.kingdra},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Soporte Mixto",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:x.metagross},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Drag√≥n Nube",item:"Capa Suave",nature:"Pl√°cida / Prudente",moves:x.altaria}]},starter_treecko:{id:"starter_treecko",name:"üåø Team Treecko",description:"Equipo basado en Sceptile. Velocidad y precisi√≥n Grass.",category:"thematic",pokemon:[{name:"Sceptile",id:254,types:["Planta"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/254.png",location:"Inicial (Treecko)",role:"Velocidad Planta L√≠der",item:"Banda Enfoque",nature:"Alegre / Activa",moves:x.sceptile},{name:"Breloom",id:286,types:["Planta","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/286.png",location:"Bosque Petalia (Shroomish)",role:"Planta Lucha",item:"Semilla Milagro",nature:"Firme / Alegre",moves:x.breloom},{name:"Flygon",id:330,types:["Tierra","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/330.png",location:"Ruta 111 (Trapinch)",role:"Velocidad Tierra",item:"Arena Fina",nature:"Firme / Alegre",moves:x.flygon},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad El√©ctrico",item:"Im√°n",nature:"Modesta / Miedosa",moves:x.manectric},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Ps√≠quico Especial",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:x.gardevoir},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Volador",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:x.salamence}]},starter_torchic:{id:"starter_torchic",name:"üî• Team Torchic",description:"Equipo basado en Blaziken. Poder f√≠sico y lucha feroz.",category:"thematic",pokemon:[{name:"Blaziken",id:257,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/257.png",location:"Inicial (Torchic)",role:"Fuego Lucha L√≠der",item:"Banda Enfoque",nature:"Alegre / Activa",moves:x.blaziken},{name:"Breloom",id:286,types:["Planta","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/286.png",location:"Bosque Petalia (Shroomish)",role:"Lucha Planta",item:"Semilla Milagro",nature:"Firme / Alegre",moves:x.breloom},{name:"Aggron",id:306,types:["Acero","Roca"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/306.png",location:"Ruta 112 (Aron)",role:"Defensa Acero",item:"Armadura Defensiva",nature:"Pl√°cida / Audaz",moves:x.aggron},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n F√≠sico",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:x.salamence},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad El√©ctrico",item:"Im√°n",nature:"Modesta / Miedosa",moves:x.manectric},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Agua Soporte",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:x.milotic}]},starter_mudkip:{id:"starter_mudkip",name:"üíß Team Mudkip",description:"Equipo basado en Swampert. Dominio de agua y tierra.",category:"thematic",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Agua Tierra L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:x.swampert},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Agua Especial",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:x.milotic},{name:"Flygon",id:330,types:["Tierra","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/330.png",location:"Ruta 111 (Trapinch)",role:"Tierra Drag√≥n",item:"Arena Fina",nature:"Firme / Alegre",moves:x.flygon},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Ps√≠quico Especial",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:x.gardevoir},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Volador",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:x.salamence},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"El√©ctrico Soporte",item:"Im√°n",nature:"Modesta / Miedosa",moves:x.manectric}]},sun_team:{id:"sun_team",name:"‚òÄÔ∏è Equipo Sol",description:"Aprovecha Sequ√≠a y D√≠a Soleado. Potencia bajo el sol.",category:"mechanic",pokemon:[{name:"Blaziken",id:257,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/257.png",location:"Inicial (Torchic)",role:"Fuego Sol",item:"Banda Enfoque",nature:"Alegre / Activa",moves:x.blaziken},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Sol",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:x.salamence},{name:"Groudon",id:383,types:["Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/383.png",location:"C√°mara de Magma (Groudon)",role:"Tierra Sequ√≠a",item:"Vida Orbe",nature:"Firme / Alegre",moves:x.groudon},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Drag√≥n Volador Sol",item:"Capa Suave",nature:"Pl√°cida / Prudente",moves:x.altaria},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Acero Ps√≠quico",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:x.metagross},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"El√©ctrico Soporte",item:"Im√°n",nature:"Modesta / Miedosa",moves:x.manectric}]},rain_team:{id:"rain_team",name:"üåßÔ∏è Equipo Lluvia",description:"Aprovecha Llovizna y Danza Lluvia. Control del clima acuoso.",category:"mechanic",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Agua Lluvia L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:x.swampert},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Agua Lluvia",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:x.milotic},{name:"Kingdra",id:230,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/230.png",location:"Ruta 119 (Horsea)",role:"Agua Drag√≥n Lluvia",item:"Gema Agua",nature:"Modesta / T√≠mida",moves:x.kingdra},{name:"Kyogre",id:382,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/382.png",location:"Cueva Primordial (Kyogre)",role:"Agua Legendaria Lluvia",item:"Vida Orbe",nature:"Modesta / T√≠mida",moves:x.kyogre},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Ps√≠quico Soporte",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:x.gardevoir},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Acero Ps√≠quico",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:x.metagross}]},legendary:{id:"legendary",name:"‚≠ê Con Legendarios",description:"Incluye los tres legendarios de Hoenn. Poder absoluto.",category:"mechanic",pokemon:[{name:"Rayquaza",id:384,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/384.png",location:"Cascada Meteoro (Rayquaza)",role:"Drag√≥n Legendario L√≠der",item:"Vida Orbe",nature:"P√≠cara / Activa",moves:x.rayquaza},{name:"Groudon",id:383,types:["Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/383.png",location:"C√°mara de Magma (Groudon)",role:"Tierra Legendario",item:"Vida Orbe",nature:"Firme / Alegre",moves:x.groudon},{name:"Kyogre",id:382,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/382.png",location:"Cueva Primordial (Kyogre)",role:"Agua Legendaria",item:"Vida Orbe",nature:"Modesta / T√≠mida",moves:x.kyogre},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Volador",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:x.salamence},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Acero Ps√≠quico",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:x.metagross},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Ps√≠quico Soporte",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:x.gardevoir}]}},Jm=[{id:"difficulty",name:"Por Objetivo",icon:"üéØ"},{id:"thematic",name:"Por Tem√°tica",icon:"üé®"},{id:"mechanic",name:"Por Mec√°nica",icon:"‚öôÔ∏è"}],Xm={competitive:{id:"competitive",name:"üèÜ Competitivo",category:"difficulty",description:"Equipo √≥ptimo para derrotar al Alto Mando y ser campe√≥n. Balanceado y potente.",pokemon:[{name:"Infernape",id:392,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/392.png",location:"Starter Pok√©mon",role:"‚öîÔ∏è Atacante Mixto",item:"Vida Orbe",nature:"Ingenua",moves:[{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Hierba Lazo",type:"Planta",category:"Especial"},{name:"U-turn",type:"Bicho",category:"F√≠sico"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üêâ Sweeper F√≠sico",item:"Banda Focus",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Lucario",id:448,types:["Lucha","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/448.png",location:"Isla Hierro",role:"üëä Atacante Especial",item:"Gafas Especiales",nature:"Miedosa",moves:[{name:"Esfera Aural",type:"Lucha",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Pulso Umbr√≠o",type:"Siniestro",category:"Especial"},{name:"Maquinaci√≥n",type:"Siniestro",category:"Estado"}]},{name:"Togekiss",id:468,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/468.png",location:"Huevo (Cintia)",role:"‚ú® Tanque Especial",item:"Restos",nature:"Serena",moves:[{name:"Tajo A√©reo",type:"Volador",category:"Especial"},{name:"Esfera Aural",type:"Lucha",category:"Especial"},{name:"Onda Trueno",type:"El√©ctrico",category:"Estado"},{name:"Respiro",type:"Volador",category:"Estado"}]},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Mt. Corona (Pesca)",role:"üíß Muralla Especial",item:"Restos",nature:"Osada",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"T√≥xico",type:"Veneno",category:"Estado"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"}]},{name:"Roserade",id:407,types:["Planta","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/407.png",location:"Ruta 204",role:"üåπ Atacante Especial",item:"Lodo Negro",nature:"Miedosa",moves:[{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Somn√≠fero",type:"Planta",category:"Estado"},{name:"P√∫as T√≥xicas",type:"Veneno",category:"Estado"}]}]},speedrun:{id:"speedrun",name:"üèÉ Speedrun",category:"difficulty",description:"Pok√©mon r√°pidos y poderosos para terminar el juego velozmente. M√°xima velocidad y power.",pokemon:[{name:"Torterra",id:389,types:["Planta","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/389.png",location:"Starter",role:"üí™ F√≠sico",item:"Restos",nature:"Audaz",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Rayo Solar",type:"Planta",category:"Especial"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"S√≠ntesis",type:"Planta",category:"Estado"}]},{name:"Rapidash",id:78,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/78.png",location:"Ruta 206",role:"üöÄ Especial",item:"Gafas de Precisi√≥n",nature:"T√≠mido",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Giro Fuego",type:"Fuego",category:"Especial"},{name:"Sofoco",type:"Fuego",category:"Especial"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"}]},{name:"Floatzel",id:419,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/419.png",location:"Ruta 203",role:"‚ö° F√≠sico",item:"Banda Muscular",nature:"Audaz",moves:[{name:"Acuatierra",type:"Agua",category:"F√≠sico"},{name:"Golpe",type:"Lucha",category:"F√≠sico"},{name:"Giro Hidro",type:"Agua",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"}]},{name:"Raichu",id:26,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/26.png",location:"Ruta 204-205",role:"‚ö° Especial",item:"Vida Orbe",nature:"T√≠mido",moves:[{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Onda Voltio",type:"El√©ctrico",category:"Especial"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Foco Energ√©tico",type:"Normal",category:"Especial"}]},{name:"Machamp",id:68,types:["Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/68.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Banda Muscular",nature:"Audaz",moves:[{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Martillazo",type:"Lucha",category:"F√≠sico"}]},{name:"Scyther",id:123,types:["Bicho","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/123.png",location:"Ruta 205-206",role:"üöÄ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Corte",type:"Normal",category:"F√≠sico"},{name:"X-Ataque",type:"Normal",category:"Estado"},{name:"Golpe A√©reo",type:"Volador",category:"F√≠sico"},{name:"Espada Santa",type:"Normal",category:"F√≠sico"}]}]},nuzlocke:{id:"nuzlocke",name:"üíÄ Nuzlocke",category:"difficulty",description:"Pok√©mon resistentes para sobrevivir a los ataques del Alto Mando. M√°xima defensa.",pokemon:[{name:"Bastionage",id:411,types:["Roca","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/411.png",location:"Cantera Fueguete",role:"üõ°Ô∏è F√≠sico",item:"Gafas de Precisi√≥n",nature:"Firme",moves:[{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"},{name:"Tierra de Poder",type:"Tierra",category:"Especial"},{name:"Reflejo",type:"Ps√≠quico",category:"Estado"}]},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"},{name:"Meteorob√∫s",type:"Acero",category:"F√≠sico"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}]},{name:"Lapras",id:131,types:["Agua","Hielo"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/131.png",location:"Lago Valor",role:"üõ°Ô∏è Especial",item:"Restos",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]},{name:"Gengar",id:94,types:["Fantasma","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/94.png",location:"Cueva √âbano",role:"‚ö° Especial",item:"Vida Orbe",nature:"T√≠mido",moves:[{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Enfoque Energ√©tico",type:"Lucha",category:"Especial"},{name:"Foco Energ√©tico",type:"Normal",category:"Especial"}]},{name:"Gallade",id:475,types:["Ps√≠quico","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/475.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Banda Muscular",nature:"Audaz",moves:[{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"},{name:"Tiro Vital",type:"Lucha",category:"F√≠sico"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}]},{name:"Rhyperior",id:464,types:["Tierra","Roca"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/464.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Gafas de Precisi√≥n",nature:"Audaz",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Martillazo",type:"Lucha",category:"F√≠sico"},{name:"Avalancha",type:"Hielo",category:"F√≠sico"}]}]},favorites:{id:"favorites",name:"üåü Favoritos",category:"difficulty",description:"Los Pok√©mon m√°s queridos de Sinnoh. Equipo sentimental pero competitivo.",pokemon:[{name:"Dialga",id:483,types:["Acero","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/483.png",location:"Spear Pillar",role:"üíé Legendario",item:"Placa Resistente",nature:"Modesto",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Meteorob√∫s",type:"Acero",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Llamarada",type:"Fuego",category:"Especial"}]},{name:"Palkia",id:484,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/484.png",location:"Spear Pillar",role:"üíé Legendario",item:"Placa H√∫meda",nature:"Modesto",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Tormenta de Truenos",type:"El√©ctrico",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"}]},{name:"Giratina",id:487,types:["Fantasma","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/487.png",location:"Distorsi√≥n del Espacio",role:"üíé Legendario",item:"Gafas de Precisi√≥n",nature:"T√≠mido",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Foco Energ√©tico",type:"Normal",category:"Especial"},{name:"Enfoque Energ√©tico",type:"Lucha",category:"Especial"}]},{name:"Cresselia",id:488,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/488.png",location:"Isla Valor",role:"‚ú® Apoyo",item:"Restos",nature:"Modesto",moves:[{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Rayo Aurora",type:"Hielo",category:"Especial"},{name:"Defensa Lunar",type:"Ps√≠quico",category:"Estado"},{name:"Amnesia",type:"Ps√≠quico",category:"Estado"}]},{name:"Togekiss",id:468,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/468.png",location:"Ruta 210-211",role:"‚ú® Apoyo",item:"Restos",nature:"Modesto",moves:[{name:"Aire Cortante",type:"Volador",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Fuego Fatuo",type:"Fuego",category:"Estado"},{name:"Agilidad",type:"Ps√≠quico",category:"Estado"}]},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Mt. Coronet",role:"üöÄ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Golpe A√©reo",type:"Volador",category:"Especial"}]}]},balanced_team:{id:"balanced_team",name:"‚öñÔ∏è Equipo Balanceado",category:"thematic",description:"Cobertura de tipos perfecta. Equipo vers√°til dise√±ado alrededor de Empoleon.",pokemon:[{name:"Empoleon",id:395,types:["Agua","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/395.png",location:"Starter",role:"üõ°Ô∏è Especial / Tanque",item:"Restos",nature:"Modesta",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Agility",type:"Ps√≠quico",category:"Estado"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üí™ F√≠sico",item:"Banda Focus",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Colmillo √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Staraptor",id:398,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/398.png",location:"Ruta 201",role:"üöÄ Atacante Veloz",item:"Cinta Elegida",nature:"Firme",moves:[{name:"P√°jaro Osado",type:"Volador",category:"F√≠sico"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"}]},{name:"Luxray",id:405,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/405.png",location:"Ruta 202",role:"‚ö° Atacante F√≠sico",item:"Magneto",nature:"Firme",moves:[{name:"Chispazo",type:"El√©ctrico",category:"Especial"},{name:"Colmillo Rayo",type:"El√©ctrico",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Superpotencia",type:"Lucha",category:"F√≠sico"}]},{name:"Roserade",id:407,types:["Planta","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/407.png",location:"Ruta 204",role:"üåπ Atacante Especial",item:"Lodo Negro",nature:"Miedosa",moves:[{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Recurso",type:"Normal",category:"Estado"},{name:"Extrasensorial",type:"Ps√≠quico",category:"Especial"}]},{name:"Gallade",id:475,types:["Ps√≠quico","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/475.png",location:"Ruta 208",role:"üó°Ô∏è Atacante F√≠sico",item:"Periscopio",nature:"Firme",moves:[{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Psicocorte",type:"Ps√≠quico",category:"F√≠sico"},{name:"Tajo Umbr√≠o",type:"Siniestro",category:"F√≠sico"},{name:"Hoja Aguda",type:"Planta",category:"F√≠sico"}]}]},monotype_water:{id:"monotype_water",name:"üíß Monotype Agua",category:"thematic",description:"Equipo 100% tipo Agua. Dominio completo de las aguas de Sinnoh.",pokemon:[{name:"Empoleon",id:395,types:["Agua","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/395.png",location:"Starter",role:"üõ°Ô∏è Especial",item:"Placa Resistente",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Onda Voltio",type:"El√©ctrico",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"},{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"}]},{name:"Floatzel",id:419,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/419.png",location:"Ruta 203",role:"‚ö° F√≠sico",item:"Banda Muscular",nature:"Audaz",moves:[{name:"Acuatierra",type:"Agua",category:"F√≠sico"},{name:"Golpe",type:"Lucha",category:"F√≠sico"},{name:"Giro Hidro",type:"Agua",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"}]},{name:"Lapras",id:131,types:["Agua","Hielo"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/131.png",location:"Lago Valor",role:"üõ°Ô∏è Especial",item:"Restos",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 222",role:"üõ°Ô∏è Especial",item:"Restos",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Rayo Aurora",type:"Hielo",category:"Especial"},{name:"Raya Lum√≠nica",type:"Agua",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]},{name:"Gastrodon",id:423,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/423.png",location:"Gran Ci√©naga",role:"üõ°Ô∏è Especial",item:"Restos",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Tierra de Poder",type:"Tierra",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]},{name:"Manaphy",id:490,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/490.png",location:"Isla Valor",role:"üíé Legendario",item:"Restos",nature:"Modesto",moves:[{name:"Raya Lum√≠nica",type:"Agua",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]}]},monotype_dragon:{id:"monotype_dragon",name:"üêâ Monotype Drag√≥n",category:"thematic",description:"Equipo 100% tipo Drag√≥n. Poder absoluto del tipo Drag√≥n.",pokemon:[{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Gafas de Precisi√≥n",nature:"Audaz",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"}]},{name:"Dialga",id:483,types:["Acero","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/483.png",location:"Spear Pillar",role:"üíé Legendario",item:"Placa Resistente",nature:"Modesto",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Meteorob√∫s",type:"Acero",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Llamarada",type:"Fuego",category:"Especial"}]},{name:"Palkia",id:484,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/484.png",location:"Spear Pillar",role:"üíé Legendario",item:"Placa H√∫meda",nature:"Modesto",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Tormenta de Truenos",type:"El√©ctrico",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"}]},{name:"Giratina",id:487,types:["Fantasma","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/487.png",location:"Distorsi√≥n del Espacio",role:"üíé Legendario",item:"Gafas de Precisi√≥n",nature:"T√≠mido",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Foco Energ√©tico",type:"Normal",category:"Especial"},{name:"Enfoque Energ√©tico",type:"Lucha",category:"Especial"}]},{name:"Dragonite",id:149,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/149.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Golpe A√©reo",type:"Volador",category:"Especial"}]},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Mt. Coronet",role:"üöÄ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Golpe A√©reo",type:"Volador",category:"Especial"}]}]},starter_turtwig:{id:"starter_turtwig",name:"üåø Team Turtwig",category:"thematic",description:"Equipo basado en Torterra. Defensa s√≥lida y potencia terrestre.",pokemon:[{name:"Torterra",id:389,types:["Planta","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/389.png",location:"Starter",role:"üå≥ Tanque F√≠sico",item:"Restos",nature:"Firme",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Mazo en la Cabeza",type:"Planta",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Maldici√≥n",type:"Fantasma",category:"Estado"}]},{name:"Staraptor",id:398,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/398.png",location:"Ruta 201",role:"üöÄ Atacante Veloz",item:"Cinta Elegida",nature:"Alegre",moves:[{name:"P√°jaro Osado",type:"Volador",category:"F√≠sico"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"}]},{name:"Magmortar",id:467,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/467.png",location:"Forja Fuego",role:"üí• Ca√±√≥n Especial",item:"Vidasfera",nature:"Modesta",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"}]},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Mt. Corona (Pesca)",role:"üíß Muralla Especial",item:"Restos",nature:"Osada",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"},{name:"T√≥xico",type:"Veneno",category:"Estado"}]},{name:"Lucario",id:448,types:["Lucha","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/448.png",location:"Isla Hierro (Huevo)",role:"üëä Atacante Mixto",item:"Cinta Experto",nature:"Firme",moves:[{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Pu√±o Incremento",type:"Lucha",category:"F√≠sico"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Velocidad Extrema",type:"Normal",category:"F√≠sico"}]},{name:"Jolteon",id:135,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/135.png",location:"Eevee (Coraz√≥n de Ciudad)",role:"‚ö° Atacante Veloz",item:"Im√°n",nature:"Miedosa",moves:[{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Onda Voltio",type:"El√©ctrico",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Doble Rayo",type:"Bicho",category:"Especial"}]}]},starter_chimchar:{id:"starter_chimchar",name:"üî• Team Chimchar",category:"thematic",description:"Equipo basado en Infernape. Poder de fuego y lucha veloz.",pokemon:[{name:"Infernape",id:392,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/392.png",location:"Starter",role:"üî• Ca√±√≥n de Fuego Veloz",item:"Vidasfera",nature:"Activa",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Pu√±o Trueno",type:"El√©ctrico",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Floatzel",id:419,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/419.png",location:"Ruta 203",role:"üö§ Atacante Veloz",item:"Cinta Experto",nature:"Firme",moves:[{name:"Cascada",type:"Agua",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Pu√±o Hielo",type:"Hielo",category:"F√≠sico"},{name:"Acua Jet",type:"Agua",category:"F√≠sico"}]},{name:"Roserade",id:407,types:["Planta","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/407.png",location:"Ruta 204",role:"üåπ Atacante Especial",item:"Lodo Negro",nature:"Miedosa",moves:[{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Somn√≠fero",type:"Planta",category:"Estado"},{name:"Brillo M√°gico",type:"Hada",category:"Especial"}]},{name:"Staraptor",id:398,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/398.png",location:"Ruta 201",role:"üöÄ Atacante Veloz",item:"Cinta Elegida",nature:"Alegre",moves:[{name:"P√°jaro Osado",type:"Volador",category:"F√≠sico"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üêâ Power Bruto",item:"Colmillo Drag√≥n",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Llamarada",type:"Fuego",category:"Especial"}]},{name:"Luxray",id:405,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/405.png",location:"Ruta 202",role:"‚ö° Atacante F√≠sico",item:"Magneto",nature:"Firme",moves:[{name:"Colmillo Rayo",type:"El√©ctrico",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Superpotencia",type:"Lucha",category:"F√≠sico"},{name:"Voltiocambio",type:"El√©ctrico",category:"Especial"}]}]},starter_piplup:{id:"starter_piplup",name:"üåä Team Piplup",category:"thematic",description:"Equipo basado en Empoleon. Elegancia real y dominio del acero.",pokemon:[{name:"Empoleon",id:395,types:["Agua","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/395.png",location:"Starter",role:"üõ°Ô∏è Tanque Especial",item:"Restos",nature:"Modesta",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Nudo Hierba",type:"Planta",category:"Especial"}]},{name:"Rapidash",id:78,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/78.png",location:"Ruta 206",role:"üèá Atacante Veloz",item:"Banda Muscular",nature:"Alegre",moves:[{name:"Envite √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Cuerpo Llama",type:"Fuego",category:"Estado"},{name:"Patada Salto Alta",type:"Lucha",category:"F√≠sico"}]},{name:"Roserade",id:407,types:["Planta","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/407.png",location:"Ruta 204",role:"üåπ Atacante Especial",item:"Lodo Negro",nature:"Miedosa",moves:[{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Extrasensorial",type:"Ps√≠quico",category:"Especial"},{name:"Paralizador",type:"Planta",category:"Estado"}]},{name:"Staraptor",id:398,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/398.png",location:"Ruta 201",role:"üöÄ Atacante Veloz",item:"Cinta Elegida",nature:"Firme",moves:[{name:"P√°jaro Osado",type:"Volador",category:"F√≠sico"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üêâ Sweeper F√≠sico",item:"Banda Focus",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Lucario",id:448,types:["Lucha","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/448.png",location:"Isla Hierro (Huevo)",role:"üëä Atacante Mixto",item:"Cinta Experto",nature:"Ingenua",moves:[{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Esfera Aural",type:"Lucha",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Velocidad Extrema",type:"Normal",category:"F√≠sico"}]}]},sun_team:{id:"sun_team",name:"‚òÄÔ∏è Equipo Sol",description:"Aprovecha D√≠a Soleado. Potencia bajo el sol.",category:"mechanic",pokemon:[{name:"Infernape",id:392,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/392.png",location:"Starter",role:"üî• Sol Sweeper",item:"Vida Orbe",nature:"Activa",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Hierba Lazo",type:"Planta",category:"Especial"},{name:"D√≠a Soleado",type:"Fuego",category:"Estado"}]},{name:"Cherrim",id:421,types:["Planta"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/421.png",location:"Ruta 221",role:"‚òÄÔ∏è Soporte Sol",item:"Roca Calor",nature:"Miedosa",moves:[{name:"D√≠a Soleado",type:"Fuego",category:"Estado"},{name:"Rayo Solar",type:"Planta",category:"Especial"},{name:"Deseo",type:"Normal",category:"Estado"},{name:"Ayuda",type:"Normal",category:"Estado"}]},{name:"Rapidash",id:78,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/78.png",location:"Ruta 206",role:"üèá Atacante Veloz",item:"Banda Muscular",nature:"Alegre",moves:[{name:"Envite √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Patada Salto Alta",type:"Lucha",category:"F√≠sico"},{name:"Nitrocarga",type:"Fuego",category:"F√≠sico"}]},{name:"Leafeon",id:470,types:["Planta"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/470.png",location:"Bosque Eterna (Eevee)",role:"üçÉ Clorofila F√≠sico",item:"Tabla Pradal",nature:"Firme",moves:[{name:"Hoja Aguda",type:"Planta",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"X-Scissor",type:"Bicho",category:"F√≠sico"},{name:"Sustituto",type:"Normal",category:"Estado"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üêâ Power Bruto",item:"Banda Focus",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Carga Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Colmillo √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Magmortar",id:467,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/467.png",location:"Forja Fuego",role:"üí• Ca√±√≥n Especial",item:"Gafas Elegid.",nature:"Modesta",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"}]}]},rain_team:{id:"rain_team",name:"üåßÔ∏è Equipo Lluvia",description:"Aprovecha Danza Lluvia. Control del clima acuoso.",category:"mechanic",pokemon:[{name:"Empoleon",id:395,types:["Agua","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/395.png",location:"Starter",role:"üõ°Ô∏è Tanque Lluvia",item:"Restos",nature:"Modesta",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Danza Lluvia",type:"Agua",category:"Estado"}]},{name:"Floatzel",id:419,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/419.png",location:"Ruta 213",role:"üõ∂ Nado R√°pido Swimmer",item:"Tabla Agua",nature:"Firme",moves:[{name:"Cascada",type:"Agua",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Pu√±o Hielo",type:"Hielo",category:"F√≠sico"},{name:"Acua Jet",type:"Agua",category:"F√≠sico"}]},{name:"Toxicroak",id:454,types:["Veneno","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/454.png",location:"Gran Pantano",role:"üê∏ Piel Seca Sweeper",item:"Lodo Negro",nature:"Alegre",moves:[{name:"Pu√±o Drenaje",type:"Lucha",category:"F√≠sico"},{name:"Puya Nociva",type:"Veneno",category:"F√≠sico"},{name:"Tajo Umbr√≠o",type:"Siniestro",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Bronzong",id:437,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/437.png",location:"Monte Corona",role:"üîî Soporte Defensivo",item:"Roca Lluvia",nature:"Pl√°cida",moves:[{name:"Danza Lluvia",type:"Agua",category:"Estado"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Giro Bola",type:"Acero",category:"F√≠sico"},{name:"Hipnosis",type:"Ps√≠quico",category:"Estado"}]},{name:"Lumineon",id:457,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/457.png",location:"Ruta 223",role:"üêü Soporte Veloz",item:"Roca Lluvia",nature:"Miedosa",moves:[{name:"Viento Hielo",type:"Hielo",category:"Especial"},{name:"Danza Lluvia",type:"Agua",category:"Estado"},{name:"U-turn",type:"Bicho",category:"F√≠sico"},{name:"Escaldar",type:"Agua",category:"Especial"}]},{name:"Rotom-Wash",id:479,types:["El√©ctrico","Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10009.png",location:"Mansi√≥n Vieja",role:"üå™Ô∏è STAB Trueno",item:"Restos",nature:"Modesta",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Fuego Fatuo",type:"Fuego",category:"Estado"},{name:"Divide Dolor",type:"Normal",category:"Estado"}]}]},legendary:{id:"legendary",name:"‚≠ê Legendarios",description:"El equipo definitivo de Sinnoh. Los seres m√°s poderosos de la creaci√≥n.",category:"mechanic",pokemon:[{name:"Arceus",id:493,types:["Normal"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/493.png",location:"Sala del Origen",role:"üëë El Dios Pok√©mon",item:"Tabla Alfa",nature:"Firme",moves:[{name:"Velocidad Extrema",type:"Normal",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Garra Umbr√≠a",type:"Fantasma",category:"F√≠sico"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"}]},{name:"Darkrai",id:491,types:["Siniestro"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/491.png",location:"Isla Nueva Luna",role:"üåô Maestro de las Pesadillas",item:"Banda Focus",nature:"Miedosa",moves:[{name:"Brecha Negra",type:"Siniestro",category:"Estado"},{name:"Maquinaci√≥n",type:"Siniestro",category:"Estado"},{name:"Pulso Umbr√≠o",type:"Siniestro",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"}]},{name:"Shaymin-Sky",id:492,types:["Planta","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10006.png",location:"V√≠a del Agradecimiento",role:"üçÉ Velocista de los Cielos",item:"Vidasfera",nature:"Miedosa",moves:[{name:"Fogonazo",type:"Planta",category:"Especial"},{name:"Tajo A√©reo",type:"Volador",category:"Especial"},{name:"Tierra Viva",type:"Tierra",category:"Especial"},{name:"S√≠ntesis",type:"Planta",category:"Estado"}]},{name:"Giratina-O",id:487,types:["Fantasma","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10007.png",location:"Mundo Distorsi√≥n",role:"üëª Guardi√°n del Mundo Inverso",item:"Griseosfera",nature:"Audaz",moves:[{name:"Golpe Umbr√≠o",type:"Fantasma",category:"F√≠sico"},{name:"Cometa Draco",type:"Drag√≥n",category:"Especial"},{name:"Esfera Aural",type:"Lucha",category:"Especial"},{name:"Fuego Fatuo",type:"Fuego",category:"Estado"}]},{name:"Dialga",id:483,types:["Acero","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/483.png",location:"Columna Lanza",role:"‚è≥ Se√±or del Tiempo",item:"Diamansfera",nature:"Modesta",moves:[{name:"Distorsi√≥n",type:"Drag√≥n",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"}]},{name:"Palkia",id:484,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/484.png",location:"Columna Lanza",role:"üåå Se√±or del Espacio",item:"Lustrosfera",nature:"Miedosa",moves:[{name:"Corte Vac√≠o",type:"Drag√≥n",category:"Especial"},{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Esfera Aural",type:"Lucha",category:"Especial"}]}]}},Au={Normal:"Normal",Fire:"Fuego",Water:"Agua",Grass:"Planta",Electric:"El√©ctrico",Ice:"Hielo",Fighting:"Lucha",Poison:"Veneno",Ground:"Tierra",Flying:"Volador",Psychic:"Ps√≠quico",Bug:"Bicho",Rock:"Roca",Ghost:"Fantasma",Dragon:"Drag√≥n",Steel:"Acero",Dark:"Siniestro"};function Da(n){if(!n)return"";const e=n.charAt(0).toUpperCase()+n.slice(1).toLowerCase();return Au[e]||n}const Tu={Placaje:{type:"Normal",category:"F√≠sico",power:40,accuracy:100,desc:"Embiste al objetivo con todo el cuerpo."},Imagen:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Crea copias ilusorias que aumentan la Evasi√≥n."},Derribo:{type:"Normal",category:"F√≠sico",power:90,accuracy:100,desc:"Placaje potente que tambi√©n da√±a al atacante."},"Golpe Cuerpo":{type:"Normal",category:"F√≠sico",power:85,accuracy:100,desc:"Golpe con todo el cuerpo. Puede paralizar."},"Ataque R√°pido":{type:"Normal",category:"F√≠sico",power:40,accuracy:100,desc:"Ataque veloz que siempre golpea primero."},Rapidez:{type:"Normal",category:"Especial",power:60,accuracy:100,desc:"Lanza estrellas que nunca fallan."},"Otra Vez":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Obliga al rival a repetir su √∫ltimo movimiento."},Finta:{type:"Siniestro",category:"F√≠sico",power:60,accuracy:100,desc:"Ataque que ignora Protecci√≥n y Detecci√≥n."},Cuchillada:{type:"Normal",category:"F√≠sico",power:70,accuracy:100,desc:"Corte con garras. Alta prob. de golpe cr√≠tico."},Hiperrayo:{type:"Normal",category:"Especial",power:150,accuracy:90,desc:"Rayo devastador. Requiere recarga despu√©s."},"Doble Filo":{type:"Normal",category:"F√≠sico",power:120,accuracy:100,desc:"Ataque temerario que da√±a mucho al usuario."},S√≥nico:{type:"Normal",category:"Especial",power:null,accuracy:100,desc:"Onda s√≥nica que causa da√±o fijo de 20 PS."},Supers√≥nico:{type:"Normal",category:"Estado",power:null,accuracy:55,desc:"Ondas que confunden al objetivo."},Salpicar:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"No hace absolutamente nada."},"Rizo Defensa":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Se enrosca para subir la Defensa."},Fortaleza:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Tensa los m√∫sculos para subir la Defensa."},Bloqueo:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Impide que el objetivo huya o sea cambiado."},Malicioso:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Mirada intimidante que baja la Defensa rival."},Aullido:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"A√∫lla para subir el Ataque Especial."},Atracci√≥n:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Enamora al rival si es de sexo opuesto."},"Doble Equipo":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Crea copias para aumentar la Evasi√≥n."},Protecci√≥n:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Evita todos los ataques ese turno."},"Velo Sagrado":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Protege al equipo de estados alterados."},"Danza Caos":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Danza que sube Ataque pero confunde."},Tambor:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Maximiza Ataque a costa de PS."},Relajo:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"No hace nada. Habilidad Ausente lo usa."},Bostezo:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Hace bostezar al rival. Dormir√° el siguiente turno."},Contoneo:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Sube el Ataque rival pero lo confunde."},Rugido:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Asusta al rival y lo cambia por otro."},"Beso Dulce":{type:"Normal",category:"Estado",power:null,accuracy:75,desc:"Beso que confunde al objetivo."},Recuperaci√≥n:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Recupera la mitad de los PS m√°ximos."},Explosi√≥n:{type:"Normal",category:"F√≠sico",power:250,accuracy:100,desc:"Explosi√≥n masiva. El usuario se debilita."},Autodestrucci√≥n:{type:"Normal",category:"F√≠sico",power:200,accuracy:100,desc:"Explosi√≥n que debilita al usuario."},Lanzallamas:{type:"Fuego",category:"Especial",power:95,accuracy:100,desc:"Lanza llamas intensas. Puede quemar."},Sofoco:{type:"Fuego",category:"Especial",power:140,accuracy:90,desc:"Ataque devastador que baja At. Esp. propio."},"Fuego Fatuo":{type:"Fuego",category:"Estado",power:null,accuracy:75,desc:"Fuego fantasmal que quema al objetivo."},"D√≠a Soleado":{type:"Fuego",category:"Estado",power:null,accuracy:100,desc:"Intensifica el sol. Potencia ataques de Fuego."},Surf:{type:"Agua",category:"Especial",power:95,accuracy:100,desc:"Gran ola que golpea a todos en combate."},Hidropulso:{type:"Agua",category:"Especial",power:60,accuracy:100,desc:"Onda de agua. Puede confundir."},Hidrobomba:{type:"Agua",category:"Especial",power:120,accuracy:80,desc:"Potente chorro de agua a presi√≥n."},Buceo:{type:"Agua",category:"F√≠sico",power:60,accuracy:100,desc:"Se sumerge y ataca en el siguiente turno."},Cascada:{type:"Agua",category:"F√≠sico",power:80,accuracy:100,desc:"Carga con una cascada. Puede hacer retroceder."},Azote:{type:"Normal",category:"F√≠sico",power:null,accuracy:100,desc:"M√°s da√±o cuanto menos PS tenga el usuario."},"Danza Lluvia":{type:"Agua",category:"Estado",power:null,accuracy:100,desc:"Invoca lluvia. Potencia ataques de Agua."},Rayo:{type:"El√©ctrico",category:"Especial",power:95,accuracy:100,desc:"Descarga el√©ctrica potente. Puede paralizar."},"Onda Trueno":{type:"El√©ctrico",category:"Estado",power:null,accuracy:100,desc:"Onda el√©ctrica que paraliza al objetivo."},Chispa:{type:"El√©ctrico",category:"F√≠sico",power:65,accuracy:100,desc:"Placaje el√©ctrico. Puede paralizar."},"Onda Voltio":{type:"El√©ctrico",category:"Especial",power:60,accuracy:100,desc:"Descarga el√©ctrica que siempre paraliza."},"Giga Drenado":{type:"Planta",category:"Especial",power:60,accuracy:100,desc:"Absorbe PS del rival. Cura la mitad del da√±o."},"Rayo Solar":{type:"Planta",category:"Especial",power:120,accuracy:100,desc:"Carga luz solar y ataca. Instant√°neo con sol."},Drenadoras:{type:"Planta",category:"Estado",power:null,accuracy:100,desc:"Planta semillas que drenan PS cada turno."},"Espora Alg.":{type:"Planta",category:"Estado",power:null,accuracy:75,desc:"Esparce esporas que bajan la Velocidad."},"Brazo Pincho":{type:"Planta",category:"F√≠sico",power:60,accuracy:100,desc:"Golpea con brazo espinoso. Alta prob. cr√≠tico."},Espora:{type:"Planta",category:"Estado",power:null,accuracy:100,desc:"Esparce esporas que duermen al objetivo."},"Rayo Hielo":{type:"Hielo",category:"Especial",power:95,accuracy:100,desc:"Rayo helado que puede congelar al rival."},"Rayo Aurora":{type:"Hielo",category:"Especial",power:65,accuracy:100,desc:"Velo helado multicolor. Puede congelar."},Ventisca:{type:"Hielo",category:"Especial",power:120,accuracy:70,desc:"Tormenta de nieve brutal. Puede congelar."},"Bola Hielo":{type:"Hielo",category:"F√≠sico",power:30,accuracy:90,desc:"Bola de hielo que incrementa poder cada turno."},"Fr√≠o Agudo":{type:"Hielo",category:"Especial",power:null,accuracy:30,desc:"Ataque que debilita de un golpe si acierta."},Granizo:{type:"Hielo",category:"Estado",power:null,accuracy:100,desc:"Invoca granizo que da√±a a no-Hielo."},"Patada Baja":{type:"Lucha",category:"F√≠sico",power:65,accuracy:100,desc:"Patada baja. M√°s da√±o a rivales pesados."},"Karate-choque":{type:"Lucha",category:"F√≠sico",power:50,accuracy:100,desc:"Golpe certero con alta prob. de cr√≠tico."},"Mov. S√≠smico":{type:"Lucha",category:"F√≠sico",power:null,accuracy:100,desc:"Lanza al rival. Da√±o igual al nivel del usuario."},"Pu√±o Certero":{type:"Lucha",category:"F√≠sico",power:150,accuracy:50,desc:"Golpe devastador pero de baja precisi√≥n."},Corpulencia:{type:"Lucha",category:"Estado",power:null,accuracy:100,desc:"Tensa m√∫sculos. Sube Ataque y Defensa."},Empuj√≥n:{type:"Lucha",category:"F√≠sico",power:20,accuracy:100,desc:"Empuja con las palmas. Ataca primero."},"Tiro Vital":{type:"Lucha",category:"F√≠sico",power:70,accuracy:100,desc:"Ataca un punto vital. Alta prob. de cr√≠tico."},Inversi√≥n:{type:"Lucha",category:"F√≠sico",power:null,accuracy:100,desc:"M√°s da√±o cuanto menos PS tenga el usuario."},"Gancho Alto":{type:"Lucha",category:"F√≠sico",power:85,accuracy:100,desc:"Pu√±etazo ascendente muy potente."},Demolici√≥n:{type:"Lucha",category:"F√≠sico",power:75,accuracy:100,desc:"Pu√±etazo fuerte capaz de romper barreras."},Martillazo:{type:"Lucha",category:"F√≠sico",power:100,accuracy:100,desc:"Golpe con las pinzas muy potente."},Poluci√≥n:{type:"Veneno",category:"Especial",power:30,accuracy:75,desc:"Ba√±o de lodo. Puede envenenar."},"Bomba Lodo":{type:"Veneno",category:"Especial",power:90,accuracy:100,desc:"Lanza lodo t√≥xico. Puede envenenar."},T√≥xico:{type:"Veneno",category:"Estado",power:null,accuracy:90,desc:"Envenena gravemente. Da√±o crece cada turno."},Terremoto:{type:"Tierra",category:"F√≠sico",power:100,accuracy:100,desc:"Terremoto que golpea a todos los adyacentes."},Magnitud:{type:"Tierra",category:"F√≠sico",power:null,accuracy:100,desc:"Terremoto de intensidad variable (10-150)."},"Ataque Arena":{type:"Tierra",category:"Estado",power:null,accuracy:100,desc:"Lanza arena que baja la Precisi√≥n rival."},"Tormenta Arena":{type:"Roca",category:"Estado",power:null,accuracy:100,desc:"Tormenta de arena que da√±a a no-Tierra/Roca/Acero."},Vuelo:{type:"Volador",category:"F√≠sico",power:70,accuracy:100,desc:"Vuela alto y ataca en el siguiente turno."},"Golpe A√©reo":{type:"Volador",category:"F√≠sico",power:60,accuracy:100,desc:"Ataque a√©reo que nunca falla."},"Mov. Espejo":{type:"Volador",category:"Especial",power:null,accuracy:100,desc:"Devuelve el da√±o especial recibido x2."},Ps√≠quico:{type:"Ps√≠quico",category:"Especial",power:90,accuracy:100,desc:"Onda ps√≠quica potente. Puede bajar Def. Esp."},Psicorrayo:{type:"Ps√≠quico",category:"Especial",power:65,accuracy:100,desc:"Rayo ps√≠quico que puede confundir."},Reflejo:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Barrera que reduce da√±o f√≠sico al equipo."},"Pantalla Luz":{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Barrera que reduce da√±o especial al equipo."},"Paz Mental":{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Meditaci√≥n que sube At. Esp. y Def. Esp."},Descanso:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Duerme 2 turnos pero cura todos los PS."},Hipnosis:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:60,desc:"Ondas hipn√≥ticas que duermen al objetivo."},Paranormal:{type:"Ps√≠quico",category:"Especial",power:80,accuracy:100,desc:"Ataque con poderes ps√≠quicos extra√±os."},"Rayo Confuso":{type:"Fantasma",category:"Estado",power:null,accuracy:100,desc:"Luz siniestra que confunde al objetivo."},Agilidad:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Relaja el cuerpo para subir mucho la Velocidad."},Amnesia:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Vac√≠a la mente para subir mucho Def. Esp."},"Lanza Rocas":{type:"Roca",category:"F√≠sico",power:50,accuracy:90,desc:"Lanza rocas peque√±as al objetivo."},"Tumba Rocas":{type:"Roca",category:"F√≠sico",power:50,accuracy:80,desc:"Lanza rocas que bajan la Velocidad rival."},"Poder Pasado":{type:"Roca",category:"Especial",power:60,accuracy:100,desc:"Poder ancestral. Puede subir todas las stats."},Avalancha:{type:"Roca",category:"F√≠sico",power:75,accuracy:90,desc:"Lanza rocas. M√°s da√±o si el usuario fue da√±ado."},Desenrollar:{type:"Roca",category:"F√≠sico",power:30,accuracy:100,desc:"Rueda que incrementa poder cada turno."},"Bola Sombra":{type:"Fantasma",category:"Especial",power:80,accuracy:100,desc:"Lanza bola de sombras. Puede bajar Def. Esp."},"Pu√±o Sombra":{type:"Fantasma",category:"F√≠sico",power:60,accuracy:100,desc:"Pu√±etazo de sombras. Golpea primero."},Maldici√≥n:{type:"Fantasma",category:"Estado",power:null,accuracy:100,desc:"Fantasma: maldice a costa de PS. Otro: sube stats."},Tinieblas:{type:"Fantasma",category:"Especial",power:null,accuracy:100,desc:"M√°s da√±o cuanto m√°s PS tenga el usuario."},Dragoaliento:{type:"Drag√≥n",category:"Especial",power:60,accuracy:100,desc:"Aliento drag√≥n. Puede paralizar."},"Garra Drag√≥n":{type:"Drag√≥n",category:"F√≠sico",power:80,accuracy:100,desc:"Zarpazo con garras afiladas de drag√≥n."},"Danza Drag√≥n":{type:"Drag√≥n",category:"Estado",power:null,accuracy:100,desc:"Danza m√≠stica que sube Ataque y Velocidad."},Mordisco:{type:"Siniestro",category:"F√≠sico",power:60,accuracy:100,desc:"Muerde con colmillos. Puede hacer retroceder."},Triturar:{type:"Siniestro",category:"F√≠sico",power:80,accuracy:100,desc:"Tritura con mand√≠bulas. Puede bajar Defensa."},Acuchillar:{type:"Siniestro",category:"F√≠sico",power:70,accuracy:100,desc:"Corte siniestro. Alta prob. de cr√≠tico."},Mofa:{type:"Siniestro",category:"Estado",power:null,accuracy:100,desc:"Provoca al rival. Solo puede usar ataques."},"Ala de Acero":{type:"Acero",category:"F√≠sico",power:70,accuracy:100,desc:"Golpea con alas de acero. Puede subir Defensa."}};function Pu(n){switch(n){case"F√≠sico":return"üí•";case"Especial":return"‚ú®";case"Estado":return"üîÑ";default:return"‚ùì"}}const qc={emerald:{"--primary-color":"#2d9e6d","--primary-rgb":"45, 158, 109","--primary-glow":"#6ee7b7","--ray-black":"#080a09","--ray-charcoal":"#111413","--glass-bg":"rgba(22, 26, 24, 0.6)","--glass-strong":"rgba(10, 15, 12, 0.85)","--bg-image":`radial-gradient(circle at 50% 0%, rgba(45, 158, 109, 0.15) 0%, transparent 50%),
                   radial-gradient(circle at 85% 90%, rgba(247, 207, 82, 0.05) 0%, transparent 40%)`},platinum:{"--primary-color":"#d4af37","--primary-rgb":"212, 175, 55","--primary-glow":"#f9e58b","--ray-black":"#0a0a0c","--ray-charcoal":"#141418","--glass-bg":"rgba(20, 20, 24, 0.6)","--glass-strong":"rgba(10, 10, 14, 0.85)","--bg-image":`radial-gradient(circle at 50% 0%, rgba(212, 175, 55, 0.15) 0%, transparent 60%),
                   radial-gradient(circle at 15% 90%, rgba(75, 75, 90, 0.1) 0%, transparent 40%)`}},Re={EMERALD:"emerald",PLATINUM:"platinum"};function ye(){return localStorage.getItem("selectedGame")||Re.EMERALD}function Ym(n){Object.values(Re).includes(n)&&(localStorage.setItem("selectedGame",n),ep())}function Zm(n){return n===Re.PLATINUM?"Pok√©mon Platino":"Pok√©mon Esmeralda"}function ep(){const n=ye();Iu(n),window.dispatchEvent(new CustomEvent("gameChanged",{detail:n}))}function Iu(n){const e=qc[n]||qc[Re.EMERALD];Object.entries(e).forEach(([t,r])=>{document.documentElement.style.setProperty(t,r)})}const $i="https://pokeapi.co/api/v2",no={pokemon:new Map,species:new Map,evolutionChain:new Map,moves:new Map},Ma={emerald:"emerald",platinum:"platinum"};async function ro(n,e,t){if(e.has(t))return e.get(t);try{const r=await fetch(n);if(!r.ok)throw new Error(`HTTP ${r.status}`);const a=await r.json();return e.set(t,a),a}catch(r){throw console.error(`PokeAPI fetch error for ${n}:`,r),r}}async function ao(n){const e=String(n).toLowerCase(),t=`${$i}/pokemon/${e}`;return ro(t,no.pokemon,e)}async function Cu(n){const e=String(n).toLowerCase(),t=`${$i}/pokemon-species/${e}`;return ro(t,no.species,e)}async function tp(n){try{const t=(await Cu(n)).evolution_chain.url,r=t.split("/").filter(Boolean).pop(),a=await ro(t,no.evolutionChain,r);return Su(a.chain)}catch(e){return console.error("Error fetching evolution chain:",e),[]}}function Su(n,e=[]){const t=n.species.name,r=n.species.url.split("/").filter(Boolean).pop();let a=null;if(n.evolution_details&&n.evolution_details.length>0){const i=n.evolution_details[0];a={trigger:i.trigger?.name||null,minLevel:i.min_level||null,item:i.item?.name||null,heldItem:i.held_item?.name||null,timeOfDay:i.time_of_day||null,minHappiness:i.min_happiness||null,minAffection:i.min_affection||null,location:i.location?.name||null,knownMove:i.known_move?.name||null,knownMoveType:i.known_move_type?.name||null}}if(e.push({name:t,id:parseInt(r),sprite:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${r}.png`,evolutionDetails:a}),n.evolves_to&&n.evolves_to.length>0)for(const i of n.evolves_to)Su(i,e);return e}async function ku(n,e){try{const t=await ao(n),r=[];for(const a of t.moves){const i=a.version_group_details.find(s=>s.version_group.name===e&&s.move_learn_method.name==="level-up"&&s.level_learned_at>0);i&&r.push({name:a.move.name,level:i.level_learned_at,url:a.move.url})}return r.sort((a,i)=>a.level-i.level),r}catch(t){return console.error("Error fetching learnset:",t),[]}}async function np(n,e){try{const t=await ao(n),r=[];let a=!1;for(const l of t.moves){let d=l.version_group_details.find(h=>h.version_group.name===e);d?a=!0:l.version_group_details.length>0&&(d=l.version_group_details[l.version_group_details.length-1]),d&&r.push({name:l.move.name,method:d.move_learn_method.name,level:d.level_learned_at,url:l.move.url})}a||console.warn(`[PokeAPI] No moves found for version group "${e}". Falling back to latest available moves.`);const i=r.map(l=>oo(l.name)),s=await Promise.all(i);return r.map((l,d)=>{const h=s[d];return h?{...l,...h,displayName:h.displayName||Je(l.name)}:null}).filter(l=>l!==null)}catch(t){return console.error("Error getting all learnable moves",t),[]}}async function oo(n){const e=String(n).toLowerCase(),t=`${$i}/move/${e}`;try{const r=await ro(t,no.moves,e),a=r.names.find(h=>h.language.name==="es"),i=a?a.name:xu[r.name]||Je(r.name);let s="";const l=r.flavor_text_entries.find(h=>h.language.name==="es"),d=r.flavor_text_entries.find(h=>h.language.name==="en");return s=l?.flavor_text||d?.flavor_text||"",{name:r.name,displayName:i,type:r.type.name,typeTranslated:Ln[r.type.name]||r.type.name,power:r.power,accuracy:r.accuracy,pp:r.pp,damageClass:r.damage_class.name,damageClassTranslated:Du[r.damage_class.name]||r.damage_class.name,description:s.replace(/\n|\f/g," ")}}catch(r){return console.error(`Error fetching move ${n}:`,r),null}}async function Ru(n,e="emerald"){try{const[t,r,a,i]=await Promise.all([ao(n),Cu(n),tp(n),ku(n,e)]),l=r.names.find(m=>m.language.name==="es")?.name||t.name;let d="";const h=e==="platinum"?["platinum","diamond","pearl","heartgold","soulsilver"]:["emerald","ruby","sapphire","firered","leafgreen"];for(const m of h){const g=r.flavor_text_entries.find(E=>E.language.name==="es"&&E.version.name===m);if(g){d=g.flavor_text.replace(/\n|\f/g," ");break}}if(!d){const m=r.flavor_text_entries.find(g=>g.language.name==="es");m&&(d=m.flavor_text.replace(/\n|\f/g," "))}if(!d){const m=r.flavor_text_entries.find(g=>g.language.name==="en");m&&(d=m.flavor_text.replace(/\n|\f/g," "))}return{id:t.id,name:l,englishName:t.name,types:t.types.map(m=>m.type.name),sprite:t.sprites.front_default,spriteAnimated:t.sprites.versions?.["generation-v"]?.["black-white"]?.animated?.front_default,stats:{hp:t.stats.find(m=>m.stat.name==="hp").base_stat,attack:t.stats.find(m=>m.stat.name==="attack").base_stat,defense:t.stats.find(m=>m.stat.name==="defense").base_stat,spAttack:t.stats.find(m=>m.stat.name==="special-attack").base_stat,spDefense:t.stats.find(m=>m.stat.name==="special-defense").base_stat,speed:t.stats.find(m=>m.stat.name==="speed").base_stat},height:t.height/10,weight:t.weight/10,abilities:t.abilities.map(m=>({name:m.ability.name,isHidden:m.is_hidden})),flavorText:d,evolutionChain:a,learnset:i}}catch(t){throw console.error("Error fetching complete Pokemon info:",t),t}}function Je(n){return n.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}const Ln={normal:"Normal",fire:"Fuego",water:"Agua",electric:"El√©ctrico",grass:"Planta",ice:"Hielo",fighting:"Lucha",poison:"Veneno",ground:"Tierra",flying:"Volador",psychic:"Ps√≠quico",bug:"Bicho",rock:"Roca",ghost:"Fantasma",dragon:"Drag√≥n",dark:"Siniestro",steel:"Acero",fairy:"Hada"},Du={physical:"F√≠sico",special:"Especial",status:"Estado"},Mu={"fire-stone":"Piedra Fuego","water-stone":"Piedra Agua","thunder-stone":"Piedra Trueno","leaf-stone":"Piedra Hoja","moon-stone":"Piedra Lunar","sun-stone":"Piedra Solar","shiny-stone":"Piedra D√≠a","dusk-stone":"Piedra Noche","dawn-stone":"Piedra Alba","oval-stone":"Piedra Oval",protector:"Protector",electirizer:"Electrizador",magmarizer:"Magmatizador","dubious-disc":"Disco Extra√±o","reaper-cloth":"Tela Terrible","razor-claw":"Garra Afilada","razor-fang":"Colmillo Agudo","prism-scale":"Escama Bella","kings-rock":"Roca del Rey","metal-coat":"Revest. Met√°l.","dragon-scale":"Escama Drag√≥n",upgrade:"Mejora","deep-sea-tooth":"Diente Marino","deep-sea-scale":"Escama Marina","link-cable":"Cable Link"},rp={"kings-rock":"Roca del Rey","metal-coat":"Revest. Met√°l.","dragon-scale":"Escama Drag√≥n","deep-sea-tooth":"Diente Marino","deep-sea-scale":"Escama Marina",electirizer:"Electrizador",magmarizer:"Magmatizador",protector:"Protector","dubious-disc":"Disco Extra√±o","reaper-cloth":"Tela Terrible","prism-scale":"Escama Bella","whipped-dream":"Dulce de Nata",sachet:"Saquito Aroma"},ap={"level-up":"Subir nivel",trade:"Intercambio","use-item":"Usar objeto",shed:"Muda",spin:"Girar","tower-of-darkness":"Torre Oscura","tower-of-waters":"Torre Agua","three-critical-hits":"3 Golpes Cr√≠ticos","take-damage":"Recibir da√±o",other:"Otro"},op={"eterna-forest":"Bosque Eterno","pinwheel-forest":"Bosque Azulejo","kalos-route-20":"Ruta 20 (Kalos)","mt-coronet":"Monte Corona","chargestone-cave":"Cueva Electrorroca","new-mauville":"Nuevo Malvalona","twist-mountain":"Monte Tuerca","frost-cavern":"Cueva Helada","sinnoh-route-217":"Ruta 217 (Sinnoh)","mossy-rock":"Roca Musgo","icy-rock":"Roca Hielo","magnetic-field":"Campo Magn√©tico"},ip={overgrow:"Espesura",blaze:"Mar Llamas",torrent:"Torrente",swarm:"Enjambre",chlorophyll:"Clorofila","solar-power":"Poder Solar","swift-swim":"Nado R√°pido","rain-dish":"Cura Lluvia","sand-stream":"Chorro Arena","snow-warning":"Alerta Nieve",drought:"Sequ√≠a",drizzle:"Llovizna","flash-fire":"Absorbe Fuego",levitate:"Levitaci√≥n",intimidate:"Intimidaci√≥n","hyper-cutter":"Corte Fuerte","huge-power":"Potencia","pure-power":"Energ√≠a Pura","speed-boost":"Impulso",sturdy:"Robustez",static:"Elec. Est√°tica","lightning-rod":"Pararrayos","volt-absorb":"Absorbe Elec","water-absorb":"Absorbe Agua","natural-cure":"Cura Natural",synchronize:"Sincron√≠a",trace:"Rastro","clear-body":"Cuerpo Puro","thick-fat":"Grasa Espesa","marvel-scale":"Escama Especial","shed-skin":"Mudar",guts:"Agallas",pressure:"Presi√≥n","inner-focus":"Foco Interno","wonder-guard":"Superguarda","poison-point":"Punto T√≥xico","effect-spore":"Efecto Espora","flame-body":"Cuerpo Llama","magma-armor":"Armadura Magma","compound-eyes":"Ojo Compuesto","keen-eye":"Vista Lince","arena-trap":"Trampa Arena","shadow-tag":"Sombra Trampa","rough-skin":"Piel Tosca","sand-veil":"Velo Arena","snow-cloak":"Manto N√≠veo",pickup:"Recogida","run-away":"Fuga",hustle:"Entusiasmo",rivalry:"Rivalidad",adaptability:"Adaptable",technician:"Experto","skill-link":"Encadenado","serene-grace":"Dicha","shield-dust":"Polvo Escudo","magic-guard":"Muro M√°gico","mold-breaker":"Rompemoldes","iron-fist":"Pu√±o F√©rreo","sheer-force":"Potencia Bruta",prankster:"Bromista",defiant:"Competitivo",justified:"Justiciero",moody:"Veleta",multiscale:"Multiescamas",regenerator:"Regeneraci√≥n","poison-heal":"Ant√≠doto","magic-bounce":"Espejo M√°gico","sand-rush":"√çmpetu Arena",chlorophyl:"Clorofila","swift-swin":"Nado R√°pido",drizzle:"Llovizna",forecast:"Predicci√≥n","battle-armor":"Armadura Batalla","shell-armor":"Caparaz√≥n","air-lock":"Esclusa Aire","stance-change":"Cambio T√°ctico",protean:"Mutatipo",pixilate:"Piel Fe√©rica",aerilate:"Piel Celeste",refrigerate:"Piel Helada",galvanize:"Piel El√©ctrica","beast-boost":"Ultraimpulso","electric-surge":"Creador Campo El√©ctrico","grassy-surge":"Creador Campo de Hierba","misty-surge":"Creador Campo de Niebla","psychic-surge":"Creador Campo Ps√≠quico",damp:"Humedad",oblivious:"Despiste",immunity:"Inmunidad","own-tempo":"Ritmo Propio",limber:"Flexibilidad",insomnia:"Insomnio","vital-spirit":"Esp√≠ritu Vital","early-bird":"Madrugar","cute-charm":"Gran Encanto","rock-head":"Cabeza Roca",truant:"Ausente",stench:"Hedor","suction-cups":"Ventosas",illuminate:"Iluminaci√≥n",soundproof:"Insonorizar","sticky-hold":"Pegamento","magnet-pull":"Im√°n","color-change":"Cambiacolor","liquid-ooze":"Viscosidad",gluttony:"Gula","white-smoke":"Humo Blanco",hydration:"Hidrataci√≥n",filter:"Filtro","solid-rock":"Roca S√≥lida","anger-point":"Irascible",unaware:"Ignorante","tinted-lens":"Cromolente","super-luck":"Afortunado",aftermath:"Detonaci√≥n",sniper:"Francotirador","ice-body":"G√©lido",download:"Descarga",simple:"Simple","dry-skin":"Piel Seca",reckless:"Audaz",rivalry:"Rivalidad",steadfast:"Impasible","no-guard":"Indefenso",stall:"Rezagado","leaf-guard":"Defensa Hoja",klutz:"Zoquete","bad-dreams":"Mal Sue√±o","slow-start":"Inicio Lento",scrappy:"Agallas",normalize:"Normalizar","tangled-feet":"Pies Confusos","motor-drive":"Electromotor",unburden:"Liviano",heatproof:"Ign√≠fugo","honey-gather":"Recogemiel",frisk:"Cacheo"};function sp(n){return ip[n]||Je(n)}function cp(n){return Mu[n]||Je(n)}function lp(n){return rp[n]||Mu[n]||Je(n)}function up(n){return op[n]||Je(n)}function dp(n){return ap[n]||Je(n)}const xu={tackle:"Placaje",scratch:"Ara√±azo",pound:"Destructor",slam:"Portazo",stomp:"Pisot√≥n","mega-punch":"Megapu√±o","mega-kick":"Megapatada","comet-punch":"Pu√±o Cometa","double-slap":"Doble Bofet√≥n",wrap:"Atadura",bind:"Constricci√≥n",clamp:"Tenaza","vice-grip":"Agarre",guillotine:"Guillotina","razor-wind":"Viento Cortante",gust:"Tornado","pay-day":"D√≠a de Pago","horn-attack":"Cornada","horn-drill":"Perforador","fury-attack":"Ataque Furia","fury-swipes":"Golpes Furia",barrage:"Bombardeo","spike-cannon":"Clavo Ca√±√≥n",bonemerang:"Huesomerang","bone-rush":"Ataque √ìseo","bone-club":"Hueso Palo","skull-bash":"Cabezazo",growl:"Gru√±ido",leer:"Malicioso","tail-whip":"L√°tigo","sand-attack":"Ataque Arena",smokescreen:"Pantalla Humo",harden:"Fortaleza",withdraw:"Refugio","defense-curl":"Rizo Defensa",minimize:"Reducci√≥n",growth:"Desarrollo",meditate:"Meditaci√≥n",sharpen:"Afilar",foresight:"Profec√≠a","odor-sleuth":"Rastreo","mud-sport":"Chapoteo Lodo","water-sport":"Hidrochorro",bide:"Venganza","focus-energy":"Foco Energ√≠a",stockpile:"Reserva","spit-up":"Escupir",swallow:"Tragar",conversion:"Conversi√≥n","conversion-2":"Conversi√≥n 2",camouflage:"Camuflaje",spite:"Rencor",powder:"Polvo","lucky-chant":"Conjuro","guard-swap":"Cambia Defensa","power-swap":"Cambia Fuerza","heart-swap":"Cambia Almas","skill-swap":"Intercambio","role-play":"Imitaci√≥n",ember:"Ascuas",flamethrower:"Lanzallamas","fire-blast":"Llamarada","fire-spin":"Giro Fuego","fire-punch":"Pu√±o Fuego","fire-fang":"Colmillo √çgneo","flame-wheel":"Rueda Fuego","blaze-kick":"Patada √çgnea","heat-wave":"Onda √çgnea",eruption:"Estallido","lava-plume":"Humareda","magma-storm":"Lluvia √çgnea",overheat:"Sofoco","will-o-wisp":"Fuego Fatuo","sunny-day":"D√≠a Soleado","flare-blitz":"Envite √çgneo","water-gun":"Pistola Agua","hydro-pump":"Hidrobomba",surf:"Surf",waterfall:"Cascada",bubble:"Burbuja","bubble-beam":"Rayo Burbuja","water-pulse":"Hidropulso","aqua-tail":"Acua Cola","aqua-jet":"Acua Jet","aqua-ring":"Acua Aro","muddy-water":"Agua Lodosa",dive:"Buceo","rain-dance":"Danza Lluvia","hydro-cannon":"Hidroca√±√≥n",whirlpool:"Torbellino",crabhammer:"Martillazo",clamp:"Tenaza",brine:"Salmuera",thunder:"Trueno",thunderbolt:"Rayo","thunder-shock":"Impactrueno","thunder-wave":"Onda Trueno","thunder-punch":"Pu√±o Trueno","thunder-fang":"Colmillo Rayo",spark:"Chispa",discharge:"Chispazo",charge:"Carga","charge-beam":"Rayo Carga","volt-tackle":"Placaje El√©c.","shock-wave":"Onda Voltio","zap-cannon":"Electroca√±√≥n","magnet-rise":"Magnetismo","razor-leaf":"Hoja Afilada","solar-beam":"Rayo Solar","vine-whip":"L√°tigo Cepa","giga-drain":"Giga Drenado","mega-drain":"Mega Agotar",absorb:"Absorber","leech-seed":"Drenadoras","leaf-blade":"Hoja Aguda","seed-bomb":"Bomba Germen","energy-ball":"Energibola","power-whip":"Latigazo",synthesis:"S√≠ntesis","grass-knot":"Hierba Lazo","leaf-storm":"Lluevehojas","bullet-seed":"Bala Semilla","petal-dance":"Danza P√©talo","magical-leaf":"Hoja M√°gica","worry-seed":"Abatidoras",ingrain:"Arraigo",aromatherapy:"Aromaterapia","frenzy-plant":"Planta Feroz","wood-hammer":"Mazazo","needle-arm":"Brazo Pincho","ice-beam":"Rayo Hielo",blizzard:"Ventisca","aurora-beam":"Rayo Aurora","icy-wind":"Viento Hielo","ice-punch":"Pu√±o Hielo","ice-fang":"Colmillo Hielo","ice-shard":"Esquirla Helada","ice-ball":"Bola Hielo","powder-snow":"Nieve Polvo","sheer-cold":"Fr√≠o Polar",hail:"Granizo",avalanche:"Avalancha",mist:"Neblina",haze:"Niebla","karate-chop":"Golpe K√°rate","cross-chop":"Tajo Cruzado","brick-break":"Demolici√≥n","sky-uppercut":"Gancho Alto","focus-punch":"Pu√±o Certero","focus-blast":"Onda Certera","mach-punch":"Ultrapu√±o","bullet-punch":"Pu√±o Bala","close-combat":"A Bocajarro",superpower:"Fuerza Bruta",reversal:"Inversi√≥n",counter:"Contraataque","seismic-toss":"Mov. S√≠smico",submission:"Sumisi√≥n","vital-throw":"Tiro Vital","low-kick":"Patada Baja","jump-kick":"Patada Salto","hi-jump-kick":"Pat. Salto Alta","rolling-kick":"Patada Giro","triple-kick":"Triple Patada","dynamic-punch":"Pu√±o Din√°mico","drain-punch":"Pu√±o Drenaje","hammer-arm":"Machada","aura-sphere":"Esfera Aural","force-palm":"Palmeo","rock-smash":"Golpe Roca","bulk-up":"Corpulencia",detect:"Detecci√≥n",earthquake:"Terremoto",dig:"Excavar","mud-slap":"Bofet√≥n Lodo","mud-shot":"Disparo Lodo","mud-bomb":"Bomba Fango","earth-power":"Tierra Viva",magnitude:"Magnitud",fissure:"Fisura","bone-rush":"Ataque √ìseo",spikes:"P√∫as","sand-tomb":"Bucle Arena",bulldoze:"Terratemblor",fly:"Vuelo","aerial-ace":"Golpe A√©reo","wing-attack":"Ataque Ala",peck:"Picotazo","drill-peck":"Pico Taladro","air-slash":"Tajo A√©reo","air-cutter":"Aire Afilado","brave-bird":"P√°jaro Osado","sky-attack":"Ataque A√©reo",bounce:"Bote",pluck:"Picoteo",roost:"Respiro",tailwind:"Viento Af√≠n",defog:"Despejar","mirror-move":"Mov. Espejo","feather-dance":"Danza Pluma",psychic:"Ps√≠quico",confusion:"Confusi√≥n",psybeam:"Psicorrayo",psywave:"Psicoonda",hypnosis:"Hipnosis","dream-eater":"Come Sue√±os","psycho-cut":"Psicocorte","psycho-boost":"Psicoataque","zen-headbutt":"Cabezazo Zen",extrasensory:"Paranormal","future-sight":"Premonici√≥n","light-screen":"Pantalla Luz",reflect:"Reflejo",barrier:"Barrera",amnesia:"Amnesia",agility:"Agilidad","calm-mind":"Paz Mental",kinesis:"Kin√©tico",teleport:"Teletransporte","trick-room":"Espacio Raro",trick:"Truco",rest:"Descanso","psycho-shift":"Psicocambio",gravity:"Gravedad","heal-block":"Anticura","miracle-eye":"Gran Ojo","luster-purge":"Resplandor","mist-ball":"Bola Neblina","shadow-ball":"Bola Sombra","shadow-claw":"Garra Umbr√≠a","night-shade":"Tinieblas","confuse-ray":"Rayo Confuso",lick:"Leng√ºetazo","shadow-punch":"Pu√±o Sombra","shadow-sneak":"Sombra Vil","shadow-force":"Golpe Umbr√≠o","destiny-bond":"Mismo Destino",grudge:"Rabia",curse:"Maldici√≥n",spite:"Rencor",nightmare:"Pesadilla",astonish:"Impresionar","ominous-wind":"Viento Aciago",bite:"Mordisco",crunch:"Triturar","faint-attack":"Finta","feint-attack":"Finta",pursuit:"Persecuci√≥n",thief:"Ladr√≥n","knock-off":"Desarme",taunt:"Mofa",torment:"Tormento","dark-pulse":"Pulso Umbr√≠o","night-slash":"Tajo Umbr√≠o","sucker-punch":"Golpe Bajo",payback:"Vendetta",assurance:"Buena Baza",embargo:"Embargo","foul-play":"Juego Sucio","nasty-plot":"Maquinaci√≥n",flatter:"Camelo",memento:"Legado",snatch:"Robo",switcheroo:"Trapicheo","beat-up":"Paliza","rock-throw":"Lanza Rocas","rock-slide":"Avalancha","rock-tomb":"Tumba Rocas","ancient-power":"Poder Pasado","stone-edge":"Roca Afilada","head-smash":"Testarazo","rock-blast":"Pedrada","power-gem":"Joya de Luz","stealth-rock":"Trampa Rocas",sandstorm:"Tormenta Arena",rollout:"Desenrollar","iron-tail":"Cola F√©rrea","metal-claw":"Garra Metal","steel-wing":"Ala de Acero","iron-head":"Cabeza Hierro","iron-defense":"Def. F√©rrea","meteor-mash":"Pu√±o Meteoro","flash-cannon":"Foco Resplandor","magnet-bomb":"Bomba Im√°n","gyro-ball":"Giro Bola","metal-sound":"Eco Met√°lico","metal-burst":"Represi√≥n Metal","doom-desire":"Deseo Oculto","mirror-shot":"Disparo Espejo","dragon-claw":"Garra Drag√≥n","dragon-breath":"Dragoaliento","dragon-rage":"Furia Drag√≥n","dragon-dance":"Danza Drag√≥n","dragon-pulse":"Pulso Drag√≥n","dragon-rush":"Carga Drag√≥n","draco-meteor":"Cometa Draco",outrage:"Enfado",twister:"Cicl√≥n","roar-of-time":"Distorsi√≥n","spacial-rend":"Corte Vac√≠o",sludge:"Residuos","sludge-bomb":"Bomba Lodo","sludge-wave":"Onda T√≥xica","poison-sting":"Picotazo Ven",toxic:"T√≥xico","poison-jab":"Puya Nociva","cross-poison":"Veneno X","poison-fang":"Colmillo Ven.","poison-tail":"Cola Veneno","poison-gas":"Gas Venenoso","poison-powder":"Polvo Veneno",acid:"√Åcido","acid-armor":"Armadura √Åcida","gastro-acid":"Bilis","gunk-shot":"Lanzamugre","toxic-spikes":"P√∫as T√≥xicas",venoshock:"Cargat√≥xica","pin-missile":"Misil Aguja",twineedle:"Doble Ataque","fury-cutter":"Corte Furia","x-scissor":"Tijera X","bug-bite":"Picadura","bug-buzz":"Zumbido","signal-beam":"Rayo Se√±al","silver-wind":"Viento Plata","u-turn":"Ida y Vuelta","string-shot":"Disparo Demora","spider-web":"Telara√±a","leech-life":"Chupavidas","hyper-beam":"Hiperrayo","giga-impact":"Giga Impacto","double-edge":"Doble Filo","take-down":"Derribo","body-slam":"Golpe Cuerpo","quick-attack":"Ataque R√°pido","extreme-speed":"Velocidad Extrema",slash:"Cuchillada",return:"Retribuci√≥n",frustration:"Frustraci√≥n",facade:"Fachada",protect:"Protecci√≥n","sleep-talk":"Son√°mbulo",snore:"Ronquido",substitute:"Sustituto",swagger:"Contoneo",attract:"Atracci√≥n","double-team":"Doble Equipo",endure:"Aguante",roar:"Rugido",whirlwind:"Remolino",safeguard:"Velo Sagrado",yawn:"Bostezo",spore:"Espora","sleep-powder":"Polvo Sue√±o","stun-spore":"Paralizador","focus-energy":"Foco Energ√≠a",explosion:"Explosi√≥n","self-destruct":"Autodestrucci√≥n","swords-dance":"Danza Espada","hidden-power":"Poder Oculto","secret-power":"Poder Secreto",strength:"Fuerza",cut:"Corte",flash:"Destello",supersonic:"Supers√≥nico",screech:"Chirrido",recover:"Recuperaci√≥n",moonlight:"Luz Lunar","morning-sun":"Sol Matinal",wish:"Deseo",refresh:"Alivio","heal-bell":"Campana Cura",softboiled:"Huevo Pasado",headbutt:"Golpe Cabeza","tri-attack":"Triataque","super-fang":"Superfang","hyper-fang":"Hiperfang",swift:"Rapidez",covet:"Antojo","false-swipe":"Falso Tortazo",encore:"Otra Vez","pain-split":"Divide Dolor","perish-song":"Canto Mortal","baton-pass":"Relevo","helping-hand":"Refuerzo",recycle:"Reciclaje","natural-gift":"Don Natural","last-resort":"√öltima Baza",feint:"Amago",acupressure:"Acupresi√≥n","me-first":"Yo Primero",copycat:"Copi√≥n","trump-card":"Baza Secreta","wring-out":"Estruj√≥n",captivate:"Seducci√≥n",rage:"Furia",thrash:"Golpe","belly-drum":"Tambor","milk-drink":"Beber Leche",present:"Presente",sketch:"Esquema",transform:"Transformaci√≥n",metronome:"Metr√≥nomo",mimic:"Mim√©tico",disable:"Anulaci√≥n",splash:"Salpicar","mean-look":"Mal de Ojo",block:"Bloqueo","lock-on":"Fijar Blanco",constrict:"Constricci√≥n","acid-spray":"Bomba √Åcida",astonish:"Impresionar","aurora-veil":"Velo Aurora","blast-burn":"Anillo √çgneo","blaze-kick":"Patada √çgnea",bounce:"Bote",camouflage:"Camuflaje",charge:"Carga","charge-beam":"Rayo Carga","defense-curl":"Rizo Defensa",discharge:"Chispazo","double-hit":"Doble Golpe","double-kick":"Doble Patada","dragon-pulse":"Pulso Drag√≥n","dragon-rush":"Carga Drag√≥n",dragonbreath:"Dragoaliento",dynamicpunch:"Pu√±o Din√°mico","egg-bomb":"Bomba Huevo","electro-ball":"Bola Voltio",electroweb:"Electrotela",ember:"Ascuas",endeavor:"Esfuerzo",facade:"Fachada","fake-out":"Sorpresa","fake-tears":"Llanto Falso","feint-attack":"Finta","fire-fang":"Colmillo √çgneo","fire-punch":"Pu√±o Fuego","fire-spin":"Giro Fuego",flail:"Azote","flame-burst":"Pirotecnia","flame-charge":"Nitrocarga","flame-wheel":"Rueda Fuego","flash-cannon":"Foco Resplandor",fling:"Lanzamiento","focus-blast":"Onda Certera","follow-me":"Se√±uelo","foul-play":"Juego Sucio","freeze-shock":"Rayo G√©lido","frost-breath":"Aliento G√©lido",frustration:"Frustraci√≥n","fury-cutter":"Corte Furia","gastro-acid":"Bilis","gear-grind":"Rueda Doble",glaciate:"Mundo G√©lido","grass-knot":"Hierba Lazo","grass-pledge":"Hierba Juramento",growl:"Gru√±ido",growth:"Desarrollo",grudge:"Rabia","guard-split":"Isodistribuci√≥n","guard-swap":"Cambia Defensa","gunk-shot":"Lanzamugre","gyro-ball":"Giro Bola","hammer-arm":"Machada",harden:"Fortaleza","head-charge":"Ariete","head-smash":"Testarazo","heal-order":"Auxilio","heal-pulse":"Pulso Cura","heart-stamp":"Matasellos","heart-swap":"Cambia Almas","heat-crash":"Golpe Calor","heavy-slam":"Cuerpo Pesado","helping-hand":"Refuerzo",hex:"Infortunio","hi-jump-kick":"Pat. Salto Alta","hold-back":"Clemencia","hone-claws":"Afilagarras","horn-leech":"Asta Drenaje",howl:"Aullido",hurricane:"Vendaval","hydro-cannon":"Hidroca√±√≥n","hyper-voice":"Vozarr√≥n","ice-ball":"Bola Hielo","ice-burn":"Llama G√©lida","ice-fang":"Colmillo Hielo","ice-punch":"Pu√±o Hielo","ice-shard":"Esquirla Helada","icicle-crash":"Car√°mbano","icicle-spear":"Chuzos","icy-wind":"Viento Hielo",imprison:"Sellar",inferno:"Infierno",ingrain:"Arraigo","iron-defense":"Def. F√©rrea","iron-head":"Cabeza Hierro","iron-tail":"Cola F√©rrea",judgment:"Sentencia","jump-kick":"Patada Salto","karate-chop":"Golpe K√°rate",kinesis:"Kin√©tico","knock-off":"Desarme","leaf-storm":"Lluevehojas","leaf-tornado":"Cicl√≥n Hojas","leech-life":"Chupavidas","leech-seed":"Drenadoras",leer:"Malicioso",lick:"Leng√ºetazo","light-screen":"Pantalla Luz","lock-on":"Fijar Blanco","lovely-kiss":"Beso Amoroso","low-kick":"Patada Baja","low-sweep":"Barrido","lucky-chant":"Conjuro","lunar-dance":"Danza Lunar","luster-purge":"Resplandor","mach-punch":"Ultrapu√±o","magic-coat":"Capa M√°gica","magic-room":"Zona M√°gica","magical-leaf":"Hoja M√°gica","magma-storm":"Lluvia √çgnea","magnet-bomb":"Bomba Im√°n","magnet-rise":"Magnetismo",magnitude:"Magnitud","me-first":"Yo Primero","mean-look":"Mal de Ojo",meditate:"Meditaci√≥n","mega-drain":"Mega Agotar","mega-kick":"Megapatada","mega-punch":"Megapu√±o",megahorn:"Megacuerno",memento:"Legado","metal-burst":"Represi√≥n Metal","metal-claw":"Garra Metal","metal-sound":"Eco Met√°lico","meteor-mash":"Pu√±o Meteoro","mind-reader":"Presciencia",minimize:"Reducci√≥n","miracle-eye":"Gran Ojo","mirror-coat":"Manto Espejo","mirror-move":"Mov. Espejo","mirror-shot":"Disparo Espejo",mist:"Neblina","mist-ball":"Bola Neblina",moonblast:"Fuerza Lunar","mud-bomb":"Bomba Fango","mud-shot":"Disparo Lodo","mud-slap":"Bofet√≥n Lodo","muddy-water":"Agua Lodosa","nasty-plot":"Maquinaci√≥n","natural-gift":"Don Natural","nature-power":"Adaptaci√≥n","needle-arm":"Brazo Pincho","night-daze":"Pulso Noche","night-shade":"Tinieblas","night-slash":"Tajo Umbr√≠o",nightmare:"Pesadilla","noble-roar":"Rugido Noble",octazooka:"Pulpo Ca√±√≥n","odor-sleuth":"Rastreo","ominous-wind":"Viento Aciago",outrage:"Enfado",overheat:"Sofoco",payback:"Vendetta",peck:"Picotazo","perish-song":"Canto Mortal","petal-blizzard":"Tormenta Flor","petal-dance":"Danza P√©talo","pin-missile":"Misil Aguja",pluck:"Picoteo","poison-fang":"Colmillo Ven.","poison-gas":"Gas Venenoso","poison-jab":"Puya Nociva","poison-powder":"Polvo Veneno","poison-sting":"Picotazo Ven","poison-tail":"Cola Veneno",pound:"Destructor",powder:"Polvo","powder-snow":"Nieve Polvo","power-gem":"Joya de Luz","power-split":"Isofuerza","power-swap":"Cambia Fuerza","power-trick":"Truco Fuerza","power-whip":"Latigazo",present:"Presente",protect:"Protecci√≥n","psych-up":"Autosugesti√≥n",psychic:"Ps√≠quico","psycho-boost":"Psicoataque","psycho-cut":"Psicocorte","psycho-shift":"Psicocambio",psyshock:"Psicocarga",psystrike:"Golpe Ps√≠quico",psywave:"Psicoonda",punishment:"Castigo",pursuit:"Persecuci√≥n","quick-attack":"Ataque R√°pido","quick-guard":"Anticipo",rage:"Furia","rage-powder":"Polvo Ira","rain-dance":"Danza Lluvia","rapid-spin":"Giro R√°pido","razor-leaf":"Hoja Afilada","razor-shell":"Concha Filo","razor-wind":"Viento Cortante",recover:"Recuperaci√≥n",recycle:"Reciclaje",reflect:"Reflejo",refresh:"Alivio","relic-song":"Canto Arcaico",rest:"Descanso",retaliate:"Represalia",return:"Retribuci√≥n",revenge:"Desquite",reversal:"Inversi√≥n",roar:"Rugido","roar-of-time":"Distorsi√≥n","rock-blast":"Pedrada","rock-climb":"Treparrocas","rock-polish":"Pulimento","rock-slide":"Avalancha","rock-smash":"Golpe Roca","rock-throw":"Lanza Rocas","rock-tomb":"Tumba Rocas","rock-wrecker":"Romperrocas","role-play":"Imitaci√≥n",rollout:"Desenrollar",roost:"Respiro",round:"Canon","sacred-fire":"Fuego Sagrado","sacred-sword":"Espada Santa",safeguard:"Velo Sagrado","sand-tomb":"Bucle Arena",sandstorm:"Tormenta Arena",scald:"Escaldar","scary-face":"Cara Susto",scratch:"Ara√±azo",screech:"Chirrido","seed-bomb":"Bomba Germen","seed-flare":"Estallido Floral","seismic-toss":"Mov. S√≠smico","self-destruct":"Autodestrucci√≥n","shadow-ball":"Bola Sombra","shadow-claw":"Garra Umbr√≠a","shadow-force":"Golpe Umbr√≠o","shadow-punch":"Pu√±o Sombra","shadow-sneak":"Sombra Vil",sharpen:"Afilar","sheer-cold":"Fr√≠o Polar","shell-smash":"Rompe Coraza","shift-gear":"Cambio Marcha","shock-wave":"Onda Voltio","signal-beam":"Rayo Se√±al","silver-wind":"Viento Plata","simple-beam":"Onda Simple",sing:"Canto",sketch:"Esquema","skill-swap":"Intercambio","skull-bash":"Cabezazo","sky-attack":"Ataque A√©reo","sky-drop":"Ca√≠da Libre","sky-uppercut":"Gancho Alto","slack-off":"Relajo",slam:"Portazo",slash:"Cuchillada","sleep-powder":"Polvo Sue√±o","sleep-talk":"Son√°mbulo",sludge:"Residuos","sludge-bomb":"Bomba Lodo","sludge-wave":"Onda T√≥xica","smack-down":"Antia√©reo","smart-strike":"Cuerno Certero","smelling-salts":"Est√≠mulo",smog:"Poluci√≥n",smokescreen:"Pantalla Humo",snarl:"Alarido",snatch:"Robo",snore:"Ronquido",soak:"Anegar","soft-boiled":"Huevo Pasado","solar-beam":"Rayo Solar",sonicboom:"S√≥nico","spacial-rend":"Corte Vac√≠o",spark:"Chispa","spider-web":"Telara√±a","spike-cannon":"Clavo Ca√±√≥n",spikes:"P√∫as","spit-up":"Escupir",spite:"Rencor",splash:"Salpicar",spore:"Espora","stealth-rock":"Trampa Rocas","steam-eruption":"Chorro Vapor","steel-wing":"Ala de Acero",stockpile:"Reserva",stomp:"Pisot√≥n","stone-edge":"Roca Afilada","stored-power":"Poder Reserva","storm-throw":"Tiro Llave","string-shot":"Disparo Demora",struggle:"Forcejeo","struggle-bug":"Estoicismo","stun-spore":"Paralizador",submission:"Sumisi√≥n",substitute:"Sustituto","sucker-punch":"Golpe Bajo","sunny-day":"D√≠a Soleado","super-fang":"Superfang",superpower:"Fuerza Bruta",supersonic:"Supers√≥nico",surf:"Surf",swagger:"Contoneo",swallow:"Tragar","sweet-kiss":"Beso Dulce","sweet-scent":"Dulce Aroma",swift:"Rapidez",switcheroo:"Trapicheo","swords-dance":"Danza Espada",synchronoise:"Sincrorruido",synthesis:"S√≠ntesis",tackle:"Placaje","tail-glow":"Luz Caudal","tail-slap":"L√°tigo Cola","tail-whip":"L√°tigo",tailwind:"Viento Af√≠n","take-down":"Derribo",taunt:"Mofa","techno-blast":"Tecnoblaster","teeter-dance":"Danza Caos",telekinesis:"Telequinesis",teleport:"Teletransporte",thief:"Ladr√≥n",thrash:"Golpe",thunder:"Trueno","thunder-fang":"Colmillo Rayo","thunder-punch":"Pu√±o Trueno","thunder-shock":"Impactrueno","thunder-wave":"Onda Trueno",thunderbolt:"Rayo",tickle:"Cosquillas",torment:"Tormento",toxic:"T√≥xico","toxic-spikes":"P√∫as T√≥xicas",transform:"Transformaci√≥n","tri-attack":"Triataque",trick:"Truco","trick-room":"Espacio Raro","triple-kick":"Triple Patada","trump-card":"Baza Secreta",twineedle:"Doble Ataque",twister:"Cicl√≥n","u-turn":"Ida y Vuelta",uproar:"Alboroto","v-create":"V-Cremaci√≥n","vacuum-wave":"Onda Vac√≠o",venoshock:"Cargat√≥xica","vice-grip":"Agarre","vine-whip":"L√°tigo Cepa","vital-throw":"Tiro Vital","volt-switch":"Voltio Cruento","volt-tackle":"Placaje El√©c.","wake-up-slap":"Espabila","water-gun":"Pistola Agua","water-pledge":"Agua Juramento","water-pulse":"Hidropulso","water-sport":"Hidrochorro","water-spout":"Salpicar",waterfall:"Cascada","weather-ball":"Bola Clim√°tica",whirlpool:"Torbellino",whirlwind:"Remolino","wide-guard":"Vasta Guardia","wild-charge":"Voltio Cruel","will-o-wisp":"Fuego Fatuo","wing-attack":"Ataque Ala",wish:"Deseo",withdraw:"Refugio","wonder-room":"Zona Extra√±a","wood-hammer":"Mazazo","work-up":"Avivar","worry-seed":"Abatidoras",wrap:"Atadura","wring-out":"Estruj√≥n","x-scissor":"Tijera X",yawn:"Bostezo","zap-cannon":"Electroca√±√≥n","zen-headbutt":"Cabezazo Zen"};function hp(n){const e=n.toLowerCase();return xu[e]||Je(n)}const mp={134:{method:"üíß Piedra Agua",explanation:"Usa una Piedra Agua en Eevee para evolucionar."},135:{method:"‚ö° Piedra Trueno",explanation:"Usa una Piedra Trueno en Eevee para evolucionar."},136:{method:"üî• Piedra Fuego",explanation:"Usa una Piedra Fuego en Eevee para evolucionar."},196:{method:"‚òÄÔ∏è Felicidad de d√≠a",explanation:"Sube el nivel de Eevee con felicidad m√°xima durante el D√çA."},197:{method:"üåô Felicidad de noche",explanation:"Sube el nivel de Eevee con felicidad m√°xima durante la NOCHE."},470:{method:"üåø Roca Musgo",explanation:"Sube de nivel a Eevee cerca de una Roca Musgo."},471:{method:"‚ùÑÔ∏è Roca Hielo",explanation:"Sube de nivel a Eevee cerca de una Roca Hielo."},68:{method:"üîÑ Intercambio",explanation:"Intercambia Machoke con otro jugador."},76:{method:"üîÑ Intercambio",explanation:"Intercambia Graveler con otro jugador."},94:{method:"üîÑ Intercambio",explanation:"Intercambia Haunter con otro jugador."},65:{method:"üîÑ Intercambio",explanation:"Intercambia Kadabra con otro jugador."},186:{method:"üîÑ Intercambio + Roca del Rey",explanation:"Intercambia Poliwhirl mientras porta Roca del Rey."},199:{method:"üîÑ Intercambio + Roca del Rey",explanation:"Intercambia Slowpoke mientras porta Roca del Rey."},208:{method:"üîÑ Intercambio + Revest. Met√°lico",explanation:"Intercambia Onix mientras porta Revestimiento Met√°lico."},212:{method:"üîÑ Intercambio + Revest. Met√°lico",explanation:"Intercambia Scyther mientras porta Revestimiento Met√°lico."},230:{method:"üîÑ Intercambio + Escama Drag√≥n",explanation:"Intercambia Seadra mientras porta Escama Drag√≥n."},233:{method:"üîÑ Intercambio + Mejora",explanation:"Intercambia Porygon mientras porta Mejora."},474:{method:"üîÑ Intercambio + Disco Extra√±o",explanation:"Intercambia Porygon2 mientras porta Disco Extra√±o."},467:{method:"üîÑ Intercambio + Magmatizador",explanation:"Intercambia Magmar mientras porta Magmatizador."},466:{method:"üîÑ Intercambio + Electrizador",explanation:"Intercambia Electabuzz mientras porta Electrizador."},464:{method:"üîÑ Intercambio + Protector",explanation:"Intercambia Rhydon mientras porta Protector."},477:{method:"üîÑ Intercambio + Tela Terrible",explanation:"Intercambia Dusclops mientras porta Tela Terrible."},350:{method:"‚ú® Belleza m√°xima",explanation:"En Gen 3-4: Sube la Belleza de Feebas al m√°ximo con Pok√©cubos/Pokitos y luego sube de nivel. En Gen 5+: Intercambia Feebas con Escama Bella."},169:{method:"‚ù§Ô∏è Felicidad alta",explanation:"Sube de nivel a Golbat con felicidad m√°xima (220+)."},242:{method:"‚ù§Ô∏è Felicidad alta",explanation:"Sube de nivel a Chansey con felicidad m√°xima."},462:{method:"üìç Campo Magn√©tico",explanation:"Sube de nivel a Magneton en Monte Corona (Sinnoh) o zona con campo magn√©tico."},476:{method:"üìç Campo Magn√©tico",explanation:"Sube de nivel a Nosepass en Monte Corona (Sinnoh) o zona con campo magn√©tico."},463:{method:"üìñ Saber Desenrollar",explanation:"Sube de nivel a Lickitung sabiendo el movimiento Desenrollar."},469:{method:"üìñ Saber Poder Pasado",explanation:"Sube de nivel a Yanma sabiendo el movimiento Poder Pasado."},473:{method:"üìñ Saber Poder Pasado",explanation:"Sube de nivel a Piloswine sabiendo el movimiento Poder Pasado."},465:{method:"üìñ Saber Poder Pasado",explanation:"Sube de nivel a Tangela sabiendo el movimiento Poder Pasado."},468:{method:"üíé Piedra D√≠a",explanation:"Usa una Piedra D√≠a en Togetic."},292:{method:"üêõ Evoluci√≥n especial",explanation:"Aparece en tu equipo al evolucionar Nincada a Ninjask si tienes: espacio en el equipo + Pok√© Ball normal en la bolsa."}};function pp(n){return mp[n]||null}const gp=()=>{};var Uc={};const Vu=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},fp=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const a=n[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=n[t++];e[r++]=String.fromCharCode((a&31)<<6|i&63)}else if(a>239&&a<365){const i=n[t++],s=n[t++],l=n[t++],d=((a&7)<<18|(i&63)<<12|(s&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const i=n[t++],s=n[t++];e[r++]=String.fromCharCode((a&15)<<12|(i&63)<<6|s&63)}}return e.join("")},Lu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<n.length;a+=3){const i=n[a],s=a+1<n.length,l=s?n[a+1]:0,d=a+2<n.length,h=d?n[a+2]:0,m=i>>2,g=(i&3)<<4|l>>4;let E=(l&15)<<2|h>>6,S=h&63;d||(S=64,s||(E=64)),r.push(t[m],t[g],t[E],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Vu(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):fp(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<n.length;){const i=t[n.charAt(a++)],l=a<n.length?t[n.charAt(a)]:0;++a;const h=a<n.length?t[n.charAt(a)]:64;++a;const g=a<n.length?t[n.charAt(a)]:64;if(++a,i==null||l==null||h==null||g==null)throw new yp;const E=i<<2|l>>4;if(r.push(E),h!==64){const S=l<<4&240|h>>2;if(r.push(S),g!==64){const I=h<<6&192|g;r.push(I)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class yp extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vp=function(n){const e=Vu(n);return Lu.encodeByteArray(e,!0)},xa=function(n){return vp(n).replace(/\./g,"")},Nu=function(n){try{return Lu.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ep(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const _p=()=>Ep().__FIREBASE_DEFAULTS__,bp=()=>{if(typeof process>"u"||typeof Uc>"u")return;const n=Uc.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},wp=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Nu(n[1]);return e&&JSON.parse(e)},io=()=>{try{return gp()||_p()||bp()||wp()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Fu=n=>io()?.emulatorHosts?.[n],Ap=n=>{const e=Fu(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ou=()=>io()?.config,Bu=n=>io()?.[`_${n}`];class Tp{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Nn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function zu(n){return(await fetch(n,{credentials:"include"})).ok}function Pp(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[xa(JSON.stringify(t)),xa(JSON.stringify(s)),""].join(".")}const pr={};function Ip(){const n={prod:[],emulator:[]};for(const e of Object.keys(pr))pr[e]?n.emulator.push(e):n.prod.push(e);return n}function Cp(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let $c=!1;function qu(n,e){if(typeof window>"u"||typeof document>"u"||!Nn(window.location.host)||pr[n]===e||pr[n]||$c)return;pr[n]=e;function t(E){return`__firebase__banner__${E}`}const r="__firebase__banner",i=Ip().prod.length>0;function s(){const E=document.getElementById(r);E&&E.remove()}function l(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function d(E,S){E.setAttribute("width","24"),E.setAttribute("id",S),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function h(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{$c=!0,s()},E}function m(E,S){E.setAttribute("id",S),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function g(){const E=Cp(r),S=t("text"),I=document.getElementById(S)||document.createElement("span"),R=t("learnmore"),C=document.getElementById(R)||document.createElement("a"),L=t("preprendIcon"),z=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const $=E.element;l($),m(C,R);const Y=h();d(z,L),$.append(z,I,C,Y),document.body.appendChild($)}i?(I.innerText="Preview backend disconnected.",z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Te(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Sp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Te())}function kp(){const n=io()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Rp(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Dp(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Mp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function xp(){const n=Te();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Vp(){return!kp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Lp(){try{return typeof indexedDB=="object"}catch{return!1}}function Np(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}const Fp="FirebaseError";class it extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Fp,Object.setPrototypeOf(this,it.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Vr.prototype.create)}}class Vr{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,i=this.errors[e],s=i?Op(i,r):"Error",l=`${this.serviceName}: ${s} (${a}).`;return new it(a,l,r)}}function Op(n,e){return n.replace(Bp,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const Bp=/\{\$([^}]+)}/g;function zp(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Xt(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const i=n[a],s=e[a];if(jc(i)&&jc(s)){if(!Xt(i,s))return!1}else if(i!==s)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function jc(n){return n!==null&&typeof n=="object"}function Lr(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function qp(n,e){const t=new Up(n,e);return t.subscribe.bind(t)}class Up{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");$p(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=ei),a.error===void 0&&(a.error=ei),a.complete===void 0&&(a.complete=ei);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $p(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ei(){}function ve(n){return n&&n._delegate?n._delegate:n}class Yt{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ht="[DEFAULT]";class jp{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Tp;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(r)return null;throw a}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Gp(e))try{this.getOrInitializeService({instanceIdentifier:Ht})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:a});r.resolve(i)}catch{}}}}clearInstance(e=Ht){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ht){return this.instances.has(e)}getOptions(e=Ht){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,s]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&s.resolve(a)}return a}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(r)??new Set;a.add(e),this.onInitCallbacks.set(r,a);const i=this.instances.get(r);return i&&e(i,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Hp(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ht){return this.component?this.component.multipleInstances?e:Ht:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Hp(n){return n===Ht?void 0:n}function Gp(n){return n.instantiationMode==="EAGER"}class Wp{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new jp(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var G;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(G||(G={}));const Kp={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},Qp=G.INFO,Jp={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},Xp=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),a=Jp[e];if(a)console[a](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ji{constructor(e){this.name=e,this._logLevel=Qp,this._logHandler=Xp,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Kp[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}}const Yp=(n,e)=>e.some(t=>n instanceof t);let Hc,Gc;function Zp(){return Hc||(Hc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eg(){return Gc||(Gc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Uu=new WeakMap,fi=new WeakMap,$u=new WeakMap,ti=new WeakMap,Hi=new WeakMap;function tg(n){const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("success",i),n.removeEventListener("error",s)},i=()=>{t(bt(n.result)),a()},s=()=>{r(n.error),a()};n.addEventListener("success",i),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&Uu.set(t,n)}).catch(()=>{}),Hi.set(e,n),e}function ng(n){if(fi.has(n))return;const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",s),n.removeEventListener("abort",s)},i=()=>{t(),a()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",i),n.addEventListener("error",s),n.addEventListener("abort",s)});fi.set(n,e)}let yi={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return fi.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$u.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function rg(n){yi=n(yi)}function ag(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(ni(this),e,...t);return $u.set(r,e.sort?e.sort():[e]),bt(r)}:eg().includes(n)?function(...e){return n.apply(ni(this),e),bt(Uu.get(this))}:function(...e){return bt(n.apply(ni(this),e))}}function og(n){return typeof n=="function"?ag(n):(n instanceof IDBTransaction&&ng(n),Yp(n,Zp())?new Proxy(n,yi):n)}function bt(n){if(n instanceof IDBRequest)return tg(n);if(ti.has(n))return ti.get(n);const e=og(n);return e!==n&&(ti.set(n,e),Hi.set(e,n)),e}const ni=n=>Hi.get(n);function ig(n,e,{blocked:t,upgrade:r,blocking:a,terminated:i}={}){const s=indexedDB.open(n,e),l=bt(s);return r&&s.addEventListener("upgradeneeded",d=>{r(bt(s.result),d.oldVersion,d.newVersion,bt(s.transaction),d)}),t&&s.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),l.then(d=>{i&&d.addEventListener("close",()=>i()),a&&d.addEventListener("versionchange",h=>a(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const sg=["get","getKey","getAll","getAllKeys","count"],cg=["put","add","delete","clear"],ri=new Map;function Wc(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ri.get(e))return ri.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=cg.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||sg.includes(t)))return;const i=async function(s,...l){const d=this.transaction(s,a?"readwrite":"readonly");let h=d.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),a&&d.done]))[0]};return ri.set(e,i),i}rg(n=>({...n,get:(e,t,r)=>Wc(e,t)||n.get(e,t,r),has:(e,t)=>!!Wc(e,t)||n.has(e,t)}));class lg{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ug(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function ug(n){return n.getComponent()?.type==="VERSION"}const vi="@firebase/app",Kc="0.14.6";const nt=new ji("@firebase/app"),dg="@firebase/app-compat",hg="@firebase/analytics-compat",mg="@firebase/analytics",pg="@firebase/app-check-compat",gg="@firebase/app-check",fg="@firebase/auth",yg="@firebase/auth-compat",vg="@firebase/database",Eg="@firebase/data-connect",_g="@firebase/database-compat",bg="@firebase/functions",wg="@firebase/functions-compat",Ag="@firebase/installations",Tg="@firebase/installations-compat",Pg="@firebase/messaging",Ig="@firebase/messaging-compat",Cg="@firebase/performance",Sg="@firebase/performance-compat",kg="@firebase/remote-config",Rg="@firebase/remote-config-compat",Dg="@firebase/storage",Mg="@firebase/storage-compat",xg="@firebase/firestore",Vg="@firebase/ai",Lg="@firebase/firestore-compat",Ng="firebase",Fg="12.6.0";const Ei="[DEFAULT]",Og={[vi]:"fire-core",[dg]:"fire-core-compat",[mg]:"fire-analytics",[hg]:"fire-analytics-compat",[gg]:"fire-app-check",[pg]:"fire-app-check-compat",[fg]:"fire-auth",[yg]:"fire-auth-compat",[vg]:"fire-rtdb",[Eg]:"fire-data-connect",[_g]:"fire-rtdb-compat",[bg]:"fire-fn",[wg]:"fire-fn-compat",[Ag]:"fire-iid",[Tg]:"fire-iid-compat",[Pg]:"fire-fcm",[Ig]:"fire-fcm-compat",[Cg]:"fire-perf",[Sg]:"fire-perf-compat",[kg]:"fire-rc",[Rg]:"fire-rc-compat",[Dg]:"fire-gcs",[Mg]:"fire-gcs-compat",[xg]:"fire-fst",[Lg]:"fire-fst-compat",[Vg]:"fire-vertex","fire-js":"fire-js",[Ng]:"fire-js-all"};const Va=new Map,Bg=new Map,_i=new Map;function Qc(n,e){try{n.container.addComponent(e)}catch(t){nt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Tn(n){const e=n.name;if(_i.has(e))return nt.debug(`There were multiple attempts to register component ${e}.`),!1;_i.set(e,n);for(const t of Va.values())Qc(t,n);for(const t of Bg.values())Qc(t,n);return!0}function Gi(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function xe(n){return n==null?!1:n.settings!==void 0}const zg={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wt=new Vr("app","Firebase",zg);class qg{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Yt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wt.create("app-deleted",{appName:this._name})}}const Fn=Fg;function ju(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Ei,automaticDataCollectionEnabled:!0,...e},a=r.name;if(typeof a!="string"||!a)throw wt.create("bad-app-name",{appName:String(a)});if(t||(t=Ou()),!t)throw wt.create("no-options");const i=Va.get(a);if(i){if(Xt(t,i.options)&&Xt(r,i.config))return i;throw wt.create("duplicate-app",{appName:a})}const s=new Wp(a);for(const d of _i.values())s.addComponent(d);const l=new qg(t,r,s);return Va.set(a,l),l}function Hu(n=Ei){const e=Va.get(n);if(!e&&n===Ei&&Ou())return ju();if(!e)throw wt.create("no-app",{appName:n});return e}function At(n,e,t){let r=Og[n]??n;t&&(r+=`-${t}`);const a=r.match(/\s|\//),i=e.match(/\s|\//);if(a||i){const s=[`Unable to register library "${r}" with version "${e}":`];a&&s.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&i&&s.push("and"),i&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nt.warn(s.join(" "));return}Tn(new Yt(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const Ug="firebase-heartbeat-database",$g=1,wr="firebase-heartbeat-store";let ai=null;function Gu(){return ai||(ai=ig(Ug,$g,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(wr)}catch(t){console.warn(t)}}}}).catch(n=>{throw wt.create("idb-open",{originalErrorMessage:n.message})})),ai}async function jg(n){try{const t=(await Gu()).transaction(wr),r=await t.objectStore(wr).get(Wu(n));return await t.done,r}catch(e){if(e instanceof it)nt.warn(e.message);else{const t=wt.create("idb-get",{originalErrorMessage:e?.message});nt.warn(t.message)}}}async function Jc(n,e){try{const r=(await Gu()).transaction(wr,"readwrite");await r.objectStore(wr).put(e,Wu(n)),await r.done}catch(t){if(t instanceof it)nt.warn(t.message);else{const r=wt.create("idb-set",{originalErrorMessage:t?.message});nt.warn(r.message)}}}function Wu(n){return`${n.name}!${n.options.appId}`}const Hg=1024,Gg=30;class Wg{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Qg(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Xc();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Gg){const a=Jg(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){nt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Xc(),{heartbeatsToSend:t,unsentEntries:r}=Kg(this._heartbeatsCache.heartbeats),a=xa(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return nt.warn(e),""}}}function Xc(){return new Date().toISOString().substring(0,10)}function Kg(n,e=Hg){const t=[];let r=n.slice();for(const a of n){const i=t.find(s=>s.agent===a.agent);if(i){if(i.dates.push(a.date),Yc(t)>e){i.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),Yc(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Qg{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Lp()?Np().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await jg(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Jc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Jc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Yc(n){return xa(JSON.stringify({version:2,heartbeats:n})).length}function Jg(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Xg(n){Tn(new Yt("platform-logger",e=>new lg(e),"PRIVATE")),Tn(new Yt("heartbeat",e=>new Wg(e),"PRIVATE")),At(vi,Kc,n),At(vi,Kc,"esm2020"),At("fire-js","")}Xg("");var Yg="firebase",Zg="12.7.0";At(Yg,Zg,"app");function Ku(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ef=Ku,Qu=new Vr("auth","Firebase",Ku());const La=new ji("@firebase/auth");function tf(n,...e){La.logLevel<=G.WARN&&La.warn(`Auth (${Fn}): ${n}`,...e)}function Ea(n,...e){La.logLevel<=G.ERROR&&La.error(`Auth (${Fn}): ${n}`,...e)}function We(n,...e){throw Ki(n,...e)}function Fe(n,...e){return Ki(n,...e)}function Wi(n,e,t){const r={...ef(),[e]:t};return new Vr("auth","Firebase",r).create(e,{appName:n.name})}function Tt(n){return Wi(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ju(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&We(n,"argument-error"),Wi(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ki(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Qu.create(n,...e)}function B(n,e,...t){if(!n)throw Ki(e,...t)}function et(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ea(e),new Error(e)}function rt(n,e){n||et(e)}function bi(){return typeof self<"u"&&self.location?.href||""}function nf(){return Zc()==="http:"||Zc()==="https:"}function Zc(){return typeof self<"u"&&self.location?.protocol||null}function rf(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nf()||Dp()||"connection"in navigator)?navigator.onLine:!0}function af(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Nr{constructor(e,t){this.shortDelay=e,this.longDelay=t,rt(t>e,"Short delay should be less than long delay!"),this.isMobile=Sp()||Mp()}get(){return rf()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Qi(n,e){rt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Xu{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;et("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;et("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;et("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const of={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const sf=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],cf=new Nr(3e4,6e4);function Ji(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function On(n,e,t,r,a={}){return Yu(n,a,async()=>{let i={},s={};r&&(e==="GET"?s=r:i={body:JSON.stringify(r)});const l=Lr({key:n.config.apiKey,...s}).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:d,...i};return Rp()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Nn(n.emulatorConfig.host)&&(h.credentials="include"),Xu.fetch()(await Zu(n,n.config.apiHost,t,l),h)})}async function Yu(n,e,t){n._canInitEmulator=!1;const r={...of,...e};try{const a=new uf(n),i=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw ha(n,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const l=i.ok?s.errorMessage:s.error.message,[d,h]=l.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw ha(n,"credential-already-in-use",s);if(d==="EMAIL_EXISTS")throw ha(n,"email-already-in-use",s);if(d==="USER_DISABLED")throw ha(n,"user-disabled",s);const m=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Wi(n,m,h);We(n,m)}}catch(a){if(a instanceof it)throw a;We(n,"network-request-failed",{message:String(a)})}}async function lf(n,e,t,r,a={}){const i=await On(n,e,t,r,a);return"mfaPendingCredential"in i&&We(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Zu(n,e,t,r){const a=`${e}${t}?${r}`,i=n,s=i.config.emulator?Qi(n.config,a):`${n.config.apiScheme}://${a}`;return sf.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(s).toString():s}class uf{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Fe(this.auth,"network-request-failed")),cf.get())})}}function ha(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=Fe(n,e,r);return a.customData._tokenResponse=t,a}async function df(n,e){return On(n,"POST","/v1/accounts:delete",e)}async function Na(n,e){return On(n,"POST","/v1/accounts:lookup",e)}function gr(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hf(n,e=!1){const t=ve(n),r=await t.getIdToken(e),a=Xi(r);B(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const i=typeof a.firebase=="object"?a.firebase:void 0,s=i?.sign_in_provider;return{claims:a,token:r,authTime:gr(oi(a.auth_time)),issuedAtTime:gr(oi(a.iat)),expirationTime:gr(oi(a.exp)),signInProvider:s||null,signInSecondFactor:i?.sign_in_second_factor||null}}function oi(n){return Number(n)*1e3}function Xi(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ea("JWT malformed, contained fewer than 3 sections"),null;try{const a=Nu(t);return a?JSON.parse(a):(Ea("Failed to decode base64 JWT payload"),null)}catch(a){return Ea("Caught error parsing JWT payload as JSON",a?.toString()),null}}function el(n){const e=Xi(n);return B(e,"internal-error"),B(typeof e.exp<"u","internal-error"),B(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ar(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof it&&mf(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function mf({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class pf{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class wi{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=gr(this.lastLoginAt),this.creationTime=gr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Fa(n){const e=n.auth,t=await n.getIdToken(),r=await Ar(n,Na(e,{idToken:t}));B(r?.users.length,e,"internal-error");const a=r.users[0];n._notifyReloadListener(a);const i=a.providerUserInfo?.length?ed(a.providerUserInfo):[],s=ff(n.providerData,i),l=n.isAnonymous,d=!(n.email&&a.passwordHash)&&!s?.length,h=l?d:!1,m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new wi(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(n,m)}async function gf(n){const e=ve(n);await Fa(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ff(n,e){return[...n.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function ed(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function yf(n,e){const t=await Yu(n,{},async()=>{const r=Lr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:i}=n.config,s=await Zu(n,a,"/v1/token",`key=${i}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:l,body:r};return n.emulatorConfig&&Nn(n.emulatorConfig.host)&&(d.credentials="include"),Xu.fetch()(s,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function vf(n,e){return On(n,"POST","/v2/accounts:revokeToken",Ji(n,e))}class yn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){B(e.idToken,"internal-error"),B(typeof e.idToken<"u","internal-error"),B(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):el(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){B(e.length!==0,"internal-error");const t=el(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(B(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:i}=await yf(e,t);this.updateTokensAndExpiration(r,a,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:i}=t,s=new yn;return r&&(B(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),a&&(B(typeof a=="string","internal-error",{appName:e}),s.accessToken=a),i&&(B(typeof i=="number","internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new yn,this.toJSON())}_performRefresh(){return et("not implemented")}}function gt(n,e){B(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ne{constructor({uid:e,auth:t,stsTokenManager:r,...a}){this.providerId="firebase",this.proactiveRefresh=new pf(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new wi(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Ar(this,this.stsTokenManager.getToken(this.auth,e));return B(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return hf(this,e)}reload(){return gf(this)}_assign(e){this!==e&&(B(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ne({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Fa(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xe(this.auth.app))return Promise.reject(Tt(this.auth));const e=await this.getIdToken();return await Ar(this,df(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,a=t.email??void 0,i=t.phoneNumber??void 0,s=t.photoURL??void 0,l=t.tenantId??void 0,d=t._redirectEventId??void 0,h=t.createdAt??void 0,m=t.lastLoginAt??void 0,{uid:g,emailVerified:E,isAnonymous:S,providerData:I,stsTokenManager:R}=t;B(g&&R,e,"internal-error");const C=yn.fromJSON(this.name,R);B(typeof g=="string",e,"internal-error"),gt(r,e.name),gt(a,e.name),B(typeof E=="boolean",e,"internal-error"),B(typeof S=="boolean",e,"internal-error"),gt(i,e.name),gt(s,e.name),gt(l,e.name),gt(d,e.name),gt(h,e.name),gt(m,e.name);const L=new Ne({uid:g,auth:e,email:a,emailVerified:E,displayName:r,isAnonymous:S,photoURL:s,phoneNumber:i,tenantId:l,stsTokenManager:C,createdAt:h,lastLoginAt:m});return I&&Array.isArray(I)&&(L.providerData=I.map(z=>({...z}))),d&&(L._redirectEventId=d),L}static async _fromIdTokenResponse(e,t,r=!1){const a=new yn;a.updateFromServerResponse(t);const i=new Ne({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await Fa(i),i}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];B(a.localId!==void 0,"internal-error");const i=a.providerUserInfo!==void 0?ed(a.providerUserInfo):[],s=!(a.email&&a.passwordHash)&&!i?.length,l=new yn;l.updateFromIdToken(r);const d=new Ne({uid:a.localId,auth:e,stsTokenManager:l,isAnonymous:s}),h={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:i,metadata:new wi(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!i?.length};return Object.assign(d,h),d}}const tl=new Map;function tt(n){rt(n instanceof Function,"Expected a class definition");let e=tl.get(n);return e?(rt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,tl.set(n,e),e)}class td{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}td.type="NONE";const nl=td;function _a(n,e,t){return`firebase:${n}:${e}:${t}`}class vn{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:i}=this.auth;this.fullUserKey=_a(this.userKey,a.apiKey,i),this.fullPersistenceKey=_a("persistence",a.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Na(this.auth,{idToken:e}).catch(()=>{});return t?Ne._fromGetAccountInfoResponse(this.auth,t,e):null}return Ne._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new vn(tt(nl),e,r);const a=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=a[0]||tt(nl);const s=_a(r,e.config.apiKey,e.name);let l=null;for(const h of t)try{const m=await h._get(s);if(m){let g;if(typeof m=="string"){const E=await Na(e,{idToken:m}).catch(()=>{});if(!E)break;g=await Ne._fromGetAccountInfoResponse(e,E,m)}else g=Ne._fromJSON(e,m);h!==i&&(l=g),i=h;break}}catch{}const d=a.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!d.length?new vn(i,e,r):(i=d[0],l&&await i._set(s,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(s)}catch{}})),new vn(i,e,r))}}function rl(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(od(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(nd(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sd(e))return"Blackberry";if(cd(e))return"Webos";if(rd(e))return"Safari";if((e.includes("chrome/")||ad(e))&&!e.includes("edge/"))return"Chrome";if(id(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function nd(n=Te()){return/firefox\//i.test(n)}function rd(n=Te()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ad(n=Te()){return/crios\//i.test(n)}function od(n=Te()){return/iemobile/i.test(n)}function id(n=Te()){return/android/i.test(n)}function sd(n=Te()){return/blackberry/i.test(n)}function cd(n=Te()){return/webos/i.test(n)}function Yi(n=Te()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Ef(n=Te()){return Yi(n)&&!!window.navigator?.standalone}function _f(){return xp()&&document.documentMode===10}function ld(n=Te()){return Yi(n)||id(n)||cd(n)||sd(n)||/windows phone/i.test(n)||od(n)}function ud(n,e=[]){let t;switch(n){case"Browser":t=rl(Te());break;case"Worker":t=`${rl(Te())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Fn}/${r}`}class bf{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((s,l)=>{try{const d=e(i);s(d)}catch(d){l(d)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function wf(n,e={}){return On(n,"GET","/v2/passwordPolicy",Ji(n,e))}const Af=6;class Tf{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Af,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Pf{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new al(this),this.idTokenSubscription=new al(this),this.beforeStateQueue=new bf(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Qu,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=tt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await vn.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Na(this,{idToken:e}),r=await Ne._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(xe(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(s,s))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,s=r?._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===s)&&l?.user&&(r=l.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return B(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Fa(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=af()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xe(this.app))return Promise.reject(Tt(this));const t=e?ve(e):null;return t&&B(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&B(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xe(this.app)?Promise.reject(Tt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xe(this.app)?Promise.reject(Tt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(tt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await wf(this),t=new Tf(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Vr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await vf(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&tt(e)||this._popupRedirectResolver;B(t,this,"argument-error"),this.redirectPersistenceManager=await vn.create(this,[tt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let s=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(B(l,this,"internal-error"),l.then(()=>{s||i(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,r,a);return()=>{s=!0,d()}}else{const d=e.addObserver(t);return()=>{s=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ud(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(xe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&tf(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Fr(n){return ve(n)}class al{constructor(e){this.auth=e,this.observer=null,this.addObserver=qp(t=>this.observer=t)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Zi={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function If(n){Zi=n}function Cf(n){return Zi.loadJS(n)}function Sf(){return Zi.gapiScript}function kf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Rf(n,e){const t=Gi(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),i=t.getOptions();if(Xt(i,e??{}))return a;We(a,"already-initialized")}return t.initialize({options:e})}function Df(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(tt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Mf(n,e,t){const r=Fr(n);B(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,i=dd(e),{host:s,port:l}=xf(e),d=l===null?"":`:${l}`,h={url:`${i}//${s}${d}/`},m=Object.freeze({host:s,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){B(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),B(Xt(h,r.config.emulator)&&Xt(m,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=m,r.settings.appVerificationDisabledForTesting=!0,Nn(s)?(zu(`${i}//${s}${d}`),qu("Auth",!0)):Vf()}function dd(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function xf(n){const e=dd(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const i=a[1];return{host:i,port:ol(r.substr(i.length+1))}}else{const[i,s]=r.split(":");return{host:i,port:ol(s)}}}function ol(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Vf(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class hd{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return et("not implemented")}_getIdTokenResponse(e){return et("not implemented")}_linkToIdToken(e,t){return et("not implemented")}_getReauthenticationResolver(e){return et("not implemented")}}async function En(n,e){return lf(n,"POST","/v1/accounts:signInWithIdp",Ji(n,e))}const Lf="http://localhost";class Zt extends hd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):We("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,...i}=t;if(!r||!a)return null;const s=new Zt(r,a);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){const t=this.buildRequest();return En(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,En(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,En(e,t)}buildRequest(){const e={requestUri:Lf,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lr(t)}return e}}class so{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Or extends so{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ft extends Or{constructor(){super("facebook.com")}static credential(e){return Zt._fromParams({providerId:ft.PROVIDER_ID,signInMethod:ft.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ft.credentialFromTaggedObject(e)}static credentialFromError(e){return ft.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ft.credential(e.oauthAccessToken)}catch{return null}}}ft.FACEBOOK_SIGN_IN_METHOD="facebook.com";ft.PROVIDER_ID="facebook.com";class Ye extends Or{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zt._fromParams({providerId:Ye.PROVIDER_ID,signInMethod:Ye.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ye.credentialFromTaggedObject(e)}static credentialFromError(e){return Ye.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ye.credential(t,r)}catch{return null}}}Ye.GOOGLE_SIGN_IN_METHOD="google.com";Ye.PROVIDER_ID="google.com";class yt extends Or{constructor(){super("github.com")}static credential(e){return Zt._fromParams({providerId:yt.PROVIDER_ID,signInMethod:yt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yt.credentialFromTaggedObject(e)}static credentialFromError(e){return yt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yt.credential(e.oauthAccessToken)}catch{return null}}}yt.GITHUB_SIGN_IN_METHOD="github.com";yt.PROVIDER_ID="github.com";class vt extends Or{constructor(){super("twitter.com")}static credential(e,t){return Zt._fromParams({providerId:vt.PROVIDER_ID,signInMethod:vt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return vt.credentialFromTaggedObject(e)}static credentialFromError(e){return vt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return vt.credential(t,r)}catch{return null}}}vt.TWITTER_SIGN_IN_METHOD="twitter.com";vt.PROVIDER_ID="twitter.com";class Pn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const i=await Ne._fromIdTokenResponse(e,r,a),s=il(r);return new Pn({user:i,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=il(r);return new Pn({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function il(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Oa extends it{constructor(e,t,r,a){super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,Oa.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new Oa(e,t,r,a)}}function md(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Oa._fromErrorAndOperation(n,i,e,r):i})}async function Nf(n,e,t=!1){const r=await Ar(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Pn._forOperation(n,"link",r)}async function Ff(n,e,t=!1){const{auth:r}=n;if(xe(r.app))return Promise.reject(Tt(r));const a="reauthenticate";try{const i=await Ar(n,md(r,a,e,n),t);B(i.idToken,r,"internal-error");const s=Xi(i.idToken);B(s,r,"internal-error");const{sub:l}=s;return B(n.uid===l,r,"user-mismatch"),Pn._forOperation(n,a,i)}catch(i){throw i?.code==="auth/user-not-found"&&We(r,"user-mismatch"),i}}async function Of(n,e,t=!1){if(xe(n.app))return Promise.reject(Tt(n));const r="signIn",a=await md(n,r,e),i=await Pn._fromIdTokenResponse(n,r,a);return t||await n._updateCurrentUser(i.user),i}function Bf(n,e,t,r){return ve(n).onIdTokenChanged(e,t,r)}function zf(n,e,t){return ve(n).beforeAuthStateChanged(e,t)}function pd(n,e,t,r){return ve(n).onAuthStateChanged(e,t,r)}function qf(n){return ve(n).signOut()}const Ba="__sak";class gd{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ba,"1"),this.storage.removeItem(Ba),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Uf=1e3,$f=10;class fd extends gd{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ld(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((s,l,d)=>{this.notifyListeners(s,d)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const s=this.storage.getItem(r);!t&&this.localCache[r]===s||this.notifyListeners(r,s)},i=this.storage.getItem(r);_f()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,$f):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Uf)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}fd.type="LOCAL";const jf=fd;class yd extends gd{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}yd.type="SESSION";const vd=yd;function Hf(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class co{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new co(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:i}=t.data,s=this.handlersMap[a];if(!s?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const l=Array.from(s).map(async h=>h(t.origin,i)),d=await Hf(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}co.receivers=[];function es(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class Gf{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let i,s;return new Promise((l,d)=>{const h=es("",20);a.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},r);s={messageChannel:a,onMessage(g){const E=g;if(E.data.eventId===h)switch(E.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(E.data.response);break;default:clearTimeout(m),clearTimeout(i),d(new Error("invalid_response"));break}}},this.handlers.add(s),a.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[a.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Ue(){return window}function Wf(n){Ue().location.href=n}function Ed(){return typeof Ue().WorkerGlobalScope<"u"&&typeof Ue().importScripts=="function"}async function Kf(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Qf(){return navigator?.serviceWorker?.controller||null}function Jf(){return Ed()?self:null}const _d="firebaseLocalStorageDb",Xf=1,za="firebaseLocalStorage",bd="fbase_key";class Br{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function lo(n,e){return n.transaction([za],e?"readwrite":"readonly").objectStore(za)}function Yf(){const n=indexedDB.deleteDatabase(_d);return new Br(n).toPromise()}function Ai(){const n=indexedDB.open(_d,Xf);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(za,{keyPath:bd})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(za)?e(r):(r.close(),await Yf(),e(await Ai()))})})}async function sl(n,e,t){const r=lo(n,!0).put({[bd]:e,value:t});return new Br(r).toPromise()}async function Zf(n,e){const t=lo(n,!1).get(e),r=await new Br(t).toPromise();return r===void 0?null:r.value}function cl(n,e){const t=lo(n,!0).delete(e);return new Br(t).toPromise()}const ey=800,ty=3;class wd{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ai(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>ty)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ed()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=co._getInstance(Jf()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Kf(),!this.activeServiceWorker)return;this.sender=new Gf(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Qf()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ai();return await sl(e,Ba,"1"),await cl(e,Ba),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>sl(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Zf(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>cl(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const i=lo(a,!1).getAll();return new Br(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:i}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(i)&&(this.notifyListeners(a,i),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ey)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wd.type="LOCAL";const ny=wd;new Nr(3e4,6e4);function ts(n,e){return e?tt(e):(B(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ns extends hd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return En(e,this._buildIdpRequest())}_linkToIdToken(e,t){return En(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return En(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ry(n){return Of(n.auth,new ns(n),n.bypassAuthState)}function ay(n){const{auth:e,user:t}=n;return B(t,e,"internal-error"),Ff(t,new ns(n),n.bypassAuthState)}async function oy(n){const{auth:e,user:t}=n;return B(t,e,"internal-error"),Nf(t,new ns(n),n.bypassAuthState)}class Ad{constructor(e,t,r,a,i=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:i,error:s,type:l}=e;if(s){this.reject(s);return}const d={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(d))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ry;case"linkViaPopup":case"linkViaRedirect":return oy;case"reauthViaPopup":case"reauthViaRedirect":return ay;default:We(this.auth,"internal-error")}}resolve(e){rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const iy=new Nr(2e3,1e4);async function sy(n,e,t){if(xe(n.app))return Promise.reject(Fe(n,"operation-not-supported-in-this-environment"));const r=Fr(n);Ju(n,e,so);const a=ts(r,t);return new Wt(r,"signInViaPopup",e,a).executeNotNull()}class Wt extends Ad{constructor(e,t,r,a,i){super(e,t,a,i),this.provider=r,this.authWindow=null,this.pollId=null,Wt.currentPopupAction&&Wt.currentPopupAction.cancel(),Wt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return B(e,this.auth,"internal-error"),e}async onExecution(){rt(this.filter.length===1,"Popup operations only handle one event");const e=es();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Fe(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Fe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wt.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fe(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,iy.get())};e()}}Wt.currentPopupAction=null;const cy="pendingRedirect",ba=new Map;class ly extends Ad{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=ba.get(this.auth._key());if(!e){try{const r=await uy(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ba.set(this.auth._key(),e)}return this.bypassAuthState||ba.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uy(n,e){const t=Pd(e),r=Td(n);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}async function dy(n,e){return Td(n)._set(Pd(e),"true")}function hy(n,e){ba.set(n._key(),e)}function Td(n){return tt(n._redirectPersistence)}function Pd(n){return _a(cy,n.config.apiKey,n.name)}function ll(n,e,t){return my(n,e,t)}async function my(n,e,t){if(xe(n.app))return Promise.reject(Tt(n));const r=Fr(n);Ju(n,e,so),await r._initializationPromise;const a=ts(r,t);return await dy(a,r),a._openRedirect(r,e,"signInViaRedirect")}async function py(n,e,t=!1){if(xe(n.app))return Promise.reject(Tt(n));const r=Fr(n),a=ts(r,e),s=await new ly(r,a,t).execute();return s&&!t&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}const gy=600*1e3;class fy{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!yy(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Id(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Fe(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gy&&this.cachedEventUids.clear(),this.cachedEventUids.has(ul(e))}saveEventToCache(e){this.cachedEventUids.add(ul(e)),this.lastProcessedEventTime=Date.now()}}function ul(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Id({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function yy(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Id(n);default:return!1}}async function vy(n,e={}){return On(n,"GET","/v1/projects",e)}const Ey=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_y=/^https?/;async function by(n){if(n.config.emulator)return;const{authorizedDomains:e}=await vy(n);for(const t of e)try{if(wy(t))return}catch{}We(n,"unauthorized-domain")}function wy(n){const e=bi(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!_y.test(t))return!1;if(Ey.test(n))return r===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const Ay=new Nr(3e4,6e4);function dl(){const n=Ue().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Ty(n){return new Promise((e,t)=>{function r(){dl(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dl(),t(Fe(n,"network-request-failed"))},timeout:Ay.get()})}if(Ue().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ue().gapi?.load)r();else{const a=kf("iframefcb");return Ue()[a]=()=>{gapi.load?r():t(Fe(n,"network-request-failed"))},Cf(`${Sf()}?onload=${a}`).catch(i=>t(i))}}).catch(e=>{throw wa=null,e})}let wa=null;function Py(n){return wa=wa||Ty(n),wa}const Iy=new Nr(5e3,15e3),Cy="__/auth/iframe",Sy="emulator/auth/iframe",ky={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ry=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dy(n){const e=n.config;B(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qi(e,Sy):`https://${n.config.authDomain}/${Cy}`,r={apiKey:e.apiKey,appName:n.name,v:Fn},a=Ry.get(n.config.apiHost);a&&(r.eid=a);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Lr(r).slice(1)}`}async function My(n){const e=await Py(n),t=Ue().gapi;return B(t,n,"internal-error"),e.open({where:document.body,url:Dy(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ky,dontclear:!0},r=>new Promise(async(a,i)=>{await r.restyle({setHideOnLeave:!1});const s=Fe(n,"network-request-failed"),l=Ue().setTimeout(()=>{i(s)},Iy.get());function d(){Ue().clearTimeout(l),a(r)}r.ping(d).then(d,()=>{i(s)})}))}const xy={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Vy=500,Ly=600,Ny="_blank",Fy="http://localhost";class hl{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Oy(n,e,t,r=Vy,a=Ly){const i=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const d={...xy,width:r.toString(),height:a.toString(),top:i,left:s},h=Te().toLowerCase();t&&(l=ad(h)?Ny:t),nd(h)&&(e=e||Fy,d.scrollbars="yes");const m=Object.entries(d).reduce((E,[S,I])=>`${E}${S}=${I},`,"");if(Ef(h)&&l!=="_self")return By(e||"",l),new hl(null);const g=window.open(e||"",l,m);B(g,n,"popup-blocked");try{g.focus()}catch{}return new hl(g)}function By(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const zy="__/auth/handler",qy="emulator/auth/handler",Uy=encodeURIComponent("fac");async function ml(n,e,t,r,a,i){B(n.config.authDomain,n,"auth-domain-config-required"),B(n.config.apiKey,n,"invalid-api-key");const s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Fn,eventId:a};if(e instanceof so){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",zp(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))s[m]=g}if(e instanceof Or){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(s.scopes=m.join(","))}n.tenantId&&(s.tid=n.tenantId);const l=s;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const d=await n._getAppCheckToken(),h=d?`#${Uy}=${encodeURIComponent(d)}`:"";return`${$y(n)}?${Lr(l).slice(1)}${h}`}function $y({config:n}){return n.emulator?Qi(n,qy):`https://${n.authDomain}/${zy}`}const ii="webStorageSupport";class jy{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vd,this._completeRedirectFn=py,this._overrideRedirectResult=hy}async _openPopup(e,t,r,a){rt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await ml(e,t,r,bi(),a);return Oy(e,i,es())}async _openRedirect(e,t,r,a){await this._originValidation(e);const i=await ml(e,t,r,bi(),a);return Wf(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:i}=this.eventManagers[t];return a?Promise.resolve(a):(rt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await My(e),r=new fy(e);return t.register("authEvent",a=>(B(a?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ii,{type:ii},a=>{const i=a?.[0]?.[ii];i!==void 0&&t(!!i),We(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=by(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ld()||rd()||Yi()}}const Hy=jy;var pl="@firebase/auth",gl="1.12.0";class Gy{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Wy(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ky(n){Tn(new Yt("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:l}=r.options;B(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const d={apiKey:s,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ud(n)},h=new Pf(r,a,i,d);return Df(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Tn(new Yt("auth-internal",e=>{const t=Fr(e.getProvider("auth").getImmediate());return(r=>new Gy(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),At(pl,gl,Wy(n)),At(pl,gl,"esm2020")}const Qy=300,Jy=Bu("authIdTokenMaxAge")||Qy;let fl=null;const Xy=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Jy)return;const a=t?.token;fl!==a&&(fl=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function Yy(n=Hu()){const e=Gi(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Rf(n,{popupRedirectResolver:Hy,persistence:[ny,jf,vd]}),r=Bu("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const s=Xy(i.toString());zf(t,s,()=>s(t.currentUser)),Bf(t,l=>s(l))}}const a=Fu("auth");return a&&Mf(t,`http://${a}`),t}function Zy(){return document.getElementsByTagName("head")?.[0]??document}If({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=a=>{const i=Fe("internal-error");i.customData=a,t(i)},r.type="text/javascript",r.charset="UTF-8",Zy().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ky("Browser");var yl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Pt,Cd;(function(){var n;function e(b,f){function v(){}v.prototype=f.prototype,b.F=f.prototype,b.prototype=new v,b.prototype.constructor=b,b.D=function(w,_,A){for(var y=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)y[pe-2]=arguments[pe];return f.prototype[_].apply(w,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(b,f,v){v||(v=0);const w=Array(16);if(typeof f=="string")for(var _=0;_<16;++_)w[_]=f.charCodeAt(v++)|f.charCodeAt(v++)<<8|f.charCodeAt(v++)<<16|f.charCodeAt(v++)<<24;else for(_=0;_<16;++_)w[_]=f[v++]|f[v++]<<8|f[v++]<<16|f[v++]<<24;f=b.g[0],v=b.g[1],_=b.g[2];let A=b.g[3],y;y=f+(A^v&(_^A))+w[0]+3614090360&4294967295,f=v+(y<<7&4294967295|y>>>25),y=A+(_^f&(v^_))+w[1]+3905402710&4294967295,A=f+(y<<12&4294967295|y>>>20),y=_+(v^A&(f^v))+w[2]+606105819&4294967295,_=A+(y<<17&4294967295|y>>>15),y=v+(f^_&(A^f))+w[3]+3250441966&4294967295,v=_+(y<<22&4294967295|y>>>10),y=f+(A^v&(_^A))+w[4]+4118548399&4294967295,f=v+(y<<7&4294967295|y>>>25),y=A+(_^f&(v^_))+w[5]+1200080426&4294967295,A=f+(y<<12&4294967295|y>>>20),y=_+(v^A&(f^v))+w[6]+2821735955&4294967295,_=A+(y<<17&4294967295|y>>>15),y=v+(f^_&(A^f))+w[7]+4249261313&4294967295,v=_+(y<<22&4294967295|y>>>10),y=f+(A^v&(_^A))+w[8]+1770035416&4294967295,f=v+(y<<7&4294967295|y>>>25),y=A+(_^f&(v^_))+w[9]+2336552879&4294967295,A=f+(y<<12&4294967295|y>>>20),y=_+(v^A&(f^v))+w[10]+4294925233&4294967295,_=A+(y<<17&4294967295|y>>>15),y=v+(f^_&(A^f))+w[11]+2304563134&4294967295,v=_+(y<<22&4294967295|y>>>10),y=f+(A^v&(_^A))+w[12]+1804603682&4294967295,f=v+(y<<7&4294967295|y>>>25),y=A+(_^f&(v^_))+w[13]+4254626195&4294967295,A=f+(y<<12&4294967295|y>>>20),y=_+(v^A&(f^v))+w[14]+2792965006&4294967295,_=A+(y<<17&4294967295|y>>>15),y=v+(f^_&(A^f))+w[15]+1236535329&4294967295,v=_+(y<<22&4294967295|y>>>10),y=f+(_^A&(v^_))+w[1]+4129170786&4294967295,f=v+(y<<5&4294967295|y>>>27),y=A+(v^_&(f^v))+w[6]+3225465664&4294967295,A=f+(y<<9&4294967295|y>>>23),y=_+(f^v&(A^f))+w[11]+643717713&4294967295,_=A+(y<<14&4294967295|y>>>18),y=v+(A^f&(_^A))+w[0]+3921069994&4294967295,v=_+(y<<20&4294967295|y>>>12),y=f+(_^A&(v^_))+w[5]+3593408605&4294967295,f=v+(y<<5&4294967295|y>>>27),y=A+(v^_&(f^v))+w[10]+38016083&4294967295,A=f+(y<<9&4294967295|y>>>23),y=_+(f^v&(A^f))+w[15]+3634488961&4294967295,_=A+(y<<14&4294967295|y>>>18),y=v+(A^f&(_^A))+w[4]+3889429448&4294967295,v=_+(y<<20&4294967295|y>>>12),y=f+(_^A&(v^_))+w[9]+568446438&4294967295,f=v+(y<<5&4294967295|y>>>27),y=A+(v^_&(f^v))+w[14]+3275163606&4294967295,A=f+(y<<9&4294967295|y>>>23),y=_+(f^v&(A^f))+w[3]+4107603335&4294967295,_=A+(y<<14&4294967295|y>>>18),y=v+(A^f&(_^A))+w[8]+1163531501&4294967295,v=_+(y<<20&4294967295|y>>>12),y=f+(_^A&(v^_))+w[13]+2850285829&4294967295,f=v+(y<<5&4294967295|y>>>27),y=A+(v^_&(f^v))+w[2]+4243563512&4294967295,A=f+(y<<9&4294967295|y>>>23),y=_+(f^v&(A^f))+w[7]+1735328473&4294967295,_=A+(y<<14&4294967295|y>>>18),y=v+(A^f&(_^A))+w[12]+2368359562&4294967295,v=_+(y<<20&4294967295|y>>>12),y=f+(v^_^A)+w[5]+4294588738&4294967295,f=v+(y<<4&4294967295|y>>>28),y=A+(f^v^_)+w[8]+2272392833&4294967295,A=f+(y<<11&4294967295|y>>>21),y=_+(A^f^v)+w[11]+1839030562&4294967295,_=A+(y<<16&4294967295|y>>>16),y=v+(_^A^f)+w[14]+4259657740&4294967295,v=_+(y<<23&4294967295|y>>>9),y=f+(v^_^A)+w[1]+2763975236&4294967295,f=v+(y<<4&4294967295|y>>>28),y=A+(f^v^_)+w[4]+1272893353&4294967295,A=f+(y<<11&4294967295|y>>>21),y=_+(A^f^v)+w[7]+4139469664&4294967295,_=A+(y<<16&4294967295|y>>>16),y=v+(_^A^f)+w[10]+3200236656&4294967295,v=_+(y<<23&4294967295|y>>>9),y=f+(v^_^A)+w[13]+681279174&4294967295,f=v+(y<<4&4294967295|y>>>28),y=A+(f^v^_)+w[0]+3936430074&4294967295,A=f+(y<<11&4294967295|y>>>21),y=_+(A^f^v)+w[3]+3572445317&4294967295,_=A+(y<<16&4294967295|y>>>16),y=v+(_^A^f)+w[6]+76029189&4294967295,v=_+(y<<23&4294967295|y>>>9),y=f+(v^_^A)+w[9]+3654602809&4294967295,f=v+(y<<4&4294967295|y>>>28),y=A+(f^v^_)+w[12]+3873151461&4294967295,A=f+(y<<11&4294967295|y>>>21),y=_+(A^f^v)+w[15]+530742520&4294967295,_=A+(y<<16&4294967295|y>>>16),y=v+(_^A^f)+w[2]+3299628645&4294967295,v=_+(y<<23&4294967295|y>>>9),y=f+(_^(v|~A))+w[0]+4096336452&4294967295,f=v+(y<<6&4294967295|y>>>26),y=A+(v^(f|~_))+w[7]+1126891415&4294967295,A=f+(y<<10&4294967295|y>>>22),y=_+(f^(A|~v))+w[14]+2878612391&4294967295,_=A+(y<<15&4294967295|y>>>17),y=v+(A^(_|~f))+w[5]+4237533241&4294967295,v=_+(y<<21&4294967295|y>>>11),y=f+(_^(v|~A))+w[12]+1700485571&4294967295,f=v+(y<<6&4294967295|y>>>26),y=A+(v^(f|~_))+w[3]+2399980690&4294967295,A=f+(y<<10&4294967295|y>>>22),y=_+(f^(A|~v))+w[10]+4293915773&4294967295,_=A+(y<<15&4294967295|y>>>17),y=v+(A^(_|~f))+w[1]+2240044497&4294967295,v=_+(y<<21&4294967295|y>>>11),y=f+(_^(v|~A))+w[8]+1873313359&4294967295,f=v+(y<<6&4294967295|y>>>26),y=A+(v^(f|~_))+w[15]+4264355552&4294967295,A=f+(y<<10&4294967295|y>>>22),y=_+(f^(A|~v))+w[6]+2734768916&4294967295,_=A+(y<<15&4294967295|y>>>17),y=v+(A^(_|~f))+w[13]+1309151649&4294967295,v=_+(y<<21&4294967295|y>>>11),y=f+(_^(v|~A))+w[4]+4149444226&4294967295,f=v+(y<<6&4294967295|y>>>26),y=A+(v^(f|~_))+w[11]+3174756917&4294967295,A=f+(y<<10&4294967295|y>>>22),y=_+(f^(A|~v))+w[2]+718787259&4294967295,_=A+(y<<15&4294967295|y>>>17),y=v+(A^(_|~f))+w[9]+3951481745&4294967295,b.g[0]=b.g[0]+f&4294967295,b.g[1]=b.g[1]+(_+(y<<21&4294967295|y>>>11))&4294967295,b.g[2]=b.g[2]+_&4294967295,b.g[3]=b.g[3]+A&4294967295}r.prototype.v=function(b,f){f===void 0&&(f=b.length);const v=f-this.blockSize,w=this.C;let _=this.h,A=0;for(;A<f;){if(_==0)for(;A<=v;)a(this,b,A),A+=this.blockSize;if(typeof b=="string"){for(;A<f;)if(w[_++]=b.charCodeAt(A++),_==this.blockSize){a(this,w),_=0;break}}else for(;A<f;)if(w[_++]=b[A++],_==this.blockSize){a(this,w),_=0;break}}this.h=_,this.o+=f},r.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var f=1;f<b.length-8;++f)b[f]=0;f=this.o*8;for(var v=b.length-8;v<b.length;++v)b[v]=f&255,f/=256;for(this.v(b),b=Array(16),f=0,v=0;v<4;++v)for(let w=0;w<32;w+=8)b[f++]=this.g[v]>>>w&255;return b};function i(b,f){var v=l;return Object.prototype.hasOwnProperty.call(v,b)?v[b]:v[b]=f(b)}function s(b,f){this.h=f;const v=[];let w=!0;for(let _=b.length-1;_>=0;_--){const A=b[_]|0;w&&A==f||(v[_]=A,w=!1)}this.g=v}var l={};function d(b){return-128<=b&&b<128?i(b,function(f){return new s([f|0],f<0?-1:0)}):new s([b|0],b<0?-1:0)}function h(b){if(isNaN(b)||!isFinite(b))return g;if(b<0)return C(h(-b));const f=[];let v=1;for(let w=0;b>=v;w++)f[w]=b/v|0,v*=4294967296;return new s(f,0)}function m(b,f){if(b.length==0)throw Error("number format error: empty string");if(f=f||10,f<2||36<f)throw Error("radix out of range: "+f);if(b.charAt(0)=="-")return C(m(b.substring(1),f));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=h(Math.pow(f,8));let w=g;for(let A=0;A<b.length;A+=8){var _=Math.min(8,b.length-A);const y=parseInt(b.substring(A,A+_),f);_<8?(_=h(Math.pow(f,_)),w=w.j(_).add(h(y))):(w=w.j(v),w=w.add(h(y)))}return w}var g=d(0),E=d(1),S=d(16777216);n=s.prototype,n.m=function(){if(R(this))return-C(this).m();let b=0,f=1;for(let v=0;v<this.g.length;v++){const w=this.i(v);b+=(w>=0?w:4294967296+w)*f,f*=4294967296}return b},n.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(I(this))return"0";if(R(this))return"-"+C(this).toString(b);const f=h(Math.pow(b,6));var v=this;let w="";for(;;){const _=Y(v,f).g;v=L(v,_.j(f));let A=((v.g.length>0?v.g[0]:v.h)>>>0).toString(b);if(v=_,I(v))return A+w;for(;A.length<6;)A="0"+A;w=A+w}},n.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function I(b){if(b.h!=0)return!1;for(let f=0;f<b.g.length;f++)if(b.g[f]!=0)return!1;return!0}function R(b){return b.h==-1}n.l=function(b){return b=L(this,b),R(b)?-1:I(b)?0:1};function C(b){const f=b.g.length,v=[];for(let w=0;w<f;w++)v[w]=~b.g[w];return new s(v,~b.h).add(E)}n.abs=function(){return R(this)?C(this):this},n.add=function(b){const f=Math.max(this.g.length,b.g.length),v=[];let w=0;for(let _=0;_<=f;_++){let A=w+(this.i(_)&65535)+(b.i(_)&65535),y=(A>>>16)+(this.i(_)>>>16)+(b.i(_)>>>16);w=y>>>16,A&=65535,y&=65535,v[_]=y<<16|A}return new s(v,v[v.length-1]&-2147483648?-1:0)};function L(b,f){return b.add(C(f))}n.j=function(b){if(I(this)||I(b))return g;if(R(this))return R(b)?C(this).j(C(b)):C(C(this).j(b));if(R(b))return C(this.j(C(b)));if(this.l(S)<0&&b.l(S)<0)return h(this.m()*b.m());const f=this.g.length+b.g.length,v=[];for(var w=0;w<2*f;w++)v[w]=0;for(w=0;w<this.g.length;w++)for(let _=0;_<b.g.length;_++){const A=this.i(w)>>>16,y=this.i(w)&65535,pe=b.i(_)>>>16,Oe=b.i(_)&65535;v[2*w+2*_]+=y*Oe,z(v,2*w+2*_),v[2*w+2*_+1]+=A*Oe,z(v,2*w+2*_+1),v[2*w+2*_+1]+=y*pe,z(v,2*w+2*_+1),v[2*w+2*_+2]+=A*pe,z(v,2*w+2*_+2)}for(b=0;b<f;b++)v[b]=v[2*b+1]<<16|v[2*b];for(b=f;b<2*f;b++)v[b]=0;return new s(v,0)};function z(b,f){for(;(b[f]&65535)!=b[f];)b[f+1]+=b[f]>>>16,b[f]&=65535,f++}function $(b,f){this.g=b,this.h=f}function Y(b,f){if(I(f))throw Error("division by zero");if(I(b))return new $(g,g);if(R(b))return f=Y(C(b),f),new $(C(f.g),C(f.h));if(R(f))return f=Y(b,C(f)),new $(C(f.g),f.h);if(b.g.length>30){if(R(b)||R(f))throw Error("slowDivide_ only works with positive integers.");for(var v=E,w=f;w.l(b)<=0;)v=H(v),w=H(w);var _=Q(v,1),A=Q(w,1);for(w=Q(w,2),v=Q(v,2);!I(w);){var y=A.add(w);y.l(b)<=0&&(_=_.add(v),A=y),w=Q(w,1),v=Q(v,1)}return f=L(b,_.j(f)),new $(_,f)}for(_=g;b.l(f)>=0;){for(v=Math.max(1,Math.floor(b.m()/f.m())),w=Math.ceil(Math.log(v)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),A=h(v),y=A.j(f);R(y)||y.l(b)>0;)v-=w,A=h(v),y=A.j(f);I(A)&&(A=E),_=_.add(A),b=L(b,y)}return new $(_,b)}n.B=function(b){return Y(this,b).h},n.and=function(b){const f=Math.max(this.g.length,b.g.length),v=[];for(let w=0;w<f;w++)v[w]=this.i(w)&b.i(w);return new s(v,this.h&b.h)},n.or=function(b){const f=Math.max(this.g.length,b.g.length),v=[];for(let w=0;w<f;w++)v[w]=this.i(w)|b.i(w);return new s(v,this.h|b.h)},n.xor=function(b){const f=Math.max(this.g.length,b.g.length),v=[];for(let w=0;w<f;w++)v[w]=this.i(w)^b.i(w);return new s(v,this.h^b.h)};function H(b){const f=b.g.length+1,v=[];for(let w=0;w<f;w++)v[w]=b.i(w)<<1|b.i(w-1)>>>31;return new s(v,b.h)}function Q(b,f){const v=f>>5;f%=32;const w=b.g.length-v,_=[];for(let A=0;A<w;A++)_[A]=f>0?b.i(A+v)>>>f|b.i(A+v+1)<<32-f:b.i(A+v);return new s(_,b.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Cd=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=h,s.fromString=m,Pt=s}).apply(typeof yl<"u"?yl:typeof self<"u"?self:typeof window<"u"?window:{});var ma=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Sd,dr,kd,Aa,Ti,Rd,Dd,Md;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ma=="object"&&ma];for(var c=0;c<o.length;++c){var u=o[c];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var r=t(this);function a(o,c){if(c)e:{var u=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var T=o[p];if(!(T in u))break e;u=u[T]}o=o[o.length-1],p=u[o],c=c(p),c!=p&&c!=null&&e(u,o,{configurable:!0,writable:!0,value:c})}}a("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(o){return o||function(c){var u=[],p;for(p in c)Object.prototype.hasOwnProperty.call(c,p)&&u.push([p,c[p]]);return u}});var i=i||{},s=this||self;function l(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function d(o,c,u){return o.call.apply(o.bind,arguments)}function h(o,c,u){return h=d,h.apply(null,arguments)}function m(o,c){var u=Array.prototype.slice.call(arguments,1);return function(){var p=u.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function g(o,c){function u(){}u.prototype=c.prototype,o.Z=c.prototype,o.prototype=new u,o.prototype.constructor=o,o.Ob=function(p,T,P){for(var M=Array(arguments.length-2),j=2;j<arguments.length;j++)M[j-2]=arguments[j];return c.prototype[T].apply(p,M)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function S(o){const c=o.length;if(c>0){const u=Array(c);for(let p=0;p<c;p++)u[p]=o[p];return u}return[]}function I(o,c){for(let p=1;p<arguments.length;p++){const T=arguments[p];var u=typeof T;if(u=u!="object"?u:T?Array.isArray(T)?"array":u:"null",u=="array"||u=="object"&&typeof T.length=="number"){u=o.length||0;const P=T.length||0;o.length=u+P;for(let M=0;M<P;M++)o[u+M]=T[M]}else o.push(T)}}class R{constructor(c,u){this.i=c,this.j=u,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function C(o){s.setTimeout(()=>{throw o},0)}function L(){var o=b;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class z{constructor(){this.h=this.g=null}add(c,u){const p=$.get();p.set(c,u),this.h?this.h.next=p:this.g=p,this.h=p}}var $=new R(()=>new Y,o=>o.reset());class Y{constructor(){this.next=this.g=this.h=null}set(c,u){this.h=c,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let H,Q=!1,b=new z,f=()=>{const o=Promise.resolve(void 0);H=()=>{o.then(v)}};function v(){for(var o;o=L();){try{o.h.call(o.g)}catch(u){C(u)}var c=$;c.j(o),c.h<100&&(c.h++,o.next=c.g,c.g=o)}Q=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}_.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const u=()=>{};s.addEventListener("test",u,c),s.removeEventListener("test",u,c)}catch{}return o})();function y(o){return/^[\s\xa0]*$/.test(o)}function pe(o,c){_.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,c)}g(pe,_),pe.prototype.init=function(o,c){const u=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget,c||(u=="mouseover"?c=o.fromElement:u=="mouseout"&&(c=o.toElement)),this.relatedTarget=c,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&pe.Z.h.call(this)},pe.prototype.h=function(){pe.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Oe="closure_listenable_"+(Math.random()*1e6|0),Gr=0;function Wr(o,c,u,p,T){this.listener=o,this.proxy=null,this.src=c,this.type=u,this.capture=!!p,this.ha=T,this.key=++Gr,this.da=this.fa=!1}function Ot(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function sn(o,c,u){for(const p in o)c.call(u,o[p],p,o)}function xo(o,c){for(const u in o)c.call(void 0,o[u],u,o)}function Vo(o){const c={};for(const u in o)c[u]=o[u];return c}const Kr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Qr(o,c){let u,p;for(let T=1;T<arguments.length;T++){p=arguments[T];for(u in p)o[u]=p[u];for(let P=0;P<Kr.length;P++)u=Kr[P],Object.prototype.hasOwnProperty.call(p,u)&&(o[u]=p[u])}}function cn(o){this.src=o,this.g={},this.h=0}cn.prototype.add=function(o,c,u,p,T){const P=o.toString();o=this.g[P],o||(o=this.g[P]=[],this.h++);const M=Gn(o,c,p,T);return M>-1?(c=o[M],u||(c.fa=!1)):(c=new Wr(c,this.src,P,!!p,T),c.fa=u,o.push(c)),c};function Hn(o,c){const u=c.type;if(u in o.g){var p=o.g[u],T=Array.prototype.indexOf.call(p,c,void 0),P;(P=T>=0)&&Array.prototype.splice.call(p,T,1),P&&(Ot(c),o.g[u].length==0&&(delete o.g[u],o.h--))}}function Gn(o,c,u,p){for(let T=0;T<o.length;++T){const P=o[T];if(!P.da&&P.listener==c&&P.capture==!!u&&P.ha==p)return T}return-1}var Jr="closure_lm_"+(Math.random()*1e6|0),Wn={};function Xr(o,c,u,p,T){if(Array.isArray(c)){for(let P=0;P<c.length;P++)Xr(o,c[P],u,p,T);return null}return u=Gs(u),o&&o[Oe]?o.J(c,u,l(p)?!!p.capture:!1,T):st(o,c,u,!1,p,T)}function st(o,c,u,p,T,P){if(!c)throw Error("Invalid event type");const M=l(T)?!!T.capture:!!T;let j=Bt(o);if(j||(o[Jr]=j=new cn(o)),u=j.add(c,u,p,M,P),u.proxy)return u;if(p=Yr(),u.proxy=p,p.src=o,p.listener=u,o.addEventListener)A||(T=M),T===void 0&&(T=!1),o.addEventListener(c.toString(),p,T);else if(o.attachEvent)o.attachEvent(Lo(c.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return u}function Yr(){function o(u){return c.call(o.src,o.listener,u)}const c=Kn;return o}function ct(o,c,u,p,T){if(Array.isArray(c))for(var P=0;P<c.length;P++)ct(o,c[P],u,p,T);else p=l(p)?!!p.capture:!!p,u=Gs(u),o&&o[Oe]?(o=o.i,P=String(c).toString(),P in o.g&&(c=o.g[P],u=Gn(c,u,p,T),u>-1&&(Ot(c[u]),Array.prototype.splice.call(c,u,1),c.length==0&&(delete o.g[P],o.h--)))):o&&(o=Bt(o))&&(c=o.g[c.toString()],o=-1,c&&(o=Gn(c,u,p,T)),(u=o>-1?c[o]:null)&&Zr(u))}function Zr(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[Oe])Hn(c.i,o);else{var u=o.type,p=o.proxy;c.removeEventListener?c.removeEventListener(u,p,o.capture):c.detachEvent?c.detachEvent(Lo(u),p):c.addListener&&c.removeListener&&c.removeListener(p),(u=Bt(c))?(Hn(u,o),u.h==0&&(u.src=null,c[Jr]=null)):Ot(o)}}}function Lo(o){return o in Wn?Wn[o]:Wn[o]="on"+o}function Kn(o,c){if(o.da)o=!0;else{c=new pe(c,this);const u=o.listener,p=o.ha||o.src;o.fa&&Zr(o),o=u.call(p,c)}return o}function Bt(o){return o=o[Jr],o instanceof cn?o:null}var No="__closure_events_fn_"+(Math.random()*1e9>>>0);function Gs(o){return typeof o=="function"?o:(o[No]||(o[No]=function(c){return o.handleEvent(c)}),o[No])}function _e(){w.call(this),this.i=new cn(this),this.M=this,this.G=null}g(_e,w),_e.prototype[Oe]=!0,_e.prototype.removeEventListener=function(o,c,u,p){ct(this,o,c,u,p)};function Pe(o,c){var u,p=o.G;if(p)for(u=[];p;p=p.G)u.push(p);if(o=o.M,p=c.type||c,typeof c=="string")c=new _(c,o);else if(c instanceof _)c.target=c.target||o;else{var T=c;c=new _(p,o),Qr(c,T)}T=!0;let P,M;if(u)for(M=u.length-1;M>=0;M--)P=c.g=u[M],T=ea(P,p,!0,c)&&T;if(P=c.g=o,T=ea(P,p,!0,c)&&T,T=ea(P,p,!1,c)&&T,u)for(M=0;M<u.length;M++)P=c.g=u[M],T=ea(P,p,!1,c)&&T}_e.prototype.N=function(){if(_e.Z.N.call(this),this.i){var o=this.i;for(const c in o.g){const u=o.g[c];for(let p=0;p<u.length;p++)Ot(u[p]);delete o.g[c],o.h--}}this.G=null},_e.prototype.J=function(o,c,u,p){return this.i.add(String(o),c,!1,u,p)},_e.prototype.K=function(o,c,u,p){return this.i.add(String(o),c,!0,u,p)};function ea(o,c,u,p){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();let T=!0;for(let P=0;P<c.length;++P){const M=c[P];if(M&&!M.da&&M.capture==u){const j=M.listener,ce=M.ha||M.src;M.fa&&Hn(o.i,M),T=j.call(ce,p)!==!1&&T}}return T&&!p.defaultPrevented}function wm(o,c){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:s.setTimeout(o,c||0)}function Ws(o){o.g=wm(()=>{o.g=null,o.i&&(o.i=!1,Ws(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class Am extends w{constructor(c,u){super(),this.m=c,this.l=u,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Ws(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qn(o){w.call(this),this.h=o,this.g={}}g(Qn,w);var Ks=[];function Qs(o){sn(o.g,function(c,u){this.g.hasOwnProperty(u)&&Zr(c)},o),o.g={}}Qn.prototype.N=function(){Qn.Z.N.call(this),Qs(this)},Qn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fo=s.JSON.stringify,Tm=s.JSON.parse,Pm=class{stringify(o){return s.JSON.stringify(o,void 0)}parse(o){return s.JSON.parse(o,void 0)}};function Js(){}function Xs(){}var Jn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Oo(){_.call(this,"d")}g(Oo,_);function Bo(){_.call(this,"c")}g(Bo,_);var zt={},Ys=null;function ta(){return Ys=Ys||new _e}zt.Ia="serverreachability";function Zs(o){_.call(this,zt.Ia,o)}g(Zs,_);function Xn(o){const c=ta();Pe(c,new Zs(c))}zt.STAT_EVENT="statevent";function ec(o,c){_.call(this,zt.STAT_EVENT,o),this.stat=c}g(ec,_);function Ie(o){const c=ta();Pe(c,new ec(c,o))}zt.Ja="timingevent";function tc(o,c){_.call(this,zt.Ja,o),this.size=c}g(tc,_);function Yn(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){o()},c)}function Zn(){this.g=!0}Zn.prototype.ua=function(){this.g=!1};function Im(o,c,u,p,T,P){o.info(function(){if(o.g)if(P){var M="",j=P.split("&");for(let Z=0;Z<j.length;Z++){var ce=j[Z].split("=");if(ce.length>1){const de=ce[0];ce=ce[1];const ze=de.split("_");M=ze.length>=2&&ze[1]=="type"?M+(de+"="+ce+"&"):M+(de+"=redacted&")}}}else M=null;else M=P;return"XMLHTTP REQ ("+p+") [attempt "+T+"]: "+c+`
`+u+`
`+M})}function Cm(o,c,u,p,T,P,M){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+T+"]: "+c+`
`+u+`
`+P+" "+M})}function ln(o,c,u,p){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+km(o,u)+(p?" "+p:"")})}function Sm(o,c){o.info(function(){return"TIMEOUT: "+c})}Zn.prototype.info=function(){};function km(o,c){if(!o.g)return c;if(!c)return null;try{const P=JSON.parse(c);if(P){for(o=0;o<P.length;o++)if(Array.isArray(P[o])){var u=P[o];if(!(u.length<2)){var p=u[1];if(Array.isArray(p)&&!(p.length<1)){var T=p[0];if(T!="noop"&&T!="stop"&&T!="close")for(let M=1;M<p.length;M++)p[M]=""}}}}return Fo(P)}catch{return c}}var na={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},nc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},rc;function zo(){}g(zo,Js),zo.prototype.g=function(){return new XMLHttpRequest},rc=new zo;function er(o){return encodeURIComponent(String(o))}function Rm(o){var c=1;o=o.split(":");const u=[];for(;c>0&&o.length;)u.push(o.shift()),c--;return o.length&&u.push(o.join(":")),u}function lt(o,c,u,p){this.j=o,this.i=c,this.l=u,this.S=p||1,this.V=new Qn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ac}function ac(){this.i=null,this.g="",this.h=!1}var oc={},qo={};function Uo(o,c,u){o.M=1,o.A=aa(Be(c)),o.u=u,o.R=!0,ic(o,null)}function ic(o,c){o.F=Date.now(),ra(o),o.B=Be(o.A);var u=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),Ec(u.i,"t",p),o.C=0,u=o.j.L,o.h=new ac,o.g=Fc(o.j,u?c:null,!o.u),o.P>0&&(o.O=new Am(h(o.Y,o,o.g),o.P)),c=o.V,u=o.g,p=o.ba;var T="readystatechange";Array.isArray(T)||(T&&(Ks[0]=T.toString()),T=Ks);for(let P=0;P<T.length;P++){const M=Xr(u,T[P],p||c.handleEvent,!1,c.h||c);if(!M)break;c.g[M.key]=M}c=o.J?Vo(o.J):{},o.u?(o.v||(o.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,c)):(o.v="GET",o.g.ea(o.B,o.v,null,c)),Xn(),Im(o.i,o.v,o.B,o.l,o.S,o.u)}lt.prototype.ba=function(o){o=o.target;const c=this.O;c&&ht(o)==3?c.j():this.Y(o)},lt.prototype.Y=function(o){try{if(o==this.g)e:{const j=ht(this.g),ce=this.g.ya(),Z=this.g.ca();if(!(j<3)&&(j!=3||this.g&&(this.h.h||this.g.la()||Ic(this.g)))){this.K||j!=4||ce==7||(ce==8||Z<=0?Xn(3):Xn(2)),$o(this);var c=this.g.ca();this.X=c;var u=Dm(this);if(this.o=c==200,Cm(this.i,this.v,this.B,this.l,this.S,j,c),this.o){if(this.U&&!this.L){t:{if(this.g){var p,T=this.g;if((p=T.g?T.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(p)){var P=p;break t}}P=null}if(o=P)ln(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,jo(this,o);else{this.o=!1,this.m=3,Ie(12),qt(this),tr(this);break e}}if(this.R){o=!0;let de;for(;!this.K&&this.C<u.length;)if(de=Mm(this,u),de==qo){j==4&&(this.m=4,Ie(14),o=!1),ln(this.i,this.l,null,"[Incomplete Response]");break}else if(de==oc){this.m=4,Ie(15),ln(this.i,this.l,u,"[Invalid Chunk]"),o=!1;break}else ln(this.i,this.l,de,null),jo(this,de);if(sc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),j!=4||u.length!=0||this.h.h||(this.m=1,Ie(16),o=!1),this.o=this.o&&o,!o)ln(this.i,this.l,u,"[Invalid Chunked Response]"),qt(this),tr(this);else if(u.length>0&&!this.W){this.W=!0;var M=this.j;M.g==this&&M.aa&&!M.P&&(M.j.info("Great, no buffering proxy detected. Bytes received: "+u.length),Yo(M),M.P=!0,Ie(11))}}else ln(this.i,this.l,u,null),jo(this,u);j==4&&qt(this),this.o&&!this.K&&(j==4?xc(this.j,this):(this.o=!1,ra(this)))}else Gm(this.g),c==400&&u.indexOf("Unknown SID")>0?(this.m=3,Ie(12)):(this.m=0,Ie(13)),qt(this),tr(this)}}}catch{}};function Dm(o){if(!sc(o))return o.g.la();const c=Ic(o.g);if(c==="")return"";let u="";const p=c.length,T=ht(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return qt(o),tr(o),"";o.h.i=new s.TextDecoder}for(let P=0;P<p;P++)o.h.h=!0,u+=o.h.i.decode(c[P],{stream:!(T&&P==p-1)});return c.length=0,o.h.g+=u,o.C=0,o.h.g}function sc(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function Mm(o,c){var u=o.C,p=c.indexOf(`
`,u);return p==-1?qo:(u=Number(c.substring(u,p)),isNaN(u)?oc:(p+=1,p+u>c.length?qo:(c=c.slice(p,p+u),o.C=p+u,c)))}lt.prototype.cancel=function(){this.K=!0,qt(this)};function ra(o){o.T=Date.now()+o.H,cc(o,o.H)}function cc(o,c){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Yn(h(o.aa,o),c)}function $o(o){o.D&&(s.clearTimeout(o.D),o.D=null)}lt.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(Sm(this.i,this.B),this.M!=2&&(Xn(),Ie(17)),qt(this),this.m=2,tr(this)):cc(this,this.T-o)};function tr(o){o.j.I==0||o.K||xc(o.j,o)}function qt(o){$o(o);var c=o.O;c&&typeof c.dispose=="function"&&c.dispose(),o.O=null,Qs(o.V),o.g&&(c=o.g,o.g=null,c.abort(),c.dispose())}function jo(o,c){try{var u=o.j;if(u.I!=0&&(u.g==o||Ho(u.h,o))){if(!o.L&&Ho(u.h,o)&&u.I==3){try{var p=u.Ba.g.parse(c)}catch{p=null}if(Array.isArray(p)&&p.length==3){var T=p;if(T[0]==0){e:if(!u.v){if(u.g)if(u.g.F+3e3<o.F)la(u),sa(u);else break e;Xo(u),Ie(18)}}else u.xa=T[1],0<u.xa-u.K&&T[2]<37500&&u.F&&u.A==0&&!u.C&&(u.C=Yn(h(u.Va,u),6e3));dc(u.h)<=1&&u.ta&&(u.ta=void 0)}else $t(u,11)}else if((o.L||u.g==o)&&la(u),!y(c))for(T=u.Ba.g.parse(c),c=0;c<T.length;c++){let Z=T[c];const de=Z[0];if(!(de<=u.K))if(u.K=de,Z=Z[1],u.I==2)if(Z[0]=="c"){u.M=Z[1],u.ba=Z[2];const ze=Z[3];ze!=null&&(u.ka=ze,u.j.info("VER="+u.ka));const jt=Z[4];jt!=null&&(u.za=jt,u.j.info("SVER="+u.za));const mt=Z[5];mt!=null&&typeof mt=="number"&&mt>0&&(p=1.5*mt,u.O=p,u.j.info("backChannelRequestTimeoutMs_="+p)),p=u;const pt=o.g;if(pt){const da=pt.g?pt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(da){var P=p.h;P.g||da.indexOf("spdy")==-1&&da.indexOf("quic")==-1&&da.indexOf("h2")==-1||(P.j=P.l,P.g=new Set,P.h&&(Go(P,P.h),P.h=null))}if(p.G){const Zo=pt.g?pt.g.getResponseHeader("X-HTTP-Session-Id"):null;Zo&&(p.wa=Zo,ee(p.J,p.G,Zo))}}u.I=3,u.l&&u.l.ra(),u.aa&&(u.T=Date.now()-o.F,u.j.info("Handshake RTT: "+u.T+"ms")),p=u;var M=o;if(p.na=Nc(p,p.L?p.ba:null,p.W),M.L){hc(p.h,M);var j=M,ce=p.O;ce&&(j.H=ce),j.D&&($o(j),ra(j)),p.g=M}else Dc(p);u.i.length>0&&ca(u)}else Z[0]!="stop"&&Z[0]!="close"||$t(u,7);else u.I==3&&(Z[0]=="stop"||Z[0]=="close"?Z[0]=="stop"?$t(u,7):Jo(u):Z[0]!="noop"&&u.l&&u.l.qa(Z),u.A=0)}}Xn(4)}catch{}}var xm=class{constructor(o,c){this.g=o,this.map=c}};function lc(o){this.l=o||10,s.PerformanceNavigationTiming?(o=s.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function uc(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function dc(o){return o.h?1:o.g?o.g.size:0}function Ho(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function Go(o,c){o.g?o.g.add(c):o.h=c}function hc(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}lc.prototype.cancel=function(){if(this.i=mc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function mc(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const u of o.g.values())c=c.concat(u.G);return c}return S(o.i)}var pc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vm(o,c){if(o){o=o.split("&");for(let u=0;u<o.length;u++){const p=o[u].indexOf("=");let T,P=null;p>=0?(T=o[u].substring(0,p),P=o[u].substring(p+1)):T=o[u],c(T,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function ut(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;o instanceof ut?(this.l=o.l,nr(this,o.j),this.o=o.o,this.g=o.g,rr(this,o.u),this.h=o.h,Wo(this,_c(o.i)),this.m=o.m):o&&(c=String(o).match(pc))?(this.l=!1,nr(this,c[1]||"",!0),this.o=ar(c[2]||""),this.g=ar(c[3]||"",!0),rr(this,c[4]),this.h=ar(c[5]||"",!0),Wo(this,c[6]||"",!0),this.m=ar(c[7]||"")):(this.l=!1,this.i=new ir(null,this.l))}ut.prototype.toString=function(){const o=[];var c=this.j;c&&o.push(or(c,gc,!0),":");var u=this.g;return(u||c=="file")&&(o.push("//"),(c=this.o)&&o.push(or(c,gc,!0),"@"),o.push(er(u).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.u,u!=null&&o.push(":",String(u))),(u=this.h)&&(this.g&&u.charAt(0)!="/"&&o.push("/"),o.push(or(u,u.charAt(0)=="/"?Fm:Nm,!0))),(u=this.i.toString())&&o.push("?",u),(u=this.m)&&o.push("#",or(u,Bm)),o.join("")},ut.prototype.resolve=function(o){const c=Be(this);let u=!!o.j;u?nr(c,o.j):u=!!o.o,u?c.o=o.o:u=!!o.g,u?c.g=o.g:u=o.u!=null;var p=o.h;if(u)rr(c,o.u);else if(u=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var T=c.h.lastIndexOf("/");T!=-1&&(p=c.h.slice(0,T+1)+p)}if(T=p,T==".."||T==".")p="";else if(T.indexOf("./")!=-1||T.indexOf("/.")!=-1){p=T.lastIndexOf("/",0)==0,T=T.split("/");const P=[];for(let M=0;M<T.length;){const j=T[M++];j=="."?p&&M==T.length&&P.push(""):j==".."?((P.length>1||P.length==1&&P[0]!="")&&P.pop(),p&&M==T.length&&P.push("")):(P.push(j),p=!0)}p=P.join("/")}else p=T}return u?c.h=p:u=o.i.toString()!=="",u?Wo(c,_c(o.i)):u=!!o.m,u&&(c.m=o.m),c};function Be(o){return new ut(o)}function nr(o,c,u){o.j=u?ar(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function rr(o,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);o.u=c}else o.u=null}function Wo(o,c,u){c instanceof ir?(o.i=c,zm(o.i,o.l)):(u||(c=or(c,Om)),o.i=new ir(c,o.l))}function ee(o,c,u){o.i.set(c,u)}function aa(o){return ee(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function ar(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function or(o,c,u){return typeof o=="string"?(o=encodeURI(o).replace(c,Lm),u&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Lm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var gc=/[#\/\?@]/g,Nm=/[#\?:]/g,Fm=/[#\?]/g,Om=/[#\?@]/g,Bm=/#/g;function ir(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function Ut(o){o.g||(o.g=new Map,o.h=0,o.i&&Vm(o.i,function(c,u){o.add(decodeURIComponent(c.replace(/\+/g," ")),u)}))}n=ir.prototype,n.add=function(o,c){Ut(this),this.i=null,o=un(this,o);let u=this.g.get(o);return u||this.g.set(o,u=[]),u.push(c),this.h+=1,this};function fc(o,c){Ut(o),c=un(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function yc(o,c){return Ut(o),c=un(o,c),o.g.has(c)}n.forEach=function(o,c){Ut(this),this.g.forEach(function(u,p){u.forEach(function(T){o.call(c,T,p,this)},this)},this)};function vc(o,c){Ut(o);let u=[];if(typeof c=="string")yc(o,c)&&(u=u.concat(o.g.get(un(o,c))));else for(o=Array.from(o.g.values()),c=0;c<o.length;c++)u=u.concat(o[c]);return u}n.set=function(o,c){return Ut(this),this.i=null,o=un(this,o),yc(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=vc(this,o),o.length>0?String(o[0]):c):c};function Ec(o,c,u){fc(o,c),u.length>0&&(o.i=null,o.g.set(un(o,c),S(u)),o.h+=u.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(let p=0;p<c.length;p++){var u=c[p];const T=er(u);u=vc(this,u);for(let P=0;P<u.length;P++){let M=T;u[P]!==""&&(M+="="+er(u[P])),o.push(M)}}return this.i=o.join("&")};function _c(o){const c=new ir;return c.i=o.i,o.g&&(c.g=new Map(o.g),c.h=o.h),c}function un(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function zm(o,c){c&&!o.j&&(Ut(o),o.i=null,o.g.forEach(function(u,p){const T=p.toLowerCase();p!=T&&(fc(this,p),Ec(this,T,u))},o)),o.j=c}function qm(o,c){const u=new Zn;if(s.Image){const p=new Image;p.onload=m(dt,u,"TestLoadImage: loaded",!0,c,p),p.onerror=m(dt,u,"TestLoadImage: error",!1,c,p),p.onabort=m(dt,u,"TestLoadImage: abort",!1,c,p),p.ontimeout=m(dt,u,"TestLoadImage: timeout",!1,c,p),s.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else c(!1)}function Um(o,c){const u=new Zn,p=new AbortController,T=setTimeout(()=>{p.abort(),dt(u,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:p.signal}).then(P=>{clearTimeout(T),P.ok?dt(u,"TestPingServer: ok",!0,c):dt(u,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),dt(u,"TestPingServer: error",!1,c)})}function dt(o,c,u,p,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),p(u)}catch{}}function $m(){this.g=new Pm}function Ko(o){this.i=o.Sb||null,this.h=o.ab||!1}g(Ko,Js),Ko.prototype.g=function(){return new oa(this.i,this.h)};function oa(o,c){_e.call(this),this.H=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(oa,_e),n=oa.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=c,this.readyState=1,cr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(c.body=o),(this.H||s).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,sr(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,cr(this)),this.g&&(this.readyState=3,cr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;bc(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function bc(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?sr(this):cr(this),this.readyState==3&&bc(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,sr(this))},n.Na=function(o){this.g&&(this.response=o,sr(this))},n.ga=function(){this.g&&sr(this)};function sr(o){o.readyState=4,o.l=null,o.j=null,o.B=null,cr(o)}n.setRequestHeader=function(o,c){this.A.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var u=c.next();!u.done;)u=u.value,o.push(u[0]+": "+u[1]),u=c.next();return o.join(`\r
`)};function cr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(oa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function wc(o){let c="";return sn(o,function(u,p){c+=p,c+=":",c+=u,c+=`\r
`}),c}function Qo(o,c,u){e:{for(p in u){var p=!1;break e}p=!0}p||(u=wc(u),typeof o=="string"?u!=null&&er(u):ee(o,c,u))}function ae(o){_e.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(ae,_e);var jm=/^https?$/i,Hm=["POST","PUT"];n=ae.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,c,u,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():rc.g(),this.g.onreadystatechange=E(h(this.Ca,this));try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(P){Ac(this,P);return}if(o=u||"",u=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var T in p)u.set(T,p[T]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const P of p.keys())u.set(P,p.get(P));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(u.keys()).find(P=>P.toLowerCase()=="content-type"),T=s.FormData&&o instanceof s.FormData,!(Array.prototype.indexOf.call(Hm,c,void 0)>=0)||p||T||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[P,M]of u)this.g.setRequestHeader(P,M);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(P){Ac(this,P)}};function Ac(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.o=5,Tc(o),ia(o)}function Tc(o){o.A||(o.A=!0,Pe(o,"complete"),Pe(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,Pe(this,"complete"),Pe(this,"abort"),ia(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ia(this,!0)),ae.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Pc(this):this.Xa())},n.Xa=function(){Pc(this)};function Pc(o){if(o.h&&typeof i<"u"){if(o.v&&ht(o)==4)setTimeout(o.Ca.bind(o),0);else if(Pe(o,"readystatechange"),ht(o)==4){o.h=!1;try{const P=o.ca();e:switch(P){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var u;if(!(u=c)){var p;if(p=P===0){let M=String(o.D).match(pc)[1]||null;!M&&s.self&&s.self.location&&(M=s.self.location.protocol.slice(0,-1)),p=!jm.test(M?M.toLowerCase():"")}u=p}if(u)Pe(o,"complete"),Pe(o,"success");else{o.o=6;try{var T=ht(o)>2?o.g.statusText:""}catch{T=""}o.l=T+" ["+o.ca()+"]",Tc(o)}}finally{ia(o)}}}}function ia(o,c){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const u=o.g;o.g=null,c||Pe(o,"ready");try{u.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ht(o){return o.g?o.g.readyState:0}n.ca=function(){try{return ht(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),Tm(c)}};function Ic(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Gm(o){const c={};o=(o.g&&ht(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(y(o[p]))continue;var u=Rm(o[p]);const T=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();const P=c[T]||[];c[T]=P,P.push(u)}xo(c,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function lr(o,c,u){return u&&u.internalChannelParams&&u.internalChannelParams[o]||c}function Cc(o){this.za=0,this.i=[],this.j=new Zn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=lr("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=lr("baseRetryDelayMs",5e3,o),this.Za=lr("retryDelaySeedMs",1e4,o),this.Ta=lr("forwardChannelMaxRetries",2,o),this.va=lr("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new lc(o&&o.concurrentRequestLimit),this.Ba=new $m,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Cc.prototype,n.ka=8,n.I=1,n.connect=function(o,c,u,p){Ie(0),this.W=o,this.H=c||{},u&&p!==void 0&&(this.H.OSID=u,this.H.OAID=p),this.F=this.X,this.J=Nc(this,null,this.W),ca(this)};function Jo(o){if(Sc(o),o.I==3){var c=o.V++,u=Be(o.J);if(ee(u,"SID",o.M),ee(u,"RID",c),ee(u,"TYPE","terminate"),ur(o,u),c=new lt(o,o.j,c),c.M=2,c.A=aa(Be(u)),u=!1,s.navigator&&s.navigator.sendBeacon)try{u=s.navigator.sendBeacon(c.A.toString(),"")}catch{}!u&&s.Image&&(new Image().src=c.A,u=!0),u||(c.g=Fc(c.j,null),c.g.ea(c.A)),c.F=Date.now(),ra(c)}Lc(o)}function sa(o){o.g&&(Yo(o),o.g.cancel(),o.g=null)}function Sc(o){sa(o),o.v&&(s.clearTimeout(o.v),o.v=null),la(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&s.clearTimeout(o.m),o.m=null)}function ca(o){if(!uc(o.h)&&!o.m){o.m=!0;var c=o.Ea;H||f(),Q||(H(),Q=!0),b.add(c,o),o.D=0}}function Wm(o,c){return dc(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=c.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Yn(h(o.Ea,o,c),Vc(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const T=new lt(this,this.j,o);let P=this.o;if(this.U&&(P?(P=Vo(P),Qr(P,this.U)):P=this.U),this.u!==null||this.R||(T.J=P,P=null),this.S)e:{for(var c=0,u=0;u<this.i.length;u++){t:{var p=this.i[u];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(c+=p,c>4096){c=u;break e}if(c===4096||u===this.i.length-1){c=u+1;break e}}c=1e3}else c=1e3;c=Rc(this,T,c),u=Be(this.J),ee(u,"RID",o),ee(u,"CVER",22),this.G&&ee(u,"X-HTTP-Session-Id",this.G),ur(this,u),P&&(this.R?c="headers="+er(wc(P))+"&"+c:this.u&&Qo(u,this.u,P)),Go(this.h,T),this.Ra&&ee(u,"TYPE","init"),this.S?(ee(u,"$req",c),ee(u,"SID","null"),T.U=!0,Uo(T,u,null)):Uo(T,u,c),this.I=2}}else this.I==3&&(o?kc(this,o):this.i.length==0||uc(this.h)||kc(this))};function kc(o,c){var u;c?u=c.l:u=o.V++;const p=Be(o.J);ee(p,"SID",o.M),ee(p,"RID",u),ee(p,"AID",o.K),ur(o,p),o.u&&o.o&&Qo(p,o.u,o.o),u=new lt(o,o.j,u,o.D+1),o.u===null&&(u.J=o.o),c&&(o.i=c.G.concat(o.i)),c=Rc(o,u,1e3),u.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),Go(o.h,u),Uo(u,p,c)}function ur(o,c){o.H&&sn(o.H,function(u,p){ee(c,p,u)}),o.l&&sn({},function(u,p){ee(c,p,u)})}function Rc(o,c,u){u=Math.min(o.i.length,u);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var T=o.i;let j=-1;for(;;){const ce=["count="+u];j==-1?u>0?(j=T[0].g,ce.push("ofs="+j)):j=0:ce.push("ofs="+j);let Z=!0;for(let de=0;de<u;de++){var P=T[de].g;const ze=T[de].map;if(P-=j,P<0)j=Math.max(0,T[de].g-100),Z=!1;else try{P="req"+P+"_"||"";try{var M=ze instanceof Map?ze:Object.entries(ze);for(const[jt,mt]of M){let pt=mt;l(mt)&&(pt=Fo(mt)),ce.push(P+jt+"="+encodeURIComponent(pt))}}catch(jt){throw ce.push(P+"type="+encodeURIComponent("_badmap")),jt}}catch{p&&p(ze)}}if(Z){M=ce.join("&");break e}}M=void 0}return o=o.i.splice(0,u),c.G=o,M}function Dc(o){if(!o.g&&!o.v){o.Y=1;var c=o.Da;H||f(),Q||(H(),Q=!0),b.add(c,o),o.A=0}}function Xo(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Yn(h(o.Da,o),Vc(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,Mc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Yn(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ie(10),sa(this),Mc(this))};function Yo(o){o.B!=null&&(s.clearTimeout(o.B),o.B=null)}function Mc(o){o.g=new lt(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var c=Be(o.na);ee(c,"RID","rpc"),ee(c,"SID",o.M),ee(c,"AID",o.K),ee(c,"CI",o.F?"0":"1"),!o.F&&o.ia&&ee(c,"TO",o.ia),ee(c,"TYPE","xmlhttp"),ur(o,c),o.u&&o.o&&Qo(c,o.u,o.o),o.O&&(o.g.H=o.O);var u=o.g;o=o.ba,u.M=1,u.A=aa(Be(c)),u.u=null,u.R=!0,ic(u,o)}n.Va=function(){this.C!=null&&(this.C=null,sa(this),Xo(this),Ie(19))};function la(o){o.C!=null&&(s.clearTimeout(o.C),o.C=null)}function xc(o,c){var u=null;if(o.g==c){la(o),Yo(o),o.g=null;var p=2}else if(Ho(o.h,c))u=c.G,hc(o.h,c),p=1;else return;if(o.I!=0){if(c.o)if(p==1){u=c.u?c.u.length:0,c=Date.now()-c.F;var T=o.D;p=ta(),Pe(p,new tc(p,u)),ca(o)}else Dc(o);else if(T=c.m,T==3||T==0&&c.X>0||!(p==1&&Wm(o,c)||p==2&&Xo(o)))switch(u&&u.length>0&&(c=o.h,c.i=c.i.concat(u)),T){case 1:$t(o,5);break;case 4:$t(o,10);break;case 3:$t(o,6);break;default:$t(o,2)}}}function Vc(o,c){let u=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(u*=2),u*c}function $t(o,c){if(o.j.info("Error code "+c),c==2){var u=h(o.bb,o),p=o.Ua;const T=!p;p=new ut(p||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||nr(p,"https"),aa(p),T?qm(p.toString(),u):Um(p.toString(),u)}else Ie(2);o.I=0,o.l&&o.l.pa(c),Lc(o),Sc(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Ie(2)):(this.j.info("Failed to ping google.com"),Ie(1))};function Lc(o){if(o.I=0,o.ja=[],o.l){const c=mc(o.h);(c.length!=0||o.i.length!=0)&&(I(o.ja,c),I(o.ja,o.i),o.h.i.length=0,S(o.i),o.i.length=0),o.l.oa()}}function Nc(o,c,u){var p=u instanceof ut?Be(u):new ut(u);if(p.g!="")c&&(p.g=c+"."+p.g),rr(p,p.u);else{var T=s.location;p=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;const P=new ut(null);p&&nr(P,p),c&&(P.g=c),T&&rr(P,T),u&&(P.h=u),p=P}return u=o.G,c=o.wa,u&&c&&ee(p,u,c),ee(p,"VER",o.ka),ur(o,p),p}function Fc(o,c,u){if(c&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Aa&&!o.ma?new ae(new Ko({ab:u})):new ae(o.ma),c.Fa(o.L),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Oc(){}n=Oc.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ua(){}ua.prototype.g=function(o,c){return new ke(o,c)};function ke(o,c){_e.call(this),this.g=new Cc(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(o?o["X-WebChannel-Client-Profile"]=c.sa:o={"X-WebChannel-Client-Profile":c.sa}),this.g.U=o,(o=c&&c.Qb)&&!y(o)&&(this.g.u=o),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!y(c)&&(this.g.G=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new dn(this)}g(ke,_e),ke.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ke.prototype.close=function(){Jo(this.g)},ke.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var u={};u.__data__=o,o=u}else this.v&&(u={},u.__data__=Fo(o),o=u);c.i.push(new xm(c.Ya++,o)),c.I==3&&ca(c)},ke.prototype.N=function(){this.g.l=null,delete this.j,Jo(this.g),delete this.g,ke.Z.N.call(this)};function Bc(o){Oo.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(const u in c){o=u;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}g(Bc,Oo);function zc(){Bo.call(this),this.status=1}g(zc,Bo);function dn(o){this.g=o}g(dn,Oc),dn.prototype.ra=function(){Pe(this.g,"a")},dn.prototype.qa=function(o){Pe(this.g,new Bc(o))},dn.prototype.pa=function(o){Pe(this.g,new zc)},dn.prototype.oa=function(){Pe(this.g,"b")},ua.prototype.createWebChannel=ua.prototype.g,ke.prototype.send=ke.prototype.o,ke.prototype.open=ke.prototype.m,ke.prototype.close=ke.prototype.close,Md=function(){return new ua},Dd=function(){return ta()},Rd=zt,Ti={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},na.NO_ERROR=0,na.TIMEOUT=8,na.HTTP_ERROR=6,Aa=na,nc.COMPLETE="complete",kd=nc,Xs.EventType=Jn,Jn.OPEN="a",Jn.CLOSE="b",Jn.ERROR="c",Jn.MESSAGE="d",_e.prototype.listen=_e.prototype.J,dr=Xs,ae.prototype.listenOnce=ae.prototype.K,ae.prototype.getLastError=ae.prototype.Ha,ae.prototype.getLastErrorCode=ae.prototype.ya,ae.prototype.getStatus=ae.prototype.ca,ae.prototype.getResponseJson=ae.prototype.La,ae.prototype.getResponseText=ae.prototype.la,ae.prototype.send=ae.prototype.ea,ae.prototype.setWithCredentials=ae.prototype.Fa,Sd=ae}).apply(typeof ma<"u"?ma:typeof self<"u"?self:typeof window<"u"?window:{});const vl="@firebase/firestore",El="4.9.3";class we{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}we.UNAUTHENTICATED=new we(null),we.GOOGLE_CREDENTIALS=new we("google-credentials-uid"),we.FIRST_PARTY=new we("first-party-uid"),we.MOCK_USER=new we("mock-user");let Bn="12.7.0";const en=new ji("@firebase/firestore");function mn(){return en.logLevel}function V(n,...e){if(en.logLevel<=G.DEBUG){const t=e.map(rs);en.debug(`Firestore (${Bn}): ${n}`,...t)}}function at(n,...e){if(en.logLevel<=G.ERROR){const t=e.map(rs);en.error(`Firestore (${Bn}): ${n}`,...t)}}function In(n,...e){if(en.logLevel<=G.WARN){const t=e.map(rs);en.warn(`Firestore (${Bn}): ${n}`,...t)}}function rs(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function O(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,xd(n,r,t)}function xd(n,e,t){let r=`FIRESTORE (${Bn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw at(r),new Error(r)}function X(n,e,t,r){let a="Unexpected state";typeof t=="string"?a=t:r=t,n||xd(e,a,r)}function U(n,e){return n}const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class N extends it{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class It{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Vd{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ev{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(we.UNAUTHENTICATED)))}shutdown(){}}class tv{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class nv{constructor(e){this.t=e,this.currentUser=we.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){X(this.o===void 0,42304);let r=this.i;const a=d=>this.i!==r?(r=this.i,t(d)):Promise.resolve();let i=new It;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new It,e.enqueueRetryable((()=>a(this.currentUser)))};const s=()=>{const d=i;e.enqueueRetryable((async()=>{await d.promise,await a(this.currentUser)}))},l=d=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((d=>l(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?l(d):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new It)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(X(typeof r.accessToken=="string",31837,{l:r}),new Vd(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return X(e===null||typeof e=="string",2055,{h:e}),new we(e)}}class rv{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=we.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class av{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new rv(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(we.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class _l{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ov{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xe(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){X(this.o===void 0,3512);const r=i=>{i.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const s=i.token!==this.m;return this.m=i.token,V("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const a=i=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>a(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?a(i):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new _l(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(X(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new _l(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function iv(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class as{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=iv(40);for(let i=0;i<a.length;++i)r.length<20&&a[i]<t&&(r+=e.charAt(a[i]%62))}return r}}function W(n,e){return n<e?-1:n>e?1:0}function Pi(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const a=n.charAt(r),i=e.charAt(r);if(a!==i)return si(a)===si(i)?W(a,i):si(a)?1:-1}return W(n.length,e.length)}const sv=55296,cv=57343;function si(n){const e=n.charCodeAt(0);return e>=sv&&e<=cv}function Cn(n,e,t){return n.length===e.length&&n.every(((r,a)=>t(r,e[a])))}const bl="__name__";class qe{constructor(e,t,r){t===void 0?t=0:t>e.length&&O(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&O(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return qe.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qe?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const i=qe.compareSegments(e.get(a),t.get(a));if(i!==0)return i}return W(e.length,t.length)}static compareSegments(e,t){const r=qe.isNumericId(e),a=qe.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?qe.extractNumericId(e).compare(qe.extractNumericId(t)):Pi(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pt.fromString(e.substring(4,e.length-2))}}class te extends qe{construct(e,t,r){return new te(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new N(D.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new te(t)}static emptyPath(){return new te([])}}const lv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fe extends qe{construct(e,t,r){return new fe(e,t,r)}static isValidIdentifier(e){return lv.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fe.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bl}static keyField(){return new fe([bl])}static fromServerFormat(e){const t=[];let r="",a=0;const i=()=>{if(r.length===0)throw new N(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let s=!1;for(;a<e.length;){const l=e[a];if(l==="\\"){if(a+1===e.length)throw new N(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[a+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new N(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,a+=2}else l==="`"?(s=!s,a++):l!=="."||s?(r+=l,a++):(i(),a++)}if(i(),s)throw new N(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fe(t)}static emptyPath(){return new fe([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(te.fromString(e))}static fromName(e){return new F(te.fromString(e).popFirst(5))}static empty(){return new F(te.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&te.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return te.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new te(e.slice()))}}function Ld(n,e,t){if(!t)throw new N(D.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function uv(n,e,t,r){if(e===!0&&r===!0)throw new N(D.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function wl(n){if(!F.isDocumentKey(n))throw new N(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Al(n){if(F.isDocumentKey(n))throw new N(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Nd(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function os(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":O(12329,{type:typeof n})}function tn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new N(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=os(n);throw new N(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function se(n,e){const t={typeString:n};return e&&(t.value=e),t}function zr(n,e){if(!Nd(n))throw new N(D.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const a=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const s=n[r];if(a&&typeof s!==a){t=`JSON field '${r}' must be a ${a}.`;break}if(i!==void 0&&s!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new N(D.INVALID_ARGUMENT,t);return!0}const Tl=-62135596800,Pl=1e6;class ne{static now(){return ne.fromMillis(Date.now())}static fromDate(e){return ne.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Pl);return new ne(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new N(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new N(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Tl)throw new N(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new N(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Pl}_compareTo(e){return this.seconds===e.seconds?W(this.nanoseconds,e.nanoseconds):W(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ne._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(zr(e,ne._jsonSchema))return new ne(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Tl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ne._jsonSchemaVersion="firestore/timestamp/1.0",ne._jsonSchema={type:se("string",ne._jsonSchemaVersion),seconds:se("number"),nanoseconds:se("number")};class q{static fromTimestamp(e){return new q(e)}static min(){return new q(new ne(0,0))}static max(){return new q(new ne(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Tr=-1;function dv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,a=q.fromTimestamp(r===1e9?new ne(t+1,0):new ne(t,r));return new St(a,F.empty(),e)}function hv(n){return new St(n.readTime,n.key,Tr)}class St{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new St(q.min(),F.empty(),Tr)}static max(){return new St(q.max(),F.empty(),Tr)}}function mv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:W(n.largestBatchId,e.largestBatchId))}const pv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function zn(n){if(n.code!==D.FAILED_PRECONDITION||n.message!==pv)throw n;V("LocalStore","Unexpectedly lost primary lease")}class k{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&O(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new k(((r,a)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,a)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof k?t:k.resolve(t)}catch(t){return k.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):k.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):k.reject(t)}static resolve(e){return new k(((t,r)=>{t(e)}))}static reject(e){return new k(((t,r)=>{r(e)}))}static waitFor(e){return new k(((t,r)=>{let a=0,i=0,s=!1;e.forEach((l=>{++a,l.next((()=>{++i,s&&i===a&&t()}),(d=>r(d)))})),s=!0,i===a&&t()}))}static or(e){let t=k.resolve(!1);for(const r of e)t=t.next((a=>a?k.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,i)=>{r.push(t.call(this,a,i))})),this.waitFor(r)}static mapArray(e,t){return new k(((r,a)=>{const i=e.length,s=new Array(i);let l=0;for(let d=0;d<i;d++){const h=d;t(e[h]).next((m=>{s[h]=m,++l,l===i&&r(s)}),(m=>a(m)))}}))}static doWhile(e,t){return new k(((r,a)=>{const i=()=>{e()===!0?t().next((()=>{i()}),a):r()};i()}))}}function fv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function qn(n){return n.name==="IndexedDbTransactionError"}class uo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}uo.ce=-1;const is=-1;function ho(n){return n==null}function qa(n){return n===0&&1/n==-1/0}function yv(n){return typeof n=="number"&&Number.isInteger(n)&&!qa(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Fd="";function vv(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Il(e)),e=Ev(n.get(t),e);return Il(e)}function Ev(n,e){let t=e;const r=n.length;for(let a=0;a<r;a++){const i=n.charAt(a);switch(i){case"\0":t+="";break;case Fd:t+="";break;default:t+=i}}return t}function Il(n){return n+Fd+""}function Cl(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Lt(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Od(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class re{constructor(e,t){this.comparator=e,this.root=t||ge.EMPTY}insert(e,t){return new re(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ge.BLACK,null,null))}remove(e){return new re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ge.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pa(this.root,e,this.comparator,!1)}getReverseIterator(){return new pa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pa(this.root,e,this.comparator,!0)}}class pa{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&a&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ge{constructor(e,t,r,a,i){this.key=e,this.value=t,this.color=r??ge.RED,this.left=a??ge.EMPTY,this.right=i??ge.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,i){return new ge(e??this.key,t??this.value,r??this.color,a??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const i=r(e,a.key);return a=i<0?a.copy(null,null,null,a.left.insert(e,t,r),null):i===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return ge.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return ge.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ge.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ge.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw O(43730,{key:this.key,value:this.value});if(this.right.isRed())throw O(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw O(27949);return e+(this.isRed()?0:1)}}ge.EMPTY=null,ge.RED=!0,ge.BLACK=!1;ge.EMPTY=new class{constructor(){this.size=0}get key(){throw O(57766)}get value(){throw O(16141)}get color(){throw O(16727)}get left(){throw O(29726)}get right(){throw O(36894)}copy(e,t,r,a,i){return this}insert(e,t,r){return new ge(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ue{constructor(e){this.comparator=e,this.data=new re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Sl(this.data.getIterator())}getIteratorFrom(e){return new Sl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof ue)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,i=r.getNext().key;if(this.comparator(a,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ue(this.comparator);return t.data=e,t}}class Sl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class De{constructor(e){this.fields=e,e.sort(fe.comparator)}static empty(){return new De([])}unionWith(e){let t=new ue(fe.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new De(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Cn(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class Bd extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ee{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Bd("Invalid base64 string: "+i):i}})(e);return new Ee(t)}static fromUint8Array(e){const t=(function(a){let i="";for(let s=0;s<a.length;++s)i+=String.fromCharCode(a[s]);return i})(e);return new Ee(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return W(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ee.EMPTY_BYTE_STRING=new Ee("");const _v=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kt(n){if(X(!!n,39018),typeof n=="string"){let e=0;const t=_v.exec(n);if(X(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:oe(n.seconds),nanos:oe(n.nanos)}}function oe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Rt(n){return typeof n=="string"?Ee.fromBase64String(n):Ee.fromUint8Array(n)}const zd="server_timestamp",qd="__type__",Ud="__previous_value__",$d="__local_write_time__";function ss(n){return(n?.mapValue?.fields||{})[qd]?.stringValue===zd}function mo(n){const e=n.mapValue.fields[Ud];return ss(e)?mo(e):e}function Pr(n){const e=kt(n.mapValue.fields[$d].timestampValue);return new ne(e.seconds,e.nanos)}class bv{constructor(e,t,r,a,i,s,l,d,h,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=l,this.longPollingOptions=d,this.useFetchStreams=h,this.isUsingEmulator=m}}const Ua="(default)";class Ir{constructor(e,t){this.projectId=e,this.database=t||Ua}static empty(){return new Ir("","")}get isDefaultDatabase(){return this.database===Ua}isEqual(e){return e instanceof Ir&&e.projectId===this.projectId&&e.database===this.database}}const jd="__type__",wv="__max__",ga={mapValue:{}},Hd="__vector__",$a="value";function Dt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ss(n)?4:Tv(n)?9007199254740991:Av(n)?10:11:O(28295,{value:n})}function Ke(n,e){if(n===e)return!0;const t=Dt(n);if(t!==Dt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Pr(n).isEqual(Pr(e));case 3:return(function(a,i){if(typeof a.timestampValue=="string"&&typeof i.timestampValue=="string"&&a.timestampValue.length===i.timestampValue.length)return a.timestampValue===i.timestampValue;const s=kt(a.timestampValue),l=kt(i.timestampValue);return s.seconds===l.seconds&&s.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,i){return Rt(a.bytesValue).isEqual(Rt(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,i){return oe(a.geoPointValue.latitude)===oe(i.geoPointValue.latitude)&&oe(a.geoPointValue.longitude)===oe(i.geoPointValue.longitude)})(n,e);case 2:return(function(a,i){if("integerValue"in a&&"integerValue"in i)return oe(a.integerValue)===oe(i.integerValue);if("doubleValue"in a&&"doubleValue"in i){const s=oe(a.doubleValue),l=oe(i.doubleValue);return s===l?qa(s)===qa(l):isNaN(s)&&isNaN(l)}return!1})(n,e);case 9:return Cn(n.arrayValue.values||[],e.arrayValue.values||[],Ke);case 10:case 11:return(function(a,i){const s=a.mapValue.fields||{},l=i.mapValue.fields||{};if(Cl(s)!==Cl(l))return!1;for(const d in s)if(s.hasOwnProperty(d)&&(l[d]===void 0||!Ke(s[d],l[d])))return!1;return!0})(n,e);default:return O(52216,{left:n})}}function Cr(n,e){return(n.values||[]).find((t=>Ke(t,e)))!==void 0}function Sn(n,e){if(n===e)return 0;const t=Dt(n),r=Dt(e);if(t!==r)return W(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return W(n.booleanValue,e.booleanValue);case 2:return(function(i,s){const l=oe(i.integerValue||i.doubleValue),d=oe(s.integerValue||s.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1})(n,e);case 3:return kl(n.timestampValue,e.timestampValue);case 4:return kl(Pr(n),Pr(e));case 5:return Pi(n.stringValue,e.stringValue);case 6:return(function(i,s){const l=Rt(i),d=Rt(s);return l.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(i,s){const l=i.split("/"),d=s.split("/");for(let h=0;h<l.length&&h<d.length;h++){const m=W(l[h],d[h]);if(m!==0)return m}return W(l.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,s){const l=W(oe(i.latitude),oe(s.latitude));return l!==0?l:W(oe(i.longitude),oe(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Rl(n.arrayValue,e.arrayValue);case 10:return(function(i,s){const l=i.fields||{},d=s.fields||{},h=l[$a]?.arrayValue,m=d[$a]?.arrayValue,g=W(h?.values?.length||0,m?.values?.length||0);return g!==0?g:Rl(h,m)})(n.mapValue,e.mapValue);case 11:return(function(i,s){if(i===ga.mapValue&&s===ga.mapValue)return 0;if(i===ga.mapValue)return 1;if(s===ga.mapValue)return-1;const l=i.fields||{},d=Object.keys(l),h=s.fields||{},m=Object.keys(h);d.sort(),m.sort();for(let g=0;g<d.length&&g<m.length;++g){const E=Pi(d[g],m[g]);if(E!==0)return E;const S=Sn(l[d[g]],h[m[g]]);if(S!==0)return S}return W(d.length,m.length)})(n.mapValue,e.mapValue);default:throw O(23264,{he:t})}}function kl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return W(n,e);const t=kt(n),r=kt(e),a=W(t.seconds,r.seconds);return a!==0?a:W(t.nanos,r.nanos)}function Rl(n,e){const t=n.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const i=Sn(t[a],r[a]);if(i)return i}return W(t.length,r.length)}function kn(n){return Ii(n)}function Ii(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=kt(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Rt(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return F.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",a=!0;for(const i of t.values||[])a?a=!1:r+=",",r+=Ii(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",i=!0;for(const s of r)i?i=!1:a+=",",a+=`${s}:${Ii(t.fields[s])}`;return a+"}"})(n.mapValue):O(61005,{value:n})}function Ta(n){switch(Dt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=mo(n);return e?16+Ta(e):16;case 5:return 2*n.stringValue.length;case 6:return Rt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,i)=>a+Ta(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let a=0;return Lt(r.fields,((i,s)=>{a+=i.length+Ta(s)})),a})(n.mapValue);default:throw O(13486,{value:n})}}function Ci(n){return!!n&&"integerValue"in n}function cs(n){return!!n&&"arrayValue"in n}function Dl(n){return!!n&&"nullValue"in n}function Ml(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Pa(n){return!!n&&"mapValue"in n}function Av(n){return(n?.mapValue?.fields||{})[jd]?.stringValue===Hd}function fr(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Lt(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=fr(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=fr(n.arrayValue.values[t]);return e}return{...n}}function Tv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===wv}class Se{constructor(e){this.value=e}static empty(){return new Se({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Pa(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=fr(t)}setAll(e){let t=fe.emptyPath(),r={},a=[];e.forEach(((s,l)=>{if(!t.isImmediateParentOf(l)){const d=this.getFieldsMap(t);this.applyChanges(d,r,a),r={},a=[],t=l.popLast()}s?r[l.lastSegment()]=fr(s):a.push(l.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,a)}delete(e){const t=this.field(e.popLast());Pa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ke(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];Pa(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){Lt(t,((a,i)=>e[a]=i));for(const a of r)delete e[a]}clone(){return new Se(fr(this.value))}}function Gd(n){const e=[];return Lt(n.fields,((t,r)=>{const a=new fe([t]);if(Pa(r)){const i=Gd(r.mapValue).fields;if(i.length===0)e.push(a);else for(const s of i)e.push(a.child(s))}else e.push(a)})),new De(e)}class Ae{constructor(e,t,r,a,i,s,l){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=i,this.data=s,this.documentState=l}static newInvalidDocument(e){return new Ae(e,0,q.min(),q.min(),q.min(),Se.empty(),0)}static newFoundDocument(e,t,r,a){return new Ae(e,1,t,q.min(),r,a,0)}static newNoDocument(e,t){return new Ae(e,2,t,q.min(),q.min(),Se.empty(),0)}static newUnknownDocument(e,t){return new Ae(e,3,t,q.min(),q.min(),Se.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Se.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Se.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ae&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ae(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ja{constructor(e,t){this.position=e,this.inclusive=t}}function xl(n,e,t){let r=0;for(let a=0;a<n.position.length;a++){const i=e[a],s=n.position[a];if(i.field.isKeyField()?r=F.comparator(F.fromName(s.referenceValue),t.key):r=Sn(s,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Vl(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ke(n.position[t],e.position[t]))return!1;return!0}class Ha{constructor(e,t="asc"){this.field=e,this.dir=t}}function Pv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Wd{}class le extends Wd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Cv(e,t,r):t==="array-contains"?new Rv(e,r):t==="in"?new Dv(e,r):t==="not-in"?new Mv(e,r):t==="array-contains-any"?new xv(e,r):new le(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Sv(e,r):new kv(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Sn(t,this.value)):t!==null&&Dt(this.value)===Dt(t)&&this.matchesComparison(Sn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return O(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qe extends Wd{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Qe(e,t)}matches(e){return Kd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Kd(n){return n.op==="and"}function Qd(n){return Iv(n)&&Kd(n)}function Iv(n){for(const e of n.filters)if(e instanceof Qe)return!1;return!0}function Si(n){if(n instanceof le)return n.field.canonicalString()+n.op.toString()+kn(n.value);if(Qd(n))return n.filters.map((e=>Si(e))).join(",");{const e=n.filters.map((t=>Si(t))).join(",");return`${n.op}(${e})`}}function Jd(n,e){return n instanceof le?(function(r,a){return a instanceof le&&r.op===a.op&&r.field.isEqual(a.field)&&Ke(r.value,a.value)})(n,e):n instanceof Qe?(function(r,a){return a instanceof Qe&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((i,s,l)=>i&&Jd(s,a.filters[l])),!0):!1})(n,e):void O(19439)}function Xd(n){return n instanceof le?(function(t){return`${t.field.canonicalString()} ${t.op} ${kn(t.value)}`})(n):n instanceof Qe?(function(t){return t.op.toString()+" {"+t.getFilters().map(Xd).join(" ,")+"}"})(n):"Filter"}class Cv extends le{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class Sv extends le{constructor(e,t){super(e,"in",t),this.keys=Yd("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class kv extends le{constructor(e,t){super(e,"not-in",t),this.keys=Yd("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Yd(n,e){return(e.arrayValue?.values||[]).map((t=>F.fromName(t.referenceValue)))}class Rv extends le{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return cs(t)&&Cr(t.arrayValue,this.value)}}class Dv extends le{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Cr(this.value.arrayValue,t)}}class Mv extends le{constructor(e,t){super(e,"not-in",t)}matches(e){if(Cr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Cr(this.value.arrayValue,t)}}class xv extends le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!cs(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Cr(this.value.arrayValue,r)))}}class Vv{constructor(e,t=null,r=[],a=[],i=null,s=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=i,this.startAt=s,this.endAt=l,this.Te=null}}function Ll(n,e=null,t=[],r=[],a=null,i=null,s=null){return new Vv(n,e,t,r,a,i,s)}function ls(n){const e=U(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Si(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),ho(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>kn(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>kn(r))).join(",")),e.Te=t}return e.Te}function us(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Pv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Jd(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Vl(n.startAt,e.startAt)&&Vl(n.endAt,e.endAt)}function ki(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class po{constructor(e,t=null,r=[],a=[],i=null,s="F",l=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=i,this.limitType=s,this.startAt=l,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Lv(n,e,t,r,a,i,s,l){return new po(n,e,t,r,a,i,s,l)}function Zd(n){return new po(n)}function Nl(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Nv(n){return n.collectionGroup!==null}function yr(n){const e=U(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let l=new ue(fe.comparator);return s.filters.forEach((d=>{d.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ha(i,r))})),t.has(fe.keyField().canonicalString())||e.Ie.push(new Ha(fe.keyField(),r))}return e.Ie}function $e(n){const e=U(n);return e.Ee||(e.Ee=Fv(e,yr(n))),e.Ee}function Fv(n,e){if(n.limitType==="F")return Ll(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const i=a.dir==="desc"?"asc":"desc";return new Ha(a.field,i)}));const t=n.endAt?new ja(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ja(n.startAt.position,n.startAt.inclusive):null;return Ll(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Ri(n,e,t){return new po(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function go(n,e){return us($e(n),$e(e))&&n.limitType===e.limitType}function eh(n){return`${ls($e(n))}|lt:${n.limitType}`}function pn(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>Xd(a))).join(", ")}]`),ho(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>kn(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>kn(a))).join(",")),`Target(${r})`})($e(n))}; limitType=${n.limitType})`}function fo(n,e){return e.isFoundDocument()&&(function(r,a){const i=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):F.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,a){for(const i of yr(r))if(!i.field.isKeyField()&&a.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,a){for(const i of r.filters)if(!i.matches(a))return!1;return!0})(n,e)&&(function(r,a){return!(r.startAt&&!(function(s,l,d){const h=xl(s,l,d);return s.inclusive?h<=0:h<0})(r.startAt,yr(r),a)||r.endAt&&!(function(s,l,d){const h=xl(s,l,d);return s.inclusive?h>=0:h>0})(r.endAt,yr(r),a))})(n,e)}function Ov(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function th(n){return(e,t)=>{let r=!1;for(const a of yr(n)){const i=Bv(a,e,t);if(i!==0)return i;r=r||a.field.isKeyField()}return 0}}function Bv(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):(function(i,s,l){const d=s.data.field(i),h=l.data.field(i);return d!==null&&h!==null?Sn(d,h):O(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return O(19790,{direction:n.dir})}}class an{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,i]of r)if(this.equalsFn(a,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<a.length;i++)if(this.equalsFn(a[i][0],e))return void(a[i]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Lt(this.inner,((t,r)=>{for(const[a,i]of r)e(a,i)}))}isEmpty(){return Od(this.inner)}size(){return this.innerSize}}const zv=new re(F.comparator);function ot(){return zv}const nh=new re(F.comparator);function hr(...n){let e=nh;for(const t of n)e=e.insert(t.key,t);return e}function rh(n){let e=nh;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Kt(){return vr()}function ah(){return vr()}function vr(){return new an((n=>n.toString()),((n,e)=>n.isEqual(e)))}const qv=new re(F.comparator),Uv=new ue(F.comparator);function K(...n){let e=Uv;for(const t of n)e=e.add(t);return e}const $v=new ue(W);function jv(){return $v}function ds(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qa(e)?"-0":e}}function oh(n){return{integerValue:""+n}}function Hv(n,e){return yv(e)?oh(e):ds(n,e)}class yo{constructor(){this._=void 0}}function Gv(n,e,t){return n instanceof Sr?(function(a,i){const s={fields:{[qd]:{stringValue:zd},[$d]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return i&&ss(i)&&(i=mo(i)),i&&(s.fields[Ud]=i),{mapValue:s}})(t,e):n instanceof kr?sh(n,e):n instanceof Rr?ch(n,e):(function(a,i){const s=ih(a,i),l=Fl(s)+Fl(a.Ae);return Ci(s)&&Ci(a.Ae)?oh(l):ds(a.serializer,l)})(n,e)}function Wv(n,e,t){return n instanceof kr?sh(n,e):n instanceof Rr?ch(n,e):t}function ih(n,e){return n instanceof Ga?(function(r){return Ci(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Sr extends yo{}class kr extends yo{constructor(e){super(),this.elements=e}}function sh(n,e){const t=lh(e);for(const r of n.elements)t.some((a=>Ke(a,r)))||t.push(r);return{arrayValue:{values:t}}}class Rr extends yo{constructor(e){super(),this.elements=e}}function ch(n,e){let t=lh(e);for(const r of n.elements)t=t.filter((a=>!Ke(a,r)));return{arrayValue:{values:t}}}class Ga extends yo{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Fl(n){return oe(n.integerValue||n.doubleValue)}function lh(n){return cs(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Kv{constructor(e,t){this.field=e,this.transform=t}}function Qv(n,e){return n.field.isEqual(e.field)&&(function(r,a){return r instanceof kr&&a instanceof kr||r instanceof Rr&&a instanceof Rr?Cn(r.elements,a.elements,Ke):r instanceof Ga&&a instanceof Ga?Ke(r.Ae,a.Ae):r instanceof Sr&&a instanceof Sr})(n.transform,e.transform)}class Jv{constructor(e,t){this.version=e,this.transformResults=t}}class Me{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Me}static exists(e){return new Me(void 0,e)}static updateTime(e){return new Me(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ia(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class vo{}function uh(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Eo(n.key,Me.none()):new qr(n.key,n.data,Me.none());{const t=n.data,r=Se.empty();let a=new ue(fe.comparator);for(let i of e.fields)if(!a.has(i)){let s=t.field(i);s===null&&i.length>1&&(i=i.popLast(),s=t.field(i)),s===null?r.delete(i):r.set(i,s),a=a.add(i)}return new Nt(n.key,r,new De(a.toArray()),Me.none())}}function Xv(n,e,t){n instanceof qr?(function(a,i,s){const l=a.value.clone(),d=Bl(a.fieldTransforms,i,s.transformResults);l.setAll(d),i.convertToFoundDocument(s.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Nt?(function(a,i,s){if(!Ia(a.precondition,i))return void i.convertToUnknownDocument(s.version);const l=Bl(a.fieldTransforms,i,s.transformResults),d=i.data;d.setAll(dh(a)),d.setAll(l),i.convertToFoundDocument(s.version,d).setHasCommittedMutations()})(n,e,t):(function(a,i,s){i.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function Er(n,e,t,r){return n instanceof qr?(function(i,s,l,d){if(!Ia(i.precondition,s))return l;const h=i.value.clone(),m=zl(i.fieldTransforms,d,s);return h.setAll(m),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Nt?(function(i,s,l,d){if(!Ia(i.precondition,s))return l;const h=zl(i.fieldTransforms,d,s),m=s.data;return m.setAll(dh(i)),m.setAll(h),s.convertToFoundDocument(s.version,m).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(i,s,l){return Ia(i.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):l})(n,e,t)}function Yv(n,e){let t=null;for(const r of n.fieldTransforms){const a=e.data.field(r.field),i=ih(r.transform,a||null);i!=null&&(t===null&&(t=Se.empty()),t.set(r.field,i))}return t||null}function Ol(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&Cn(r,a,((i,s)=>Qv(i,s)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class qr extends vo{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Nt extends vo{constructor(e,t,r,a,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function dh(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function Bl(n,e,t){const r=new Map;X(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let a=0;a<t.length;a++){const i=n[a],s=i.transform,l=e.data.field(i.field);r.set(i.field,Wv(s,l,t[a]))}return r}function zl(n,e,t){const r=new Map;for(const a of n){const i=a.transform,s=t.data.field(a.field);r.set(a.field,Gv(i,s,e))}return r}class Eo extends vo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zv extends vo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class eE{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const i=this.mutations[a];i.key.isEqual(e.key)&&Xv(i,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Er(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Er(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=ah();return this.mutations.forEach((a=>{const i=e.get(a.key),s=i.overlayedDocument;let l=this.applyToLocalView(s,i.mutatedFields);l=t.has(a.key)?null:l;const d=uh(s,l);d!==null&&r.set(a.key,d),s.isValidDocument()||s.convertToNoDocument(q.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),K())}isEqual(e){return this.batchId===e.batchId&&Cn(this.mutations,e.mutations,((t,r)=>Ol(t,r)))&&Cn(this.baseMutations,e.baseMutations,((t,r)=>Ol(t,r)))}}class hs{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){X(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=(function(){return qv})();const i=e.mutations;for(let s=0;s<i.length;s++)a=a.insert(i[s].key,r[s].version);return new hs(e,t,r,a)}}class tE{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class nE{constructor(e,t){this.count=e,this.unchangedNames=t}}var ie,J;function rE(n){switch(n){case D.OK:return O(64938);case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0;default:return O(15467,{code:n})}}function hh(n){if(n===void 0)return at("GRPC error has no .code"),D.UNKNOWN;switch(n){case ie.OK:return D.OK;case ie.CANCELLED:return D.CANCELLED;case ie.UNKNOWN:return D.UNKNOWN;case ie.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case ie.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case ie.INTERNAL:return D.INTERNAL;case ie.UNAVAILABLE:return D.UNAVAILABLE;case ie.UNAUTHENTICATED:return D.UNAUTHENTICATED;case ie.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case ie.NOT_FOUND:return D.NOT_FOUND;case ie.ALREADY_EXISTS:return D.ALREADY_EXISTS;case ie.PERMISSION_DENIED:return D.PERMISSION_DENIED;case ie.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case ie.ABORTED:return D.ABORTED;case ie.OUT_OF_RANGE:return D.OUT_OF_RANGE;case ie.UNIMPLEMENTED:return D.UNIMPLEMENTED;case ie.DATA_LOSS:return D.DATA_LOSS;default:return O(39323,{code:n})}}(J=ie||(ie={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";function aE(){return new TextEncoder}const oE=new Pt([4294967295,4294967295],0);function ql(n){const e=aE().encode(n),t=new Cd;return t.update(e),new Uint8Array(t.digest())}function Ul(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Pt([t,r],0),new Pt([a,i],0)]}class ms{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new mr(`Invalid padding: ${t}`);if(r<0)throw new mr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new mr(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Pt.fromNumber(this.ge)}ye(e,t,r){let a=e.add(t.multiply(Pt.fromNumber(r)));return a.compare(oE)===1&&(a=new Pt([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=ql(e),[r,a]=Ul(t);for(let i=0;i<this.hashCount;i++){const s=this.ye(r,a,i);if(!this.we(s))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new ms(i,a,t);return r.forEach((l=>s.insert(l))),s}insert(e){if(this.ge===0)return;const t=ql(e),[r,a]=Ul(t);for(let i=0;i<this.hashCount;i++){const s=this.ye(r,a,i);this.Se(s)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class mr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class _o{constructor(e,t,r,a,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,Ur.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new _o(q.min(),a,new re(W),ot(),K())}}class Ur{constructor(e,t,r,a,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ur(r,t,K(),K(),K())}}class Ca{constructor(e,t,r,a){this.be=e,this.removedTargetIds=t,this.key=r,this.De=a}}class mh{constructor(e,t){this.targetId=e,this.Ce=t}}class ph{constructor(e,t,r=Ee.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class $l{constructor(){this.ve=0,this.Fe=jl(),this.Me=Ee.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=K(),t=K(),r=K();return this.Fe.forEach(((a,i)=>{switch(i){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:O(38017,{changeType:i})}})),new Ur(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=jl()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,X(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class iE{constructor(e){this.Ge=e,this.ze=new Map,this.je=ot(),this.Je=fa(),this.He=fa(),this.Ye=new re(W)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:O(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,r=e.Ce.count,a=this.ot(t);if(a){const i=a.target;if(ki(i))if(r===0){const s=new F(i.path);this.et(t,s,Ae.newNoDocument(s,q.min()))}else X(r===1,20013,{expectedCount:r});else{const s=this._t(t);if(s!==r){const l=this.ut(e),d=l?this.ct(l,e,s):1;if(d!==0){this.it(t);const h=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:i=0}=t;let s,l;try{s=Rt(r).toUint8Array()}catch(d){if(d instanceof Bd)return In("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{l=new ms(s,a,i)}catch(d){return In(d instanceof mr?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return l.ge===0?null:l}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let a=0;return r.forEach((i=>{const s=this.Ge.ht(),l=`projects/${s.projectId}/databases/${s.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((i,s)=>{const l=this.ot(s);if(l){if(i.current&&ki(l.target)){const d=new F(l.target.path);this.It(d).has(s)||this.Et(s,d)||this.et(s,d,Ae.newNoDocument(d,e))}i.Be&&(t.set(s,i.ke()),i.qe())}}));let r=K();this.He.forEach(((i,s)=>{let l=!0;s.forEachWhile((d=>{const h=this.ot(d);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(r=r.add(i))})),this.je.forEach(((i,s)=>s.setReadTime(e)));const a=new _o(e,t,this.Ye,this.je,r);return this.je=ot(),this.Je=fa(),this.He=fa(),this.Ye=new re(W),a}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new $l,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ue(W),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ue(W),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new $l),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function fa(){return new re(F.comparator)}function jl(){return new re(F.comparator)}const sE={asc:"ASCENDING",desc:"DESCENDING"},cE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lE={and:"AND",or:"OR"};class uE{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Di(n,e){return n.useProto3Json||ho(e)?e:{value:e}}function Wa(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function gh(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function dE(n,e){return Wa(n,e.toTimestamp())}function je(n){return X(!!n,49232),q.fromTimestamp((function(t){const r=kt(t);return new ne(r.seconds,r.nanos)})(n))}function ps(n,e){return Mi(n,e).canonicalString()}function Mi(n,e){const t=(function(a){return new te(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function fh(n){const e=te.fromString(n);return X(bh(e),10190,{key:e.toString()}),e}function xi(n,e){return ps(n.databaseId,e.path)}function ci(n,e){const t=fh(e);if(t.get(1)!==n.databaseId.projectId)throw new N(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new N(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(vh(t))}function yh(n,e){return ps(n.databaseId,e)}function hE(n){const e=fh(n);return e.length===4?te.emptyPath():vh(e)}function Vi(n){return new te(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function vh(n){return X(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Hl(n,e,t){return{name:xi(n,e),fields:t.value.mapValue.fields}}function mE(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:O(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],i=(function(h,m){return h.useProto3Json?(X(m===void 0||typeof m=="string",58123),Ee.fromBase64String(m||"")):(X(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Ee.fromUint8Array(m||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,l=s&&(function(h){const m=h.code===void 0?D.UNKNOWN:hh(h.code);return new N(m,h.message||"")})(s);t=new ph(r,a,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=ci(n,r.document.name),i=je(r.document.updateTime),s=r.document.createTime?je(r.document.createTime):q.min(),l=new Se({mapValue:{fields:r.document.fields}}),d=Ae.newFoundDocument(a,i,s,l),h=r.targetIds||[],m=r.removedTargetIds||[];t=new Ca(h,m,d.key,d)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=ci(n,r.document),i=r.readTime?je(r.readTime):q.min(),s=Ae.newNoDocument(a,i),l=r.removedTargetIds||[];t=new Ca([],l,s.key,s)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=ci(n,r.document),i=r.removedTargetIds||[];t=new Ca([],i,a,null)}else{if(!("filter"in e))return O(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:i}=r,s=new nE(a,i),l=r.targetId;t=new mh(l,s)}}return t}function pE(n,e){let t;if(e instanceof qr)t={update:Hl(n,e.key,e.value)};else if(e instanceof Eo)t={delete:xi(n,e.key)};else if(e instanceof Nt)t={update:Hl(n,e.key,e.data),updateMask:AE(e.fieldMask)};else{if(!(e instanceof Zv))return O(16599,{Vt:e.type});t={verify:xi(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,s){const l=s.transform;if(l instanceof Sr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof kr)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Rr)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ga)return{fieldPath:s.field.canonicalString(),increment:l.Ae};throw O(20930,{transform:s.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,i){return i.updateTime!==void 0?{updateTime:dE(a,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:O(27497)})(n,e.precondition)),t}function gE(n,e){return n&&n.length>0?(X(e!==void 0,14353),n.map((t=>(function(a,i){let s=a.updateTime?je(a.updateTime):je(i);return s.isEqual(q.min())&&(s=je(i)),new Jv(s,a.transformResults||[])})(t,e)))):[]}function fE(n,e){return{documents:[yh(n,e.path)]}}function yE(n,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=yh(n,a);const i=(function(h){if(h.length!==0)return _h(Qe.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const s=(function(h){if(h.length!==0)return h.map((m=>(function(E){return{field:gn(E.field),direction:_E(E.dir)}})(m)))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);const l=Di(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:a}}function vE(n){let e=hE(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){X(r===1,65062);const m=t.from[0];m.allDescendants?a=m.collectionId:e=e.child(m.collectionId)}let i=[];t.where&&(i=(function(g){const E=Eh(g);return E instanceof Qe&&Qd(E)?E.getFilters():[E]})(t.where));let s=[];t.orderBy&&(s=(function(g){return g.map((E=>(function(I){return new Ha(fn(I.field),(function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(E)))})(t.orderBy));let l=null;t.limit&&(l=(function(g){let E;return E=typeof g=="object"?g.value:g,ho(E)?null:E})(t.limit));let d=null;t.startAt&&(d=(function(g){const E=!!g.before,S=g.values||[];return new ja(S,E)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const E=!g.before,S=g.values||[];return new ja(S,E)})(t.endAt)),Lv(e,a,s,i,l,"F",d,h)}function EE(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return O(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Eh(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=fn(t.unaryFilter.field);return le.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=fn(t.unaryFilter.field);return le.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=fn(t.unaryFilter.field);return le.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=fn(t.unaryFilter.field);return le.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return O(61313);default:return O(60726)}})(n):n.fieldFilter!==void 0?(function(t){return le.create(fn(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return O(58110);default:return O(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Qe.create(t.compositeFilter.filters.map((r=>Eh(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return O(1026)}})(t.compositeFilter.op))})(n):O(30097,{filter:n})}function _E(n){return sE[n]}function bE(n){return cE[n]}function wE(n){return lE[n]}function gn(n){return{fieldPath:n.canonicalString()}}function fn(n){return fe.fromServerFormat(n.fieldPath)}function _h(n){return n instanceof le?(function(t){if(t.op==="=="){if(Ml(t.value))return{unaryFilter:{field:gn(t.field),op:"IS_NAN"}};if(Dl(t.value))return{unaryFilter:{field:gn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ml(t.value))return{unaryFilter:{field:gn(t.field),op:"IS_NOT_NAN"}};if(Dl(t.value))return{unaryFilter:{field:gn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gn(t.field),op:bE(t.op),value:t.value}}})(n):n instanceof Qe?(function(t){const r=t.getFilters().map((a=>_h(a)));return r.length===1?r[0]:{compositeFilter:{op:wE(t.op),filters:r}}})(n):O(54877,{filter:n})}function AE(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function bh(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class _t{constructor(e,t,r,a,i=q.min(),s=q.min(),l=Ee.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=l,this.expectedCount=d}withSequenceNumber(e){return new _t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _t(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class TE{constructor(e){this.yt=e}}function PE(n){const e=vE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ri(e,e.limit,"L"):e}class IE{constructor(){this.Cn=new CE}addToCollectionParentIndex(e,t){return this.Cn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(St.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(St.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}}class CE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new ue(te.comparator),i=!a.has(r);return this.index[t]=a.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new ue(te.comparator)).toArray()}}const Gl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},wh=41943040;class Ce{static withCacheSize(e){return new Ce(e,Ce.DEFAULT_COLLECTION_PERCENTILE,Ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}Ce.DEFAULT_COLLECTION_PERCENTILE=10,Ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ce.DEFAULT=new Ce(wh,Ce.DEFAULT_COLLECTION_PERCENTILE,Ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ce.DISABLED=new Ce(-1,0,0);class Rn{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Rn(0)}static cr(){return new Rn(-1)}}const Wl="LruGarbageCollector",SE=1048576;function Kl([n,e],[t,r]){const a=W(n,t);return a===0?W(e,r):a}class kE{constructor(e){this.Ir=e,this.buffer=new ue(Kl),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Kl(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class RE{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){V(Wl,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){qn(t)?V(Wl,"Ignoring IndexedDB error during garbage collection: ",t):await zn(t)}await this.Vr(3e5)}))}}class DE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return k.resolve(uo.ce);const r=new kE(t);return this.mr.forEachTarget(e,(a=>r.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>r.Ar(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(Gl)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Gl):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,a,i,s,l,d,h;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),a=this.params.maximumSequenceNumbersToCollect):a=g,s=Date.now(),this.nthSequenceNumber(e,a)))).next((g=>(r=g,l=Date.now(),this.removeTargets(e,r,t)))).next((g=>(i=g,d=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(h=Date.now(),mn()<=G.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-m}ms
	Determined least recently used ${a} in `+(l-s)+`ms
	Removed ${i} targets in `+(d-l)+`ms
	Removed ${g} documents in `+(h-d)+`ms
Total Duration: ${h-m}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:i,documentsRemoved:g}))))}}function ME(n,e){return new DE(n,e)}class xE{constructor(){this.changes=new an((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ae.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class VE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class LE{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&Er(r.mutation,a,De.empty(),ne.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,K()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=K()){const a=Kt();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((i=>{let s=hr();return i.forEach(((l,d)=>{s=s.insert(l,d.overlayedDocument)})),s}))))}getOverlayedDocuments(e,t){const r=Kt();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,K())))}populateOverlays(e,t,r){const a=[];return r.forEach((i=>{t.has(i)||a.push(i)})),this.documentOverlayCache.getOverlays(e,a).next((i=>{i.forEach(((s,l)=>{t.set(s,l)}))}))}computeViews(e,t,r,a){let i=ot();const s=vr(),l=(function(){return vr()})();return t.forEach(((d,h)=>{const m=r.get(h.key);a.has(h.key)&&(m===void 0||m.mutation instanceof Nt)?i=i.insert(h.key,h):m!==void 0?(s.set(h.key,m.mutation.getFieldMask()),Er(m.mutation,h,m.mutation.getFieldMask(),ne.now())):s.set(h.key,De.empty())})),this.recalculateAndSaveOverlays(e,i).next((d=>(d.forEach(((h,m)=>s.set(h,m))),t.forEach(((h,m)=>l.set(h,new VE(m,s.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const r=vr();let a=new re(((s,l)=>s-l)),i=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((s=>{for(const l of s)l.keys().forEach((d=>{const h=t.get(d);if(h===null)return;let m=r.get(d)||De.empty();m=l.applyToLocalView(h,m),r.set(d,m);const g=(a.get(l.batchId)||K()).add(d);a=a.insert(l.batchId,g)}))})).next((()=>{const s=[],l=a.getReverseIterator();for(;l.hasNext();){const d=l.getNext(),h=d.key,m=d.value,g=ah();m.forEach((E=>{if(!i.has(E)){const S=uh(t.get(E),r.get(E));S!==null&&g.set(E,S),i=i.add(E)}})),s.push(this.documentOverlayCache.saveOverlays(e,h,g))}return k.waitFor(s)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return(function(s){return F.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Nv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((i=>{const s=a-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-i.size):k.resolve(Kt());let l=Tr,d=i;return s.next((h=>k.forEach(h,((m,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(m)?k.resolve():this.remoteDocumentCache.getEntry(e,m).next((E=>{d=d.insert(m,E)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,d,h,K()))).next((m=>({batchId:l,changes:rh(m)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next((r=>{let a=hr();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const i=t.collectionGroup;let s=hr();return this.indexManager.getCollectionParents(e,i).next((l=>k.forEach(l,(d=>{const h=(function(g,E){return new po(E,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,d.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,a).next((m=>{m.forEach(((g,E)=>{s=s.insert(g,E)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,a)))).next((s=>{i.forEach(((d,h)=>{const m=h.getKey();s.get(m)===null&&(s=s.insert(m,Ae.newInvalidDocument(m)))}));let l=hr();return s.forEach(((d,h)=>{const m=i.get(d);m!==void 0&&Er(m.mutation,h,De.empty(),ne.now()),fo(t,h)&&(l=l.insert(d,h))})),l}))}}class NE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return k.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:je(a.createTime)}})(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(a){return{name:a.name,query:PE(a.bundledQuery),readTime:je(a.readTime)}})(t)),k.resolve()}}class FE{constructor(){this.overlays=new re(F.comparator),this.qr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Kt();return k.forEach(t,(a=>this.getOverlay(e,a).next((i=>{i!==null&&r.set(a,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,i)=>{this.St(e,t,i)})),k.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.qr.get(r);return a!==void 0&&(a.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){const a=Kt(),i=t.length+1,s=new F(t.child("")),l=this.overlays.getIteratorFrom(s);for(;l.hasNext();){const d=l.getNext().value,h=d.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&d.largestBatchId>r&&a.set(d.getKey(),d)}return k.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let i=new re(((h,m)=>h-m));const s=this.overlays.getIterator();for(;s.hasNext();){const h=s.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let m=i.get(h.largestBatchId);m===null&&(m=Kt(),i=i.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const l=Kt(),d=i.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((h,m)=>l.set(h,m))),!(l.size()>=a)););return k.resolve(l)}St(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const s=this.qr.get(a.largestBatchId).delete(r.key);this.qr.set(a.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new tE(t,r));let i=this.qr.get(t);i===void 0&&(i=K(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class OE{constructor(){this.sessionToken=Ee.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}}class gs{constructor(){this.Qr=new ue(he.$r),this.Ur=new ue(he.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new he(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new he(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new F(new te([])),r=new he(t,e),a=new he(t,e+1),i=[];return this.Ur.forEachInRange([r,a],(s=>{this.Gr(s),i.push(s.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new F(new te([])),r=new he(t,e),a=new he(t,e+1);let i=K();return this.Ur.forEachInRange([r,a],(s=>{i=i.add(s.key)})),i}containsKey(e){const t=new he(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class he{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return F.comparator(e.key,t.key)||W(e.Yr,t.Yr)}static Kr(e,t){return W(e.Yr,t.Yr)||F.comparator(e.key,t.key)}}class BE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ue(he.$r)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new eE(i,t,r,a);this.mutationQueue.push(s);for(const l of a)this.Zr=this.Zr.add(new he(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return k.resolve(s)}lookupMutationBatch(e,t){return k.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.ei(r),i=a<0?0:a;return k.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?is:this.tr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new he(t,0),a=new he(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,a],(s=>{const l=this.Xr(s.Yr);i.push(l)})),k.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ue(W);return t.forEach((a=>{const i=new he(a,0),s=new he(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,s],(l=>{r=r.add(l.Yr)}))})),k.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let i=r;F.isDocumentKey(i)||(i=i.child(""));const s=new he(new F(i),0);let l=new ue(W);return this.Zr.forEachWhile((d=>{const h=d.key.path;return!!r.isPrefixOf(h)&&(h.length===a&&(l=l.add(d.Yr)),!0)}),s),k.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((r=>{const a=this.Xr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){X(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return k.forEach(t.mutations,(a=>{const i=new he(a.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new he(t,0),a=this.Zr.firstAfterOrEqual(r);return k.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class zE{constructor(e){this.ri=e,this.docs=(function(){return new re(F.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),i=a?a.size:0,s=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():Ae.newInvalidDocument(t))}getEntries(e,t){let r=ot();return t.forEach((a=>{const i=this.docs.get(a);r=r.insert(a,i?i.document.mutableCopy():Ae.newInvalidDocument(a))})),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let i=ot();const s=t.path,l=new F(s.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(l);for(;d.hasNext();){const{key:h,value:{document:m}}=d.getNext();if(!s.isPrefixOf(h.path))break;h.path.length>s.length+1||mv(hv(m),r)<=0||(a.has(m.key)||fo(t,m))&&(i=i.insert(m.key,m.mutableCopy()))}return k.resolve(i)}getAllFromCollectionGroup(e,t,r,a){O(9500)}ii(e,t){return k.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new qE(this)}getSize(e){return k.resolve(this.size)}}class qE extends xE{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(r)})),k.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class UE{constructor(e){this.persistence=e,this.si=new an((t=>ls(t)),us),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.oi=0,this._i=new gs,this.targetCount=0,this.ai=Rn.ur()}forEachTarget(e,t){return this.si.forEach(((r,a)=>t(a))),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),k.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Rn(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Pr(t),k.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let a=0;const i=[];return this.si.forEach(((s,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.si.delete(s),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),a++)})),k.waitFor(i).next((()=>a))}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const a=this.persistence.referenceDelegate,i=[];return a&&t.forEach((s=>{i.push(a.markPotentiallyOrphaned(e,s))})),k.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),k.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this._i.containsKey(t))}}class Ah{constructor(e,t){this.ui={},this.overlays={},this.ci=new uo(0),this.li=!1,this.li=!0,this.hi=new OE,this.referenceDelegate=e(this),this.Pi=new UE(this),this.indexManager=new IE,this.remoteDocumentCache=(function(a){return new zE(a)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new TE(t),this.Ii=new NE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new FE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new BE(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);const a=new $E(this.ci.next());return this.referenceDelegate.Ei(),r(a).next((i=>this.referenceDelegate.di(a).next((()=>i)))).toPromise().then((i=>(a.raiseOnCommittedEvent(),i)))}Ai(e,t){return k.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class $E extends gv{constructor(e){super(),this.currentSequenceNumber=e}}class fs{constructor(e){this.persistence=e,this.Ri=new gs,this.Vi=null}static mi(e){return new fs(e)}get fi(){if(this.Vi)return this.Vi;throw O(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),k.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((a=>this.fi.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.fi,(r=>{const a=F.fromPath(r);return this.gi(e,a).next((i=>{i||t.removeEntry(a,q.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return k.or([()=>k.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ka{constructor(e,t){this.persistence=e,this.pi=new an((r=>vv(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=ME(this,t)}static mi(e,t){return new Ka(e,t)}Ei(){}di(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return k.forEach(this.pi,((r,a)=>this.br(e,r,a).next((i=>i?k.resolve():t(a)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),i=a.newChangeBuffer();return a.ii(e,(s=>this.br(e,s,t).next((l=>{l||(r++,i.removeEntry(s,q.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ta(e.data.value)),t}br(e,t,r){return k.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.pi.get(t);return k.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ys{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=a}static As(e,t){let r=K(),a=K();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:a=a.add(i.doc.key)}return new ys(e,t.fromCache,r,a)}}class jE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class HE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Vp()?8:fv(Te())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,a){const i={result:null};return this.ys(e,t).next((s=>{i.result=s})).next((()=>{if(!i.result)return this.ws(e,t,a,r).next((s=>{i.result=s}))})).next((()=>{if(i.result)return;const s=new jE;return this.Ss(e,t,s).next((l=>{if(i.result=l,this.Vs)return this.bs(e,t,s,l.size)}))})).next((()=>i.result))}bs(e,t,r,a){return r.documentReadCount<this.fs?(mn()<=G.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",pn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),k.resolve()):(mn()<=G.DEBUG&&V("QueryEngine","Query:",pn(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.gs*a?(mn()<=G.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",pn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$e(t))):k.resolve())}ys(e,t){if(Nl(t))return k.resolve(null);let r=$e(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Ri(t,null,"F"),r=$e(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const s=K(...i);return this.ps.getDocuments(e,s).next((l=>this.indexManager.getMinOffset(e,r).next((d=>{const h=this.Ds(t,l);return this.Cs(t,h,s,d.readTime)?this.ys(e,Ri(t,null,"F")):this.vs(e,h,t,d)}))))})))))}ws(e,t,r,a){return Nl(t)||a.isEqual(q.min())?k.resolve(null):this.ps.getDocuments(e,r).next((i=>{const s=this.Ds(t,i);return this.Cs(t,s,r,a)?k.resolve(null):(mn()<=G.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),pn(t)),this.vs(e,s,t,dv(a,Tr)).next((l=>l)))}))}Ds(e,t){let r=new ue(th(e));return t.forEach(((a,i)=>{fo(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(a)>0)}Ss(e,t,r){return mn()<=G.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",pn(t)),this.ps.getDocumentsMatchingQuery(e,t,St.min(),r)}vs(e,t,r,a){return this.ps.getDocumentsMatchingQuery(e,r,a).next((i=>(t.forEach((s=>{i=i.insert(s.key,s)})),i)))}}const vs="LocalStore",GE=3e8;class WE{constructor(e,t,r,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new re(W),this.xs=new an((i=>ls(i)),us),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function KE(n,e,t,r){return new WE(n,e,t,r)}async function Th(n,e){const t=U(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((i=>(a=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const s=[],l=[];let d=K();for(const h of a){s.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}for(const h of i){l.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}return t.localDocuments.getDocuments(r,d).next((h=>({Ls:h,removedBatchIds:s,addedBatchIds:l})))}))}))}function QE(n,e){const t=U(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,d,h,m){const g=h.batch,E=g.keys();let S=k.resolve();return E.forEach((I=>{S=S.next((()=>m.getEntry(d,I))).next((R=>{const C=h.docVersions.get(I);X(C!==null,48541),R.version.compareTo(C)<0&&(g.applyToRemoteDocument(R,h),R.isValidDocument()&&(R.setReadTime(h.commitVersion),m.addEntry(R)))}))})),S.next((()=>l.mutationQueue.removeMutationBatch(d,g)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(l){let d=K();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(d=d.add(l.batch.mutations[h].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function Ph(n){const e=U(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function JE(n,e){const t=U(n),r=e.snapshotVersion;let a=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const s=t.Ns.newChangeBuffer({trackRemovals:!0});a=t.Ms;const l=[];e.targetChanges.forEach(((m,g)=>{const E=a.get(g);if(!E)return;l.push(t.Pi.removeMatchingKeys(i,m.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(i,m.addedDocuments,g))));let S=E.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?S=S.withResumeToken(Ee.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):m.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(m.resumeToken,r)),a=a.insert(g,S),(function(R,C,L){return R.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=GE?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(E,S,m)&&l.push(t.Pi.updateTargetData(i,S))}));let d=ot(),h=K();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,m))})),l.push(XE(i,s,e.documentUpdates).next((m=>{d=m.ks,h=m.qs}))),!r.isEqual(q.min())){const m=t.Pi.getLastRemoteSnapshotVersion(i).next((g=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));l.push(m)}return k.waitFor(l).next((()=>s.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,d,h))).next((()=>d))})).then((i=>(t.Ms=a,i)))}function XE(n,e,t){let r=K(),a=K();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let s=ot();return t.forEach(((l,d)=>{const h=i.get(l);d.isFoundDocument()!==h.isFoundDocument()&&(a=a.add(l)),d.isNoDocument()&&d.version.isEqual(q.min())?(e.removeEntry(l,d.readTime),s=s.insert(l,d)):!h.isValidDocument()||d.version.compareTo(h.version)>0||d.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(d),s=s.insert(l,d)):V(vs,"Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",d.version)})),{ks:s,qs:a}}))}function YE(n,e){const t=U(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=is),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function ZE(n,e){const t=U(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.Pi.getTargetData(r,e).next((i=>i?(a=i,k.resolve(a)):t.Pi.allocateTargetId(r).next((s=>(a=new _t(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.Ms.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Li(n,e,t){const r=U(n),a=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(s=>r.persistence.referenceDelegate.removeTarget(s,a)))}catch(s){if(!qn(s))throw s;V(vs,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Ms=r.Ms.remove(e),r.xs.delete(a.target)}function Ql(n,e,t){const r=U(n);let a=q.min(),i=K();return r.persistence.runTransaction("Execute query","readwrite",(s=>(function(d,h,m){const g=U(d),E=g.xs.get(m);return E!==void 0?k.resolve(g.Ms.get(E)):g.Pi.getTargetData(h,m)})(r,s,$e(e)).next((l=>{if(l)return a=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(s,l.targetId).next((d=>{i=d}))})).next((()=>r.Fs.getDocumentsMatchingQuery(s,e,t?a:q.min(),t?i:K()))).next((l=>(e_(r,Ov(e),l),{documents:l,Qs:i})))))}function e_(n,e,t){let r=n.Os.get(e)||q.min();t.forEach(((a,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class Jl{constructor(){this.activeTargetIds=jv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class t_{constructor(){this.Mo=new Jl,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Jl,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class n_{Oo(e){}shutdown(){}}const Xl="ConnectivityMonitor";class Yl{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){V(Xl,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){V(Xl,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ya=null;function Ni(){return ya===null?ya=(function(){return 268435456+Math.round(2147483648*Math.random())})():ya++,"0x"+ya.toString(16)}const li="RestConnection",r_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class a_{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${a}`,this.Wo=this.databaseId.database===Ua?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Go(e,t,r,a,i){const s=Ni(),l=this.zo(e,t.toUriEncodedString());V(li,`Sending RPC '${e}' ${s}:`,l,r);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,a,i);const{host:h}=new URL(l),m=Nn(h);return this.Jo(e,l,d,r,m).then((g=>(V(li,`Received RPC '${e}' ${s}: `,g),g)),(g=>{throw In(li,`RPC '${e}' ${s} failed with error: `,g,"url: ",l,"request:",r),g}))}Ho(e,t,r,a,i,s){return this.Go(e,t,r,a,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Bn})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,i)=>e[i]=a)),r&&r.headers.forEach(((a,i)=>e[i]=a))}zo(e,t){const r=r_[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class o_{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const be="WebChannelConnection";class i_ extends a_{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,a,i){const s=Ni();return new Promise(((l,d)=>{const h=new Sd;h.setWithCredentials(!0),h.listenOnce(kd.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Aa.NO_ERROR:const g=h.getResponseJson();V(be,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(g)),l(g);break;case Aa.TIMEOUT:V(be,`RPC '${e}' ${s} timed out`),d(new N(D.DEADLINE_EXCEEDED,"Request time out"));break;case Aa.HTTP_ERROR:const E=h.getStatus();if(V(be,`RPC '${e}' ${s} failed with status:`,E,"response text:",h.getResponseText()),E>0){let S=h.getResponseJson();Array.isArray(S)&&(S=S[0]);const I=S?.error;if(I&&I.status&&I.message){const R=(function(L){const z=L.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(z)>=0?z:D.UNKNOWN})(I.status);d(new N(R,I.message))}else d(new N(D.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new N(D.UNAVAILABLE,"Connection failed."));break;default:O(9055,{l_:e,streamId:s,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{V(be,`RPC '${e}' ${s} completed.`)}}));const m=JSON.stringify(a);V(be,`RPC '${e}' ${s} sending request:`,a),h.send(t,"POST",m,r,15)}))}T_(e,t,r){const a=Ni(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Md(),l=Dd(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(d.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;const m=i.join("");V(be,`Creating RPC '${e}' stream ${a}: ${m}`,d);const g=s.createWebChannel(m,d);this.I_(g);let E=!1,S=!1;const I=new o_({Yo:C=>{S?V(be,`Not sending because RPC '${e}' stream ${a} is closed:`,C):(E||(V(be,`Opening RPC '${e}' stream ${a} transport.`),g.open(),E=!0),V(be,`RPC '${e}' stream ${a} sending:`,C),g.send(C))},Zo:()=>g.close()}),R=(C,L,z)=>{C.listen(L,($=>{try{z($)}catch(Y){setTimeout((()=>{throw Y}),0)}}))};return R(g,dr.EventType.OPEN,(()=>{S||(V(be,`RPC '${e}' stream ${a} transport opened.`),I.o_())})),R(g,dr.EventType.CLOSE,(()=>{S||(S=!0,V(be,`RPC '${e}' stream ${a} transport closed`),I.a_(),this.E_(g))})),R(g,dr.EventType.ERROR,(C=>{S||(S=!0,In(be,`RPC '${e}' stream ${a} transport errored. Name:`,C.name,"Message:",C.message),I.a_(new N(D.UNAVAILABLE,"The operation could not be completed")))})),R(g,dr.EventType.MESSAGE,(C=>{if(!S){const L=C.data[0];X(!!L,16349);const z=L,$=z?.error||z[0]?.error;if($){V(be,`RPC '${e}' stream ${a} received error:`,$);const Y=$.status;let H=(function(f){const v=ie[f];if(v!==void 0)return hh(v)})(Y),Q=$.message;H===void 0&&(H=D.INTERNAL,Q="Unknown error status: "+Y+" with message "+$.message),S=!0,I.a_(new N(H,Q)),g.close()}else V(be,`RPC '${e}' stream ${a} received:`,L),I.u_(L)}})),R(l,Rd.STAT_EVENT,(C=>{C.stat===Ti.PROXY?V(be,`RPC '${e}' stream ${a} detected buffering proxy`):C.stat===Ti.NOPROXY&&V(be,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{I.__()}),0),I}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function ui(){return typeof document<"u"?document:null}function bo(n){return new uE(n,!0)}class Ih{constructor(e,t,r=1e3,a=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=a,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-r);a>0&&V("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Zl="PersistentStream";class Ch{constructor(e,t,r,a,i,s,l,d){this.Mi=e,this.S_=r,this.b_=a,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=l,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ih(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===D.RESOURCE_EXHAUSTED?(at(t.toString()),at("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.D_===t&&this.G_(r,a)}),(r=>{e((()=>{const a=new N(D.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(a)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{r((()=>this.z_(a)))})),this.stream.onMessage((a=>{r((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return V(Zl,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(V(Zl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class s_ extends Ch{constructor(e,t,r,a,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=mE(this.serializer,e),r=(function(i){if(!("targetChange"in i))return q.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?q.min():s.readTime?je(s.readTime):q.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Vi(this.serializer),t.addTarget=(function(i,s){let l;const d=s.target;if(l=ki(d)?{documents:fE(i,d)}:{query:yE(i,d).ft},l.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){l.resumeToken=gh(i,s.resumeToken);const h=Di(i,s.expectedCount);h!==null&&(l.expectedCount=h)}else if(s.snapshotVersion.compareTo(q.min())>0){l.readTime=Wa(i,s.snapshotVersion.toTimestamp());const h=Di(i,s.expectedCount);h!==null&&(l.expectedCount=h)}return l})(this.serializer,e);const r=EE(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Vi(this.serializer),t.removeTarget=e,this.q_(t)}}class c_ extends Ch{constructor(e,t,r,a,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,s),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return X(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,X(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){X(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=gE(e.writeResults,e.commitTime),r=je(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Vi(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>pE(this.serializer,r)))};this.q_(t)}}class l_{}class u_ extends l_{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new N(D.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.Go(e,Mi(t,r),a,i,s))).catch((i=>{throw i.name==="FirebaseError"?(i.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new N(D.UNKNOWN,i.toString())}))}Ho(e,t,r,a,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,l])=>this.connection.Ho(e,Mi(t,r),a,s,l,i))).catch((s=>{throw s.name==="FirebaseError"?(s.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new N(D.UNKNOWN,s.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class d_{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(at(t),this.aa=!1):V("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const nn="RemoteStore";class h_{constructor(e,t,r,a,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((s=>{r.enqueueAndForget((async()=>{on(this)&&(V(nn,"Restarting streams for network reachability change."),await(async function(d){const h=U(d);h.Ea.add(4),await $r(h),h.Ra.set("Unknown"),h.Ea.delete(4),await wo(h)})(this))}))})),this.Ra=new d_(r,a)}}async function wo(n){if(on(n))for(const e of n.da)await e(!0)}async function $r(n){for(const e of n.da)await e(!1)}function Sh(n,e){const t=U(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ws(t)?bs(t):Un(t).O_()&&_s(t,e))}function Es(n,e){const t=U(n),r=Un(t);t.Ia.delete(e),r.O_()&&kh(t,e),t.Ia.size===0&&(r.O_()?r.L_():on(t)&&t.Ra.set("Unknown"))}function _s(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Un(n).Y_(e)}function kh(n,e){n.Va.Ue(e),Un(n).Z_(e)}function bs(n){n.Va=new iE({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Un(n).start(),n.Ra.ua()}function ws(n){return on(n)&&!Un(n).x_()&&n.Ia.size>0}function on(n){return U(n).Ea.size===0}function Rh(n){n.Va=void 0}async function m_(n){n.Ra.set("Online")}async function p_(n){n.Ia.forEach(((e,t)=>{_s(n,e)}))}async function g_(n,e){Rh(n),ws(n)?(n.Ra.ha(e),bs(n)):n.Ra.set("Unknown")}async function f_(n,e,t){if(n.Ra.set("Online"),e instanceof ph&&e.state===2&&e.cause)try{await(async function(a,i){const s=i.cause;for(const l of i.targetIds)a.Ia.has(l)&&(await a.remoteSyncer.rejectListen(l,s),a.Ia.delete(l),a.Va.removeTarget(l))})(n,e)}catch(r){V(nn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qa(n,r)}else if(e instanceof Ca?n.Va.Ze(e):e instanceof mh?n.Va.st(e):n.Va.tt(e),!t.isEqual(q.min()))try{const r=await Ph(n.localStore);t.compareTo(r)>=0&&await(function(i,s){const l=i.Va.Tt(s);return l.targetChanges.forEach(((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const m=i.Ia.get(h);m&&i.Ia.set(h,m.withResumeToken(d.resumeToken,s))}})),l.targetMismatches.forEach(((d,h)=>{const m=i.Ia.get(d);if(!m)return;i.Ia.set(d,m.withResumeToken(Ee.EMPTY_BYTE_STRING,m.snapshotVersion)),kh(i,d);const g=new _t(m.target,d,h,m.sequenceNumber);_s(i,g)})),i.remoteSyncer.applyRemoteEvent(l)})(n,t)}catch(r){V(nn,"Failed to raise snapshot:",r),await Qa(n,r)}}async function Qa(n,e,t){if(!qn(e))throw e;n.Ea.add(1),await $r(n),n.Ra.set("Offline"),t||(t=()=>Ph(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{V(nn,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await wo(n)}))}function Dh(n,e){return e().catch((t=>Qa(n,t,e)))}async function Ao(n){const e=U(n),t=Mt(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:is;for(;y_(e);)try{const a=await YE(e.localStore,r);if(a===null){e.Ta.length===0&&t.L_();break}r=a.batchId,v_(e,a)}catch(a){await Qa(e,a)}Mh(e)&&xh(e)}function y_(n){return on(n)&&n.Ta.length<10}function v_(n,e){n.Ta.push(e);const t=Mt(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Mh(n){return on(n)&&!Mt(n).x_()&&n.Ta.length>0}function xh(n){Mt(n).start()}async function E_(n){Mt(n).ra()}async function __(n){const e=Mt(n);for(const t of n.Ta)e.ea(t.mutations)}async function b_(n,e,t){const r=n.Ta.shift(),a=hs.from(r,e,t);await Dh(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await Ao(n)}async function w_(n,e){e&&Mt(n).X_&&await(async function(r,a){if((function(s){return rE(s)&&s!==D.ABORTED})(a.code)){const i=r.Ta.shift();Mt(r).B_(),await Dh(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,a))),await Ao(r)}})(n,e),Mh(n)&&xh(n)}async function eu(n,e){const t=U(n);t.asyncQueue.verifyOperationInProgress(),V(nn,"RemoteStore received new credentials");const r=on(t);t.Ea.add(3),await $r(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await wo(t)}async function A_(n,e){const t=U(n);e?(t.Ea.delete(2),await wo(t)):e||(t.Ea.add(2),await $r(t),t.Ra.set("Unknown"))}function Un(n){return n.ma||(n.ma=(function(t,r,a){const i=U(t);return i.sa(),new s_(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(n.datastore,n.asyncQueue,{Xo:m_.bind(null,n),t_:p_.bind(null,n),r_:g_.bind(null,n),H_:f_.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),ws(n)?bs(n):n.Ra.set("Unknown")):(await n.ma.stop(),Rh(n))}))),n.ma}function Mt(n){return n.fa||(n.fa=(function(t,r,a){const i=U(t);return i.sa(),new c_(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:E_.bind(null,n),r_:w_.bind(null,n),ta:__.bind(null,n),na:b_.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Ao(n)):(await n.fa.stop(),n.Ta.length>0&&(V(nn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class As{constructor(e,t,r,a,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=i,this.deferred=new It,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((s=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,i){const s=Date.now()+r,l=new As(e,t,s,a,i);return l.start(r),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new N(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ts(n,e){if(at("AsyncQueue",`${e}: ${n}`),qn(n))return new N(D.UNAVAILABLE,`${e}: ${n}`);throw n}class _n{static emptySet(e){return new _n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=hr(),this.sortedSet=new re(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof _n)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,i=r.getNext().key;if(!a.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new _n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class tu{constructor(){this.ga=new re(F.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):O(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Dn{constructor(e,t,r,a,i,s,l,d,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=l,this.excludesMetadataChanges=d,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,a,i){const s=[];return t.forEach((l=>{s.push({type:0,doc:l})})),new Dn(e,t,_n.emptySet(t),s,r,a,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&go(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}class T_{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class P_{constructor(){this.queries=nu(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const a=U(t),i=a.queries;a.queries=nu(),i.forEach(((s,l)=>{for(const d of l.Sa)d.onError(r)}))})(this,new N(D.ABORTED,"Firestore shutting down"))}}function nu(){return new an((n=>eh(n)),go)}async function I_(n,e){const t=U(n);let r=3;const a=e.query;let i=t.queries.get(a);i?!i.ba()&&e.Da()&&(r=2):(i=new T_,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(a,!0);break;case 1:i.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(s){const l=Ts(s,`Initialization of query '${pn(e.query)}' failed`);return void e.onError(l)}t.queries.set(a,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Ps(t)}async function C_(n,e){const t=U(n),r=e.query;let a=3;const i=t.queries.get(r);if(i){const s=i.Sa.indexOf(e);s>=0&&(i.Sa.splice(s,1),i.Sa.length===0?a=e.Da()?0:1:!i.ba()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function S_(n,e){const t=U(n);let r=!1;for(const a of e){const i=a.query,s=t.queries.get(i);if(s){for(const l of s.Sa)l.Fa(a)&&(r=!0);s.wa=a}}r&&Ps(t)}function k_(n,e,t){const r=U(n),a=r.queries.get(e);if(a)for(const i of a.Sa)i.onError(t);r.queries.delete(e)}function Ps(n){n.Ca.forEach((e=>{e.next()}))}var Fi,ru;(ru=Fi||(Fi={})).Ma="default",ru.Cache="cache";class R_{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new Dn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Dn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Fi.Cache}}class Vh{constructor(e){this.key=e}}class Lh{constructor(e){this.key=e}}class D_{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=K(),this.mutatedKeys=K(),this.eu=th(e),this.tu=new _n(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new tu,a=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,s=a,l=!1;const d=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,h=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((m,g)=>{const E=a.get(m),S=fo(this.query,g)?g:null,I=!!E&&this.mutatedKeys.has(E.key),R=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let C=!1;E&&S?E.data.isEqual(S.data)?I!==R&&(r.track({type:3,doc:S}),C=!0):this.su(E,S)||(r.track({type:2,doc:S}),C=!0,(d&&this.eu(S,d)>0||h&&this.eu(S,h)<0)&&(l=!0)):!E&&S?(r.track({type:0,doc:S}),C=!0):E&&!S&&(r.track({type:1,doc:E}),C=!0,(d||h)&&(l=!0)),C&&(S?(s=s.add(S),i=R?i.add(m):i.delete(m)):(s=s.delete(m),i=i.delete(m)))})),this.query.limit!==null)for(;s.size>this.query.limit;){const m=this.query.limitType==="F"?s.last():s.first();s=s.delete(m.key),i=i.delete(m.key),r.track({type:1,doc:m})}return{tu:s,iu:r,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort(((m,g)=>(function(S,I){const R=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return O(20277,{Rt:C})}};return R(S)-R(I)})(m.type,g.type)||this.eu(m.doc,g.doc))),this.ou(r),a=a??!1;const l=t&&!a?this._u():[],d=this.Xa.size===0&&this.current&&!a?1:0,h=d!==this.Za;return this.Za=d,s.length!==0||h?{snapshot:new Dn(this.query,e.tu,i,s,e.mutatedKeys,d===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new tu,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=K(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new Lh(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new Vh(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=K();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Dn.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Is="SyncEngine";class M_{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class x_{constructor(e){this.key=e,this.hu=!1}}class V_{constructor(e,t,r,a,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new an((l=>eh(l)),go),this.Iu=new Map,this.Eu=new Set,this.du=new re(F.comparator),this.Au=new Map,this.Ru=new gs,this.Vu={},this.mu=new Map,this.fu=Rn.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function L_(n,e,t=!0){const r=qh(n);let a;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.lu()):a=await Nh(r,e,t,!0),a}async function N_(n,e){const t=qh(n);await Nh(t,e,!0,!1)}async function Nh(n,e,t,r){const a=await ZE(n.localStore,$e(e)),i=a.targetId,s=n.sharedClientState.addLocalQueryTarget(i,t);let l;return r&&(l=await F_(n,e,i,s==="current",a.resumeToken)),n.isPrimaryClient&&t&&Sh(n.remoteStore,a),l}async function F_(n,e,t,r,a){n.pu=(g,E,S)=>(async function(R,C,L,z){let $=C.view.ru(L);$.Cs&&($=await Ql(R.localStore,C.query,!1).then((({documents:b})=>C.view.ru(b,$))));const Y=z&&z.targetChanges.get(C.targetId),H=z&&z.targetMismatches.get(C.targetId)!=null,Q=C.view.applyChanges($,R.isPrimaryClient,Y,H);return ou(R,C.targetId,Q.au),Q.snapshot})(n,g,E,S);const i=await Ql(n.localStore,e,!0),s=new D_(e,i.Qs),l=s.ru(i.documents),d=Ur.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",a),h=s.applyChanges(l,n.isPrimaryClient,d);ou(n,t,h.au);const m=new M_(e,t,s);return n.Tu.set(e,m),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function O_(n,e,t){const r=U(n),a=r.Tu.get(e),i=r.Iu.get(a.targetId);if(i.length>1)return r.Iu.set(a.targetId,i.filter((s=>!go(s,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await Li(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&Es(r.remoteStore,a.targetId),Oi(r,a.targetId)})).catch(zn)):(Oi(r,a.targetId),await Li(r.localStore,a.targetId,!0))}async function B_(n,e){const t=U(n),r=t.Tu.get(e),a=t.Iu.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Es(t.remoteStore,r.targetId))}async function z_(n,e,t){const r=W_(n);try{const a=await(function(s,l){const d=U(s),h=ne.now(),m=l.reduce(((S,I)=>S.add(I.key)),K());let g,E;return d.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let I=ot(),R=K();return d.Ns.getEntries(S,m).next((C=>{I=C,I.forEach(((L,z)=>{z.isValidDocument()||(R=R.add(L))}))})).next((()=>d.localDocuments.getOverlayedDocuments(S,I))).next((C=>{g=C;const L=[];for(const z of l){const $=Yv(z,g.get(z.key).overlayedDocument);$!=null&&L.push(new Nt(z.key,$,Gd($.value.mapValue),Me.exists(!0)))}return d.mutationQueue.addMutationBatch(S,h,L,l)})).next((C=>{E=C;const L=C.applyToLocalDocumentSet(g,R);return d.documentOverlayCache.saveOverlays(S,C.batchId,L)}))})).then((()=>({batchId:E.batchId,changes:rh(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(s,l,d){let h=s.Vu[s.currentUser.toKey()];h||(h=new re(W)),h=h.insert(l,d),s.Vu[s.currentUser.toKey()]=h})(r,a.batchId,t),await jr(r,a.changes),await Ao(r.remoteStore)}catch(a){const i=Ts(a,"Failed to persist write");t.reject(i)}}async function Fh(n,e){const t=U(n);try{const r=await JE(t.localStore,e);e.targetChanges.forEach(((a,i)=>{const s=t.Au.get(i);s&&(X(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?s.hu=!0:a.modifiedDocuments.size>0?X(s.hu,14607):a.removedDocuments.size>0&&(X(s.hu,42227),s.hu=!1))})),await jr(t,r,e)}catch(r){await zn(r)}}function au(n,e,t){const r=U(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Tu.forEach(((i,s)=>{const l=s.view.va(e);l.snapshot&&a.push(l.snapshot)})),(function(s,l){const d=U(s);d.onlineState=l;let h=!1;d.queries.forEach(((m,g)=>{for(const E of g.Sa)E.va(l)&&(h=!0)})),h&&Ps(d)})(r.eventManager,e),a.length&&r.Pu.H_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function q_(n,e,t){const r=U(n);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Au.get(e),i=a&&a.key;if(i){let s=new re(F.comparator);s=s.insert(i,Ae.newNoDocument(i,q.min()));const l=K().add(i),d=new _o(q.min(),new Map,new re(W),s,l);await Fh(r,d),r.du=r.du.remove(i),r.Au.delete(e),Cs(r)}else await Li(r.localStore,e,!1).then((()=>Oi(r,e,t))).catch(zn)}async function U_(n,e){const t=U(n),r=e.batch.batchId;try{const a=await QE(t.localStore,e);Bh(t,r,null),Oh(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await jr(t,a)}catch(a){await zn(a)}}async function $_(n,e,t){const r=U(n);try{const a=await(function(s,l){const d=U(s);return d.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let m;return d.mutationQueue.lookupMutationBatch(h,l).next((g=>(X(g!==null,37113),m=g.keys(),d.mutationQueue.removeMutationBatch(h,g)))).next((()=>d.mutationQueue.performConsistencyCheck(h))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(h,m,l))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m))).next((()=>d.localDocuments.getDocuments(h,m)))}))})(r.localStore,e);Bh(r,e,t),Oh(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await jr(r,a)}catch(a){await zn(a)}}function Oh(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Bh(n,e,t){const r=U(n);let a=r.Vu[r.currentUser.toKey()];if(a){const i=a.get(e);i&&(t?i.reject(t):i.resolve(),a=a.remove(e)),r.Vu[r.currentUser.toKey()]=a}}function Oi(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||zh(n,r)}))}function zh(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Es(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Cs(n))}function ou(n,e,t){for(const r of t)r instanceof Vh?(n.Ru.addReference(r.key,e),j_(n,r)):r instanceof Lh?(V(Is,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||zh(n,r.key)):O(19791,{wu:r})}function j_(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(V(Is,"New document in limbo: "+t),n.Eu.add(r),Cs(n))}function Cs(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new F(te.fromString(e)),r=n.fu.next();n.Au.set(r,new x_(t)),n.du=n.du.insert(t,r),Sh(n.remoteStore,new _t($e(Zd(t.path)),r,"TargetPurposeLimboResolution",uo.ce))}}async function jr(n,e,t){const r=U(n),a=[],i=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach(((l,d)=>{s.push(r.pu(d,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const m=h?!h.fromCache:t?.targetChanges.get(d.targetId)?.current;r.sharedClientState.updateQueryState(d.targetId,m?"current":"not-current")}if(h){a.push(h);const m=ys.As(d.targetId,h);i.push(m)}})))})),await Promise.all(s),r.Pu.H_(a),await(async function(d,h){const m=U(d);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>k.forEach(h,(E=>k.forEach(E.Es,(S=>m.persistence.referenceDelegate.addReference(g,E.targetId,S))).next((()=>k.forEach(E.ds,(S=>m.persistence.referenceDelegate.removeReference(g,E.targetId,S)))))))))}catch(g){if(!qn(g))throw g;V(vs,"Failed to update sequence numbers: "+g)}for(const g of h){const E=g.targetId;if(!g.fromCache){const S=m.Ms.get(E),I=S.snapshotVersion,R=S.withLastLimboFreeSnapshotVersion(I);m.Ms=m.Ms.insert(E,R)}}})(r.localStore,i))}async function H_(n,e){const t=U(n);if(!t.currentUser.isEqual(e)){V(Is,"User change. New user:",e.toKey());const r=await Th(t.localStore,e);t.currentUser=e,(function(i,s){i.mu.forEach((l=>{l.forEach((d=>{d.reject(new N(D.CANCELLED,s))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await jr(t,r.Ls)}}function G_(n,e){const t=U(n),r=t.Au.get(e);if(r&&r.hu)return K().add(r.key);{let a=K();const i=t.Iu.get(e);if(!i)return a;for(const s of i){const l=t.Tu.get(s);a=a.unionWith(l.view.nu)}return a}}function qh(n){const e=U(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Fh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=G_.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=q_.bind(null,e),e.Pu.H_=S_.bind(null,e.eventManager),e.Pu.yu=k_.bind(null,e.eventManager),e}function W_(n){const e=U(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=U_.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$_.bind(null,e),e}class Ja{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return KE(this.persistence,new HE,e.initialUser,this.serializer)}Cu(e){return new Ah(fs.mi,this.serializer)}Du(e){return new t_}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ja.provider={build:()=>new Ja};class K_ extends Ja{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){X(this.persistence.referenceDelegate instanceof Ka,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new RE(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ce.withCacheSize(this.cacheSizeBytes):Ce.DEFAULT;return new Ah((r=>Ka.mi(r,t)),this.serializer)}}class Bi{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>au(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=H_.bind(null,this.syncEngine),await A_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new P_})()}createDatastore(e){const t=bo(e.databaseInfo.databaseId),r=(function(i){return new i_(i)})(e.databaseInfo);return(function(i,s,l,d){return new u_(i,s,l,d)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,i,s,l){return new h_(r,a,i,s,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>au(this.syncEngine,t,0)),(function(){return Yl.v()?new Yl:new n_})())}createSyncEngine(e,t){return(function(a,i,s,l,d,h,m){const g=new V_(a,i,s,l,d,h);return m&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=U(t);V(nn,"RemoteStore shutting down."),r.Ea.add(5),await $r(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Bi.provider={build:()=>new Bi};class Q_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):at("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const xt="FirestoreClient";class J_{constructor(e,t,r,a,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=we.UNAUTHENTICATED,this.clientId=as.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async s=>{V(xt,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,(s=>(V(xt,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new It;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ts(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function di(n,e){n.asyncQueue.verifyOperationInProgress(),V(xt,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async a=>{r.isEqual(a)||(await Th(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function iu(n,e){n.asyncQueue.verifyOperationInProgress();const t=await X_(n);V(xt,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>eu(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,a)=>eu(e.remoteStore,a))),n._onlineComponents=e}async function X_(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V(xt,"Using user provided OfflineComponentProvider");try{await di(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===D.FAILED_PRECONDITION||a.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;In("Error using user provided cache. Falling back to memory cache: "+t),await di(n,new Ja)}}else V(xt,"Using default OfflineComponentProvider"),await di(n,new K_(void 0));return n._offlineComponents}async function Uh(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(V(xt,"Using user provided OnlineComponentProvider"),await iu(n,n._uninitializedComponentsProvider._online)):(V(xt,"Using default OnlineComponentProvider"),await iu(n,new Bi))),n._onlineComponents}function Y_(n){return Uh(n).then((e=>e.syncEngine))}async function Z_(n){const e=await Uh(n),t=e.eventManager;return t.onListen=L_.bind(null,e.syncEngine),t.onUnlisten=O_.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=N_.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=B_.bind(null,e.syncEngine),t}function eb(n,e,t={}){const r=new It;return n.asyncQueue.enqueueAndForget((async()=>(function(i,s,l,d,h){const m=new Q_({next:E=>{m.Nu(),s.enqueueAndForget((()=>C_(i,g))),E.fromCache&&d.source==="server"?h.reject(new N(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(E)},error:E=>h.reject(E)}),g=new R_(l,m,{includeMetadataChanges:!0,qa:!0});return I_(i,g)})(await Z_(n),n.asyncQueue,e,t,r))),r.promise}function $h(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const su=new Map;const jh="firestore.googleapis.com",cu=!0;class lu{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new N(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=jh,this.ssl=cu}else this.host=e.host,this.ssl=e.ssl??cu;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=wh;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SE)throw new N(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$h(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new N(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new N(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new N(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class To{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new N(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new N(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lu(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new ev;switch(r.type){case"firstParty":return new av(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new N(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=su.get(t);r&&(V("ComponentProvider","Removing Datastore"),su.delete(t),r.terminate())})(this),Promise.resolve()}}function tb(n,e,t,r={}){n=tn(n,To);const a=Nn(e),i=n._getSettings(),s={...i,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;a&&(zu(`https://${l}`),qu("Firestore",!0)),i.host!==jh&&i.host!==l&&In("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...i,host:l,ssl:a,emulatorOptions:r};if(!Xt(d,s)&&(n._setSettings(d),r.mockUserToken)){let h,m;if(typeof r.mockUserToken=="string")h=r.mockUserToken,m=we.MOCK_USER;else{h=Pp(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new N(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new we(g)}n._authCredentials=new tv(new Vd(h,m))}}class Po{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Po(this.firestore,e,this._query)}}class me{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ct(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new me(this.firestore,e,this._key)}toJSON(){return{type:me._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(zr(t,me._jsonSchema))return new me(e,r||null,new F(te.fromString(t.referencePath)))}}me._jsonSchemaVersion="firestore/documentReference/1.0",me._jsonSchema={type:se("string",me._jsonSchemaVersion),referencePath:se("string")};class Ct extends Po{constructor(e,t,r){super(e,t,Zd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new me(this.firestore,null,new F(e))}withConverter(e){return new Ct(this.firestore,e,this._path)}}function nb(n,e,...t){if(n=ve(n),Ld("collection","path",e),n instanceof To){const r=te.fromString(e,...t);return Al(r),new Ct(n,null,r)}{if(!(n instanceof me||n instanceof Ct))throw new N(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(te.fromString(e,...t));return Al(r),new Ct(n.firestore,null,r)}}function Ss(n,e,...t){if(n=ve(n),arguments.length===1&&(e=as.newId()),Ld("doc","path",e),n instanceof To){const r=te.fromString(e,...t);return wl(r),new me(n,null,new F(r))}{if(!(n instanceof me||n instanceof Ct))throw new N(D.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(te.fromString(e,...t));return wl(r),new me(n.firestore,n instanceof Ct?n.converter:null,new F(r))}}const uu="AsyncQueue";class du{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ih(this,"async_queue_retry"),this._c=()=>{const r=ui();r&&V(uu,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=ui();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ui();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new It;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qn(e))throw e;V(uu,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,at("INTERNAL UNHANDLED ERROR: ",hu(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=As.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(a),a}uc(){this.nc&&O(47125,{Pc:hu(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function hu(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Hr extends To{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new du,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new du(e),this._firestoreClient=void 0,await e}}}function rb(n,e){const t=typeof n=="object"?n:Hu(),r=typeof n=="string"?n:Ua,a=Gi(t,"firestore").getImmediate({identifier:r});if(!a._initialized){const i=Ap("firestore");i&&tb(a,...i)}return a}function ks(n){if(n._terminated)throw new N(D.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||ab(n),n._firestoreClient}function ab(n){const e=n._freezeSettings(),t=(function(a,i,s,l){return new bv(a,i,s,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,$h(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new J_(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(a){const i=a?._online.build();return{_offline:a?._offline.build(i),_online:i}})(n._componentsProvider))}class Ve{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ve(Ee.fromBase64String(e))}catch(t){throw new N(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ve(Ee.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ve._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(zr(e,Ve._jsonSchema))return Ve.fromBase64String(e.bytes)}}Ve._jsonSchemaVersion="firestore/bytes/1.0",Ve._jsonSchema={type:se("string",Ve._jsonSchemaVersion),bytes:se("string")};class Io{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new N(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Co{constructor(e){this._methodName=e}}class He{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new N(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new N(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return W(this._lat,e._lat)||W(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:He._jsonSchemaVersion}}static fromJSON(e){if(zr(e,He._jsonSchema))return new He(e.latitude,e.longitude)}}He._jsonSchemaVersion="firestore/geoPoint/1.0",He._jsonSchema={type:se("string",He._jsonSchemaVersion),latitude:se("number"),longitude:se("number")};class Ge{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==a[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ge._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(zr(e,Ge._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ge(e.vectorValues);throw new N(D.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ge._jsonSchemaVersion="firestore/vectorValue/1.0",Ge._jsonSchema={type:se("string",Ge._jsonSchemaVersion),vectorValues:se("object")};const ob=/^__.*__$/;class ib{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Nt(e,this.data,this.fieldMask,t,this.fieldTransforms):new qr(e,this.data,t,this.fieldTransforms)}}class Hh{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Nt(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Gh(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw O(40011,{Ac:n})}}class Rs{constructor(e,t,r,a,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Rs({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Xa(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Gh(this.Ac)&&ob.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class sb{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||bo(e)}Cc(e,t,r,a=!1){return new Rs({Ac:e,methodName:t,Dc:r,path:fe.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wh(n){const e=n._freezeSettings(),t=bo(n._databaseId);return new sb(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Kh(n,e,t,r,a,i={}){const s=n.Cc(i.merge||i.mergeFields?2:0,e,t,a);Ms("Data must be an object, but it was:",s,r);const l=Qh(r,s);let d,h;if(i.merge)d=new De(s.fieldMask),h=s.fieldTransforms;else if(i.mergeFields){const m=[];for(const g of i.mergeFields){const E=zi(e,g,t);if(!s.contains(E))throw new N(D.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);Xh(m,E)||m.push(E)}d=new De(m),h=s.fieldTransforms.filter((g=>d.covers(g.field)))}else d=null,h=s.fieldTransforms;return new ib(new Se(l),d,h)}class So extends Co{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof So}}class Ds extends Co{_toFieldTransform(e){return new Kv(e.path,new Sr)}isEqual(e){return e instanceof Ds}}function cb(n,e,t,r){const a=n.Cc(1,e,t);Ms("Data must be an object, but it was:",a,r);const i=[],s=Se.empty();Lt(r,((d,h)=>{const m=xs(e,d,t);h=ve(h);const g=a.yc(m);if(h instanceof So)i.push(m);else{const E=ko(h,g);E!=null&&(i.push(m),s.set(m,E))}}));const l=new De(i);return new Hh(s,l,a.fieldTransforms)}function lb(n,e,t,r,a,i){const s=n.Cc(1,e,t),l=[zi(e,r,t)],d=[a];if(i.length%2!=0)throw new N(D.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<i.length;E+=2)l.push(zi(e,i[E])),d.push(i[E+1]);const h=[],m=Se.empty();for(let E=l.length-1;E>=0;--E)if(!Xh(h,l[E])){const S=l[E];let I=d[E];I=ve(I);const R=s.yc(S);if(I instanceof So)h.push(S);else{const C=ko(I,R);C!=null&&(h.push(S),m.set(S,C))}}const g=new De(h);return new Hh(m,g,s.fieldTransforms)}function ko(n,e){if(Jh(n=ve(n)))return Ms("Unsupported field value:",e,n),Qh(n,e);if(n instanceof Co)return(function(r,a){if(!Gh(a.Ac))throw a.Sc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(a);i&&a.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,a){const i=[];let s=0;for(const l of r){let d=ko(l,a.wc(s));d==null&&(d={nullValue:"NULL_VALUE"}),i.push(d),s++}return{arrayValue:{values:i}}})(n,e)}return(function(r,a){if((r=ve(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Hv(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ne.fromDate(r);return{timestampValue:Wa(a.serializer,i)}}if(r instanceof ne){const i=new ne(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Wa(a.serializer,i)}}if(r instanceof He)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ve)return{bytesValue:gh(a.serializer,r._byteString)};if(r instanceof me){const i=a.databaseId,s=r.firestore._databaseId;if(!s.isEqual(i))throw a.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ps(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof Ge)return(function(s,l){return{mapValue:{fields:{[jd]:{stringValue:Hd},[$a]:{arrayValue:{values:s.toArray().map((h=>{if(typeof h!="number")throw l.Sc("VectorValues must only contain numeric values.");return ds(l.serializer,h)}))}}}}}})(r,a);throw a.Sc(`Unsupported field value: ${os(r)}`)})(n,e)}function Qh(n,e){const t={};return Od(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Lt(n,((r,a)=>{const i=ko(a,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function Jh(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ne||n instanceof He||n instanceof Ve||n instanceof me||n instanceof Co||n instanceof Ge)}function Ms(n,e,t){if(!Jh(t)||!Nd(t)){const r=os(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function zi(n,e,t){if((e=ve(e))instanceof Io)return e._internalPath;if(typeof e=="string")return xs(n,e);throw Xa("Field path arguments must be of type string or ",n,!1,void 0,t)}const ub=new RegExp("[~\\*/\\[\\]]");function xs(n,e,t){if(e.search(ub)>=0)throw Xa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Io(...e.split("."))._internalPath}catch{throw Xa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Xa(n,e,t,r,a){const i=r&&!r.isEmpty(),s=a!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let d="";return(i||s)&&(d+=" (found",i&&(d+=` in field ${r}`),s&&(d+=` in document ${a}`),d+=")"),new N(D.INVALID_ARGUMENT,l+n+d)}function Xh(n,e){return n.some((t=>t.isEqual(e)))}class Yh{constructor(e,t,r,a,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new db(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Zh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class db extends Yh{data(){return super.data()}}function Zh(n,e){return typeof e=="string"?xs(n,e):e instanceof Io?e._internalPath:e._delegate._internalPath}function hb(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new N(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mb{convertValue(e,t="none"){switch(Dt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return oe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Rt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw O(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Lt(e,((a,i)=>{r[a]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[$a].arrayValue?.values?.map((r=>oe(r.doubleValue)));return new Ge(t)}convertGeoPoint(e){return new He(oe(e.latitude),oe(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=mo(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Pr(e));default:return null}}convertTimestamp(e){const t=kt(e);return new ne(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=te.fromString(e);X(bh(r),9688,{name:e});const a=new Ir(r.get(1),r.get(3)),i=new F(r.popFirst(5));return a.isEqual(t)||at(`Document ${i} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function em(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class va{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class bn extends Yh{constructor(e,t,r,a,i,s){super(e,t,r,a,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Sa(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Zh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new N(D.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=bn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}bn._jsonSchemaVersion="firestore/documentSnapshot/1.0",bn._jsonSchema={type:se("string",bn._jsonSchemaVersion),bundleSource:se("string","DocumentSnapshot"),bundleName:se("string"),bundle:se("string")};class Sa extends bn{data(e={}){return super.data(e)}}class wn{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new va(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Sa(this._firestore,this._userDataWriter,r.key,r,new va(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new N(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,i){if(a._snapshot.oldDocs.isEmpty()){let s=0;return a._snapshot.docChanges.map((l=>{const d=new Sa(a._firestore,a._userDataWriter,l.doc.key,l.doc,new va(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);return l.doc,{type:"added",doc:d,oldIndex:-1,newIndex:s++}}))}{let s=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((l=>i||l.type!==3)).map((l=>{const d=new Sa(a._firestore,a._userDataWriter,l.doc.key,l.doc,new va(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);let h=-1,m=-1;return l.type!==0&&(h=s.indexOf(l.doc.key),s=s.delete(l.doc.key)),l.type!==1&&(s=s.add(l.doc),m=s.indexOf(l.doc.key)),{type:pb(l.type),doc:d,oldIndex:h,newIndex:m}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new N(D.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=wn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=as.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),a.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function pb(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return O(61501,{type:n})}}wn._jsonSchemaVersion="firestore/querySnapshot/1.0",wn._jsonSchema={type:se("string",wn._jsonSchemaVersion),bundleSource:se("string","QuerySnapshot"),bundleName:se("string"),bundle:se("string")};class gb extends mb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ve(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new me(this.firestore,null,t)}}function fb(n){n=tn(n,Po);const e=tn(n.firestore,Hr),t=ks(e),r=new gb(e);return hb(n._query),eb(t,n._query).then((a=>new wn(e,r,n,a)))}function yb(n,e,t){n=tn(n,me);const r=tn(n.firestore,Hr),a=em(n.converter,e,t);return Vs(r,[Kh(Wh(r),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Me.none())])}function vb(n){return Vs(tn(n.firestore,Hr),[new Eo(n._key,Me.none())])}function Vs(n,e){return(function(r,a){const i=new It;return r.asyncQueue.enqueueAndForget((async()=>z_(await Y_(r),a,i))),i.promise})(ks(n),e)}class Eb{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wh(e)}set(e,t,r){this._verifyNotCommitted();const a=hi(e,this._firestore),i=em(a.converter,t,r),s=Kh(this._dataReader,"WriteBatch.set",a._key,i,a.converter!==null,r);return this._mutations.push(s.toMutation(a._key,Me.none())),this}update(e,t,r,...a){this._verifyNotCommitted();const i=hi(e,this._firestore);let s;return s=typeof(t=ve(t))=="string"||t instanceof Io?lb(this._dataReader,"WriteBatch.update",i._key,t,r,a):cb(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,Me.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=hi(e,this._firestore);return this._mutations=this._mutations.concat(new Eo(t._key,Me.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new N(D.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function hi(n,e){if((n=ve(n)).firestore!==e)throw new N(D.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function tm(){return new Ds("serverTimestamp")}function _b(n){return ks(n=tn(n,Hr)),new Eb(n,(e=>Vs(n,e)))}(function(e,t=!0){(function(a){Bn=a})(Fn),Tn(new Yt("firestore",((r,{instanceIdentifier:a,options:i})=>{const s=r.getProvider("app").getImmediate(),l=new Hr(new nv(r.getProvider("auth-internal")),new ov(s,r.getProvider("app-check-internal")),(function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new N(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ir(h.options.projectId,m)})(s,a),s);return i={useFetchStreams:t,...i},l._setSettings(i),l}),"PUBLIC").setMultipleInstances(!0)),At(vl,El,e),At(vl,El,"esm2020")})();const bb={apiKey:"AIzaSyAqeZ8V87ZxTCaqkhVY0cH43plER_7L_Fs",authDomain:"pokemon-companion-pro.firebaseapp.com",projectId:"pokemon-companion-pro",storageBucket:"pokemon-companion-pro.firebasestorage.app",messagingSenderId:"113946186968",appId:"1:113946186968:web:3200750a74f649681ab3ad",measurementId:"G-LHLX84RZQK"},nm=ju(bb),Jt=Yy(nm),Dr=rb(nm),mi=new Ye;let Gt=null;pd(Jt,n=>{Gt=n,window.dispatchEvent(new CustomEvent("authStateChanged",{detail:n}))});async function wb(){try{return(await sy(Jt,mi)).user}catch(n){return console.error("Error signing in with Google:",n),n.code==="auth/popup-closed-by-user"?(console.log("User closed the popup"),null):n.code==="auth/popup-blocked"?(alert("El popup fue bloqueado. Por favor, permite popups para este sitio."),await ll(Jt,mi),null):n.code==="auth/cancelled-popup-request"?(await ll(Jt,mi),null):(n.code==="auth/unauthorized-domain"&&alert("Este dominio no est√° autorizado para el inicio de sesi√≥n con Google. Revisa la configuraci√≥n de Firebase."),null)}}async function Ab(){try{return await qf(Jt),!0}catch(n){return console.error("Error signing out:",n),!1}}function rm(){return Gt||Jt.currentUser}function Tb(n){return pd(Jt,n)}function Pb(){return Gt?{uid:Gt.uid,displayName:Gt.displayName||"Usuario",email:Gt.email,photoURL:Gt.photoURL||null}:null}async function am(n,e){try{const t=_b(Dr);return e.forEach(r=>{const a=Ss(Dr,"users",n,"teams",r.id);t.set(a,{...r,updatedAt:tm()})}),await t.commit(),!0}catch(t){return console.error("Error saving teams to cloud:",t),!1}}async function Ls(n){try{const e=nb(Dr,"users",n,"teams"),t=await fb(e),r=[];return t.forEach(a=>{r.push({id:a.id,...a.data()})}),r.sort((a,i)=>(a.createdAt||0)-(i.createdAt||0)),r}catch(e){return console.error("Error getting teams from cloud:",e),[]}}async function Ib(n,e){try{const t=Ss(Dr,"users",n,"teams",e);return await vb(t),!0}catch(t){return console.error("Error deleting team from cloud:",t),!1}}async function Cb(n,e){try{const t=Ss(Dr,"users",n,"settings","preferences");return await yb(t,{...e,updatedAt:tm()}),!0}catch(t){return console.error("Error saving preferences to cloud:",t),!1}}async function Sb(n,e,t){try{return(await Ls(n)).length===0&&e.length>0&&(console.log("Migrating local teams to cloud..."),await am(n,e)),t&&await Cb(n,t),!0}catch(r){return console.error("Error migrating data to cloud:",r),!1}}const kb="poke_companion_teams_",Ns="poke_companion_active_team_id";function Fs(){return kb+ye()}function Rb(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function mu(n){return n.trim().toLowerCase()}function om(n,e=null){const t=mu(n);return Ft().some(r=>e&&r.id===e?!1:mu(r.name)===t)}function Ft(){try{const n=localStorage.getItem(Fs());return n?JSON.parse(n):[]}catch(n){return console.error("Error loading teams",n),[]}}function Os(){localStorage.removeItem(Fs()),localStorage.removeItem(Ns)}function $n(n){localStorage.setItem(Fs(),JSON.stringify(n));const e=rm();console.log("[TeamManager] Saving teams. User authenticated:",!!e,e?.uid),e&&(console.log("[TeamManager] Syncing",n.length,"teams to cloud for user:",e.uid),am(e.uid,n).then(()=>console.log("[TeamManager] ‚úÖ Cloud sync successful")).catch(t=>{console.warn("[TeamManager] ‚ùå Failed to sync teams to cloud:",t)}))}function im(n="Nuevo Equipo"){if(om(n))return alert("Ya existe un equipo con ese nombre."),null;const e=Ft(),t={id:Rb(),name:n,game:ye(),slots:Array(6).fill(null),createdAt:Date.now()};return e.push(t),$n(e),jn(t.id),t}function Ro(){return localStorage.getItem(Ns)}function jn(n){localStorage.setItem(Ns,n),window.dispatchEvent(new CustomEvent("teamChanged",{detail:n}))}function Le(){const n=Ft(),e=Ro();let t=n.find(r=>r.id===e);return!t&&n.length>0&&(t=n[0],jn(t.id)),t||(t=im("Mi Equipo Principal")),t}function Do(n){const e=Ft(),t=Ro(),r=e.findIndex(a=>a.id===t);r!==-1&&(e[r].slots=n,$n(e))}function Db(n,e){if(om(e,n))return alert("Ya existe un equipo con ese nombre."),!1;const t=Ft(),r=t.find(a=>a.id===n);return r?(r.name=e,$n(t),window.dispatchEvent(new CustomEvent("teamListUpdated")),!0):!1}function Mb(n){let e=Ft();if(e.length<=1){alert("No puedes borrar el √∫ltimo equipo.");return}e=e.filter(r=>r.id!==n),$n(e),Ro()===n?jn(e[0].id):window.dispatchEvent(new CustomEvent("teamListUpdated"));const t=rm();t&&Ib(t.uid,n).then(()=>console.log("[TeamManager] ‚úÖ Cloud delete successful")).catch(r=>{console.warn("[TeamManager] ‚ùå Failed to delete team from cloud:",r)})}const Mr=[{name:"Piedra Fuego",category:"Evoluci√≥n",loc:"Senda √çgnea (Fuerza) / Parte Roja",img:"fire-stone",desc:"Evoluciona a Vulpix, Growlithe, Eevee."},{name:"Piedra Agua",category:"Evoluci√≥n",loc:"Nao Abandonada / Parte Azul",img:"water-stone",desc:"Evoluciona a Poliwhirl, Shellder, Staryu, Eevee, Lombre."},{name:"Piedra Trueno",category:"Evoluci√≥n",loc:"Malvalanova / Parte Amarilla",img:"thunder-stone",desc:"Evoluciona a Pikachu, Eevee."},{name:"Piedra Hoja",category:"Evoluci√≥n",loc:"Ruta 119 / Parte Verde",img:"leaf-stone",desc:"Evoluciona a Gloom, Weepinbell, Exeggcute, Nuzleaf."},{name:"Piedra Lunar",category:"Evoluci√≥n",loc:"Cascada Meteoro / Lunatone (5%)",img:"moon-stone",desc:"Evoluciona a Nidorina/o, Clefairy, Jigglypuff, Skitty."},{name:"Piedra Solar",category:"Evoluci√≥n",loc:"Centro Espacial / Solrock (5%)",img:"sun-stone",desc:"Evoluciona a Gloom, Sunkern."},{name:"Escama Drag√≥n",category:"Evoluci√≥n",loc:"Bagon/Horsea (5%) / Pilar Celeste",img:"dragon-scale",desc:"Evoluciona Seadra a Kingdra (Intercambio)."},{name:"Revestimiento Met√°lico",category:"Evoluci√≥n",loc:"Malvalanova / Magnemite (5%)",img:"metal-coat",desc:"Evoluciona Onix/Scyther (Intercambio). Potencia Acero."},{name:"Roca del Rey",category:"Evoluci√≥n",loc:"Ciudad Algaria (M√°ximo) / Recogida",img:"kings-rock",desc:"Evoluciona Poliwhirl/Slowpoke (Intercambio). Puede hacer retroceder."},{name:"Mejora",category:"Evoluci√≥n",loc:"Torre Batalla (Premio)",img:"up-grade",desc:"Evoluciona Porygon a Porygon2."},{name:"Diente Marino",category:"Evoluci√≥n",loc:"Ciudad Portual (Esc√°ner)",img:"deep-sea-tooth",desc:"Evoluciona Clamperl a Huntail. Dobla At. Esp de Clamperl."},{name:"Escama Marina",category:"Evoluci√≥n",loc:"Ciudad Portual (Esc√°ner)",img:"deep-sea-scale",desc:"Evoluciona Clamperl a Gorebyss. Dobla Def. Esp de Clamperl."},{name:"Restos",category:"Combate",loc:"S.S. Tidal (Basura) / Torre Batalla",img:"leftovers",desc:"Recupera 1/16 PS cada turno."},{name:"Cinta Elegida",category:"Combate",loc:"Torre Batalla (64 BP)",img:"choice-band",desc:"Sube Ataque x1.5 pero bloquea movimiento."},{name:"Banda Focus",category:"Combate",loc:"Torre Batalla (64 BP)",img:"focus-band",desc:"10% probabilidad de aguantar con 1 PS."},{name:"Periscopio",category:"Combate",loc:"Torre Batalla (64 BP)",img:"scope-lens",desc:"Aumenta √≠ndice de golpe cr√≠tico."},{name:"Hierba Blanca",category:"Combate",loc:"Torre Batalla (48 BP)",img:"white-herb",desc:"Restaura stats bajados una vez."},{name:"Hierba Mental",category:"Combate",loc:"Ciudad Arborada / Torre Batalla",img:"mental-herb",desc:"Cura atracci√≥n y mofa."},{name:"Garra R√°pida",category:"Combate",loc:"Ciudad F√©rrica (Escuela)",img:"quick-claw",desc:"20% probabilidad de atacar primero."},{name:"Campana Concha",category:"Combate",loc:"Cueva Cardumen (4 Sales/Conchas)",img:"shell-bell",desc:"Cura 1/8 del da√±o infligido."},{name:"Polvo Brillo",category:"Combate",loc:"Torre Batalla (64 BP)",img:"bright-powder",desc:"Baja la precisi√≥n del rival."},{name:"Lodo Negro",category:"Combate",loc:"Grimer/Muk (5%)",img:"black-sludge",desc:"Cura a Veneno, da√±a a otros."},{name:"Cintur√≥n Negro",category:"Combate",loc:"Ruta 115",img:"black-belt",desc:"Potencia tipo Lucha (+10%)."},{name:"Gafas de Sol",category:"Combate",loc:"Ruta 116",img:"black-glasses",desc:"Potencia tipo Siniestro (+10%)."},{name:"Carb√≥n",category:"Combate",loc:"Lavacalda (Herborister√≠a)",img:"charcoal",desc:"Potencia tipo Fuego (+10%)."},{name:"Colmillo Drag√≥n",category:"Combate",loc:"Cascada Meteoro (Drac√≥nida)",img:"dragon-fang",desc:"Potencia tipo Drag√≥n (+10%)."},{name:"Piedra Dura",category:"Combate",loc:"Casa Treta / Nao Abandonada",img:"hard-stone",desc:"Potencia tipo Roca (+10%)."},{name:"Im√°n",category:"Combate",loc:"Malvalanova",img:"magnet",desc:"Potencia tipo El√©ctrico (+10%)."},{name:"Semilla Milagro",category:"Combate",loc:"Ruta 104 (Bosque Petalia)",img:"miracle-seed",desc:"Potencia tipo Planta (+10%)."},{name:"Agua M√≠stica",category:"Combate",loc:"Forma Castform (Instituto Meteorol√≥gico)",img:"mystic-water",desc:"Potencia tipo Agua (+10%)."},{name:"Antiderretir",category:"Combate",loc:"Cueva Cardumen",img:"never-melt-ice",desc:"Potencia tipo Hielo (+10%)."},{name:"Flecha Venenosa",category:"Combate",loc:"Roselia/Cacnea salvaje (5%)",img:"poison-barb",desc:"Potencia tipo Veneno (+10%)."},{name:"Pico Afilado",category:"Combate",loc:"Ruta 124 / Doduo salvaje",img:"sharp-beak",desc:"Potencia tipo Volador (+10%)."},{name:"Pa√±uelo Seda",category:"Combate",loc:"Pueblo Azuliza",img:"silk-scarf",desc:"Potencia tipo Normal (+10%)."},{name:"Polvo Plata",category:"Combate",loc:"Ruta 120 / Masquerain salvaje",img:"silver-powder",desc:"Potencia tipo Bicho (+10%)."},{name:"Arena Fina",category:"Combate",loc:"Ruta 109 / Trapinch salvaje",img:"soft-sand",desc:"Potencia tipo Tierra (+10%)."},{name:"Hechizo",category:"Combate",loc:"Monte P√≠rico / Shuppet salvaje",img:"spell-tag",desc:"Potencia tipo Fantasma (+10%)."},{name:"Cuchara Torcida",category:"Combate",loc:"Abra salvaje (5%)",img:"twisted-spoon",desc:"Potencia tipo Ps√≠quico (+10%)."},{name:"Repartir Exp",category:"Utilidad",loc:"Ciudad F√©rrica (Sr. Pe√±as)",img:"exp-share",desc:"Comparte experiencia con el equipo."},{name:"Moneda Amuleto",category:"Utilidad",loc:"Vila Raiz (Tras 5¬™ medalla)",img:"amulet-coin",desc:"Doble dinero si participa en combate."},{name:"Huevo Suerte",category:"Utilidad",loc:"Raro (Chansey Salvaje)",img:"lucky-egg",desc:"Gana +50% experiencia."},{name:"Piedra Eterna",category:"Utilidad",loc:"Cueva Granito / Geodude (5%)",img:"everstone",desc:"Impide evoluci√≥n / Hereda naturaleza."},{name:"Campana Alivio",category:"Utilidad",loc:"Club Fans (Portual)",img:"soothe-bell",desc:"Aumenta ganancia de amistad."},{name:"Bola de Humo",category:"Utilidad",loc:"Casa Treta / Koffing (5%)",img:"smoke-ball",desc:"Huida garantizada de salvajes."},{name:"Amuleto",category:"Utilidad",loc:"Monte P√≠rico",img:"cleanse-tag",desc:"Reduce encuentros salvajes (1er slot)."},{name:"Vestidura",category:"Utilidad",loc:"Ruta 111 (Familia Estrate)",img:"macho-brace",desc:"Doble EVs ganados, mitad velocidad."},{name:"Bici Carrera",category:"Clave",loc:"Ciudad Malvalona (Rydel)",img:"mach-bike",desc:"Sube pendientes de barro."},{name:"Bici Acrob√°tica",category:"Clave",loc:"Ciudad Malvalona (Rydel)",img:"acro-bike",desc:"Salta piedras y rieles."},{name:"Ca√±a Vieja",category:"Clave",loc:"Pueblo Azuliza",img:"old-rod",desc:"Pesca Magikarp."},{name:"Ca√±a Buena",category:"Clave",loc:"Ruta 118",img:"good-rod",desc:"Pesca Pok√©mon de nivel medio."},{name:"Superca√±a",category:"Clave",loc:"Ciudad Algaria",img:"super-rod",desc:"Pesca Pok√©mon fuertes."},{name:"Buscaobjetos",category:"Clave",loc:"Ruta 110",img:"itemfinder",desc:"Detecta objetos invisibles."},{name:"Gafas Aislantes",category:"Clave",loc:"Lavacalda (Rival)",img:"go-goggles",desc:"Permite cruzar el desierto."},{name:"Saco Holl√≠n",category:"Clave",loc:"Ruta 113",img:"soot-sack",desc:"Recoge ceniza para flautas/objetos."},{name:"Baya Zidra",category:"Baya",loc:"Rutas / Recogida",img:"sitrus-berry",desc:"Recupera 30 PS."},{name:"Baya Ziuela",category:"Baya",loc:"Rutas / Recogida",img:"lum-berry",desc:"Cura cualquier estado."},{name:"Baya Atania",category:"Baya",loc:"Rutas",img:"chesto-berry",desc:"Despierta al Pok√©mon."},{name:"Baya Caquic",category:"Baya",loc:"Rutas",img:"leppa-berry",desc:"Restaura 10 PP."},{name:"Baya Lichi",category:"Baya",loc:"Isla Espejismo",img:"liechi-berry",desc:"Sube Ataque con PS bajos."},{name:"Baya Gonlan",category:"Baya",loc:"Coliseo / XD",img:"ganlon-berry",desc:"Sube Defensa con PS bajos."},{name:"Baya Aslac",category:"Baya",loc:"Coliseo / XD",img:"salac-berry",desc:"Sube Velocidad con PS bajos."},{name:"Baya Petasi",category:"Baya",loc:"Coliseo / XD",img:"petaya-berry",desc:"Sube At. Esp con PS bajos."},{name:"Baya Yapati",category:"Baya",loc:"Coliseo / XD",img:"apicot-berry",desc:"Sube Def. Esp con PS bajos."},{name:"Pa√±uelo Rojo",category:"Concurso",loc:"Portual (Max Carisma)",img:"red-scarf",desc:"Mejora Carisma en Concursos."},{name:"Pa√±uelo Azul",category:"Concurso",loc:"Portual (Max Belleza)",img:"blue-scarf",desc:"Mejora Belleza en Concursos."},{name:"Pa√±uelo Rosa",category:"Concurso",loc:"Portual (Max Dulzura)",img:"pink-scarf",desc:"Mejora Dulzura en Concursos."},{name:"Pa√±uelo Verde",category:"Concurso",loc:"Portual (Max Ingenio)",img:"green-scarf",desc:"Mejora Ingenio en Concursos."},{name:"Pa√±uelo Amarillo",category:"Concurso",loc:"Portual (Max Dureza)",img:"yellow-scarf",desc:"Mejora Dureza en Concursos."}],Bs=[{name:"Hura√±a (Lonely)",up:"Atk",down:"Def"},{name:"Audaz (Brave)",up:"Atk",down:"Spe"},{name:"Firme (Adamant)",up:"Atk",down:"SpA"},{name:"P√≠cara (Naughty)",up:"Atk",down:"SpD"},{name:"Osada (Bold)",up:"Def",down:"Atk"},{name:"Pl√°cida (Relaxed)",up:"Def",down:"Spe"},{name:"Agitada (Impish)",up:"Def",down:"SpA"},{name:"Floja (Lax)",up:"Def",down:"SpD"},{name:"Miedosa (Timid)",up:"Spe",down:"Atk"},{name:"Activa (Hasty)",up:"Spe",down:"Def"},{name:"Alegre (Jolly)",up:"Spe",down:"SpA"},{name:"Ingenua (Naive)",up:"Spe",down:"SpD"},{name:"Modesta (Modest)",up:"SpA",down:"Atk"},{name:"Afable (Mild)",up:"SpA",down:"Def"},{name:"Mansa (Quiet)",up:"SpA",down:"Spe"},{name:"Alocada (Rash)",up:"SpA",down:"SpD"},{name:"Serena (Calm)",up:"SpD",down:"Atk"},{name:"Amable (Gentle)",up:"SpD",down:"Def"},{name:"Grosera (Sassy)",up:"SpD",down:"Spe"},{name:"Cauta (Careful)",up:"SpD",down:"SpA"},{name:"Fuerte (Hardy)",up:"---",down:"---"},{name:"D√≥cil (Docile)",up:"---",down:"---"},{name:"Seria (Serious)",up:"---",down:"---"},{name:"T√≠mida (Bashful)",up:"---",down:"---"},{name:"Rara (Quirky)",up:"---",down:"---"}],xb=Bs.map(n=>({name:n.name.split(" (")[0],name:n.name,plus:n.up==="---"?"-":n.up,minus:n.down==="---"?"-":n.down}));let xr=[],An=[],_r=!1,ka="";const pu={emerald:386,platinum:493},rn=n=>n?n.charAt(0).toUpperCase()+n.slice(1):"";function Vb(n){const e=n.target,t=e.closest(".slot-remove-btn");t&&t.closest(".team-slot");const r=e.closest(".team-tab");if(r){console.log("Tab Clicked:",r);let a=r.dataset.id;if(!isNaN(a)&&!a.includes("-")&&!a.includes("_")){const i=parseInt(a);String(i)===a&&(a=i)}else{const i=Number(a);isNaN(i)||(a=i)}console.log("Switching to team ID:",a),jn(a),Vt();return}if(e.closest("#btn-new-team")){Ui("create");return}if(e.closest("#btn-rename-team")){const a=Le();Ui("rename",a.name);return}if(e.closest("#btn-delete-team")){zs("team");return}if(e.matches(".btn-retry")){_r=!1,lm();return}}function sm(){const n=document.querySelector(".builder-container");if(!n)return;console.log("Hydrating Team Builder Events..."),n.onclick=Vb;const e=document.getElementById("builder-search");e&&(e.oninput=t=>{Bb(t.target.value)}),Lb()}function Lb(){const n=document.getElementById("pokemon-source-list"),e=document.querySelector(".team-slots-container");n&&n.addEventListener("dragstart",t=>{const r=t.target.closest(".source-pokemon-card");if(!r)return;const a=r.dataset.id;console.log("Drag Start Source:",a),t.dataTransfer.setData("text/plain",JSON.stringify({type:"new",id:a})),t.dataTransfer.effectAllowed="copyMove"}),e&&(e.addEventListener("dragstart",t=>{const r=t.target.closest(".team-slot");if(!r||!r.classList.contains("filled"))return;const a=r.dataset.index;console.log("Drag Start Team:",a),t.dataTransfer.setData("text/plain",JSON.stringify({type:"move",index:a})),t.dataTransfer.effectAllowed="copyMove"}),e.addEventListener("dragover",t=>{t.preventDefault(),t.dataTransfer.dropEffect="copy";const r=t.target.closest(".team-slot");r&&r.classList.add("drag-over")}),e.addEventListener("dragleave",t=>{const r=t.target.closest(".team-slot");r&&r.classList.remove("drag-over")}),e.addEventListener("drop",async t=>{t.preventDefault();const r=t.target.closest(".team-slot");if(!r)return;r.classList.remove("drag-over");const a=parseInt(r.dataset.index),i=t.dataTransfer.getData("text/plain");if(i)try{const s=JSON.parse(i);s.type==="new"?await zb(s.id,a):s.type==="move"&&dm(s.index,a)}catch(s){console.error("Drop Error:",s)}}))}function Nb(){return xr.length===0&&setTimeout(lm,0),Fb()}function Vt(){const n=document.querySelector(".builder-container");n&&(n.innerHTML=cm(),sm(),um())}function Fb(){return`
        <div class="builder-container" style="display: block; opacity: 1; visibility: visible; min-height: 500px;">
           ${cm()}
        </div>
    `}function cm(){const n=Le(),e=Ft();return`
    <div class="builder-header" style="flex-direction: column; gap:1.5rem; align-items: flex-start;">
        <div style="display:flex; justify-content:space-between; align-items:center; width:100%;">
             <h2 style="margin:0; font-size:1.5rem; background: linear-gradient(to right, #4ade80, #3b82f6); -webkit-background-clip: text; color: transparent;">Constructor de Equipos</h2>
             <div class="team-summary" style="font-size:0.9rem; color:var(--text-muted); background:rgba(255,255,255,0.05); padding:0.3rem 0.8rem; border-radius:100px;">
                ${n.slots.filter(t=>t).length}/6 Pok√©mon
            </div>
        </div>

        <div class="team-selector-wrapper-fix">
            <div class="team-tabs-container-fix">
                ${e.map(t=>`
                    <div class="team-tab ${t.id===n.id?"active":""}" data-id="${t.id}">
                        <span class="tab-name">${t.name}</span>
                        ${t.id===n.id?'<span class="tab-indicator"></span>':""}
                    </div>
                `).join("")}
                <button id="btn-new-team" class="new-team-tab" title="Nuevo Equipo">+</button>
            </div>
            
            <div class="team-actions-fix">
                 <button id="btn-rename-team" class="action-btn-icon" title="Renombrar Equipo">‚úèÔ∏è</button>
                 <button id="btn-delete-team" class="action-btn-icon danger" title="Borrar Equipo">üóëÔ∏è</button>
            </div>
        </div>
    </div>

    <!-- Custom Confirmation Modal -->
    <div id="confirm-modal-overlay" class="modal-overlay hidden" style="z-index: 10000;">
        <div class="confirm-modal">
            <div class="confirm-modal-icon">‚ö†Ô∏è</div>
            <h3>¬øEst√°s seguro?</h3>
            <p id="confirm-modal-text">¬øQuieres eliminar este Pok√©mon del equipo?</p>
            <div class="confirm-actions">
                <button class="btn-cancel" onclick="closeConfirmationModal()">Cancelar</button>
                <button class="btn-confirm-delete" onclick="confirmDelete()">Eliminar</button>
            </div>
        </div>
    </div>

    <!-- Custom Prompt Modal -->
    <div id="prompt-modal-overlay" class="modal-overlay hidden" style="z-index: 10000;">
        <div class="confirm-modal">
            <h3 id="prompt-modal-title">T√≠tulo</h3>
            <div style="width:100%; display:flex; justify-content:center;">
                <input type="text" id="prompt-modal-input" class="prompt-input" placeholder="Nombre..." onkeydown="handlePromptKeydown(event)">
            </div>
            <div class="confirm-actions">
                <button class="btn-cancel" onclick="closePromptModal()">Cancelar</button>
                <button class="btn-confirm-delete" onclick="confirmPrompt()" id="btn-confirm-prompt">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal Placeholder -->
    <div id="edit-modal-overlay" class="modal-overlay hidden">
        <div class="edit-modal">
            <!-- Content injected via JS -->
        </div>
    </div>

    <div class="builder-workspace">
        <div class="team-slots-container">
            ${n.slots.map((t,r)=>Ob(t,r)).join("")}
        </div>

        <div class="pokemon-source-panel" style="margin-top: 1.1rem;">
            <div class="search-box-container-fix">
                    <input type="text" id="builder-search" class="search-input-fix" placeholder="Buscar por nombre...">
            </div>
            <div id="pokemon-source-list" class="pokemon-source-list">
                ${xr.length===0?'<div class="loading-spinner">Cargando Pok√©mon...</div>':""}
            </div>
        </div>
    </div>
    `}function Ob(n,e){if(!n)return`
            <div class="team-slot empty" data-index="${e}">
                <div class="slot-empty-content">
                    <span class="slot-number">${e+1}</span>
                    <span class="plus-icon">+</span>
                    <span class="drag-hint">A√±adir</span>
                </div>
            </div>
        `;const t=n.nature?n.nature.name.split("(")[0].trim():"-",r=n.item?n.item.name:"-",a=n.types.map(s=>{const l=s.english?s.english.toLowerCase():(s.spanish||"").toLowerCase(),d=Ln[l]||s.spanish||s.english||"???";return`<span class="type-badge-modern type-${l}" title="${d}">
            ${d.substring(0,3).toUpperCase()}
         </span>`}).join(""),i=n.moves?n.moves.map(s=>{if(!s)return"";const l=s.type?`type-${s.type.toLowerCase()}`:"",d=s.displayName||s.name||"???",h=s.typeTranslated||s.type||"???",m=s.power||"-",g=s.accuracy||"-",E=s.damageClassTranslated||s.damageClass||"-",S=s.description||"";return`<div class="move-wrapper">
            <div class="move-pill ${l}">
                <span class="move-type-label">${h.substring(0,3).toUpperCase()}</span>
                <span class="move-name-text">${d}</span>
            </div>
            <div class="move-tooltip">
                <div class="tooltip-header">
                    <span class="tooltip-name">${d}</span>
                    <span class="tooltip-type type-pill ${l}">${h}</span>
                </div>
                <div class="tooltip-category">${E} ¬∑ Pot: ${m} ¬∑ Pre: ${g}%</div>
                <p class="tooltip-desc">${S||"Sin descripci√≥n disponible."}</p>
            </div>
        </div>`}).filter(s=>s).join(""):'<span class="no-moves">Sin ataques</span>';return`
        <div class="team-slot filled slot-card-premium" draggable="true" data-index="${e}" onclick="handleSlotClick(event, ${n.id})">
            <button class="slot-remove-btn" type="button" title="Eliminar" style="z-index: 10;" onclick="event.stopPropagation(); window.openConfirmationModal('pokemon', ${e})">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <button class="slot-edit-btn-ghost" type="button" title="Editar" style="z-index: 10;" onclick="event.stopPropagation(); window.openEditModal(${e})">‚úèÔ∏è</button>
            
            <div class="slot-premium-content">
                <!-- Background Gradient/Effect derived from primary type? -->
                <div class="slot-bg-effect"></div>

                <div class="slot-visual-container">
                    <img src="${n.sprite}" alt="${n.name}" class="slot-sprite-premium" draggable="false">
                </div>

                <div class="slot-info-premium">
                    <div class="slot-header-premium">
                        <span class="slot-name-premium">${n.nickname||n.name}</span>
                        <div class="slot-types-premium">${a}</div>
                    </div>

                    <div class="slot-stats-row">
                        <div class="stat-pill" title="Naturaleza">
                            <span class="stat-icon">üß¨</span>
                            <span class="stat-val">${t}</span>
                        </div>
                        <div class="stat-pill" title="Objeto">
                            <span class="stat-icon">üéí</span>
                            <span class="stat-val">${r}</span>
                        </div>
                    </div>
                    
                    <div class="slot-moves-row">
                        ${i}
                    </div>
                </div>
            </div>
        </div>
    `}function gu(){document.getElementById("edit-modal-overlay").classList.add("hidden")}async function lm(){if(xr.length>0){qi();return}if(!_r){_r=!0;try{xr=(await(await fetch("https://pokeapi.co/api/v2/pokemon?limit=493")).json()).results.map((t,r)=>({id:r+1,name:t.name,url:t.url,sprite:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${r+1}.png`})),qi()}catch(n){console.error("Fetch error",n)}finally{_r=!1}}}function um(){const n=document.getElementById("pokemon-source-list");if(!n)return;if(An.length===0&&!_r){n.innerHTML='<div class="no-results">No se encontraron</div>';return}const e=An.slice(0,100);n.innerHTML=e.map(t=>`
        <div class="source-pokemon-card" draggable="true" data-id="${t.id}">
            <img src="${t.sprite}" class="source-sprite" loading="lazy" draggable="false">
            <span class="source-name">${rn(t.name)}</span>
        </div>
    `).join("")+(An.length>100?'<div style="opacity:0.5; text-align:center;">...</div>':"")}function Bb(n){ka=n.toLowerCase(),qi()}function qi(){const n=ye(),e=pu[n]||pu.emerald;An=xr.filter(t=>t.id<=e),ka&&(An=An.filter(t=>t.name.includes(ka)||String(t.id).includes(ka))),um()}async function zb(n,e){try{const t=await ao(n),r=t.types.map(l=>({english:l.type.name,spanish:Ln[l.type.name]||rn(l.type.name)}));let a=[null,null,null,null];try{const l=ye(),d=await ku(n,l);if(d.length>0){const m=d.slice(-4).reverse().map(E=>oo(E.name));a=[...await Promise.all(m),null,null,null,null].slice(0,4)}}catch(l){console.warn("Auto-suggest moves failed:",l)}const i={id:t.id,name:rn(t.name),nickname:"",sprite:t.sprites.other["official-artwork"].front_default||t.sprites.front_default,types:r,nature:null,item:null,moves:a,image:t.sprites.other["official-artwork"].front_default},s=Le();s.slots[e]=i,Do(s.slots),Vt()}catch(t){console.error("Add Pokemon Error",t)}}function qb(n,e){n.target.closest(".slot-remove-btn")||n.target.closest(".slot-edit-btn")||window.openPokemonModal&&window.openPokemonModal(e)}window.handleSlotClick=qb;function Ub(n){console.log("Function removePokemon called for index:",n),zs("pokemon",n)}window.removePokemon=Ub;function dm(n,e){const t=Le();if(n===e)return;const r=t.slots[e];t.slots[e]=t.slots[n],t.slots[n]=r,Do(t.slots),Vt()}window.movePokemon=dm;function zs(n,e){Za=n,Us=e;const t=document.getElementById("confirm-modal-overlay"),r=document.getElementById("confirm-modal-text"),a=Le();if(n==="pokemon"){if(!a.slots[e])return;const i=a.slots[e].nickname||a.slots[e].name;r&&(r.textContent=`¬øQuieres eliminar a ${i} del equipo?`)}else n==="team"&&r&&(r.textContent=`¬øQuieres borrar el equipo "${a.name}"? Esta acci√≥n no se puede deshacer.`);t&&t.classList.remove("hidden")}window.openConfirmationModal=zs;function hm(){Us=null,Za=null;const n=document.getElementById("confirm-modal-overlay");n&&n.classList.add("hidden")}window.closeConfirmationModal=hm;function $b(){const n=Le();if(Za==="pokemon"){const e=Us;e!==null&&n.slots[e]&&(n.slots[e]=null,Do(n.slots),Vt())}else Za==="team"&&(Mb(n.id),Vt());hm()}window.confirmDelete=$b;let Ya=null;function Ui(n,e=""){Ya=n;const t=document.getElementById("prompt-modal-overlay"),r=document.getElementById("prompt-modal-title"),a=document.getElementById("prompt-modal-input"),i=document.getElementById("btn-confirm-prompt");n==="create"?(r.textContent="Nuevo Equipo",i.textContent="Crear"):(r.textContent="Renombrar Equipo",i.textContent="Guardar"),a.value=e,t&&t.classList.remove("hidden"),a.focus()}window.openPromptModal=Ui;function qs(){Ya=null;const n=document.getElementById("prompt-modal-overlay");n&&n.classList.add("hidden")}window.closePromptModal=qs;function mm(){const e=document.getElementById("prompt-modal-input").value.trim();if(e){if(Ya==="create"){if(!im(e))return;Vt()}else if(Ya==="rename"){const t=Le();if(!Db(t.id,e))return;Vt()}qs()}}window.confirmPrompt=mm;function jb(n){n.key==="Enter"&&mm(),n.key==="Escape"&&qs()}window.handlePromptKeydown=jb;let Mn=-1,Us=null,Za=null,Qt=[],xn=null,Et=null,eo=[];window.openEditModal=async n=>{const t=Le().slots[n];if(!t)return;Mn=n,Qt=[...t.moves],xn=t.nature,Et=t.item;let r=document.getElementById("edit-team-modal");r||(document.body.insertAdjacentHTML("beforeend",`
            <div id="edit-team-modal" class="pokemon-modal-container" style="z-index: 2000; display: none;">
                <div class="pokemon-modal-backdrop" onclick="closeEditModal()"></div>
                <div class="pokemon-modal" style="max-width: 600px;">
                    <button class="pokemon-modal-close" onclick="closeEditModal()">‚úï</button>
                    <div class="pokemon-modal-content" id="edit-modal-content">
                        <!-- Content -->
                    </div>
                </div>
            </div>
        `),r=document.getElementById("edit-team-modal"));const a=document.getElementById("edit-modal-content");a.innerHTML='<div style="text-align:center; padding:2rem;">Cargando movimientos...</div>',r.style.display="flex";const i=ye();eo=await np(t.id,i),$s(t)};window.closeEditModal=()=>{document.getElementById("edit-team-modal").classList.add("hidden"),Mn=-1};function $s(n){const e=document.getElementById("edit-modal-content"),t=Qt.map((l,d)=>{const h=l?l.displayName||rn(l.name):"Vac√≠o",m=l?l.type:"normal",g=l&&l.typeTranslated?l.typeTranslated:rn(m),E=l?`<span class="type-badge-modern type-${m}" style="font-size:0.7rem; padding: 2px 6px;">${g.substring(0,3).toUpperCase()}</span>`:"";return`
        <div class="edit-move-slot" onclick="openMoveSelector(${d})">
            <div class="edit-move-label">Movimiento ${d+1}</div>
            <div class="edit-move-card ${l?"filled":"empty"}">
                ${E}
                <span class="move-name-display" style="margin-left:8px;">${h}</span>
                ${l?`<span class="move-power-badge">${l.power||"-"}</span>`:'<span class="move-chevron">‚ñº</span>'}
            </div>
        </div>
        `}).join(""),r=Bs.map(l=>{const d=Hb(l);return`<option value="${l.name}" ${xn&&xn.name===l.name?"selected":""}>${d}</option>`}).join(""),a=Et?Et.name:"Sin Objeto",i=Et?`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/${Et.img}.png`:null,s=Et?`<img src="${i}" style="width:24px; margin-right:8px;"> <span>${a}</span>`:`<span>${a}</span>`;e.innerHTML=`
        <div class="edit-modal-header">
            <img src="${n.sprite}" class="edit-sprite">
            <div class="edit-info">
                <h3>${n.name}</h3>
                <input type="text" class="edit-nickname" value="${n.nickname}" placeholder="Apodo" onchange="updateMemberNickname(this.value)">
            </div>
        </div>

        <!-- Info Section (Nature / Item) -->
        <div class="edit-section-row">
            <div class="edit-field-group">
                <label>Naturaleza</label>
                <select class="edit-select" onchange="updateMemberNature(this.value)">
                    <option value="">Neutro</option>
                    ${r}
                </select>
            </div>
            <div class="edit-field-group">
                <label>Objeto</label>
                <div class="edit-item-trigger" onclick="openItemSelector()">
                    ${s}
                    <span class="move-chevron">‚ñº</span>
                </div>
            </div>
        </div>

        <div class="edit-section">
            <h4>Movimientos</h4>
            <div class="edit-moves-grid">
                ${t}
            </div>
        </div>
        
        <div class="edit-actions">
           <button class="save-btn" onclick="saveEditChanges(); document.getElementById('edit-team-modal').style.display='none';" style="font-family: inherit;">Guardar Cambios</button>
        </div>
    `}window.updateMemberNature=n=>{if(!n){xn=null;return}xn=Bs.find(t=>t.name===n)};window.openItemSelector=()=>{const n=document.getElementById("item-selector-overlay");n&&n.remove();const e=document.createElement("div");e.id="item-selector-overlay",e.className="move-selector-overlay",e.innerHTML=`
        <div class="move-selector-modal">
            <div class="move-search-header">
                <input type="text" id="item-search-input" placeholder="Buscar objeto..." autofocus>
                <button onclick="document.getElementById('item-selector-overlay').remove()" class="close-overlay-btn">‚úï</button>
            </div>
            <div class="move-list-container" id="item-list-container">
                <!-- Items injected here -->
            </div>
        </div>
    `,document.body.appendChild(e);const t=document.getElementById("item-search-input"),r=document.getElementById("item-list-container");fu(Mr,r),t.addEventListener("input",a=>{const i=a.target.value.toLowerCase(),s=Mr.filter(l=>l.name.toLowerCase().includes(i));fu(s,r)}),t.focus()};function fu(n,e){if(n.length===0){e.innerHTML='<div class="no-moves">No se encontraron objetos.</div>';return}e.innerHTML=n.map(t=>{const r=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/${t.img}.png`;return`
        <div class="move-option-item" style="border-left-color: #ffd700;" onclick="selectItem('${t.name}')">
            <div class="move-opt-header" style="align-items: center; justify-content: flex-start; gap: 10px;">
                <img src="${r}" style="width: 30px; height: 30px; object-fit: contain;" onerror="this.style.display='none'">
                <span class="move-opt-name">${t.name}</span>
                <span class="move-opt-power" style="font-size:0.7rem; opacity:0.8; margin-left: auto;">${t.category}</span>
            </div>
            <div class="move-opt-details">
                <span class="move-opt-acc" style="width:100%">${t.desc}</span>
            </div>
        </div>
        `}).join("")}window.selectItem=n=>{const e=Mr.find(t=>t.name===n);if(e){Et=e;const t=Le().slots[Mn];$s({...t,nickname:document.querySelector(".edit-nickname").value})}document.getElementById("item-selector-overlay").remove()};window.openMoveSelector=n=>{const e=document.getElementById("move-selector-overlay");e&&e.remove();const t=document.createElement("div");t.id="move-selector-overlay",t.className="move-selector-overlay",t.innerHTML=`
        <div class="move-selector-modal">
            <div class="move-search-header">
                <input type="text" id="move-search-input" placeholder="Buscar movimiento..." autofocus>
                <button onclick="document.getElementById('move-selector-overlay').remove()" class="close-overlay-btn">‚úï</button>
            </div>
            <div class="move-list-container" id="move-list-container">
                <!-- Moves injected here -->
            </div>
        </div>
    `,document.body.appendChild(t);const r=document.getElementById("move-search-input"),a=document.getElementById("move-list-container");yu(eo,a,n),r.addEventListener("input",i=>{const s=i.target.value.toLowerCase(),l=eo.filter(d=>d.name.includes(s)||d.displayName.toLowerCase().includes(s));yu(l,a,n)}),r.focus()};function yu(n,e,t){if(n.length===0){e.innerHTML='<div class="no-moves">No se encontraron movimientos.</div>';return}e.innerHTML=n.map(r=>`
        <div class="move-option-item type-${r.type}" onclick="selectMoveForSlot(${t}, '${r.name}')">
            <div class="move-opt-header">
                <span class="move-opt-name">${r.displayName||rn(r.name)}</span>
                <span class="move-opt-power">Pot: ${r.power||"-"}</span>
            </div>
            <div class="move-opt-details">
                <span class="type-badge-modern type-${r.type}" style="font-size:0.7rem; padding: 2px 6px; margin-right: 0.5rem;">${(r.typeTranslated||rn(r.type)).substring(0,3).toUpperCase()}</span>
                <img src="https://play.pokemonshowdown.com/sprites/categories/${r.damageClassTranslated==="F√≠sico"?"Physical":r.damageClassTranslated==="Especial"?"Special":"Status"}.png" alt="${r.damageClassTranslated}" title="${r.damageClassTranslated}" style="width: 32px; height: 14px; object-fit: contain;">
                <span class="move-opt-acc" style="margin-left:auto">Pre: ${r.accuracy||"-"}%</span>
            </div>
        </div>
    `).join("")}window.selectMoveForSlot=(n,e)=>{const t=Qt.some(i=>i&&i.name===e),r=Qt[n]&&Qt[n].name===e;if(t&&!r){alert("¬°Este movimiento ya est√° seleccionado!");return}const a=eo.find(i=>i.name===e);if(a){Qt[n]=a;const i=Le().slots[Mn];$s({...i,nickname:document.querySelector(".edit-nickname").value})}document.getElementById("move-selector-overlay").remove()};function Hb(n){if(n.up==="---")return n.name.split(" (")[0];const e={Atk:"Ataque",Def:"Defensa",SpA:"At. Esp",SpD:"Def. Esp",Spe:"Velocidad"};return`${n.name.split(" (")[0]} (+${e[n.up]} / -${e[n.down]})`}window.updateMemberNickname=n=>{};window.saveEditChanges=()=>{try{const n=Le(),e=n.slots[Mn];if(!e){console.error("No member found at index",Mn),gu();return}const t=document.querySelector(".edit-nickname");t&&(e.nickname=t.value),e.moves=Qt,e.nature=xn,e.item=Et,Do(n.slots),Vt()}catch(n){console.error("Error saving changes:",n)}gu()};window.closeEditModal=()=>{const n=document.getElementById("edit-team-modal");n&&(n.style.display="none")};function pm(){return ye()===Re.PLATINUM?{teams:Xm,categories:Jm}:{teams:Qm,categories:Km}}function gm(){return localStorage.getItem("selectedTeamId")||"competitive"}function fm(n){localStorage.setItem("selectedTeamId",n)}function Gb(){return localStorage.getItem("selectedCategoryId")||"difficulty"}function Wb(n){localStorage.setItem("selectedCategoryId",n)}let Vn=!1;function Kb(){if(Vn)try{return Nb()}catch(s){return console.error("Error rendering TeamBuilder:",s),`<div class="error-banner">Error cargando el constructor de equipos: ${s.message}</div>`}const{teams:n,categories:e}=pm(),t=Gb(),r=gm();let a=n[r];if(!a){const s=Object.keys(n)[0];a=n[s],fm(s)}const i=Object.values(n).filter(s=>s.category===t);return`
    <div class="team-selector-container">
      <h2 style="margin-bottom: 1.5rem; text-align: center;">üéÆ Elige tu Estilo de Juego</h2>
      
      <!-- Category Tabs -->
      <div class="category-tabs">
        ${e.map(s=>`
          <button 
            class="category-tab ${s.id===t?"active":""}"
            data-category-id="${s.id}"
            onclick="handleCategoryChange('${s.id}')"
          >
            ${s.icon} ${s.name}
          </button>
        `).join("")}
      </div>

      <!-- Team Selection Pills -->
      <div class="team-pills-container">
        ${i.map(s=>`
          <button
            class="team-pill ${s.id===r?"active":""}"
            data-team-id="${s.id}"
            onclick="handleTeamChange('${s.id}')"
            title="${s.description}"
          >
            ${s.name}
          </button>
        `).join("")}
      </div>

      <!-- Team Description -->
      <div class="team-description">
        <p>${a.description}</p>
      </div>
    </div>
  `}function Qb(n){return`
    <div class="team-grid">
      ${n.pokemon.map(e=>`
        <div class="pokemon-card clickable" onclick="openPokemonModal(${e.id})" title="Haz clic para ver detalles">
          <div class="card-header">
            <span class="poke-name">${e.name}</span>
            <div class="poke-types">
              ${e.types.map(t=>`<span class="type-${t.toLowerCase()}">${Da(t)}</span>`).join("")}
            </div>
          </div>
          <div class="poke-img-container">
            <img src="${e.image}" alt="${e.name}" class="poke-img">
          </div>
          <div class="poke-details">
            <div class="detail-row">
              <span class="detail-label">Rol</span>
              <span>${e.role}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Objeto</span>
              <span>${e.item}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Naturaleza</span>
              <span>${e.nature}</span>
            </div>
          </div>
          <div class="moves-list">
            ${e.moves.filter(t=>t).map(t=>{const r=Tu[t.name]||{type:t.type,category:t.category,desc:"Movimiento desconocido",power:null,accuracy:100},a=Pu(r.category),i=r.power?`Potencia: ${r.power}`:"Sin potencia",s=r.accuracy?`Precisi√≥n: ${r.accuracy}%`:"Precisi√≥n: 100%";return`
                <div class="move-wrapper">
                  <div class="move-tag">
                    <span class="move-type-indicator type-${r.type.toLowerCase()}">${r.type.substring(0,3).toUpperCase()}</span>
                    <span style="font-weight:bold; flex:1;">${t.name}</span>
                  </div>
                  <div class="move-tooltip">
                    <div class="tooltip-header">
                      <span class="tooltip-name">${t.name}</span>
                      <span class="tooltip-type type-pill type-${r.type.toLowerCase()}">${r.type}</span>
                    </div>
                    <div class="tooltip-category">${a} ${r.category} ¬∑ ${i} ¬∑ ${s}</div>
                    <p class="tooltip-desc">${r.desc}</p>
                  </div>
                </div>
              `}).join("")}
          </div>
          <div style="margin-top:1rem; font-size:0.85rem; color:var(--text-secondary); text-align:center;">
             üìç ${e.location}
          </div>
        </div>
      `).join("")}
    </div>
  `}function Jb(){return`
      <div class="team-mode-toggle" style="display: flex; justify-content: center; margin-bottom: 2rem; gap: 1rem;">
          <button class="nav-btn ${Vn?"":"active"}" onclick="window.setSafeBuilderMode(false)">
            üìã Recomendados
          </button>
          <button class="nav-btn ${Vn?"active":""}" onclick="window.setSafeBuilderMode(true)">
            üõ†Ô∏è Crear Equipo
          </button>
      </div>
    `}function br(){const n=document.getElementById("team");if(!n)return;const{teams:e}=pm(),t=gm(),r=e[t];n.innerHTML=`
    ${Jb()}
    ${Kb()}
    <div style="margin-top: 2rem;">
      ${Vn?"":Qb(r)}
    </div>
  `,Xb(),Vn&&setTimeout(()=>sm(),0)}function Xb(){window.handleCategoryChange=function(n){Wb(n),br()},window.handleTeamChange=function(n){fm(n),br()},window.setSafeBuilderMode=function(n){Vn=n,br()}}function vu(){const n=document.getElementById("reference");if(!n)return;n.innerHTML=`
    <h2>Referencia de Mec√°nicas</h2>
    
    <div class="calculator-container" style="max-width:1200px;">
      
      <!-- Search -->
      <div style="max-width:600px; margin:0 auto 2rem auto; position:relative;">
        <input type="text" id="ref-search" class="search-input" placeholder="Buscar naturaleza..." style="padding-left: 3.5rem; height:3.5rem; font-size:1.2rem;">
        <span style="position:absolute; left:1.2rem; top:50%; transform:translateY(-50%); font-size:1.4rem; opacity:0.5;">üîç</span>
      </div>

      <!-- Natures Grid -->
      <div class="emulator-box" style="margin-bottom:2rem;">
        <h3 style="margin-bottom:1.5rem;">Naturalezas</h3>
        <div id="natures-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 1rem;">
          <!-- JS Populated -->
        </div>
      </div>

      <!-- Catch Rate Info -->
      <div class="guide-card">
        <h3 style="margin-bottom:1.5rem;">Ratios de Captura (F√≥rmula Simplificada)</h3>
        
        <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:1.5rem;">
           <div style="background:rgba(255,255,255,0.03); padding:1rem; border-radius:12px; border:1px solid var(--glass-border);">
              <h4 style="color:var(--ray-red); margin-bottom:0.5rem; font-size:1.1rem;">‚ù§Ô∏è 1. Vida (HP)</h4>
              <p style="font-size:0.9rem; color:var(--text-muted); line-height:1.5;">Bajar la vida es lo m√°s efectivo. En rojo (1 HP), el ratio de captura se multiplica hasta por <strong>x3</strong>.</p>
           </div>
           
           <div style="background:rgba(255,255,255,0.03); padding:1rem; border-radius:12px; border:1px solid var(--glass-border);">
              <h4 style="color:var(--ray-yellow); margin-bottom:0.5rem; font-size:1.1rem;">üí§ 2. Estados</h4>
              <p style="font-size:0.9rem; color:var(--text-muted); line-height:1.5;">
                <strong style="color:var(--text-main)">Dormir / Congelar:</strong> x2 (Lo mejor)<br>
                <strong style="color:var(--text-main)">Par√°lisis / Veneno / Quemado:</strong> x1.5
              </p>
           </div>
           
           <div style="background:rgba(255,255,255,0.03); padding:1rem; border-radius:12px; border:1px solid var(--glass-border);">
              <h4 style="color:var(--primary-color); margin-bottom:0.5rem; font-size:1.1rem;">üèê 3. Pok√©ball</h4>
              <p style="font-size:0.9rem; color:var(--text-muted); line-height:1.5;">
                <strong style="color:var(--text-main)">Ultra Ball:</strong> x2<br>
                <strong style="color:var(--text-main)">Malla Ball / Buceo Ball:</strong> x3 (En condiciones espec√≠ficas)<br>
                <strong style="color:var(--text-main)">Turno Ball:</strong> x4 (Tras turno 30)
              </p>
           </div>
        </div>

        <div style="margin-top:1.5rem; background:rgba(var(--primary-rgb),0.1); padding:1rem; border-radius:12px; border-left:3px solid var(--primary-color);">
            <p style="font-size:0.95rem; color:var(--text-main); margin:0;">
                <span style="font-size:1.2rem; margin-right:0.5rem;">üí°</span>
                <strong>Pro Tip:</strong> Usa a <strong>Breloom</strong> con <em>Espora</em> (100% Sue√±o) y <em>Falsotortazo</em> (Deja a 1 HP) para garantizar capturas.
            </p>
        </div>
      </div>
    </div>
  `;const e=document.getElementById("natures-grid"),t=document.getElementById("ref-search");function r(a=""){const i=a.toLowerCase(),s=xb.filter(l=>l.name.toLowerCase().includes(i));if(s.length===0){e.innerHTML='<p style="grid-column: 1/-1; text-align: center; color: var(--text-muted);">No se encontraron naturalezas.</p>';return}e.innerHTML=s.map(l=>{const d=l.plus==="-"&&l.minus==="-";return`
            <div class="interactive-card" style="
                background: rgba(255, 255, 255, 0.03);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 16px;
                padding: 1.25rem 1rem;
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
                cursor: default;
            ">
               
               <h4 style="font-size: 1.1rem; margin-bottom: 0.75rem; color: ${d?"var(--text-muted)":"var(--text-main)"}; font-weight:700;">${l.name}</h4>
               
               ${d?'<span style="color: var(--text-muted); font-size: 0.85rem; padding: 0.25rem 0.75rem; background:rgba(255,255,255,0.05); border-radius:100px;">Neutra</span>':`
                   <div style="width:100%; display:flex; flex-direction:column; gap:0.4rem; font-size:0.85rem;">
                     <div style="color: var(--primary-glow); display:flex; justify-content:space-between; width:100%;">
                        <span>‚ñ≤ Sube</span> <strong>${l.plus}</strong>
                     </div>
                     <div style="color: var(--ray-red); display:flex; justify-content:space-between; width:100%;">
                        <span>‚ñº Baja</span> <strong>${l.minus}</strong>
                     </div>
                   </div>
                 `}
            </div>
        `}).join("")}r(),t.addEventListener("input",a=>{r(a.target.value)})}const Yb=[{name:"MO01 Corte",location:"Ciudad F√©rrica (Casa del Cortador)"},{name:"MO02 Vuelo",location:"Ruta 119 (Tras vencer al Rival)"},{name:"MO03 Surf",location:"Gimnasio de Petalia (Tras vencer a Norman)"},{name:"MO04 Fuerza",location:"T√∫nel Verdegal (Tras romper las rocas)"},{name:"MO05 Destello",location:"Cueva Granito (Monta√±ero en la entrada)"},{name:"MO06 Golpe Roca",location:"Ciudad Malvalona (Casa al sureste)"},{name:"MO07 Cascada",location:"Gimnasio de Arrec√≠polis (Tras el evento del despertar)"},{name:"MO08 Buceo",location:"Ciudad Algaria (Casa de M√°ximo)"}],Zb=[{name:"MT26 Terremoto",location:"Caverna Abisal (Cueva) / Recogida (Nivel 91+)"},{name:"MT13 Rayo Hielo",location:"Nao Abandonada / Casino de Malvalona (4000 fichas)"},{name:"MT24 Rayo",location:"Ciudad Malvalona (Misi√≥n de Erico) / Casino"},{name:"MT35 Lanzallamas",location:"Casino de Malvalona (4000 fichas)"},{name:"MT30 Bola Sombra",location:"Monte P√≠rico"},{name:"MT06 T√≥xico",location:"Senda √çgnea"},{name:"MT02 Garra Drag√≥n",location:"Cascada Meteoro (Requiere Surf/Cascada)"},{name:"MT31 Demolici√≥n",location:"Ciudad Arrec√≠polis / Nao Abandonada"},{name:"MT40 Golpe A√©reo",location:"Gimnasio de Arborada (Premio)"}],Eu=["Treecko","Grovyle","Sceptile","Torchic","Combusken","Blaziken","Mudkip","Marshtomp","Swampert","Poochyena","Mightyena","Zigzagoon","Linoone","Wurmple","Silcoon","Beautifly","Cascoon","Dustox","Lotad","Lombre","Ludicolo","Seedot","Nuzleaf","Shiftry","Nincada","Ninjask","Shedinja","Taillow","Swellow","Shroomish","Breloom","Spinda","Wingull","Pelipper","Surskit","Masquerain","Wailmer","Wailord","Skitty","Delcatty","Kecleon","Baltoy","Claydol","Nosepass","Torkoal","Sableye","Barboach","Whiscash","Luvdisc","Corphish","Crawdaunt","Feebas","Milotic","Carvanha","Sharpedo","Trapinch","Vibrava","Flygon","Makuhita","Hariyama","Electrike","Manectric","Numel","Camerupt","Spheal","Sealeo","Walrein","Cacnea","Cacturne","Snorunt","Glalie","Lunatone","Solrock","Azurill","Spoink","Grumpig","Plusle","Minun","Mawile","Meditite","Medicham","Swablu","Altaria","Wynaut","Duskull","Dusclops","Roselia","Slakoth","Vigoroth","Slaking","Gulpin","Swalot","Tropius","Whismur","Loudred","Exploud","Clamperl","Huntail","Gorebyss","Absol","Shuppet","Banette","Seviper","Zangoose","Relicanth","Aron","Lairon","Aggron","Castform","Volbeat","Illumise","Lileep","Cradily","Anorith","Armaldo","Ralts","Kirlia","Gardevoir","Bagon","Shelgon","Salamence","Beldum","Metang","Metagross","Regirock","Regice","Registeel","Kyogre","Groudon","Rayquaza","Latias","Latios","Jirachi","Deoxys","Chimecho"],Mo=new Array(412).fill(0);for(let n=1;n<=251;n++)Mo[n]=n;for(let n=252;n<=276;n++)Mo[n]=201;const ew={Treecko:252,Grovyle:253,Sceptile:254,Torchic:255,Combusken:256,Blaziken:257,Mudkip:258,Marshtomp:259,Swampert:260,Poochyena:261,Mightyena:262,Zigzagoon:263,Linoone:264,Wurmple:265,Silcoon:266,Beautifly:267,Cascoon:268,Dustox:269,Lotad:270,Lombre:271,Ludicolo:272,Seedot:273,Nuzleaf:274,Shiftry:275,Taillow:276,Swellow:277,Wingull:278,Pelipper:279,Ralts:280,Kirlia:281,Gardevoir:282,Surskit:283,Masquerain:284,Shroomish:285,Breloom:286,Slakoth:287,Vigoroth:288,Slaking:289,Nincada:290,Ninjask:291,Shedinja:292,Whismur:293,Loudred:294,Exploud:295,Makuhita:296,Hariyama:297,Azurill:298,Nosepass:299,Skitty:300,Delcatty:301,Sableye:302,Mawile:303,Aron:304,Lairon:305,Aggron:306,Meditite:307,Medicham:308,Electrike:309,Manectric:310,Plusle:311,Minun:312,Volbeat:313,Illumise:314,Roselia:315,Gulpin:316,Swalot:317,Carvanha:318,Sharpedo:319,Wailmer:320,Wailord:321,Numel:322,Camerupt:323,Torkoal:324,Spoink:325,Grumpig:326,Spinda:327,Trapinch:328,Vibrava:329,Flygon:330,Cacnea:331,Cacturne:332,Swablu:333,Altaria:334,Zangoose:335,Seviper:336,Lunatone:337,Solrock:338,Barboach:339,Whiscash:340,Corphish:341,Crawdaunt:342,Baltoy:343,Claydol:344,Lileep:345,Cradily:346,Anorith:347,Armaldo:348,Feebas:349,Milotic:350,Castform:351,Kecleon:352,Shuppet:353,Banette:354,Duskull:355,Dusclops:356,Tropius:357,Chimecho:358,Absol:359,Wynaut:360,Snorunt:361,Glalie:362,Spheal:363,Sealeo:364,Walrein:365,Clamperl:366,Huntail:367,Gorebyss:368,Relicanth:369,Luvdisc:370,Bagon:371,Shelgon:372,Salamence:373,Beldum:374,Metang:375,Metagross:376,Regirock:377,Regice:378,Registeel:379,Latias:380,Latios:381,Kyogre:382,Groudon:383,Rayquaza:384,Jirachi:385,Deoxys:386};for(let n=0;n<Eu.length;n++){const e=277+n,t=Eu[n],r=ew[t];r&&(Mo[e]=r)}const tw={0:" ",1:"√Ä",2:"√Å",3:"√Ç",4:"√á",5:"√à",6:"√â",7:"√ä",8:"√ã",9:"√å",11:"√é",12:"√è",13:"√í",14:"√ì",15:"√î",16:"≈í",17:"√ô",18:"√ö",19:"√õ",20:"√ë",21:"√ü",22:"√†",23:"√°",25:"√ß",26:"√®",27:"√©",28:"√™",29:"√´",30:"√¨",32:"√Æ",33:"√Ø",34:"√≤",35:"√≥",36:"√¥",37:"≈ì",38:"√π",39:"√∫",40:"√ª",41:"√±",45:"&",46:"+",53:"=",80:"‚ñØ",81:"¬ø",82:"¬°",90:"√ç",91:"%",92:"(",93:")",104:"√¢",111:"√≠",121:"‚¨Ü",122:"‚¨á",123:"‚¨Ö",124:"‚û°",133:"<",134:">",161:"0",162:"1",163:"2",164:"3",165:"4",166:"5",167:"6",168:"7",169:"8",170:"9",171:"!",172:"?",173:".",174:"-",176:"...",177:'"',178:'"',179:"'",180:"'",181:"M",182:"F",184:",",185:"x",186:"/",187:"A",188:"B",189:"C",190:"D",191:"E",192:"F",193:"G",194:"H",195:"I",196:"J",197:"K",198:"L",199:"M",200:"N",201:"O",202:"P",203:"Q",204:"R",205:"S",206:"T",207:"U",208:"V",209:"W",210:"X",211:"Y",212:"Z",213:"a",214:"b",215:"c",216:"d",217:"e",218:"f",219:"g",220:"h",221:"i",222:"j",223:"k",224:"l",225:"m",226:"n",227:"o",228:"p",229:"q",230:"r",231:"s",232:"t",233:"u",234:"v",235:"w",236:"x",237:"y",238:"z",239:"‚ñ∂",240:":",241:"√Ñ",242:"√ñ",243:"√ú",244:"√§",245:"√∂",246:"√º",255:"",0:" "};function nw(n){let e="";for(let t=0;t<n.length&&n[t]!==255;t++)e+=tw[n[t]]||"";return e.trim()}class rw{constructor(e){this.data=new DataView(e),this.buffer=e}parse(){const e=this.getGlobalSaveIndex(0),t=this.getGlobalSaveIndex(57344);let r=0;if(e===-1&&t===-1)throw new Error("No se encontr√≥ un archivo de guardado v√°lido (Gen 3).");e>t?r=0:r=57344;const a=new Uint8Array(57344);for(let m=0;m<14;m++){const g=r+m*4096,E=this.data.getUint16(g+4084,!0),S=new Uint8Array(this.buffer,g,4096);a.set(S,E*4096)}const l=new DataView(a.buffer).getUint32(4660,!0),d=4664,h=[];if(l>6)return{error:"Datos corruptos o versi√≥n no soportada."};for(let m=0;m<l;m++){const g=d+m*100,E=new Uint8Array(a.buffer,g,100);h.push(this.parsePokemon(E))}return{team:h,gameCode:"Emerald"}}getGlobalSaveIndex(e){let t=-1;for(let r=0;r<14;r++){const a=e+r*4096;if(this.data.getUint32(a+4088,!0)!==134291493)return-1;const s=this.data.getUint32(a+4092,!0);s>t&&(t=s)}return t}parsePokemon(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=t.getUint32(0,!0),a=t.getUint32(4,!0),i=nw(e.slice(8,18)),s=r^a,l=new Uint8Array(48);for(let st=0;st<12;st++){const ct=t.getUint32(32+st*4,!0)^s;l.set(new Uint8Array(new Int32Array([ct]).buffer),st*4)}const d=r%24,m=["GAEM","GAME","GEAM","GEMA","GMAE","GMEA","AGEM","AGME","AEGM","AEMG","AMGE","AMEG","EGAM","EGMA","EAGM","EAMG","EMGA","EMAG","MGAE","MGEA","MAGE","MAEG","MEGA","MEAG"][d],g=(st,Yr,ct)=>{const Kn=m.indexOf(st)*12+Yr,Bt=new DataView(l.buffer);return ct==="u16"?Bt.getUint16(Kn,!0):ct==="u8"?Bt.getUint8(Kn):ct==="u32"?Bt.getUint32(Kn,!0):0},E=g("G",0,"u16"),S=g("G",9,"u8"),I=g("E",0,"u8"),R=g("E",1,"u8"),C=g("E",2,"u8"),L=g("E",3,"u8"),z=g("E",4,"u8"),$=g("E",5,"u8"),Y=g("M",4,"u32"),H=g("M",0,"u8"),Q=Y>>0&31,b=Y>>5&31,f=Y>>10&31,v=Y>>15&31,w=Y>>20&31,_=Y>>25&31,A=(Y>>30&1)===1,y=Q%2,pe=b%2,Oe=f%2,Gr=v%2,Wr=w%2,Ot=_%2,sn=Math.floor((y+2*pe+4*Oe+8*Gr+16*Wr+32*Ot)*15/63),xo=Math.floor((y+2*pe+4*Oe+8*Gr+16*Wr+32*Ot)*40/63)+30,Kr=["Lucha","Volador","Veneno","Tierra","Roca","Bicho","Fantasma","Acero","Fuego","Agua","Planta","El√©ctrico","Ps√≠quico","Hielo","Drag√≥n","Siniestro"][sn],Qr=a&65535,cn=a>>16&65535,Hn=r>>16&65535,Gn=r&65535,Wn=(Qr^cn^Hn^Gn)<8,Xr=Mo[E]||E;return{nickname:i.trim(),speciesId:E,nationalId:Xr,isEgg:A,isShiny:Wn,pokerusStatus:H,friendship:S,ivs:{hp:Q,atk:b,def:f,spd:v,spa:w,spdef:_},evs:{hp:I,atk:R,def:C,spd:L,spa:z,spdef:$},hiddenPower:{type:Kr,power:xo},pid:r}}}function aw(){const n=document.getElementById("save-scanner-root");if(!n)return;const e=Zm(ye());n.innerHTML=`
    <div style="text-align:center; padding: 2rem; animation: fadeIn 0.5s;">
      <h2 style="color:var(--ray-yellow); text-shadow:0 0 10px var(--ray-green);">Esc√°ner de Partida (.sav)</h2>
      <p style="color:#ccc; margin-bottom:2rem;">Arrastra tu archivo .sav de ${e} para ver lo invisible.</p>
      
      <div id="drop-zone" style="
          border: 2px dashed var(--primary-color); 
          border-radius: 16px; 
          padding: 3rem; 
          background: rgba(var(--primary-rgb), 0.05); 
          cursor: pointer;
          transition: all 0.3s;
          margin-bottom: 2rem;
      ">
        <p style="font-size:1.2rem; color:#fff;">üìÇ Arrastra tu .sav aqu√≠ o haz clic</p>
        <input type="file" id="file-input" accept=".sav" style="display:none;">
      </div>

      <div id="scanner-results" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:1rem;"></div>
      <div id="error-msg" style="color:#ff6b81; margin-top:1rem; font-weight:bold;"></div>
    </div>
  `;const t=document.getElementById("drop-zone"),r=document.getElementById("file-input"),a=document.getElementById("scanner-results"),i=document.getElementById("error-msg");t.addEventListener("click",()=>r.click()),t.addEventListener("dragover",m=>{m.preventDefault(),t.style.background="rgba(var(--primary-rgb), 0.2)",t.style.borderColor="#fff"}),t.addEventListener("dragleave",m=>{m.preventDefault(),t.style.background="rgba(var(--primary-rgb), 0.05)",t.style.borderColor="var(--primary-color)"}),t.addEventListener("drop",m=>{m.preventDefault(),t.style.background="rgba(var(--primary-rgb), 0.05)",t.style.borderColor="var(--primary-color)",m.dataTransfer.files.length&&s(m.dataTransfer.files[0])}),r.addEventListener("change",m=>{m.target.files.length&&s(m.target.files[0])});function s(m){i.innerText="",a.innerHTML="<p style='color:var(--primary-color); width:100%; text-align:center;'>Analizando estructura binaria...</p>";const g=new FileReader;g.onload=E=>{try{const S=E.target.result,R=new rw(S).parse();if(R.error)throw new Error(R.error);l(R.team)}catch(S){console.error(S),i.innerText="Error: "+S.message,a.innerHTML=""}},g.readAsArrayBuffer(m)}function l(m){a.innerHTML=m.map(g=>{if(g.speciesId===0)return"";const E=g.isEgg?"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/egg.png":`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${g.isShiny?"shiny/":""}${g.nationalId}.png`;return`
        <div class="emulator-box clickable" style="text-align:left; position:relative; overflow:hidden; border: 1px solid ${g.isShiny?"#ffd700":"rgba(255,255,255,0.1)"}; cursor:pointer;" onclick="openPokemonModal(${g.nationalId})" title="Haz clic para ver detalles">
            ${g.isShiny?'<div style="position:absolute; top:5px; right:5px; font-size:1.2rem; animation: pulse 2s infinite;">‚ú®</div>':""}
            
            <div style="display:flex; gap:1rem; align-items:center; margin-bottom:1rem; padding-bottom:1rem; border-bottom:1px solid rgba(255,255,255,0.05);">
                 <div style="width:64px; height:64px; background:rgba(0,0,0,0.2); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                    <img src="${E}" style="width:64px; height:64px; image-rendering:pixelated;" onerror="this.src='https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png'">
                 </div>
                 <div>
                    <h3 style="margin:0; color:${g.isShiny?"#ffd700":"var(--ray-yellow)"}; font-size:1.2rem;">
                        ${g.isEgg?"Huevo":g.nickname||"Pok√©mon"}
                    </h3>
                    <span class="type-pill" style="font-size:0.75rem; opacity:0.7;">Dex #${g.nationalId} ${g.pokerusStatus?"‚Ä¢ ü¶† Pok√©rus":""}</span>
                 </div>
            </div>
            
            ${g.isEgg?'<p style="color:#ccc; text-align:center;">Un huevo misterioso...</p>':`
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:0.5rem; font-size:0.85rem; color:#ccc;">
                <div>
                    <strong style="color:var(--ray-green);">IVs (Gen√©tica):</strong><br>
                    PS: <span style="${d(g.ivs.hp)}">${g.ivs.hp}</span><br>
                    Ataque: <span style="${d(g.ivs.atk)}">${g.ivs.atk}</span><br>
                    Defensa: <span style="${d(g.ivs.def)}">${g.ivs.def}</span><br>
                    Velocid: <span style="${d(g.ivs.spd)}">${g.ivs.spd}</span><br>
                    At.Esp: <span style="${d(g.ivs.spa)}">${g.ivs.spa}</span><br>
                    Df.Esp: <span style="${d(g.ivs.spdef)}">${g.ivs.spdef}</span>
                </div>
                <div>
                    <strong style="color:var(--ray-green);">EVs (Esfuerzo):</strong><br>
                    PS: ${g.evs.hp}<br>
                    Ataque: ${g.evs.atk}<br>
                    Defensa: ${g.evs.def}<br>
                    Velocid: ${g.evs.spd}<br>
                    At.Esp: ${g.evs.spa}<br>
                    Df.Esp: ${g.evs.spdef}
                </div>
            </div>

            <div style="margin-top:0.75rem; padding-top:0.75rem; border-top:1px solid rgba(255,255,255,0.1); display:grid; grid-template-columns: 1fr 1fr; gap:0.5rem;">
                <p style="font-size:0.9rem; margin:0;">
                   üîÆ <strong>Poder Oculto:</strong><br> 
                   <span style="color:${h(g.hiddenPower.type)}">${g.hiddenPower.type}</span> (${g.hiddenPower.power})
                </p>
                <p style="font-size:0.9rem; margin:0;">
                   ‚ù§Ô∏è <strong>Felicidad:</strong><br>
                   ${g.friendship} / 255
                </p>
            </div>
            `}
        </div>
      `}).join("")}function d(m){return m===31?"color:#ffeb3b; font-weight:bold; text-shadow:0 0 5px #ffeb3b;":m>=25?"color:#4cd137; font-weight:bold;":m<=5?"color:#e84118;":"color:#fff;"}function h(m){return{Lucha:"#c0392b",Volador:"#a29bfe",Veneno:"#8e44ad",Tierra:"#d35400",Roca:"#7f8c8d",Bicho:"#2ecc71",Fantasma:"#34495e",Acero:"#95a5a6",Fuego:"#e74c3c",Agua:"#3498db",Planta:"#27ae60",El√©ctrico:"#f1c40f",Ps√≠quico:"#9b59b6",Hielo:"#74b9ff",Drag√≥n:"#4834d4",Siniestro:"#2c3e50"}[m]||"#ccc"}}const ow=[{name:"Petra",city:"Ciudad F√©rrica",type:"Roca",badge:"Medalla Piedra",strategy:"Los ataques de tipo Agua y Planta son debilidades x4 para sus Geodude. Ten cuidado con Tumba Rocas, que reduce tu Velocidad.",pokemon:[{name:"Geodude",id:74,level:12,types:["Roca","Tierra"],moves:["Placaje","Rizo Defensa","Lanza Rocas","Tumba Rocas"]},{name:"Geodude",id:74,level:12,types:["Roca","Tierra"],moves:["Placaje","Rizo Defensa","Lanza Rocas","Tumba Rocas"]},{name:"Nosepass",id:299,level:15,types:["Roca"],moves:["Bloqueo","Fortaleza","Placaje","Tumba Rocas"],item:"Baya Aranja"}]},{name:"Marcial",city:"Pueblo Azuliza",type:"Lucha",badge:"Medalla Pu√±o",strategy:"Usa tipos Volador o Ps√≠quico. Meditite puede usar Reflejo, lo que reduce el da√±o f√≠sico que recibe su equipo.",pokemon:[{name:"Machop",id:66,level:16,types:["Lucha"],moves:["Patada Baja","Corpulencia","Foco Energ√≠a","Venganza"]},{name:"Meditite",id:307,level:16,types:["Lucha","Ps√≠quico"],moves:["Foco Energ√≠a","Confusi√≥n","Detecci√≥n","Corpulencia"]},{name:"Makuhita",id:296,level:19,types:["Lucha"],moves:["Empuj√≥n","Vigor","Corpulencia","Tiro Vital"],item:"Baya Aranja"}]},{name:"Erico",city:"Ciudad Malvalona",type:"El√©ctrico",badge:"Medalla Dinamo",strategy:"Un tipo Tierra es indispensable aqu√≠ para ser inmune a sus ataques el√©ctricos. Cuidado con el Autodestrucci√≥n de Voltorb.",pokemon:[{name:"Voltorb",id:100,level:20,types:["El√©ctrico"],moves:["Desenrollar","Chispa","Autodestrucci√≥n","Onda Voltio"]},{name:"Electrike",id:309,level:20,types:["El√©ctrico"],moves:["Ataque R√°pido","Malicioso","Aullido","Onda Voltio"]},{name:"Magneton",id:82,level:22,types:["El√©ctrico","Acero"],moves:["Supers√≥nico","Onda Trueno","Bomba S√≥nica","Onda Voltio"]},{name:"Manectric",id:310,level:24,types:["El√©ctrico"],moves:["Ataque R√°pido","Onda Trueno","Aullido","Onda Voltio"]}]},{name:"Candela",city:"Pueblo Lavacalda",type:"Fuego",badge:"Medalla Calor",strategy:"El movimiento Sofoco es devastador pero reduce su Ataque Especial. El clima soleado de Sequ√≠a potencia sus ataques.",pokemon:[{name:"Numel",id:322,level:24,types:["Fuego","Tierra"],moves:["D√≠a Soleado","Velo Sagrado","Magnitud","Sofoco"]},{name:"Slugma",id:218,level:24,types:["Fuego"],moves:["D√≠a Soleado","Poluci√≥n","Pantalla Luz","Sofoco"]},{name:"Camerupt",id:323,level:26,types:["Fuego","Tierra"],moves:["D√≠a Soleado","Atracci√≥n","Magnitud","Sofoco"]},{name:"Torkoal",id:324,level:29,types:["Fuego"],moves:["D√≠a Soleado","Cuerpo Llama","Atracci√≥n","Sofoco"],item:"Hierba Blanca"}]},{name:"Norman",city:"Ciudad Petalia",type:"Normal",badge:"Medalla Equilibrio",strategy:"Usa ataques de tipo Lucha. Slaking tiene estad√≠sticas de legendario pero solo ataca cada dos turnos por Ausente.",pokemon:[{name:"Spinda",id:327,level:27,types:["Normal"],moves:["Psicorrayo","Otra Vez","Danza Caos","Imagen"]},{name:"Vigoroth",id:288,level:27,types:["Normal"],moves:["Cuchillada","Finta","Otra Vez","Imagen"]},{name:"Linoone",id:264,level:29,types:["Normal"],moves:["Cuchillada","Tambor","Golpe Cabeza","Imagen"]},{name:"Slaking",id:289,level:31,types:["Normal"],moves:["Bostezo","Finta","Contador","Imagen"],item:"Baya Ziuela"}]},{name:"Alana",city:"Ciudad Arborada",type:"Volador",badge:"Medalla Pluma",strategy:"Altaria con Danza Drag√≥n es el mayor peligro. Un ataque de Hielo fuerte puede acabar con ella r√°pidamente.",pokemon:[{name:"Swablu",id:333,level:29,types:["Normal","Volador"],moves:["Golpe A√©reo","Mov. Espejo","Velo Sagrado","Canto Mortal"]},{name:"Tropius",id:357,level:29,types:["Planta","Volador"],moves:["D√≠a Soleado","Rayo Solar","Golpe A√©reo","S√≠ntesis"]},{name:"Pelipper",id:279,level:30,types:["Agua","Volador"],moves:["Pistola Agua","Protecci√≥n","Supers√≥nico","Golpe A√©reo"]},{name:"Skarmory",id:227,level:31,types:["Acero","Volador"],moves:["Ataque Arena","Ala de Acero","Ataque Furia","Golpe A√©reo"]},{name:"Altaria",id:334,level:33,types:["Drag√≥n","Volador"],moves:["Dragoaliento","Danza Drag√≥n","Terremoto","Golpe A√©reo"],item:"Baya Ziuela"}]},{name:"Vito y Leti",city:"Ciudad Algaria",type:"Ps√≠quico",badge:"Medalla Mente",strategy:"Combate Doble. Claydol puede usar Terremoto sin da√±ar a sus aliados si son tipo Volador o tienen Levitaci√≥n.",pokemon:[{name:"Claydol",id:344,level:41,types:["Tierra","Ps√≠quico"],moves:["Poder Pasado","Ps√≠quico","Terremoto","Pantalla Luz"]},{name:"Xatu",id:178,level:41,types:["Ps√≠quico","Volador"],moves:["Ps√≠quico","Rayo Confuso","Paz Mental","Teletransporte"]},{name:"Lunatone",id:337,level:42,types:["Roca","Ps√≠quico"],moves:["Ps√≠quico","Hipnosis","Pantalla Luz","Rayo Confuso"]},{name:"Solrock",id:338,level:42,types:["Roca","Ps√≠quico"],moves:["Ps√≠quico","Lanzallamas","D√≠a Soleado","Reflejo"]}]},{name:"Juan",city:"Arrec√≠polis",type:"Agua",badge:"Medalla Lluvia",strategy:"Kingdra es su as. Usa Doble Equipo y Descanso para desesperarte. Los ataques de tipo Drag√≥n son los √∫nicos efectivos.",pokemon:[{name:"Luvdisc",id:370,level:41,types:["Agua"],moves:["Hidropulso","Atracci√≥n","Beso Dulce","Azote"]},{name:"Whiscash",id:340,level:41,types:["Agua","Tierra"],moves:["Danza Lluvia","Hidropulso","Amnesia","Terremoto"]},{name:"Sealeo",id:364,level:43,types:["Hielo","Agua"],moves:["Otra Vez","Golpe Cuerpo","Rayo Aurora","Hidropulso"]},{name:"Crawdaunt",id:342,level:43,types:["Agua","Siniestro"],moves:["Martillazo","Hidropulso","Malicioso","Mofa"]},{name:"Kingdra",id:230,level:46,types:["Agua","Drag√≥n"],moves:["Hidropulso","Doble Equipo","Rayo Hielo","Descanso"],item:"Baya Atania"}]}],iw=[{name:"Sixto",type:"Siniestro",strategy:"Usa tipos Lucha o Bicho. Ten cuidado con Intimidaci√≥n de Mightyena y los counters de Absol.",pokemon:[{name:"Mightyena",id:262,level:46,types:["Siniestro"],moves:["Triturar","Doble Filo","Ataque Arena","Rugido"]},{name:"Cacturne",id:332,level:46,types:["Planta","Siniestro"],moves:["Finta","Brazo Pincho","Drenadoras","Espora Alg."]},{name:"Shiftry",id:275,level:46,types:["Planta","Siniestro"],moves:["Paranormal","Doble Equipo","Contoneo","Tormento"]},{name:"Crawdaunt",id:342,level:48,types:["Agua","Siniestro"],moves:["Danza Espada","Fuerza","Imagen","Surf"]},{name:"Absol",id:359,level:49,types:["Siniestro"],moves:["Danza Espada","Avalancha","Golpe A√©reo","Acuchillar"],item:"Baya Ziuela"}]},{name:"F√°tima",type:"Fantasma",strategy:"Los ataques tipo Siniestro o Fantasma son clave. Sableye no tiene debilidades en esta generaci√≥n.",pokemon:[{name:"Dusclops",id:356,level:48,types:["Fantasma"],moves:["Protecci√≥n","Maldici√≥n","Rayo Confuso","Pu√±o Sombra"]},{name:"Banette",id:354,level:49,types:["Fantasma"],moves:["Rabia","Fuego Fatuo","Finta","Bola Sombra"]},{name:"Sableye",id:302,level:50,types:["Siniestro","Fantasma"],moves:["Doble Equipo","Tinieblas","Finta","Bola Sombra"]},{name:"Banette",id:354,level:49,types:["Fantasma"],moves:["Bola Sombra","Rayo","Ps√≠quico","Imagen"]},{name:"Dusclops",id:356,level:51,types:["Fantasma"],moves:["Rayo Hielo","Bola Sombra","Avalancha","Terremoto"],item:"Baya Ziuela"}]},{name:"N√≠vea",type:"Hielo",strategy:"Tipos Lucha, Fuego, Roca o El√©ctrico. Walrein puede usar Fr√≠o Agudo, un movimiento que debilita de un golpe.",pokemon:[{name:"Sealeo",id:364,level:50,types:["Hielo","Agua"],moves:["Bola Hielo","Golpe Cuerpo","Rayo Aurora","Granizo"]},{name:"Glalie",id:362,level:50,types:["Hielo"],moves:["Rayo Hielo","Triturar","Pantalla Luz","Granizo"]},{name:"Sealeo",id:364,level:52,types:["Hielo","Agua"],moves:["Rayo Hielo","Ventisca","Atracci√≥n","Granizo"]},{name:"Glalie",id:362,level:52,types:["Hielo"],moves:["Rayo Hielo","Terremoto","Explosi√≥n","Granizo"]},{name:"Walrein",id:365,level:53,types:["Hielo","Agua"],moves:["Rayo Hielo","Surf","Golpe Cuerpo","Fr√≠o Agudo"],item:"Baya Ziuela"}]},{name:"Drac√≥n",type:"Drag√≥n",strategy:"Ataques de Hielo son x4 efectivos contra Altaria, Salamence y Flygon. Kingdra solo es d√©bil a Drag√≥n.",pokemon:[{name:"Shelgon",id:372,level:52,types:["Drag√≥n"],moves:["Garra Drag√≥n","Tumba Rocas","Protecci√≥n","Dragoaliento"]},{name:"Altaria",id:334,level:54,types:["Drag√≥n","Volador"],moves:["Danza Drag√≥n","Dragoaliento","Golpe A√©reo","Doble Filo"]},{name:"Kingdra",id:230,level:53,types:["Agua","Drag√≥n"],moves:["Surf","Golpe Cuerpo","Danza Drag√≥n","Pantalla Humo"]},{name:"Flygon",id:330,level:53,types:["Tierra","Drag√≥n"],moves:["Dragoaliento","Tormenta Arena","Terremoto","Triturar"]},{name:"Salamence",id:373,level:55,types:["Drag√≥n","Volador"],moves:["Garra Drag√≥n","Lanzallamas","Triturar","Avalancha"],item:"Baya Ziuela"}]},{name:"Plubio",type:"Campe√≥n / Agua",strategy:"Un equipo equilibrado con ataques el√©ctricos y de planta es vital. Milotic con Recuperaci√≥n y T√≥xico es muy resistente.",pokemon:[{name:"Wailord",id:321,level:57,types:["Agua"],moves:["Danza Lluvia","Salpicar","Doble Filo","Ventisca"]},{name:"Tentacruel",id:73,level:55,types:["Agua","Veneno"],moves:["Hidrobomba","Bomba Lodo","Rayo Hielo","T√≥xico"]},{name:"Ludicolo",id:272,level:56,types:["Agua","Planta"],moves:["Giga Drenado","Surf","Drenadoras","Doble Equipo"]},{name:"Whiscash",id:340,level:56,types:["Agua","Tierra"],moves:["Terremoto","Surf","Hiperrayo","Amnesia"]},{name:"Gyarados",id:130,level:56,types:["Agua","Volador"],moves:["Danza Drag√≥n","Hiperrayo","Terremoto","Surf"]},{name:"Milotic",id:350,level:58,types:["Agua"],moves:["Recuperaci√≥n","Surf","Rayo Hielo","T√≥xico"],item:"Baya Ziuela"}]}],sw=[{name:"Roco",city:"Ciudad Pirita",type:"Roca",badge:"Medalla Lignito",strategy:"Los ataques de Agua, Planta y Lucha son letales. Cranidos tiene un Ataque alt√≠simo para ser el primer gimnasio.",pokemon:[{name:"Geodude",id:74,level:12,types:["Roca","Tierra"],moves:["Trampa Rocas","Desenrollar","Empuj√≥n"]},{name:"Onix",id:95,level:12,types:["Roca","Tierra"],moves:["Trampa Rocas","Chirrido","Lanzarrocas"]},{name:"Cranidos",id:408,level:14,types:["Roca"],moves:["Golpe Cabeza","Malicioso","Persecuci√≥n"]}]},{name:"Gardenia",city:"Ciudad Eterna",type:"Planta",badge:"Medalla Bosque",strategy:"Usa tipos Fuego, Volador o Bicho. Su Roserade usa Hierba Lazo, que hace m√°s da√±o a Pok√©mon pesados.",pokemon:[{name:"Turtwig",id:387,level:20,types:["Planta"],moves:["Reflejo","Hoja Afilada","D√≠a Soleado"]},{name:"Cherrim",id:421,level:20,types:["Planta"],moves:["D√≠a Soleado","Bomba Germen","Drenadoras"]},{name:"Roserade",id:407,level:22,types:["Planta","Veneno"],moves:["Hierba Lazo","Hoja M√°gica","Paralizador","Ponzo√±a"]}]},{name:"Fantina",city:"Ciudad Coraz√≥n",type:"Fantasma",badge:"Medalla Reliquia",strategy:"El tipo Siniestro es tu mejor aliado. Su Mismagius es muy r√°pido y golpea fuerte por el lado especial.",pokemon:[{name:"Duskull",id:355,level:24,types:["Fantasma"],moves:["Sombra Nocturna","Fuego Fatuo","Rayo Confuso"]},{name:"Haunter",id:93,level:24,types:["Fantasma","Veneno"],moves:["Pu√±o Sombra","Rayo Confuso","Hipnosis"]},{name:"Mismagius",id:429,level:26,types:["Fantasma"],moves:["Bola Sombra","Psicorrayo","Hoja M√°gica","Rayo Confuso"]}]},{name:"Brega",city:"Ciudad Rocavelo",type:"Lucha",badge:"Medalla Cobalto",strategy:"Los tipos Volador y Ps√≠quico son claves. Lucario puede resistir mucho gracias a su tipo Acero secundario.",pokemon:[{name:"Meditite",id:307,level:28,types:["Lucha","Ps√≠quico"],moves:["Sorpresa","Confusi√≥n","Tumba Rocas","Pu√±o Drenaje"]},{name:"Machoke",id:67,level:29,types:["Lucha"],moves:["Foco Energ√≠a","Karate-choque","Tumba Rocas","Fuerza"]},{name:"Lucario",id:448,level:32,types:["Lucha","Acero"],moves:["Pu√±o Drenaje","Palmeo","Garra Metal","Ataque √ìseo"],item:"Baya Ziuela"}]},{name:"Mananti",city:"Ciudad Pradera",type:"Agua",badge:"Medalla Ci√©naga",strategy:"Tipo El√©ctrico y Planta son necesarios. Cuidado con Quagsire, que es inmune a la electricidad por ser tipo Tierra.",pokemon:[{name:"Gyarados",id:130,level:27,types:["Agua","Volador"],moves:["Salmuera","Mordisco","Furia Drag√≥n","Contoneo"]},{name:"Quagsire",id:195,level:27,types:["Agua","Tierra"],moves:["Portazo","Bomba Lodo","Mudar Agua","L√°tigo"]},{name:"Floatzel",id:419,level:30,types:["Agua"],moves:["Salmuera","Colmillo Hielo","Persecuci√≥n","Ataque R√°pido"],item:"Baya Ziuela"}]},{name:"Acer√≥n",city:"Ciudad Canal",type:"Acero",badge:"Medalla Mina",strategy:"Tipo Fuego, Lucha y Tierra. Bastiodon tiene una defensa f√≠sica y especial inmensa, intenta desgastarlo.",pokemon:[{name:"Bronzor",id:436,level:36,types:["Acero","Ps√≠quico"],moves:["Trampa Rocas","Hipnosis","Rayo Confuso","Giro Bola"]},{name:"Steelix",id:208,level:36,types:["Acero","Tierra"],moves:["Colmillo Hielo","Colmillo Rayo","Colmillo √çgneo","Terremoto"]},{name:"Bastiodon",id:411,level:39,types:["Roca","Acero"],moves:["Roca Afilada","Defensa F√©rrea","Mofa","Represi√≥n Metal"],item:"Baya Ziuela"}]},{name:"Inverna",city:"Ciudad Puntaneva",type:"Hielo",badge:"Medalla Glaciar",strategy:"Fuego, Lucha, Acero y Roca. Su Abomasnow invoca Granizo nada m√°s salir.",pokemon:[{name:"Snover",id:459,level:38,types:["Planta","Hielo"],moves:["Alud","Arraigo","Ventisca","Hierba Lazo"]},{name:"Sneasel",id:215,level:38,types:["Siniestro","Hielo"],moves:["Alud","Ataque R√°pido","Chirrido","Canto Helado"]},{name:"Medicham",id:308,level:40,types:["Lucha","Ps√≠quico"],moves:["Pu√±o Hielo","Psicocorte","Detecci√≥n","Sorpresa"]},{name:"Abomasnow",id:460,level:42,types:["Planta","Hielo"],moves:["Alud","Mazazo","Onda Certera","Granizo"],item:"Baya Ziuela"}]},{name:"Lectro",city:"Ciudad Marina",type:"El√©ctrico",badge:"Medalla Faro",strategy:"Tipo Tierra es indispensable. Electivire tiene una cobertura de movimientos muy amplia con los Pu√±os Elementales.",pokemon:[{name:"Jolteon",id:135,level:46,types:["El√©ctrico"],moves:["Rayo Carga","Onda Trueno","Cola F√©rrea","Ataque R√°pido"]},{name:"Raichu",id:26,level:46,types:["El√©ctrico"],moves:["Rayo Carga","Doble Rayo","Onda Certera","Ataque R√°pido"]},{name:"Luxray",id:405,level:48,types:["El√©ctrico"],moves:["Colmillo Rayo","Colmillo Hielo","Colmillo √çgneo","Triturar"]},{name:"Electivire",id:466,level:50,types:["El√©ctrico"],moves:["Pu√±o Trueno","Pu√±o Fuego","Giga Impacto","Ataque R√°pido"],item:"Baya Ziuela"}]}],cw=[{name:"Alecr√°n",type:"Bicho",strategy:"Usa tipos Fuego, Volador o Roca. Drapion es su Pok√©mon m√°s peligroso y solo es d√©bil a Tierra.",pokemon:[{name:"Yanomega",id:469,level:49,types:["Bicho","Volador"],moves:["Tajo A√©reo","Zumbido","Ida y Vuelta","Doble Equipo"]},{name:"Scizor",id:212,level:49,types:["Bicho","Acero"],moves:["Cabeza de Hierro","Tajo X","Tajo Umbr√≠o","Ataque R√°pido"]},{name:"Vespiquen",id:416,level:50,types:["Bicho","Volador"],moves:["Al Ataque","A Defender","Auxilio","Gema Robusta"]},{name:"Heracross",id:214,level:51,types:["Bicho","Lucha"],moves:["Megacuerno","A Bocajarro","Tajo Umbr√≠o","Roca Afilada"]},{name:"Drapion",id:452,level:53,types:["Veneno","Siniestro"],moves:["Tajo X","Veneno X","Colmillo Hielo","Golpe A√©reo"]}]},{name:"Gaia",type:"Tierra",strategy:"Ataques de Agua y Planta (especialmente especial) destrozan a la mayor√≠a de su equipo.",pokemon:[{name:"Whiscash",id:340,level:50,types:["Agua","Tierra"],moves:["Tierra Viva","Tormenta Arena","Cabezazo Zen","Acua Cola"]},{name:"Gliscor",id:472,level:53,types:["Tierra","Volador"],moves:["Terremoto","Colmillo √çgneo","Colmillo Hielo","Colmillo Rayo"]},{name:"Hippowdon",id:450,level:52,types:["Tierra"],moves:["Terremoto","Piedra Afilada","Triturar","Bostezo"]},{name:"Golem",id:76,level:52,types:["Roca","Tierra"],moves:["Pu√±o Fuego","Pu√±o Trueno","Terremoto","Tormenta Arena"]},{name:"Rhyperior",id:464,level:55,types:["Tierra","Roca"],moves:["Alud","Megacuerno","Terremoto","Romperrocas"],item:"Baya Ziuela"}]},{name:"Fausto",type:"Fuego",strategy:"Tierra, Agua y Roca. Su Magmortar y su Infernape son atacantes mixtos muy peligrosos.",pokemon:[{name:"Houndoom",id:229,level:52,types:["Siniestro","Fuego"],moves:["Lanzallamas","Bomba Lodo","Pulso Umbr√≠o","D√≠a Soleado"]},{name:"Flareon",id:136,level:55,types:["Fuego"],moves:["Sofoco","Giga Impacto","Ataque R√°pido","Fuego Fatuo"]},{name:"Rapidash",id:78,level:53,types:["Fuego"],moves:["Envite √çgneo","Rayo Solar","Bote","D√≠a Soleado"]},{name:"Infernape",id:392,level:55,types:["Fuego","Lucha"],moves:["Envite √çgneo","Pu√±o Trueno","Ultrapu√±o","Terremoto"]},{name:"Magmortar",id:467,level:57,types:["Fuego"],moves:["Lanzallamas","Rayo","Rayo Solar","Hiperrayo"]}]},{name:"Delos",type:"Ps√≠quico",strategy:"Siniestro, Fantasma y Bicho. Gallade usa ataques f√≠sicos de lucha para cubrir sus debilidades.",pokemon:[{name:"Mr. Mime",id:122,level:53,types:["Ps√≠quico"],moves:["Ps√≠quico","Pantalla Luz","Reflejo","Rayo"]},{name:"Espeon",id:196,level:55,types:["Ps√≠quico"],moves:["Ps√≠quico","Ataque R√°pido","Bola Sombra","Doble Rayo"]},{name:"Bronzong",id:437,level:54,types:["Acero","Ps√≠quico"],moves:["Ps√≠quico","Giro Bola","Paz Mental","Terremoto"],item:"Refleluz"},{name:"Alakazam",id:65,level:56,types:["Ps√≠quico"],moves:["Ps√≠quico","Onda Certera","Recuperaci√≥n","Energibola"]},{name:"Gallade",id:475,level:59,types:["Ps√≠quico","Lucha"],moves:["Psicocorte","Pu√±o Drenaje","Hoja Aguda","Roca Afilada"],item:"Cinta Experto"}]},{name:"Cintia",type:"Campeona",strategy:"La campeona definitiva. Su Garchomp es legendariamente fuerte. Necesitas un ataque de Hielo s√≠ o s√≠.",pokemon:[{name:"Spiritomb",id:442,level:58,types:["Fantasma","Siniestro"],moves:["Pulso Umbr√≠o","Viento Plata","Bola Sombra","Ps√≠quico"]},{name:"Roserade",id:407,level:58,types:["Planta","Veneno"],moves:["Bomba Lodo","Energibola","T√≥xico","Extrasensorial"]},{name:"Togekiss",id:468,level:60,types:["Normal","Volador"],moves:["Tajo A√©reo","Esfera Aural","Hidropulso","Velocidad Extrema"]},{name:"Lucario",id:448,level:60,types:["Lucha","Acero"],moves:["Esfera Aural","Bola Sombra","Roca Afilada","Velocidad Extrema"]},{name:"Milotic",id:350,level:58,types:["Agua"],moves:["Surf","Rayo Hielo","Espejo Manto","Acua Aro"]},{name:"Garchomp",id:445,level:62,types:["Drag√≥n","Tierra"],moves:["Carga Drag√≥n","Terremoto","Lanzallamas","Giga Impacto"],item:"Baya Ziuela"}]}];function _u(){const n=document.getElementById("guide");if(!n)return;const e=ye(),t=e===Re.PLATINUM?sw:ow,r=e===Re.PLATINUM?cw:iw,a="https://play.pokemonshowdown.com/sprites/trainers/",i="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/",s=I=>{const R=document.getElementById("item-dex-container");R&&(R.innerHTML=I.map(C=>`
         <div class="recommendation-card" style="border-left: 3px solid ${l(C.category)}">
            <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/${C.img}.png" 
                 onerror="this.src='https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png'"
                 style="width:48px; height:48px; image-rendering:pixelated; flex-shrink:0;">
            <div style="flex:1;">
              <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                  <h4 style="color:var(--text-main); margin-bottom:0.15rem; font-size:1rem;">${C.name}</h4>
                  <span class="type-pill" style="font-size:0.65rem; background:rgba(255,255,255,0.1); padding:2px 8px;">${C.category}</span>
              </div>
              <p style="font-size:0.85rem; color:var(--primary-color); margin-bottom:0.25rem;">üìç ${C.loc}</p>
              <p style="font-size:0.8rem; color:var(--text-muted); line-height:1.4;">${C.desc}</p>
            </div>
         </div>
      `).join(""),I.length===0&&(R.innerHTML='<p style="text-align:center; color:var(--text-muted); width:100%; padding:2rem;">No se encontraron objetos.</p>'))};function l(I){return I==="Evoluci√≥n"?"#f0932b":I==="Combate"?"#eb4d4b":I==="Utilidad"?"#48dbfb":I==="Clave"?"#f1c40f":I==="Baya"?"#7bed9f":I==="Concurso"?"#ff6b81":"#ccc"}const d={"Medalla Piedra":"/pokemon-emerald-companion/badges/stone_badge.png","Medalla Pu√±o":"/pokemon-emerald-companion/badges/knuckle_badge.png","Medalla Dinamo":"/pokemon-emerald-companion/badges/dynamo_badge.png","Medalla Calor":"/pokemon-emerald-companion/badges/heat_badge.png","Medalla Equilibrio":"/pokemon-emerald-companion/badges/balance_badge.png","Medalla Pluma":"/pokemon-emerald-companion/badges/feather_badge.png","Medalla Mente":"/pokemon-emerald-companion/badges/mind_badge.png","Medalla Lluvia":"/pokemon-emerald-companion/badges/rain_badge.png","Medalla Lignito":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/25.png","Medalla Bosque":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/26.png","Medalla Cobalto":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/27.png","Medalla Ci√©naga":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/28.png","Medalla Reliquia":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/29.png","Medalla Mina":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/30.png","Medalla Glaciar":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/31.png","Medalla Faro":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/32.png"},h=I=>`
      <div class="leader-team">
        ${I.map(R=>`
          <div class="leader-poke-card clickable" onclick="openPokemonModal(${R.id})" title="Haz clic para ver detalles">
            <div style="display:flex; align-items:center; gap:0.75rem; margin-bottom: 0.75rem;">
                <img src="${i}${R.id}.png" class="leader-poke-img" alt="${R.name}">
                <div style="flex:1;">
                    <div class="leader-poke-name">${R.name}</div>
                    <div class="leader-poke-lvl">Nv. ${R.level}</div>
                    <div style="display:flex; gap:0.25rem; flex-wrap:wrap; margin-top:0.25rem;">
                      ${R.types.map(C=>`<span class="type-pill type-${C.toLowerCase()}" style="font-size:0.6rem; padding:2px 6px;">${C}</span>`).join("")}
                    </div>
                </div>
            </div>
            
            <div class="moves-section">
              <div class="moves-label">‚öîÔ∏è Movimientos</div>
              <div class="leader-moves">
                ${R.moves.map(C=>{const L=Tu[C]||{type:"Normal",category:"F√≠sico",desc:"Ataque normal.",power:null,accuracy:100},z=Pu(L.category);return`
                    <div class="move-wrapper">
                      <span class="leader-move-tag" style="${R.types.includes(L.type)?"border-color:var(--primary-color); background:rgba(var(--primary-rgb),0.15);":""}">
                         ${C}
                      </span>
                      <div class="move-tooltip">
                        <div class="tooltip-header">
                          <span class="tooltip-name">${C}</span>
                          <span class="type-pill type-${L.type.toLowerCase()}">${L.type}</span>
                        </div>
                        <div class="tooltip-category">${z} ${L.category} ¬∑ Pot: ${L.power||"-"} ¬∑ Pre: ${L.accuracy||"-"}%</div>
                        <p class="tooltip-desc">${L.desc}</p>
                      </div>
                    </div>
                  `}).join("")}
              </div>
            </div>
          </div>
        `).join("")}
      </div>
    `,m={Petra:"roxanne-gen3.png",Marcial:"brawly-gen3.png",Erico:"wattson-gen3.png",Candela:"flannery-gen3.png",Norman:"norman-gen3.png",Alana:"winona-gen3.png","Vito y Leti":"tateandliza-gen3.png",Juan:"juan-gen3.png",Sixto:"sidney-gen3.png",F√°tima:"phoebe-gen3.png",N√≠vea:"glacia-gen3.png",Drac√≥n:"drake-gen3.png",Plubio:"wallace-gen3.png",Roco:"roark.png",Gardenia:"gardenia.png",Fantina:"fantina.png",Brega:"maylene.png",Mananti:"crasherwake.png",Acer√≥n:"byron.png",Inverna:"candice.png",Lectro:"volkner.png",Alecr√°n:"aaron.png",Gaia:"bertha.png",Fausto:"flint.png",Delos:"lucian.png",Cintia:"cynthia.png"};n.innerHTML=`
    <h2>Gu√≠a de Aventura</h2>
    
    <div class="guide-tabs">
      <div class="guide-tab active" data-tab="gyms">L√≠deres</div>
      <div class="guide-tab" data-tab="e4">Alto Mando</div>
      <div class="guide-tab" data-tab="items">MOs y MTs</div>
      <div class="guide-tab" data-tab="held">Objetos</div>
      <div class="guide-tab" id="scanner-btn" style="border-color:var(--primary-glow); color:var(--primary-glow);">üíæ Scanner</div>
    </div>

    <!-- GYMS GRID LAYOUT -->
    <div id="tab-gyms" class="tab-content" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap:2rem;">
       ${t.map((I,R)=>`
         <div class="emulator-box" style="display:flex; flex-direction:column; height:100%;">
             <div style="display:flex; gap:1.5rem; align-items:center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--glass-border); position: relative; z-index: 2;">
              <div style="position:relative;">
                 <img src="${a}${m[I.name]}" style="height:100px; filter:drop-shadow(0 4px 10px rgba(0,0,0,0.5)); transform: scale(1.1);">
              </div>
              <div style="flex:1;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h3 style="margin:0; font-size: 1.5rem; text-align:left;">${I.name}</h3>
                    <span style="font-size:3rem; font-weight:800; color:rgba(255,255,255,0.03); line-height:0;">${R+1}</span>
                </div>
                <div style="color:var(--text-secondary); font-size:0.9rem; margin-bottom:0.5rem;">${I.city}</div>
                <div style="display:flex; gap:0.5rem; align-items:center;">
                  <span class="type-pill type-${I.type.toLowerCase()}">${I.type}</span>
                  ${I.badge?`
                  <div style="display:flex; align-items:center; gap:0.4rem; background:rgba(0,0,0,0.2); padding:2px 8px; border-radius:100px;">
                    <img src="${d[I.badge]}" alt="${I.badge}" style="width:24px; height:24px;">
                    <span style="color:var(--ray-yellow); font-size:0.8rem; font-weight:600;">${I.badge}</span>
                  </div>`:""}
                </div>
              </div>
            </div>
            
            <!-- Strategy Popover/Text -->
            <div style="background:rgba(var(--primary-rgb), 0.05); border:1px solid rgba(var(--primary-rgb), 0.1); padding:1rem; border-radius:12px; margin-bottom:1.5rem;">
                <p style="font-size:0.9rem; color:var(--text-main); line-height: 1.5; font-style:italic;">"${I.strategy}"</p>
            </div>

            ${h(I.pokemon)}
         </div>
       `).join("")}
    </div>

    <!-- ELITE FOUR LAYOUT -->
    <div id="tab-e4" class="tab-content hidden" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap:2rem;">
       ${r.map((I,R)=>`
         <div class="emulator-box" style="border-color:${R===r.length-1?"var(--ray-yellow)":"var(--glass-border)"};">
             <div style="display:flex; gap:1.5rem; align-items:center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--glass-border); position: relative; z-index: 2;">
              <img src="${a}${m[I.name]}" style="height:100px; filter:drop-shadow(0 4px 10px rgba(0,0,0,0.5));">
              <div>
                <h3 style="margin:0; font-size: 1.5rem; text-align:left; color:${R===r.length-1?"var(--ray-yellow)":"white"};">
                    ${R===r.length-1?"CAMPE√ìN ":""}${I.name}
                </h3>
                <span class="type-pill type-${I.type.toLowerCase().includes("/")?"water":I.type.toLowerCase()}" style="margin-top:0.5rem; display:inline-block;">${I.type}</span>
              </div>
            </div>
            <p style="font-size:0.9rem; color:var(--text-muted); margin-bottom:1.5rem; padding:1rem; background:rgba(255,255,255,0.03); border-radius:12px; font-style:italic; position: relative; z-index: 2;">
                ${I.strategy}
            </p>
            ${h(I.pokemon)}
         </div>
       `).join("")}
    </div>

    <!-- MOs / MTs -->
    <div id="tab-items" class="tab-content hidden">
       <div class="emulator-box" style="margin-bottom:2rem;">
        <h3 style="margin-bottom:1.5rem;">üíø M√°quinas Ocultas (MO)</h3>
        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:1rem;">
          ${Yb.map(I=>`
            <div class="recommendation-card" style="margin:0; cursor:default; border-left:3px solid var(--primary-color);">
              <div style="background:var(--primary-color); color:black; font-weight:bold; width:32px; height:32px; display:flex; align-items:center; justify-content:center; border-radius:8px;">HM</div>
              <div>
                  <div style="color:var(--text-main); font-weight:700; font-size:1rem;">${I.name}</div>
                  <div style="font-size:0.85rem; color:var(--text-muted);">üìç ${I.location}</div>
              </div>
            </div>
          `).join("")}
        </div>
      </div>

      <div class="emulator-box">
        <h3 style="margin-bottom:1.5rem;">üíø M√°quinas T√©cnicas (MT) Importantes</h3>
         <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:1rem;">
          ${Zb.map(I=>`
            <div class="recommendation-card" style="margin:0; cursor:default; border-left:3px solid var(--ray-yellow);">
              <div style="background:var(--ray-yellow); color:black; font-weight:bold; width:32px; height:32px; display:flex; align-items:center; justify-content:center; border-radius:8px;">TM</div>
              <div>
                  <div style="color:var(--text-main); font-weight:700; font-size:1rem;">${I.name}</div>
                  <div style="font-size:0.85rem; color:var(--text-muted);">üìç ${I.location}</div>
              </div>
            </div>
          `).join("")}
        </div>
      </div>
    </div>

    <!-- ITEM DEX (SEARCHABLE) -->
    <div id="tab-held" class="tab-content hidden">
       <div style="max-width:600px; margin:0 auto 2rem auto; position:relative;">
          <input type="text" id="item-search" class="search-input" placeholder="Buscar objeto..." style="padding-left: 3.5rem; height:3.5rem; font-size:1.2rem;">
          <span style="position:absolute; left:1.2rem; top:50%; transform:translateY(-50%); font-size:1.4rem; opacity:0.5;">üîç</span>
       </div>
       <div id="item-dex-container" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap:1rem; padding-bottom:2rem;">
           <!-- Items Injected Here -->
       </div>
    </div>

    <!-- SAVE SCANNER -->
    <div id="tab-scanner" class="tab-content hidden">
        <div id="save-scanner-root"></div>
    </div>
  `;const g=document.getElementById("item-search");g&&(g.addEventListener("input",I=>{const R=I.target.value.toLowerCase(),C=Mr.filter(L=>L.name.toLowerCase().includes(R)||L.category.toLowerCase().includes(R)||L.desc.toLowerCase().includes(R)||L.loc.toLowerCase().includes(R));s(C)}),s(Mr));const E=document.querySelectorAll(".guide-tab"),S=document.querySelectorAll(".tab-content");E.forEach(I=>{I.addEventListener("click",()=>{if(I.id==="scanner-btn"){E.forEach(R=>R.classList.remove("active")),S.forEach(R=>R.classList.add("hidden")),I.classList.add("active"),document.getElementById("tab-scanner").classList.remove("hidden"),aw();return}E.forEach(R=>R.classList.remove("active")),S.forEach(R=>R.classList.add("hidden")),I.classList.add("active"),document.getElementById(`tab-${I.dataset.tab}`).classList.remove("hidden")})})}const Xe=["Normal","Fuego","Agua","El√©ctrico","Planta","Hielo","Lucha","Veneno","Tierra","Volador","Ps√≠quico","Bicho","Roca","Fantasma","Drag√≥n","Siniestro","Acero"],pi=[[1,1,1,1,1,1,1,1,1,1,1,1,.5,0,1,1,.5],[1,.5,.5,1,2,2,1,1,1,1,1,2,.5,1,.5,1,2],[1,2,.5,1,.5,1,1,1,2,1,1,1,2,1,.5,1,1],[1,1,2,.5,.5,1,1,1,0,2,1,1,1,1,.5,1,1],[1,.5,2,1,.5,1,1,.5,2,.5,1,.5,2,1,.5,1,.5],[1,.5,.5,1,2,.5,1,1,2,2,1,1,1,1,2,1,.5],[2,1,1,1,1,2,1,.5,1,.5,.5,.5,2,0,1,2,2],[1,1,1,1,2,1,1,.5,.5,1,1,1,.5,.5,1,1,0],[1,2,1,2,.5,1,1,2,1,0,1,.5,2,1,1,1,2],[1,1,1,.5,2,1,2,1,1,1,1,2,.5,1,1,1,.5],[1,1,1,1,1,1,2,2,1,1,.5,1,1,1,1,0,.5],[1,.5,1,1,2,1,.5,.5,1,.5,2,1,1,.5,1,2,.5],[1,2,1,1,1,2,.5,1,.5,2,1,2,1,1,1,1,.5],[0,1,1,1,1,1,1,1,1,1,2,1,1,2,1,.5,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,.5],[1,1,1,1,1,1,.5,1,1,1,2,1,1,2,1,.5,.5],[1,.5,.5,.5,1,2,1,1,1,1,1,1,2,1,1,1,.5]];let gi=[];function lw(){return Le().slots.filter(e=>e!==null)}let ym="search",Ze=[];async function bu(){const n=document.getElementById("calculator");if(!n)return;if(n.innerHTML=`
    <h2>Calculadora de Tipos</h2>
    
    <div class="calculator-container" style="max-width:1200px;">
      
      <!-- Mode Tabs -->
      <div class="calc-toggle-container" style="display:flex; justify-content:center; gap:1rem; margin-bottom:2rem;">
         <button id="mode-search" class="calc-tab active" onclick="switchCalcMode('search')">üîç Por Nombre</button>
         <button id="mode-manual" class="calc-tab" onclick="switchCalcMode('manual')">‚ö° Selector de Tipos</button>
      </div>

      <!-- SEARCH MODE -->
      <div id="calc-search-panel" style="max-width:600px; margin:0 auto 2rem auto; position:relative; z-index:50;">
        <div class="calc-search-box" style="position:relative;">
             <input type="text" id="poke-search" class="search-input" placeholder="Buscar Pok√©mon rival (ej. Milotic...)" autocomplete="off" style="padding-left: 3.5rem; height:3.5rem; font-size:1.2rem;">
             <span style="position:absolute; left:1.2rem; top:50%; transform:translateY(-50%); font-size:1.4rem; opacity:0.5;">üîç</span>
             <div id="search-suggestions" style="position:absolute; width:100%; top:110%; left:0; max-height:300px; overflow-y:auto; background:var(--ray-charcoal); border:1px solid var(--glass-border); display:none; border-radius: 12px; box-shadow:0 10px 40px rgba(0,0,0,0.5);"></div>
        </div>
      </div>

      <!-- MANUAL MODE -->
      <div id="calc-manual-panel" style="display:none; max-width:800px; margin:0 auto 2rem auto;">
         <div class="manual-type-selector" style="background:rgba(0,0,0,0.2); border-radius:16px; padding:1.5rem; border:1px solid var(--glass-border);">
            <h3 style="text-align:center; margin-bottom:1rem; color:var(--text-muted);">Selecciona los tipos del Defensor (M√°x 2)</h3>
            <div id="type-grid" style="display:flex; flex-wrap:wrap; gap:0.5rem; justify-content:center;">
               ${Xe.map(r=>`
                  <button class="type-pill type-${r.toLowerCase()} manual-type-btn" 
                          onclick="toggleManualType('${r}')"
                          style="opacity:0.6; filter:grayscale(0.4); transition:all 0.2s; border:2px solid transparent;">
                     ${Da(r)}
                  </button>
               `).join("")}
            </div>
            <div class="manual-actions" style="margin-top:1.5rem; text-align:center;">
               <button onclick="clearManualTypes()" style="background:rgba(255,255,255,0.1); border:none; color:var(--text-muted); padding:0.5rem 1rem; border-radius:8px; cursor:pointer;">Limpiar</button>
            </div>
         </div>
      </div>

      <!-- Results Area -->
      <div id="calc-results" class="results-panel" style="display:none; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap:2rem;">
        
        <!-- Left Col: Weakness Chart -->
        <div class="glass-panel" style="display:flex; flex-direction:column; gap:1.5rem;">
           <div id="enemy-header" style="text-align:center;"></div>
           <div id="weakness-info" style="display:flex; flex-direction:column; gap:1rem;"></div>
        </div>

        <!-- Right Col: Team Suggestions -->
        <div class="glass-panel" style="display:flex; flex-direction:column;">
          <h3 style="margin-bottom:1.5rem; padding-bottom:1rem; border-bottom:1px solid var(--glass-border); display:flex; align-items:center; gap:0.5rem;">
             <span>üõ°Ô∏è</span> An√°lisis de tu Equipo
          </h3>
          <div id="team-analysis" style="display:grid; gap:0.75rem;"></div>
        </div>

      </div>
    </div>
  `,switchCalcMode(ym),gi.length===0)try{gi=(await(await fetch("https://pokeapi.co/api/v2/pokemon?limit=1000")).json()).results}catch(r){console.error("Error fetching pokemon",r)}const e=document.getElementById("poke-search"),t=document.getElementById("search-suggestions");e.addEventListener("input",r=>{const a=r.target.value.toLowerCase();if(t.innerHTML="",a.length<2){t.style.display="none";return}const i=gi.filter(s=>s.name.includes(a)).slice(0,8);i.length>0?(t.style.display="block",t.innerHTML=i.map(s=>{const d=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${s.url.split("/")[6]}.png`;return`
                <div class="suggestion-item" data-url="${s.url}" style="padding:0.75rem 1rem; cursor:pointer; border-bottom:1px solid var(--glass-border); color:var(--text-main); transition:0.2s; font-size:1rem; display:flex; align-items:center; gap:1rem;">
                    <img src="${d}" alt="${s.name}" style="width:40px; height:40px; object-fit:contain;">
                    <span style="font-weight:600;">${s.name.charAt(0).toUpperCase()+s.name.slice(1)}</span>
                </div>
              `}).join(""),document.querySelectorAll(".suggestion-item").forEach(s=>{s.addEventListener("click",()=>{e.value=s.textContent.trim(),t.style.display="none",uw(s.dataset.url)}),s.addEventListener("mouseenter",()=>s.style.background="var(--glass-shine)"),s.addEventListener("mouseleave",()=>s.style.background="transparent")})):t.style.display="none"}),document.addEventListener("click",r=>{r.target.closest(".calc-search-box")||(t.style.display="none")})}window.switchCalcMode=n=>{ym=n,document.querySelectorAll(".calc-tab").forEach(a=>a.classList.remove("active")),document.getElementById(`mode-${n}`).classList.add("active");const e=document.getElementById("calc-search-panel"),t=document.getElementById("calc-manual-panel"),r=document.getElementById("calc-results");n==="search"?(e.style.display="block",t.style.display="none",r.style.display="none"):(e.style.display="none",t.style.display="block",r.style.display="none",clearManualTypes())};window.toggleManualType=n=>{if(Ze.includes(n))Ze=Ze.filter(e=>e!==n);else{if(Ze.length>=2)return;Ze.push(n)}vm()};window.clearManualTypes=()=>{Ze=[],vm()};function vm(){document.querySelectorAll(".manual-type-btn").forEach(n=>{const e=Array.from(n.classList).find(r=>r.startsWith("type-")&&r!=="type-pill"),t=Xe.find(r=>`type-${r.toLowerCase()}`===e);Ze.includes(t)?(n.style.opacity="1",n.style.filter="none",n.style.boxShadow="0 0 15px rgba(255,255,255,0.4)",n.style.transform="scale(1.1)",n.style.border="2px solid white"):(n.style.opacity="0.5",n.style.filter="grayscale(0.6)",n.style.boxShadow="none",n.style.transform="scale(1)",n.style.border="2px solid transparent")}),Ze.length>0?Em(Ze,"Manual Selection",null):document.getElementById("calc-results").style.display="none"}async function uw(n){const e=document.getElementById("calc-results"),t=document.getElementById("enemy-header");e.style.display="grid",t.innerHTML='<div style="padding:2rem;">Cargando datos...</div>';try{const a=await(await fetch(n)).json(),i=a.id,s=a.types.map(l=>{const d=l.type.name.charAt(0).toUpperCase()+l.type.name.slice(1);return Au[d]||d});Em(s,a.name.toUpperCase(),a.sprites.front_default,i)}catch(r){console.error(r),t.innerHTML="Error cargando detalles."}}function Em(n,e,t,r=null){const a=document.getElementById("calc-results"),i=document.getElementById("enemy-header"),s=document.getElementById("weakness-info"),l=document.getElementById("team-analysis");a.style.display="grid";let d="";t?d+=`
          <div style="position:relative; width:120px; height:120px; margin:0 auto; cursor:pointer;" 
               class="clickable"
               onclick="openPokemonModal(${r})">
             <div style="position:absolute; inset:0; background:var(--primary-glow); filter:blur(40px); opacity:0.2; border-radius:50%;"></div>
             <img src="${t}" style="width:100%; height:100%; position:relative; z-index:1; image-rendering:pixelated; transform:scale(1.2);">
          </div>
          <h2 style="margin:0.5rem 0 1rem 0; color:var(--text-main); font-size:1.8rem; height: auto;">${e}</h2>
        `:d+='<h2 style="margin:0 0 1rem 0; color:var(--text-main); font-size:1.5rem;">Defensor</h2>',d+=`<div class="poke-types" style="justify-content:center; gap:0.5rem; margin-bottom:1rem;">
      ${n.map(I=>`<span class="type-pill type-${I.toLowerCase()}" style="padding:0.3rem 1rem; font-size:1rem;">${Da(I)}</span>`).join("")}
    </div>`,i.innerHTML=d;const h={};Xe.forEach(I=>{let R=1;n.forEach(C=>{const L=Xe.indexOf(I),z=Xe.indexOf(C);L!==-1&&z!==-1&&(R*=pi[L][z])}),h[I]=R});const m={4:[],2:[],1:[],"0.5":[],"0.25":[],0:[]};Object.entries(h).forEach(([I,R])=>{R===4?m[4].push(I):R===2?m[2].push(I):R===1?m[1].push(I):R===.5?m["0.5"].push(I):R===.25?m["0.25"].push(I):R===0&&m[0].push(I)});let g=`
      <div class="eff-grid" style="display:grid; gap:1rem;">
    `;const E=(I,R,C)=>C.length===0?"":`
         <div class="eff-row" style="background:rgba(255,255,255,0.03); border-radius:12px; padding:0.8rem; border-left:4px solid ${R};">
            <div style="font-weight:700; color:${R}; font-size:0.9rem; margin-bottom:0.5rem;">${I}</div>
            <div style="display:flex; flex-wrap:wrap; gap:0.5rem;">
               ${C.map(L=>`<span class="type-badge-modern type-${L.toLowerCase()}" style="font-size:0.8rem; padding:4px 8px; text-transform:uppercase;">${Da(L)}</span>`).join("")}
            </div>
         </div>
        `;m[4].length&&(g+=E("S√∫per eficaz (x4)","#ef4444",m[4])),m[2].length&&(g+=E("Eficaz (x2)","#f97316",m[2])),m["0.5"].length&&(g+=E("Poco eficaz (x0.5)","#3b82f6",m["0.5"])),m["0.25"].length&&(g+=E("Muy poco eficaz (x0.25)","#6366f1",m["0.25"])),m[0].length&&(g+=E("Inmune (x0)","#64748b",m[0])),g+="</div>",s.innerHTML=g;const S=lw();if(S.length===0)l.innerHTML='<div style="text-align:center; color:var(--text-muted); padding:2rem;">A√±ade Pok√©mon a tu equipo para ver sugerencias.</div>';else{const I={normal:"Normal",fire:"Fuego",water:"Agua",electric:"El√©ctrico",grass:"Planta",ice:"Hielo",fighting:"Lucha",poison:"Veneno",ground:"Tierra",flying:"Volador",psychic:"Ps√≠quico",bug:"Bicho",rock:"Roca",ghost:"Fantasma",dragon:"Drag√≥n",dark:"Siniestro",steel:"Acero",fairy:"Hada"},R=S.map(C=>{let L={name:"Ninguno",displayName:"Sin movimiento efectivo",mod:0,typeES:null};(C.moves?C.moves.filter(H=>H):[]).forEach(H=>{if(H.category==="Status"||H.damageClass==="status")return;const Q=I[H.type?.toLowerCase()]||H.type;let b=1;n.forEach(w=>{const _=Xe.indexOf(Q),A=Xe.indexOf(w);_!==-1&&A!==-1&&(b*=pi[_][A])});const v=C.types.map(w=>{const _=typeof w=="string"?w:w?.english||w?.spanish||"";return I[_?.toLowerCase()]||_}).includes(Q);v&&(b*=1.5),b>L.mod&&(L={name:H.name,displayName:H.displayName||H.name,mod:b,type:H.type,typeES:Q,typeTranslated:H.typeTranslated||Q,hasSTAB:v})});let $=0;const Y=C.types.map(H=>{const Q=typeof H=="string"?H:H?.english||H?.spanish||"";return I[Q?.toLowerCase()]||Q});return n.forEach(H=>{let Q=1;Y.forEach(b=>{const f=Xe.indexOf(H),v=Xe.indexOf(b);f!==-1&&v!==-1&&(Q*=pi[f][v])}),Q>$&&($=Q)}),{member:C,bestMove:L,maxReceiveMod:$}});R.sort((C,L)=>L.bestMove.mod!==C.bestMove.mod?L.bestMove.mod-C.bestMove.mod:C.maxReceiveMod-L.maxReceiveMod),l.innerHTML=R.map((C,L)=>{let z="transparent",$="rgba(255,255,255,0.03)",Y="";L===0&&C.bestMove.mod>=2?(z="#22c55e",$="rgba(34, 197, 94, 0.15)",Y='<span style="background:#22c55e; color:#000; font-size:0.65rem; padding:0.15rem 0.5rem; border-radius:4px; font-weight:700; margin-left:0.5rem;">‚≠ê MEJOR</span>'):C.bestMove.mod>=2?(z="var(--primary-color)",$="rgba(var(--primary-rgb), 0.1)"):C.maxReceiveMod>=2&&(z="var(--ray-red)",$="rgba(244, 63, 94, 0.05)");const H=C.bestMove.typeTranslated||C.bestMove.typeES||"???",Q=C.bestMove.type?`type-${C.bestMove.type.toLowerCase()}`:"";return`
            <div class="recommendation-card clickable" 
                 style="border-left: 3px solid ${z}; background:${$}; padding:0.75rem 1rem; margin:0; display:flex; align-items:center; gap:1rem; cursor:pointer;"
                 onclick="openPokemonModal(${C.member.id})">
              <img src="${C.member.image}" style="width:48px; height:48px; object-fit:contain; filter:drop-shadow(0 2px 5px rgba(0,0,0,0.5)); transform:scale(1.1);">
              
              <div style="flex:1;">
                <div style="font-weight:700; font-size:1rem; color:var(--text-main); margin-bottom:0.2rem; display:flex; align-items:center;">
                    ${C.member.name}${Y}
                </div>
                ${C.bestMove.mod>=1?`<div style="font-size:0.85rem; color:var(--text-muted); display:flex; align-items:center; gap:0.4rem;">
                        Usa <span style="color:#fff; font-weight:600;">${C.bestMove.displayName}</span>
                        <span class="type-pill ${Q}" style="padding:0.1rem 0.4rem; font-size:0.65rem;">${H}</span>
                        <span style="background:rgba(0,0,0,0.3); padding:0 4px; border-radius:4px; font-size:0.75rem;">x${C.bestMove.mod.toFixed(1)}</span>
                       </div>`:'<div style="font-size:0.85rem; color:var(--text-muted);">Sin movimientos efectivos</div>'}
              </div>

              <div style="text-align:right;">
                 ${C.maxReceiveMod>=2?`<div style="color:var(--ray-red); font-size:0.8rem; font-weight:600; display:flex; flex-direction:column; align-items:flex-end;"><span>‚ö†Ô∏è Recibe</span><span>x${C.maxReceiveMod}</span></div>`:'<div style="color:var(--primary-color); font-size:0.8rem; font-weight:600;">üõ°Ô∏è Seguro</div>'}
              </div>
            </div>
          `}).join("")}}let js=null,Hs=!1;function _m(){if(document.getElementById("pokemon-detail-modal"))return;const n=document.createElement("div");n.id="pokemon-detail-modal",n.className="pokemon-modal-container hidden",n.innerHTML=`
    <div class="pokemon-modal-backdrop"></div>
    <div class="pokemon-modal">
      <button class="pokemon-modal-close" aria-label="Cerrar">‚úï</button>
      <div class="pokemon-modal-content">
        <!-- Content loaded dynamically -->
      </div>
    </div>
  `,document.body.appendChild(n);const e=n.querySelector(".pokemon-modal-backdrop"),t=n.querySelector(".pokemon-modal-close");e.addEventListener("click",Ra),t.addEventListener("click",Ra),document.addEventListener("keydown",r=>{r.key==="Escape"&&Hs&&Ra()})}async function dw(n){if(!n)return;document.getElementById("pokemon-detail-modal")||_m();const t=document.getElementById("pokemon-detail-modal"),r=t.querySelector(".pokemon-modal-content");js=n,Hs=!0,t.classList.remove("hidden"),document.body.style.overflow="hidden",r.innerHTML=hw();const i=ye()===Re.PLATINUM?Ma.platinum:Ma.emerald;try{const s=await Ru(n,i);r.innerHTML=await pw(s,i),Ew()}catch(s){console.error("Error loading Pokemon details:",s),r.innerHTML=mw()}}function Ra(){const n=document.getElementById("pokemon-detail-modal");n&&(n.classList.add("hidden"),document.body.style.overflow="",Hs=!1,js=null)}function hw(){return`
    <div class="pokemon-modal-loading">
      <div class="skeleton-header">
        <div class="skeleton skeleton-sprite"></div>
        <div class="skeleton-info">
          <div class="skeleton skeleton-title"></div>
          <div class="skeleton skeleton-types"></div>
        </div>
      </div>
      <div class="skeleton skeleton-stats"></div>
      <div class="skeleton skeleton-evolution"></div>
      <div class="skeleton skeleton-learnset"></div>
    </div>
  `}function mw(){return`
    <div class="pokemon-modal-error">
      <span class="error-icon">‚ö†Ô∏è</span>
      <h3>Error al cargar datos</h3>
      <p>No se pudo obtener la informaci√≥n del Pok√©mon. Verifica tu conexi√≥n a internet.</p>
      <button onclick="closePokemonModal()" class="retry-btn">Cerrar</button>
    </div>
  `}async function pw(n,e){const t=e==="platinum"?"Platino":"Esmeralda";return`
    <div class="pokemon-modal-header">
      <div class="pokemon-sprite-container">
        <img src="${n.spriteAnimated||n.sprite}" alt="${n.name}" class="pokemon-sprite-large">
        <span class="pokemon-id">#${String(n.id).padStart(3,"0")}</span>
      </div>
      <div class="pokemon-header-info">
        <h2 class="pokemon-modal-name">${n.name}</h2>
        <div class="pokemon-modal-types">
          ${n.types.map(a=>`
            <span class="type-pill type-${a}">${Ln[a]||a}</span>
          `).join("")}
        </div>
        <p class="pokemon-flavor-text">${n.flavorText||"Sin descripci√≥n disponible."}</p>
      </div>
    </div>
    
    <div class="pokemon-modal-section">
      <h3 class="section-title">üìä Estad√≠sticas Base</h3>
      <div class="pokemon-stats-grid">
        ${hn("PS",n.stats.hp,"#ff5555")}
        ${hn("Ataque",n.stats.attack,"#f5ac78")}
        ${hn("Defensa",n.stats.defense,"#fae078")}
        ${hn("At. Esp.",n.stats.spAttack,"#9db7f5")}
        ${hn("Def. Esp.",n.stats.spDefense,"#a7db8d")}
        ${hn("Velocidad",n.stats.speed,"#fa92b2")}
      </div>
      <div class="stats-total">
        <span>Total:</span>
        <strong>${Object.values(n.stats).reduce((a,i)=>a+i,0)}</strong>
      </div>
    </div>
    
    <div class="pokemon-modal-section">
      <h3 class="section-title">üîÑ Cadena Evolutiva</h3>
      <div class="evolution-chain-container">
        ${gw(n.evolutionChain,n.id)}
      </div>
    </div>
    
    <div class="pokemon-modal-section">
      <h3 class="section-title">üìñ Movimientos por Nivel <span class="version-badge">${t}</span></h3>
      <div class="learnset-container">
        ${await yw(n.learnset)}
      </div>
    </div>
    
    <div class="pokemon-modal-section pokemon-details-extra">
      <div class="detail-item">
        <span class="detail-label">Altura</span>
        <span class="detail-value">${n.height} m</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Peso</span>
        <span class="detail-value">${n.weight} kg</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Habilidades</span>
        <span class="detail-value">${n.abilities.map(a=>sp(a.name)+(a.isHidden?" (oculta)":"")).join(", ")}</span>
      </div>
    </div>
  `}function hn(n,e,t){const a=Math.min(e/255*100,100);return`
    <div class="stat-row">
      <span class="stat-label">${n}</span>
      <div class="stat-bar-container">
        <div class="stat-bar" style="width: ${a}%; background: ${t};"></div>
      </div>
      <span class="stat-value">${e}</span>
    </div>
  `}function gw(n,e){return!n||n.length===0?'<p class="no-evolution">Este Pok√©mon no evoluciona.</p>':n.length===1?'<p class="no-evolution">Este Pok√©mon no tiene evoluciones.</p>':`
    <div class="evolution-chain">
      ${n.map((t,r)=>{const a=t.id===e,i=pp(t.id),s=i?i.method:fw(t.evolutionDetails),l=i?i.explanation:"";return`
          ${r>0?`
            <div class="evolution-arrow" ${l?`title="${l}"`:""}>
              <span class="arrow-icon">‚Üí</span>
              <span class="evolution-method">${s}</span>
            </div>
          `:""}
          <div class="evolution-pokemon ${a?"active":""}" 
               onclick="openPokemonModal(${t.id})"
               data-pokemon-id="${t.id}"
               ${l?`title="${l}"`:""}>
            <img src="${t.sprite}" alt="${t.name}" class="evolution-sprite">
            <span class="evolution-name">${Je(t.name)}</span>
          </div>
        `}).join("")}
    </div>
  `}function fw(n){if(!n)return"";const e=[];if(n.trigger==="trade"?(e.push("üîÑ Intercambio"),n.heldItem&&e.push(`+ ${lp(n.heldItem)}`)):n.trigger==="use-item"&&n.item?e.push(`üíé ${cp(n.item)}`):n.minLevel&&e.push(`Nv. ${n.minLevel}`),n.minHappiness&&e.push("‚ù§Ô∏è Felicidad alta"),n.timeOfDay==="day"?e.push("‚òÄÔ∏è De d√≠a"):n.timeOfDay==="night"&&e.push("üåô De noche"),n.location&&e.push(`üìç ${up(n.location)}`),n.knownMove&&e.push(`Saber ${Je(n.knownMove)}`),n.knownMoveType){const t=Ln[n.knownMoveType]||n.knownMoveType;e.push(`Mov. tipo ${t}`)}return n.minAffection&&e.push("üíï Afecto alto"),e.length===0?n.trigger?dp(n.trigger):"Evoluciona":e.join(" ")}async function yw(n){if(!n||n.length===0)return'<p class="no-moves">No hay movimientos disponibles para esta versi√≥n.</p>';const e=n.slice(0,15),t=n.slice(15);return`
    <table class="learnset-table">
      <thead>
        <tr>
          <th>Nv.</th>
          <th>Movimiento</th>
          <th>Tipo</th>
          <th>Cat.</th>
          <th>Poder</th>
          <th>Prec.</th>
        </tr>
      </thead>
      <tbody>
        ${(await Promise.all(e.map(async a=>{const i=await oo(a.name);return{...a,details:i}}))).map(a=>bm(a)).join("")}
        ${t.length>0?`
          <tr class="load-more-row">
            <td colspan="6">
              <button class="load-more-btn" data-remaining='${JSON.stringify(t.map(a=>a.name))}'>
                Cargar ${t.length} movimientos m√°s...
              </button>
            </td>
          </tr>
        `:""}
      </tbody>
    </table>
  `}function bm(n){const e=hp(n.name);if(!n.details)return`
      <tr>
        <td>${n.level}</td>
        <td>${e}</td>
        <td colspan="4">-</td>
      </tr>
    `;const{details:t}=n,r=`type-${t.type}`,a=vw(t.damageClass);return`
    <tr class="move-row" title="${t.description}">
      <td class="move-level">${n.level}</td>
      <td class="move-name">${e}</td>
      <td><span class="type-mini ${r}">${Ln[t.type]||t.type}</span></td>
      <td class="move-category">${a}</td>
      <td class="move-power">${t.power||"‚Äî"}</td>
      <td class="move-accuracy">${t.accuracy?t.accuracy+"%":"‚Äî"}</td>
    </tr>
  `}function vw(n){const e={physical:"üí•",special:"‚ú®",status:"üìä"};return`<span title="${Du[n]||n}">${e[n]||"?"}</span>`}function Ew(){const n=document.querySelector(".load-more-btn");n&&n.addEventListener("click",async e=>{const t=e.target,r=JSON.parse(t.dataset.remaining);t.textContent="Cargando...",t.disabled=!0;try{const a=await Promise.all(r.map(async m=>{const g=await oo(m);return{name:m,level:"?",details:g}})),s=ye()===Re.PLATINUM?Ma.platinum:Ma.emerald,l=await Ru(js,s),d=a.map(m=>{const g=l.learnset.find(E=>E.name===m.name);return m.level=g?.level||"?",bm(m)}).join(""),h=document.querySelector(".load-more-row");h.insertAdjacentHTML("beforebegin",d),h.remove()}catch(a){console.error("Error loading more moves:",a),t.textContent="Error - Reintentar",t.disabled=!1}})}window.openPokemonModal=dw;window.closePokemonModal=Ra;let to=!1;function _w(n="auth-container"){const e=document.getElementById(n);e&&(Tb(t=>{wu(e,t),t?bw(t):to=!1}),wu(e,null))}async function bw(n){if(!to){to=!0;try{const e=await Ls(n.uid),t=ye(),r=e.filter(a=>a.game===t);if(Os(),r.length===0)return;$n(r),!Ro()&&r.length>0&&jn(r[0].id),window.dispatchEvent(new CustomEvent("teamListUpdated")),window.dispatchEvent(new CustomEvent("teamChanged"))}catch(e){console.warn("[Auth] Failed to sync teams from cloud:",e)}}}function wu(n,e){if(e){const t=Pb(),r={uid:e.uid,displayName:e.displayName||t?.displayName||"Usuario",email:e.email||t?.email||"",photoURL:e.photoURL||t?.photoURL||null},a=r.displayName,i=r.email||"",s=r.photoURL;n.innerHTML=`
      <div class="auth-user-profile">
        <button class="auth-profile-btn" onclick="toggleAuthDropdown(event)">
          ${s?`<img src="${s}" alt="Avatar" class="auth-avatar" referrerpolicy="no-referrer">`:`<div class="auth-avatar-placeholder">${a.charAt(0).toUpperCase()}</div>`}
          <span class="auth-user-name">${a}</span>
          <svg class="auth-chevron" width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
            <path d="M2.5 4.5L6 8L9.5 4.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </button>
        <div class="auth-dropdown hidden" id="auth-dropdown">
          <div class="auth-dropdown-header">
            <span class="auth-dropdown-email">${i}</span>
          </div>
          <div class="auth-dropdown-divider"></div>
          <button class="auth-dropdown-item" onclick="handleSignOut()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
              <polyline points="16 17 21 12 16 7"/>
              <line x1="21" y1="12" x2="9" y2="12"/>
            </svg>
            Cerrar sesi√≥n
          </button>
        </div>
      </div>
    `}else n.innerHTML=`
      <button class="auth-login-btn" onclick="handleGoogleLogin(event)">
        <svg class="google-icon" viewBox="0 0 24 24" width="18" height="18">
          <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
          <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
          <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
        </svg>
        <span>Iniciar sesi√≥n</span>
      </button>
    `}window.handleGoogleLogin=async function(n){n&&(n.preventDefault(),n.stopPropagation());const e=await wb();if(e){console.log("[Auth] User logged in:",e.uid);const t=Ft(),r={selectedGame:ye()},a=await Ls(e.uid),i=ye(),s=a.filter(l=>l.game===i);console.log("[Auth] Cloud teams:",s.length,"| Local teams:",t.length),s.length>0?(console.log("[Auth] Loading cloud teams:",s.length),Os(),$n(s),s.length>0&&jn(s[0].id)):t.length>0&&(console.log("[Auth] Migrating local teams to cloud..."),await Sb(e.uid,t,r)),console.log("[Auth] Refreshing UI..."),window.dispatchEvent(new CustomEvent("teamListUpdated")),window.dispatchEvent(new CustomEvent("teamChanged")),window.location.reload()}};window.handleSignOut=async function(){await Ab(),to=!1,Os(),window.location.reload();const n=document.getElementById("auth-dropdown");n&&n.classList.add("hidden")};window.toggleAuthDropdown=function(n){n.stopPropagation();const e=document.getElementById("auth-dropdown");e&&e.classList.toggle("hidden")};document.addEventListener("click",n=>{const e=document.getElementById("auth-dropdown");e&&!n.target.closest(".auth-user-profile")&&e.classList.add("hidden")});document.addEventListener("DOMContentLoaded",()=>{Iu(ye()),_m(),_w(),br(),vu(),_u(),bu();const n=document.getElementById("page-title");n&&(n.textContent=ye()===Re.PLATINUM?"Gu√≠a Pok√©mon Platino":"Gu√≠a Pok√©mon Esmeralda");const e=document.querySelectorAll("header nav .nav-btn"),t=document.querySelectorAll(".section");e.forEach(m=>{m.addEventListener("click",()=>{e.forEach(E=>E.classList.remove("active")),t.forEach(E=>E.classList.remove("active")),m.classList.add("active");const g=m.getAttribute("data-target");document.getElementById(g).classList.add("active")})});const r=document.getElementById("game-selector"),a=document.getElementById("game-selector-icon"),i=document.getElementById("game-modal"),s=document.querySelector(".game-modal-backdrop"),l=document.querySelectorAll(".game-option-card"),d=ye(),h={emerald:"https://cdn2.steamgriddb.com/icon_thumb/5d12d5a76a9683536eb23a6a1c9767cc.png",platinum:"https://cdn2.steamgriddb.com/icon_thumb/691f73fdf1c5edeb3f600c515715a358.png"};a&&(a.src=h[d],a.alt=d===Re.PLATINUM?"Pok√©mon Platino":"Pok√©mon Esmeralda"),r&&r.addEventListener("click",m=>{m.stopPropagation(),i.classList.remove("hidden")}),s&&s.addEventListener("click",()=>{i.classList.add("hidden")}),window.addEventListener("gameChanged",m=>{const g=m.detail,E=document.getElementById("page-title");E&&(E.textContent=g===Re.PLATINUM?"Gu√≠a Pok√©mon Platino":"Gu√≠a Pok√©mon Esmeralda"),a&&(a.src=h[g],a.alt=g===Re.PLATINUM?"Pok√©mon Platino":"Pok√©mon Esmeralda"),br(),vu(),_u(),bu()}),l.forEach(m=>{m.addEventListener("click",()=>{const g=m.getAttribute("data-game");Ym(g),i.classList.add("hidden")})}),document.addEventListener("keydown",m=>{m.key==="Escape"&&!i.classList.contains("hidden")&&i.classList.add("hidden")})});
