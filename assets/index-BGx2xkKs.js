(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();const F={swampert:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Cascada",type:"Agua",category:"F√≠sico"}],gardevoir:[{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Paz Mental",type:"Ps√≠quico",category:"Estado"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"}],breloom:[{name:"Espora",type:"Planta",category:"Estado"},{name:"Gancho Alto",type:"Lucha",category:"F√≠sico"},{name:"Giga Drenado",type:"Planta",category:"Especial"},{name:"Corpulencia",type:"Lucha",category:"Estado"}],manectric:[{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Mordisco",type:"Siniestro",category:"Especial"},{name:"Onda Trueno",type:"El√©ctrico",category:"Estado"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"}],flygon:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Avalancha",type:"Roca",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Vuelo",type:"Volador",category:"F√≠sico"}],salamence:[{name:"Vuelo",type:"Volador",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"}],blaziken:[{name:"Patada de Fuego",type:"Fuego",category:"F√≠sico"},{name:"Patada Alta",type:"Lucha",category:"F√≠sico"},{name:"Piedra Fr√≠a",type:"Hielo",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"}],metagross:[{name:"Meteoro",type:"Acero",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"}],milotic:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Descanso",type:"Ps√≠quico",category:"Estado"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"}],altaria:[{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Psicocarga",type:"Ps√≠quico",category:"Especial"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Danza Drag√≥n",type:"Drag√≥n",category:"Estado"}],aggron:[{name:"Cabezazo",type:"Acero",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Potencia",type:"Roca",category:"F√≠sico"},{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"}],rayquaza:[{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Avinazo",type:"Volador",category:"F√≠sico"}],groudon:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Sequia",type:"Fuego",category:"Estado"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"}],kyogre:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Lluvia",type:"Agua",category:"Estado"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"}],kingdra:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Lluvia",type:"Agua",category:"Estado"}],gyarados:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Mordedura",type:"Siniestro",category:"F√≠sico"},{name:"Avalancha",type:"Hielo",category:"F√≠sico"},{name:"Vuelo",type:"Volador",category:"F√≠sico"}],sharpedo:[{name:"Mordedura",type:"Siniestro",category:"F√≠sico"},{name:"Pirueta Ictio",type:"Agua",category:"F√≠sico"},{name:"Niebla",type:"Agua",category:"Estado"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}],sceptile:[{name:"Hoja Afilada",type:"Planta",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}]},Kp=[{id:"difficulty",name:"Por Objetivo",icon:"üéØ"},{id:"thematic",name:"Por Tem√°tica",icon:"üé®"},{id:"mechanic",name:"Por Mec√°nica",icon:"‚öôÔ∏è"}],Qp={competitive:{id:"competitive",name:"üèÜ Competitivo",description:"Equipo √≥ptimo para derrotar al Alto Mando y ser campe√≥n. Balanceado y potente.",category:"difficulty",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Tanque Mixto / L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:F.swampert},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Atacante Especial",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:F.gardevoir},{name:"Breloom",id:286,types:["Planta","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/286.png",location:"Bosque Petalia (Shroomish)",role:"F√≠sico / Espora",item:"Semilla Milagro",nature:"Firme / Alegre",moves:F.breloom},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad Especial",item:"Im√°n",nature:"Modesta / Miedosa",moves:F.manectric},{name:"Flygon",id:330,types:["Tierra","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/330.png",location:"Ruta 111 (Trapinch)",role:"Atacante F√≠sico",item:"Arena Fina",nature:"Firme / Alegre",moves:F.flygon},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Potencia Bruta",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:F.salamence}]},speedrun:{id:"speedrun",name:"‚ö° Speedrun",description:"Pok√©mon r√°pidos y poderosos para terminar el juego velozmente. M√°xima velocidad y power.",category:"difficulty",pokemon:[{name:"Blaziken",id:257,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/257.png",location:"Inicial (Torchic)",role:"Atacante F√≠sico Veloz",item:"Banda Enfoque",nature:"Alegre / Activa",moves:F.blaziken},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad Especial",item:"Im√°n",nature:"Modesta / Miedosa",moves:F.manectric},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Velocidad Drag√≥n",item:"Capa Suave",nature:"P√≠cara / Ingenua",moves:F.altaria},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Velocidad F√≠sica Explosiva",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:F.salamence},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Atacante Mixto R√°pido",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:F.metagross},{name:"Sharpedo",id:319,types:["Agua","Siniestro"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/319.png",location:"Ruta 110 (Carvanha)",role:"Velocidad F√≠sica Agua",item:"Banda Enfoque",nature:"Alegre / Activa",moves:F.sharpedo}]},nuzlocke:{id:"nuzlocke",name:"üíÄ Nuzlocke",description:"Pok√©mon resistentes para sobrevivir a los ataques del Alto Mando. M√°xima defensa.",category:"difficulty",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Tanque Mixto / L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:F.swampert},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Tanque Especial",item:"Banda Defensiva",nature:"Pl√°cida / Prudente",moves:F.milotic},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Tanque Mixto Volador",item:"Capa Suave",nature:"Pl√°cida / Prudente",moves:F.altaria},{name:"Aggron",id:306,types:["Acero","Roca"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/306.png",location:"Ruta 112 (Aron)",role:"Tanque F√≠sico",item:"Armadura Defensiva",nature:"Pl√°cida / Audaz",moves:F.aggron},{name:"Gyarados",id:130,types:["Agua","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/130.png",location:"Ruta 119 (Magikarp)",role:"Tanque Mixto Volador",item:"Escudo Especial",nature:"Pl√°cida / Prudente",moves:F.gyarados},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Acero Defensivo",item:"Lentes de Precisi√≥n",nature:"Prudente / Pl√°cida",moves:F.metagross}]},favorites:{id:"favorites",name:"üåü Favoritos",description:"Los Pok√©mon m√°s queridos de Hoenn. Equipo sentimental pero competitivo.",category:"difficulty",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Estrella Principal",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:F.swampert},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Favorito Especial",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:F.gardevoir},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Legendario",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:F.salamence},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"M√°quina Legendaria",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:F.metagross},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Belleza del Agua",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:F.milotic},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Nube Voladora",item:"Capa Suave",nature:"Pl√°cida / Prudente",moves:F.altaria}]},balanced_team:{id:"balanced_team",name:"‚öñÔ∏è Equipo Balanceado",description:"Cobertura de tipos perfecta. Equipo vers√°til sin starters legendarios.",category:"thematic",pokemon:[{name:"Sceptile",id:254,types:["Planta"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/254.png",location:"Inicial (Treecko)",role:"Velocidad Planta",item:"Banda Enfoque",nature:"Alegre / Activa",moves:F.sceptile},{name:"Crobat",id:169,types:["Veneno","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/169.png",location:"Ruta 110 (Zubat)",role:"Velocidad Volador",item:"Banda Enfoque",nature:"Alegre / Activa",moves:[{name:"Mordisco",type:"Siniestro",category:"F√≠sico"},{name:"Ara√±azo",type:"Normal",category:"F√≠sico"},{name:"Supers√≥nico",type:"Normal",category:"Estado"},{name:"Polvareda",type:"Normal",category:"Estado"}]},{name:"Gyarados",id:130,types:["Agua","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/130.png",location:"Ruta 119 (Magikarp)",role:"F√≠sico Agua",item:"Escudo Especial",nature:"Firme / Alegre",moves:F.gyarados},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad Especial",item:"Im√°n",nature:"Modesta / Miedosa",moves:F.manectric},{name:"Absol",id:359,types:["Siniestro"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/359.png",location:"Ruta 120 (Absol)",role:"F√≠sico Siniestro",item:"Banda Enfoque",nature:"P√≠cara / Alegre",moves:[{name:"Rayo Oscuro",type:"Siniestro",category:"F√≠sico"},{name:"Garra Met√°lica",type:"Acero",category:"F√≠sico"},{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"}]},{name:"Claydol",id:344,types:["Tierra","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/344.png",location:"Ruta 111 (Baltoy)",role:"Tanque Mixto Tierra",item:"Gema Tierra",nature:"Pl√°cida / Audaz",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Avalancha",type:"Hielo",category:"Especial"}]}]},monotype_water:{id:"monotype_water",name:"üíß Monotype Agua",description:"Equipo 100% tipo Agua. Dominio completo de las aguas de Hoenn.",category:"thematic",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Agua L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:F.swampert},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Agua Especial",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:F.milotic},{name:"Kingdra",id:230,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/230.png",location:"Ruta 119 (Horsea)",role:"Agua Drag√≥n",item:"Gema Agua",nature:"Modesta / T√≠mida",moves:F.kingdra},{name:"Gyarados",id:130,types:["Agua","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/130.png",location:"Ruta 119 (Magikarp)",role:"Agua Volador",item:"Escudo Especial",nature:"Pl√°cida / Prudente",moves:F.gyarados},{name:"Sharpedo",id:319,types:["Agua","Siniestro"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/319.png",location:"Ruta 110 (Carvanha)",role:"Agua F√≠sico",item:"Banda Enfoque",nature:"Alegre / Activa",moves:F.sharpedo},{name:"Wailord",id:321,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/321.png",location:"Ruta 110 (Wailmer)",role:"Agua Tanque",item:"Armadura Defensiva",nature:"Pl√°cida / Prudente",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"},{name:"Avalancha",type:"Hielo",category:"F√≠sico"}]}]},monotype_dragon:{id:"monotype_dragon",name:"üêâ Monotype Drag√≥n",description:"Equipo 100% tipo Drag√≥n. Poder absoluto del tipo Drag√≥n.",category:"thematic",pokemon:[{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n L√≠der",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:F.salamence},{name:"Flygon",id:330,types:["Tierra","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/330.png",location:"Ruta 111 (Trapinch)",role:"Drag√≥n Tierra",item:"Arena Fina",nature:"Firme / Alegre",moves:F.flygon},{name:"Rayquaza",id:384,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/384.png",location:"Cascada Meteoro (Rayquaza)",role:"Drag√≥n Legendario",item:"Vida Orbe",nature:"P√≠cara / Activa",moves:F.rayquaza},{name:"Kingdra",id:230,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/230.png",location:"Ruta 119 (Horsea)",role:"Drag√≥n Agua",item:"Gema Agua",nature:"Modesta / T√≠mida",moves:F.kingdra},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Soporte Mixto",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:F.metagross},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Drag√≥n Nube",item:"Capa Suave",nature:"Pl√°cida / Prudente",moves:F.altaria}]},starter_treecko:{id:"starter_treecko",name:"üåø Team Treecko",description:"Equipo basado en Sceptile. Velocidad y precisi√≥n Grass.",category:"thematic",pokemon:[{name:"Sceptile",id:254,types:["Planta"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/254.png",location:"Inicial (Treecko)",role:"Velocidad Planta L√≠der",item:"Banda Enfoque",nature:"Alegre / Activa",moves:F.sceptile},{name:"Breloom",id:286,types:["Planta","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/286.png",location:"Bosque Petalia (Shroomish)",role:"Planta Lucha",item:"Semilla Milagro",nature:"Firme / Alegre",moves:F.breloom},{name:"Flygon",id:330,types:["Tierra","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/330.png",location:"Ruta 111 (Trapinch)",role:"Velocidad Tierra",item:"Arena Fina",nature:"Firme / Alegre",moves:F.flygon},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad El√©ctrico",item:"Im√°n",nature:"Modesta / Miedosa",moves:F.manectric},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Ps√≠quico Especial",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:F.gardevoir},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Volador",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:F.salamence}]},starter_torchic:{id:"starter_torchic",name:"üî• Team Torchic",description:"Equipo basado en Blaziken. Poder f√≠sico y lucha feroz.",category:"thematic",pokemon:[{name:"Blaziken",id:257,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/257.png",location:"Inicial (Torchic)",role:"Fuego Lucha L√≠der",item:"Banda Enfoque",nature:"Alegre / Activa",moves:F.blaziken},{name:"Breloom",id:286,types:["Planta","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/286.png",location:"Bosque Petalia (Shroomish)",role:"Lucha Planta",item:"Semilla Milagro",nature:"Firme / Alegre",moves:F.breloom},{name:"Aggron",id:306,types:["Acero","Roca"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/306.png",location:"Ruta 112 (Aron)",role:"Defensa Acero",item:"Armadura Defensiva",nature:"Pl√°cida / Audaz",moves:F.aggron},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n F√≠sico",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:F.salamence},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"Velocidad El√©ctrico",item:"Im√°n",nature:"Modesta / Miedosa",moves:F.manectric},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Agua Soporte",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:F.milotic}]},starter_mudkip:{id:"starter_mudkip",name:"üíß Team Mudkip",description:"Equipo basado en Swampert. Dominio de agua y tierra.",category:"thematic",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Agua Tierra L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:F.swampert},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Agua Especial",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:F.milotic},{name:"Flygon",id:330,types:["Tierra","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/330.png",location:"Ruta 111 (Trapinch)",role:"Tierra Drag√≥n",item:"Arena Fina",nature:"Firme / Alegre",moves:F.flygon},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Ps√≠quico Especial",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:F.gardevoir},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Volador",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:F.salamence},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"El√©ctrico Soporte",item:"Im√°n",nature:"Modesta / Miedosa",moves:F.manectric}]},sun_team:{id:"sun_team",name:"‚òÄÔ∏è Equipo Sol",description:"Aprovecha Sequ√≠a y D√≠a Soleado. Potencia bajo el sol.",category:"mechanic",pokemon:[{name:"Blaziken",id:257,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/257.png",location:"Inicial (Torchic)",role:"Fuego Sol",item:"Banda Enfoque",nature:"Alegre / Activa",moves:F.blaziken},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Sol",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:F.salamence},{name:"Groudon",id:383,types:["Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/383.png",location:"C√°mara de Magma (Groudon)",role:"Tierra Sequ√≠a",item:"Vida Orbe",nature:"Firme / Alegre",moves:F.groudon},{name:"Altaria",id:334,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/334.png",location:"Ruta 119 (Swablu)",role:"Drag√≥n Volador Sol",item:"Capa Suave",nature:"Pl√°cida / Prudente",moves:F.altaria},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Acero Ps√≠quico",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:F.metagross},{name:"Manectric",id:310,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/310.png",location:"Ruta 110 (Electrike)",role:"El√©ctrico Soporte",item:"Im√°n",nature:"Modesta / Miedosa",moves:F.manectric}]},rain_team:{id:"rain_team",name:"üåßÔ∏è Equipo Lluvia",description:"Aprovecha Llovizna y Danza Lluvia. Control del clima acuoso.",category:"mechanic",pokemon:[{name:"Swampert",id:260,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/260.png",location:"Inicial (Mudkip)",role:"Agua Lluvia L√≠der",item:"Arena Fina",nature:"Pl√°cida / Audaz",moves:F.swampert},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 119 (Feebas)",role:"Agua Lluvia",item:"Banda Asalto",nature:"Modesta / T√≠mida",moves:F.milotic},{name:"Kingdra",id:230,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/230.png",location:"Ruta 119 (Horsea)",role:"Agua Drag√≥n Lluvia",item:"Gema Agua",nature:"Modesta / T√≠mida",moves:F.kingdra},{name:"Kyogre",id:382,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/382.png",location:"Cueva Primordial (Kyogre)",role:"Agua Legendaria Lluvia",item:"Vida Orbe",nature:"Modesta / T√≠mida",moves:F.kyogre},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Ps√≠quico Soporte",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:F.gardevoir},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Acero Ps√≠quico",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:F.metagross}]},legendary:{id:"legendary",name:"‚≠ê Con Legendarios",description:"Incluye los tres legendarios de Hoenn. Poder absoluto.",category:"mechanic",pokemon:[{name:"Rayquaza",id:384,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/384.png",location:"Cascada Meteoro (Rayquaza)",role:"Drag√≥n Legendario L√≠der",item:"Vida Orbe",nature:"P√≠cara / Activa",moves:F.rayquaza},{name:"Groudon",id:383,types:["Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/383.png",location:"C√°mara de Magma (Groudon)",role:"Tierra Legendario",item:"Vida Orbe",nature:"Firme / Alegre",moves:F.groudon},{name:"Kyogre",id:382,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/382.png",location:"Cueva Primordial (Kyogre)",role:"Agua Legendaria",item:"Vida Orbe",nature:"Modesta / T√≠mida",moves:F.kyogre},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Cascada Meteoro (Bagon)",role:"Drag√≥n Volador",item:"Colmillo Drag√≥n",nature:"P√≠cara / Ingenua",moves:F.salamence},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Cascada Meteoro (Beldum)",role:"Acero Ps√≠quico",item:"Lentes de Precisi√≥n",nature:"P√≠cara / Activa",moves:F.metagross},{name:"Gardevoir",id:282,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/282.png",location:"Ruta 102 (Ralts)",role:"Ps√≠quico Soporte",item:"Cuchara Torcida",nature:"Modesta / Miedosa",moves:F.gardevoir}]}},Jp=[{id:"difficulty",name:"Por Objetivo",icon:"üéØ"},{id:"thematic",name:"Por Tem√°tica",icon:"üé®"},{id:"mechanic",name:"Por Mec√°nica",icon:"‚öôÔ∏è"}],Xp={competitive:{id:"competitive",name:"üèÜ Competitivo",category:"difficulty",description:"Equipo √≥ptimo para derrotar al Alto Mando y ser campe√≥n. Balanceado y potente.",pokemon:[{name:"Infernape",id:392,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/392.png",location:"Starter Pok√©mon",role:"‚öîÔ∏è Atacante Mixto",item:"Vida Orbe",nature:"Ingenua",moves:[{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Hierba Lazo",type:"Planta",category:"Especial"},{name:"U-turn",type:"Bicho",category:"F√≠sico"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üêâ Sweeper F√≠sico",item:"Banda Focus",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Lucario",id:448,types:["Lucha","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/448.png",location:"Isla Hierro",role:"üëä Atacante Especial",item:"Gafas Especiales",nature:"Miedosa",moves:[{name:"Esfera Aural",type:"Lucha",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Pulso Umbr√≠o",type:"Siniestro",category:"Especial"},{name:"Maquinaci√≥n",type:"Siniestro",category:"Estado"}]},{name:"Togekiss",id:468,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/468.png",location:"Huevo (Cintia)",role:"‚ú® Tanque Especial",item:"Restos",nature:"Serena",moves:[{name:"Tajo A√©reo",type:"Volador",category:"Especial"},{name:"Esfera Aural",type:"Lucha",category:"Especial"},{name:"Onda Trueno",type:"El√©ctrico",category:"Estado"},{name:"Respiro",type:"Volador",category:"Estado"}]},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Mt. Corona (Pesca)",role:"üíß Muralla Especial",item:"Restos",nature:"Osada",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"T√≥xico",type:"Veneno",category:"Estado"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"}]},{name:"Roserade",id:407,types:["Planta","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/407.png",location:"Ruta 204",role:"üåπ Atacante Especial",item:"Lodo Negro",nature:"Miedosa",moves:[{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Somn√≠fero",type:"Planta",category:"Estado"},{name:"P√∫as T√≥xicas",type:"Veneno",category:"Estado"}]}]},speedrun:{id:"speedrun",name:"üèÉ Speedrun",category:"difficulty",description:"Pok√©mon r√°pidos y poderosos para terminar el juego velozmente. M√°xima velocidad y power.",pokemon:[{name:"Torterra",id:389,types:["Planta","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/389.png",location:"Starter",role:"üí™ F√≠sico",item:"Restos",nature:"Audaz",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Rayo Solar",type:"Planta",category:"Especial"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"S√≠ntesis",type:"Planta",category:"Estado"}]},{name:"Rapidash",id:78,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/78.png",location:"Ruta 206",role:"üöÄ Especial",item:"Gafas de Precisi√≥n",nature:"T√≠mido",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Giro Fuego",type:"Fuego",category:"Especial"},{name:"Sofoco",type:"Fuego",category:"Especial"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"}]},{name:"Floatzel",id:419,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/419.png",location:"Ruta 203",role:"‚ö° F√≠sico",item:"Banda Muscular",nature:"Audaz",moves:[{name:"Acuatierra",type:"Agua",category:"F√≠sico"},{name:"Golpe",type:"Lucha",category:"F√≠sico"},{name:"Giro Hidro",type:"Agua",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"}]},{name:"Raichu",id:26,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/26.png",location:"Ruta 204-205",role:"‚ö° Especial",item:"Vida Orbe",nature:"T√≠mido",moves:[{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Onda Voltio",type:"El√©ctrico",category:"Especial"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Foco Energ√©tico",type:"Normal",category:"Especial"}]},{name:"Machamp",id:68,types:["Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/68.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Banda Muscular",nature:"Audaz",moves:[{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Martillazo",type:"Lucha",category:"F√≠sico"}]},{name:"Scyther",id:123,types:["Bicho","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/123.png",location:"Ruta 205-206",role:"üöÄ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Corte",type:"Normal",category:"F√≠sico"},{name:"X-Ataque",type:"Normal",category:"Estado"},{name:"Golpe A√©reo",type:"Volador",category:"F√≠sico"},{name:"Espada Santa",type:"Normal",category:"F√≠sico"}]}]},nuzlocke:{id:"nuzlocke",name:"üíÄ Nuzlocke",category:"difficulty",description:"Pok√©mon resistentes para sobrevivir a los ataques del Alto Mando. M√°xima defensa.",pokemon:[{name:"Bastionage",id:411,types:["Roca","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/411.png",location:"Cantera Fueguete",role:"üõ°Ô∏è F√≠sico",item:"Gafas de Precisi√≥n",nature:"Firme",moves:[{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"},{name:"Tierra de Poder",type:"Tierra",category:"Especial"},{name:"Reflejo",type:"Ps√≠quico",category:"Estado"}]},{name:"Metagross",id:376,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/376.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"},{name:"Meteorob√∫s",type:"Acero",category:"F√≠sico"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}]},{name:"Lapras",id:131,types:["Agua","Hielo"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/131.png",location:"Lago Valor",role:"üõ°Ô∏è Especial",item:"Restos",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]},{name:"Gengar",id:94,types:["Fantasma","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/94.png",location:"Cueva √âbano",role:"‚ö° Especial",item:"Vida Orbe",nature:"T√≠mido",moves:[{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Enfoque Energ√©tico",type:"Lucha",category:"Especial"},{name:"Foco Energ√©tico",type:"Normal",category:"Especial"}]},{name:"Gallade",id:475,types:["Ps√≠quico","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/475.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Banda Muscular",nature:"Audaz",moves:[{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"},{name:"Tiro Vital",type:"Lucha",category:"F√≠sico"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}]},{name:"Rhyperior",id:464,types:["Tierra","Roca"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/464.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Gafas de Precisi√≥n",nature:"Audaz",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Martillazo",type:"Lucha",category:"F√≠sico"},{name:"Avalancha",type:"Hielo",category:"F√≠sico"}]}]},favorites:{id:"favorites",name:"üåü Favoritos",category:"difficulty",description:"Los Pok√©mon m√°s queridos de Sinnoh. Equipo sentimental pero competitivo.",pokemon:[{name:"Dialga",id:483,types:["Acero","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/483.png",location:"Spear Pillar",role:"üíé Legendario",item:"Placa Resistente",nature:"Modesto",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Meteorob√∫s",type:"Acero",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Llamarada",type:"Fuego",category:"Especial"}]},{name:"Palkia",id:484,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/484.png",location:"Spear Pillar",role:"üíé Legendario",item:"Placa H√∫meda",nature:"Modesto",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Tormenta de Truenos",type:"El√©ctrico",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"}]},{name:"Giratina",id:487,types:["Fantasma","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/487.png",location:"Distorsi√≥n del Espacio",role:"üíé Legendario",item:"Gafas de Precisi√≥n",nature:"T√≠mido",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Foco Energ√©tico",type:"Normal",category:"Especial"},{name:"Enfoque Energ√©tico",type:"Lucha",category:"Especial"}]},{name:"Cresselia",id:488,types:["Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/488.png",location:"Isla Valor",role:"‚ú® Apoyo",item:"Restos",nature:"Modesto",moves:[{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Rayo Aurora",type:"Hielo",category:"Especial"},{name:"Defensa Lunar",type:"Ps√≠quico",category:"Estado"},{name:"Amnesia",type:"Ps√≠quico",category:"Estado"}]},{name:"Togekiss",id:468,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/468.png",location:"Ruta 210-211",role:"‚ú® Apoyo",item:"Restos",nature:"Modesto",moves:[{name:"Aire Cortante",type:"Volador",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Fuego Fatuo",type:"Fuego",category:"Estado"},{name:"Agilidad",type:"Ps√≠quico",category:"Estado"}]},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Mt. Coronet",role:"üöÄ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Golpe A√©reo",type:"Volador",category:"Especial"}]}]},balanced_team:{id:"balanced_team",name:"‚öñÔ∏è Equipo Balanceado",category:"thematic",description:"Cobertura de tipos perfecta. Equipo vers√°til dise√±ado alrededor de Empoleon.",pokemon:[{name:"Empoleon",id:395,types:["Agua","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/395.png",location:"Starter",role:"üõ°Ô∏è Especial / Tanque",item:"Restos",nature:"Modesta",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Agility",type:"Ps√≠quico",category:"Estado"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üí™ F√≠sico",item:"Banda Focus",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Colmillo √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Staraptor",id:398,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/398.png",location:"Ruta 201",role:"üöÄ Atacante Veloz",item:"Cinta Elegida",nature:"Firme",moves:[{name:"P√°jaro Osado",type:"Volador",category:"F√≠sico"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"}]},{name:"Luxray",id:405,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/405.png",location:"Ruta 202",role:"‚ö° Atacante F√≠sico",item:"Magneto",nature:"Firme",moves:[{name:"Chispazo",type:"El√©ctrico",category:"Especial"},{name:"Colmillo Rayo",type:"El√©ctrico",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Superpotencia",type:"Lucha",category:"F√≠sico"}]},{name:"Roserade",id:407,types:["Planta","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/407.png",location:"Ruta 204",role:"üåπ Atacante Especial",item:"Lodo Negro",nature:"Miedosa",moves:[{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Recurso",type:"Normal",category:"Estado"},{name:"Extrasensorial",type:"Ps√≠quico",category:"Especial"}]},{name:"Gallade",id:475,types:["Ps√≠quico","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/475.png",location:"Ruta 208",role:"üó°Ô∏è Atacante F√≠sico",item:"Periscopio",nature:"Firme",moves:[{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Psicocorte",type:"Ps√≠quico",category:"F√≠sico"},{name:"Tajo Umbr√≠o",type:"Siniestro",category:"F√≠sico"},{name:"Hoja Aguda",type:"Planta",category:"F√≠sico"}]}]},monotype_water:{id:"monotype_water",name:"üíß Monotype Agua",category:"thematic",description:"Equipo 100% tipo Agua. Dominio completo de las aguas de Sinnoh.",pokemon:[{name:"Empoleon",id:395,types:["Agua","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/395.png",location:"Starter",role:"üõ°Ô∏è Especial",item:"Placa Resistente",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Onda Voltio",type:"El√©ctrico",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"},{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"}]},{name:"Floatzel",id:419,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/419.png",location:"Ruta 203",role:"‚ö° F√≠sico",item:"Banda Muscular",nature:"Audaz",moves:[{name:"Acuatierra",type:"Agua",category:"F√≠sico"},{name:"Golpe",type:"Lucha",category:"F√≠sico"},{name:"Giro Hidro",type:"Agua",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"}]},{name:"Lapras",id:131,types:["Agua","Hielo"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/131.png",location:"Lago Valor",role:"üõ°Ô∏è Especial",item:"Restos",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Ruta 222",role:"üõ°Ô∏è Especial",item:"Restos",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Rayo Aurora",type:"Hielo",category:"Especial"},{name:"Raya Lum√≠nica",type:"Agua",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]},{name:"Gastrodon",id:423,types:["Agua","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/423.png",location:"Gran Ci√©naga",role:"üõ°Ô∏è Especial",item:"Restos",nature:"Modesto",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Tierra de Poder",type:"Tierra",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]},{name:"Manaphy",id:490,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/490.png",location:"Isla Valor",role:"üíé Legendario",item:"Restos",nature:"Modesto",moves:[{name:"Raya Lum√≠nica",type:"Agua",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Calmia",type:"Agua",category:"Estado"}]}]},monotype_dragon:{id:"monotype_dragon",name:"üêâ Monotype Drag√≥n",category:"thematic",description:"Equipo 100% tipo Drag√≥n. Poder absoluto del tipo Drag√≥n.",pokemon:[{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Gafas de Precisi√≥n",nature:"Audaz",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"}]},{name:"Dialga",id:483,types:["Acero","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/483.png",location:"Spear Pillar",role:"üíé Legendario",item:"Placa Resistente",nature:"Modesto",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Meteorob√∫s",type:"Acero",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Llamarada",type:"Fuego",category:"Especial"}]},{name:"Palkia",id:484,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/484.png",location:"Spear Pillar",role:"üíé Legendario",item:"Placa H√∫meda",nature:"Modesto",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Tormenta de Truenos",type:"El√©ctrico",category:"Especial"},{name:"Rayo de Hielo",type:"Hielo",category:"Especial"}]},{name:"Giratina",id:487,types:["Fantasma","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/487.png",location:"Distorsi√≥n del Espacio",role:"üíé Legendario",item:"Gafas de Precisi√≥n",nature:"T√≠mido",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Foco Energ√©tico",type:"Normal",category:"Especial"},{name:"Enfoque Energ√©tico",type:"Lucha",category:"Especial"}]},{name:"Dragonite",id:149,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/149.png",location:"Mt. Coronet",role:"üí™ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Golpe A√©reo",type:"Volador",category:"Especial"}]},{name:"Salamence",id:373,types:["Drag√≥n","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/373.png",location:"Mt. Coronet",role:"üöÄ F√≠sico",item:"Vida Orbe",nature:"Audaz",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Piedra Afilada",type:"Roca",category:"F√≠sico"},{name:"Golpe A√©reo",type:"Volador",category:"Especial"}]}]},starter_turtwig:{id:"starter_turtwig",name:"üåø Team Turtwig",category:"thematic",description:"Equipo basado en Torterra. Defensa s√≥lida y potencia terrestre.",pokemon:[{name:"Torterra",id:389,types:["Planta","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/389.png",location:"Starter",role:"üå≥ Tanque F√≠sico",item:"Restos",nature:"Firme",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Mazo en la Cabeza",type:"Planta",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Maldici√≥n",type:"Fantasma",category:"Estado"}]},{name:"Staraptor",id:398,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/398.png",location:"Ruta 201",role:"üöÄ Atacante Veloz",item:"Cinta Elegida",nature:"Alegre",moves:[{name:"P√°jaro Osado",type:"Volador",category:"F√≠sico"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"}]},{name:"Magmortar",id:467,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/467.png",location:"Forja Fuego",role:"üí• Ca√±√≥n Especial",item:"Vidasfera",nature:"Modesta",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"}]},{name:"Milotic",id:350,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/350.png",location:"Mt. Corona (Pesca)",role:"üíß Muralla Especial",item:"Restos",nature:"Osada",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"},{name:"T√≥xico",type:"Veneno",category:"Estado"}]},{name:"Lucario",id:448,types:["Lucha","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/448.png",location:"Isla Hierro (Huevo)",role:"üëä Atacante Mixto",item:"Cinta Experto",nature:"Firme",moves:[{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Pu√±o Incremento",type:"Lucha",category:"F√≠sico"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Velocidad Extrema",type:"Normal",category:"F√≠sico"}]},{name:"Jolteon",id:135,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/135.png",location:"Eevee (Coraz√≥n de Ciudad)",role:"‚ö° Atacante Veloz",item:"Im√°n",nature:"Miedosa",moves:[{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Onda Voltio",type:"El√©ctrico",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Doble Rayo",type:"Bicho",category:"Especial"}]}]},starter_chimchar:{id:"starter_chimchar",name:"üî• Team Chimchar",category:"thematic",description:"Equipo basado en Infernape. Poder de fuego y lucha veloz.",pokemon:[{name:"Infernape",id:392,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/392.png",location:"Starter",role:"üî• Ca√±√≥n de Fuego Veloz",item:"Vidasfera",nature:"Activa",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Pu√±o Trueno",type:"El√©ctrico",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Floatzel",id:419,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/419.png",location:"Ruta 203",role:"üö§ Atacante Veloz",item:"Cinta Experto",nature:"Firme",moves:[{name:"Cascada",type:"Agua",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Pu√±o Hielo",type:"Hielo",category:"F√≠sico"},{name:"Acua Jet",type:"Agua",category:"F√≠sico"}]},{name:"Roserade",id:407,types:["Planta","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/407.png",location:"Ruta 204",role:"üåπ Atacante Especial",item:"Lodo Negro",nature:"Miedosa",moves:[{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Somn√≠fero",type:"Planta",category:"Estado"},{name:"Brillo M√°gico",type:"Hada",category:"Especial"}]},{name:"Staraptor",id:398,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/398.png",location:"Ruta 201",role:"üöÄ Atacante Veloz",item:"Cinta Elegida",nature:"Alegre",moves:[{name:"P√°jaro Osado",type:"Volador",category:"F√≠sico"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üêâ Power Bruto",item:"Colmillo Drag√≥n",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Llamarada",type:"Fuego",category:"Especial"}]},{name:"Luxray",id:405,types:["El√©ctrico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/405.png",location:"Ruta 202",role:"‚ö° Atacante F√≠sico",item:"Magneto",nature:"Firme",moves:[{name:"Colmillo Rayo",type:"El√©ctrico",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Superpotencia",type:"Lucha",category:"F√≠sico"},{name:"Voltiocambio",type:"El√©ctrico",category:"Especial"}]}]},starter_piplup:{id:"starter_piplup",name:"üåä Team Piplup",category:"thematic",description:"Equipo basado en Empoleon. Elegancia real y dominio del acero.",pokemon:[{name:"Empoleon",id:395,types:["Agua","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/395.png",location:"Starter",role:"üõ°Ô∏è Tanque Especial",item:"Restos",nature:"Modesta",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Nudo Hierba",type:"Planta",category:"Especial"}]},{name:"Rapidash",id:78,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/78.png",location:"Ruta 206",role:"üèá Atacante Veloz",item:"Banda Muscular",nature:"Alegre",moves:[{name:"Envite √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Cuerpo Llama",type:"Fuego",category:"Estado"},{name:"Patada Salto Alta",type:"Lucha",category:"F√≠sico"}]},{name:"Roserade",id:407,types:["Planta","Veneno"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/407.png",location:"Ruta 204",role:"üåπ Atacante Especial",item:"Lodo Negro",nature:"Miedosa",moves:[{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Extrasensorial",type:"Ps√≠quico",category:"Especial"},{name:"Paralizador",type:"Planta",category:"Estado"}]},{name:"Staraptor",id:398,types:["Normal","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/398.png",location:"Ruta 201",role:"üöÄ Atacante Veloz",item:"Cinta Elegida",nature:"Firme",moves:[{name:"P√°jaro Osado",type:"Volador",category:"F√≠sico"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Ataque R√°pido",type:"Normal",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üêâ Sweeper F√≠sico",item:"Banda Focus",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Lucario",id:448,types:["Lucha","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/448.png",location:"Isla Hierro (Huevo)",role:"üëä Atacante Mixto",item:"Cinta Experto",nature:"Ingenua",moves:[{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Esfera Aural",type:"Lucha",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Velocidad Extrema",type:"Normal",category:"F√≠sico"}]}]},sun_team:{id:"sun_team",name:"‚òÄÔ∏è Equipo Sol",description:"Aprovecha D√≠a Soleado. Potencia bajo el sol.",category:"mechanic",pokemon:[{name:"Infernape",id:392,types:["Fuego","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/392.png",location:"Starter",role:"üî• Sol Sweeper",item:"Vida Orbe",nature:"Activa",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"A bocajarro",type:"Lucha",category:"F√≠sico"},{name:"Hierba Lazo",type:"Planta",category:"Especial"},{name:"D√≠a Soleado",type:"Fuego",category:"Estado"}]},{name:"Cherrim",id:421,types:["Planta"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/421.png",location:"Ruta 221",role:"‚òÄÔ∏è Soporte Sol",item:"Roca Calor",nature:"Miedosa",moves:[{name:"D√≠a Soleado",type:"Fuego",category:"Estado"},{name:"Rayo Solar",type:"Planta",category:"Especial"},{name:"Deseo",type:"Normal",category:"Estado"},{name:"Ayuda",type:"Normal",category:"Estado"}]},{name:"Rapidash",id:78,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/78.png",location:"Ruta 206",role:"üèá Atacante Veloz",item:"Banda Muscular",nature:"Alegre",moves:[{name:"Envite √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Patada Salto Alta",type:"Lucha",category:"F√≠sico"},{name:"Nitrocarga",type:"Fuego",category:"F√≠sico"}]},{name:"Leafeon",id:470,types:["Planta"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/470.png",location:"Bosque Eterna (Eevee)",role:"üçÉ Clorofila F√≠sico",item:"Tabla Pradal",nature:"Firme",moves:[{name:"Hoja Aguda",type:"Planta",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"X-Scissor",type:"Bicho",category:"F√≠sico"},{name:"Sustituto",type:"Normal",category:"Estado"}]},{name:"Garchomp",id:445,types:["Drag√≥n","Tierra"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/445.png",location:"Cueva Extrav√≠o",role:"üêâ Power Bruto",item:"Banda Focus",nature:"Alegre",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Carga Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Colmillo √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Magmortar",id:467,types:["Fuego"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/467.png",location:"Forja Fuego",role:"üí• Ca√±√≥n Especial",item:"Gafas Elegid.",nature:"Modesta",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Rayo",type:"El√©ctrico",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"}]}]},rain_team:{id:"rain_team",name:"üåßÔ∏è Equipo Lluvia",description:"Aprovecha Danza Lluvia. Control del clima acuoso.",category:"mechanic",pokemon:[{name:"Empoleon",id:395,types:["Agua","Acero"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/395.png",location:"Starter",role:"üõ°Ô∏è Tanque Lluvia",item:"Restos",nature:"Modesta",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Danza Lluvia",type:"Agua",category:"Estado"}]},{name:"Floatzel",id:419,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/419.png",location:"Ruta 213",role:"üõ∂ Nado R√°pido Swimmer",item:"Tabla Agua",nature:"Firme",moves:[{name:"Cascada",type:"Agua",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Pu√±o Hielo",type:"Hielo",category:"F√≠sico"},{name:"Acua Jet",type:"Agua",category:"F√≠sico"}]},{name:"Toxicroak",id:454,types:["Veneno","Lucha"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/454.png",location:"Gran Pantano",role:"üê∏ Piel Seca Sweeper",item:"Lodo Negro",nature:"Alegre",moves:[{name:"Pu√±o Drenaje",type:"Lucha",category:"F√≠sico"},{name:"Puya Nociva",type:"Veneno",category:"F√≠sico"},{name:"Tajo Umbr√≠o",type:"Siniestro",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Bronzong",id:437,types:["Acero","Ps√≠quico"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/437.png",location:"Monte Corona",role:"üîî Soporte Defensivo",item:"Roca Lluvia",nature:"Pl√°cida",moves:[{name:"Danza Lluvia",type:"Agua",category:"Estado"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Giro Bola",type:"Acero",category:"F√≠sico"},{name:"Hipnosis",type:"Ps√≠quico",category:"Estado"}]},{name:"Lumineon",id:457,types:["Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/457.png",location:"Ruta 223",role:"üêü Soporte Veloz",item:"Roca Lluvia",nature:"Miedosa",moves:[{name:"Viento Hielo",type:"Hielo",category:"Especial"},{name:"Danza Lluvia",type:"Agua",category:"Estado"},{name:"U-turn",type:"Bicho",category:"F√≠sico"},{name:"Escaldar",type:"Agua",category:"Especial"}]},{name:"Rotom-Wash",id:479,types:["El√©ctrico","Agua"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10009.png",location:"Mansi√≥n Vieja",role:"üå™Ô∏è STAB Trueno",item:"Restos",nature:"Modesta",moves:[{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Fuego Fatuo",type:"Fuego",category:"Estado"},{name:"Divide Dolor",type:"Normal",category:"Estado"}]}]},legendary:{id:"legendary",name:"‚≠ê Legendarios",description:"El equipo definitivo de Sinnoh. Los seres m√°s poderosos de la creaci√≥n.",category:"mechanic",pokemon:[{name:"Arceus",id:493,types:["Normal"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/493.png",location:"Sala del Origen",role:"üëë El Dios Pok√©mon",item:"Tabla Alfa",nature:"Firme",moves:[{name:"Velocidad Extrema",type:"Normal",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Garra Umbr√≠a",type:"Fantasma",category:"F√≠sico"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"}]},{name:"Darkrai",id:491,types:["Siniestro"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/491.png",location:"Isla Nueva Luna",role:"üåô Maestro de las Pesadillas",item:"Banda Focus",nature:"Miedosa",moves:[{name:"Brecha Negra",type:"Siniestro",category:"Estado"},{name:"Maquinaci√≥n",type:"Siniestro",category:"Estado"},{name:"Pulso Umbr√≠o",type:"Siniestro",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"}]},{name:"Shaymin-Sky",id:492,types:["Planta","Volador"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10006.png",location:"V√≠a del Agradecimiento",role:"üçÉ Velocista de los Cielos",item:"Vidasfera",nature:"Miedosa",moves:[{name:"Fogonazo",type:"Planta",category:"Especial"},{name:"Tajo A√©reo",type:"Volador",category:"Especial"},{name:"Tierra Viva",type:"Tierra",category:"Especial"},{name:"S√≠ntesis",type:"Planta",category:"Estado"}]},{name:"Giratina-O",id:487,types:["Fantasma","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10007.png",location:"Mundo Distorsi√≥n",role:"üëª Guardi√°n del Mundo Inverso",item:"Griseosfera",nature:"Audaz",moves:[{name:"Golpe Umbr√≠o",type:"Fantasma",category:"F√≠sico"},{name:"Cometa Draco",type:"Drag√≥n",category:"Especial"},{name:"Esfera Aural",type:"Lucha",category:"Especial"},{name:"Fuego Fatuo",type:"Fuego",category:"Estado"}]},{name:"Dialga",id:483,types:["Acero","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/483.png",location:"Columna Lanza",role:"‚è≥ Se√±or del Tiempo",item:"Diamansfera",nature:"Modesta",moves:[{name:"Distorsi√≥n",type:"Drag√≥n",category:"Especial"},{name:"Foco Resplandor",type:"Acero",category:"Especial"},{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Trueno",type:"El√©ctrico",category:"Especial"}]},{name:"Palkia",id:484,types:["Agua","Drag√≥n"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/484.png",location:"Columna Lanza",role:"üåå Se√±or del Espacio",item:"Lustrosfera",nature:"Miedosa",moves:[{name:"Corte Vac√≠o",type:"Drag√≥n",category:"Especial"},{name:"Hidrobomba",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Esfera Aural",type:"Lucha",category:"Especial"}]}]}},Yp=[{id:"difficulty",name:"Por Objetivo",icon:"üéØ"},{id:"thematic",name:"Por Tem√°tica",icon:"üé®"},{id:"mechanic",name:"Por Mec√°nica",icon:"‚öôÔ∏è"}],Zp={competitive:{id:"competitive",name:"üèÜ Competitivo Historia",category:"difficulty",description:"Equipo balanceado y poderoso para superar la historia y derrotar a N y Ghechis sin problemas.",pokemon:[{name:"Samurott",id:503,types:["Water"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/503.png",location:"Inicial",role:"‚öîÔ∏è Atacante Mixto",item:"Agua M√≠stica",nature:"Afable",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Acua Jet",type:"Agua",category:"F√≠sico"}]},{name:"Excadrill",id:530,types:["Ground","Steel"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/530.png",location:"Cueva Manantial",role:"üí™ Sweeper F√≠sico",item:"Pa√±uelo Seda",nature:"Firme",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Avalancha",type:"Roca",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Tijera X",type:"Bicho",category:"F√≠sico"}]},{name:"Darmanitan",id:555,types:["Fire"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/555.png",location:"Desierto Recreo",role:"üî• Potencia Bruta",item:"Carb√≥n",nature:"Firme",moves:[{name:"Envite √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Fuerza Bruta",type:"Lucha",category:"F√≠sico"},{name:"Pu√±o Fuego",type:"Fuego",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Scrafty",id:560,types:["Dark","Fighting"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/560.png",location:"Desierto Recreo",role:"üõ°Ô∏è Tanque Ofensivo",item:"Restos",nature:"Cauta",moves:[{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Patada S. Alta",type:"Lucha",category:"F√≠sico"},{name:"Pu√±o Drenaje",type:"Lucha",category:"F√≠sico"},{name:"Corpulencia",type:"Lucha",category:"Estado"}]},{name:"Archeops",id:567,types:["Rock","Flying"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/567.png",location:"Castillo Ancestral (F√≥sil)",role:"üöÄ Glass Cannon",item:"Gema Volad.",nature:"Alegre",moves:[{name:"Acr√≥bata",type:"Volador",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Haxorus",id:612,types:["Dragon"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/612.png",location:"Cueva Loza",role:"üêâ Rompemurallas",item:"Tabla Draco",nature:"Alegre",moves:[{name:"Danza Drag√≥n",type:"Drag√≥n",category:"Estado"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"}]}]},speedrun:{id:"speedrun",name:"üèÉ Speedrun / R√°pido",category:"difficulty",description:"Pok√©mon que destrozan el juego con pura potencia ofensiva. Dise√±ado para acabar combates en 1 turno.",pokemon:[{name:"Emboar",id:500,types:["Fire","Fighting"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/500.png",location:"Inicial",role:"üî• Atacante Mixto",item:"Carb√≥n",nature:"Hura√±a",moves:[{name:"Envite √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Machada",type:"Lucha",category:"F√≠sico"},{name:"Escaldar",type:"Agua",category:"Especial"},{name:"Voltio Cruel",type:"El√©ctrico",category:"F√≠sico"}]},{name:"Excadrill",id:530,types:["Ground","Steel"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/530.png",location:"Cueva Manantial",role:"üí™ MVP",item:"Pa√±uelo Seda",nature:"Firme",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Garra Metal",type:"Acero",category:"F√≠sico"},{name:"Avalancha",type:"Roca",category:"F√≠sico"}]},{name:"Lilligant",id:549,types:["Grass"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/549.png",location:"Bosque Azulejo (Petilil)",role:"üíÉ Danza Aleteo",item:"Semilla Milagro",nature:"Modesta",moves:[{name:"Danza Aleteo",type:"Bicho",category:"Estado"},{name:"Danza P√©talo",type:"Planta",category:"Especial"},{name:"Giga Drenado",type:"Planta",category:"Especial"},{name:"Somn√≠fero",type:"Planta",category:"Estado"}]},{name:"Simipour",id:516,types:["Water"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/516.png",location:"Solar de los Sue√±os",role:"üíß Cobertura",item:"Agua M√≠stica",nature:"Alocada",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Acr√≥bata",type:"Volador",category:"F√≠sico"}]},{name:"Chandelure",id:609,types:["Ghost","Fire"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/609.png",location:"Torre de los Cielos",role:"üëª Nuker Especial",item:"Hechizo",nature:"Modesta",moves:[{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Paz Mental",type:"Ps√≠quico",category:"Estado"}]},{name:"Zekrom",id:644,types:["Dragon","Electric"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/644.png",location:"Palacio de N",role:"‚ö° Legendario",item:"Gema Elec.",nature:"Firme",moves:[{name:"Ataque Fulgor",type:"El√©ctrico",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Cabezazo Zen",type:"Ps√≠quico",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"}]}]},nuzlocke:{id:"nuzlocke",name:"üíÄ Nuzlocke Seguro",category:"difficulty",description:"Pok√©mon con altas defensas y pocos puntos d√©biles para sobrevivir el reto.",pokemon:[{name:"Serperior",id:497,types:["Grass"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/497.png",location:"Inicial",role:"üõ°Ô∏è Soporte R√°pido",item:"Restos",nature:"Miedosa",moves:[{name:"Drenadoras",type:"Planta",category:"Estado"},{name:"Giga Drenado",type:"Planta",category:"Especial"},{name:"Danza Aleteo",type:"Bicho",category:"Estado"},{name:"Enrosque",type:"Veneno",category:"Estado"}]},{name:"Stoutland",id:508,types:["Normal"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/508.png",location:"Ruta 1",role:"üêï Tanque Normal",item:"Pa√±uelo Seda",nature:"Firme",moves:[{name:"Represalia",type:"Normal",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Colmillo Hielo",type:"Hielo",category:"F√≠sico"},{name:"Avivar",type:"Normal",category:"Estado"}]},{name:"Ferrothorn",id:598,types:["Grass","Steel"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/598.png",location:"Cueva Electrorroca",role:"üè∞ Muralla Impenetrable",item:"Casco Dentado",nature:"Pl√°cida",moves:[{name:"Latigazo",type:"Planta",category:"F√≠sico"},{name:"Giro Bola",type:"Acero",category:"F√≠sico"},{name:"Drenadoras",type:"Planta",category:"Estado"},{name:"Trampa Rocas",type:"Roca",category:"Estado"}]},{name:"Jellicent",id:593,types:["Water","Ghost"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/593.png",location:"Bah√≠a Arenisca",role:"üëª Muralla Especial",item:"Restos",nature:"Serena",moves:[{name:"Escaldar",type:"Agua",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"},{name:"Fuego Fatuo",type:"Fuego",category:"Estado"}]},{name:"Scrafty",id:560,types:["Dark","Fighting"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/560.png",location:"Desierto Recreo",role:"ü•ã Mudar",item:"Baya Ziuela",nature:"Cauta",moves:[{name:"Pu√±o Drenaje",type:"Lucha",category:"F√≠sico"},{name:"Trtitar",type:"Siniestro",category:"F√≠sico"},{name:"Corpulencia",type:"Lucha",category:"Estado"},{name:"Cabezazo Zen",type:"Ps√≠quico",category:"F√≠sico"}]},{name:"Sigilyph",id:561,types:["Psychic","Flying"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/561.png",location:"Zona Desierto",role:"‚ú® Muro M√°gico",item:"Llama Esfera",nature:"Miedosa",moves:[{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Tajo A√©reo",type:"Volador",category:"Especial"},{name:"Masa C√≥smica",type:"Ps√≠quico",category:"Estado"},{name:"Respiro",type:"Volador",category:"Estado"}]}]},starter_snivy:{id:"starter_snivy",name:"üåø Team Snivy",category:"thematic",description:"Equipo basado en Serperior. Velocidad, evasi√≥n y soporte.",pokemon:[{name:"Serperior",id:497,types:["Grass"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/497.png",location:"Inicial",role:"üêç L√≠der Veloz",item:"Restos",nature:"Miedosa",moves:[{name:"Lluevehojas",type:"Planta",category:"Especial"},{name:"Gigadrenado",type:"Planta",category:"Especial"},{name:"Enrosque",type:"Veneno",category:"Estado"},{name:"Drenadoras",type:"Planta",category:"Estado"}]},{name:"Simipour",id:516,types:["Water"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/516.png",location:"Solar de los Sue√±os",role:"üíß Cobertura Agua",item:"Agua M√≠stica",nature:"Modesta",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Hierba Lazo",type:"Planta",category:"Especial"},{name:"Escaldar",type:"Agua",category:"Especial"}]},{name:"Chandelure",id:609,types:["Ghost","Fire"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/609.png",location:"Torre de los Cielos",role:"üî• Ca√±√≥n Especial",item:"Hechizo",nature:"Modesta",moves:[{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Paz Mental",type:"Ps√≠quico",category:"Estado"}]},{name:"Scrafty",id:560,types:["Dark","Fighting"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/560.png",location:"Desierto Recreo",role:"ü•ã Tanque Lucha",item:"Restos",nature:"Firme",moves:[{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Patada S. Alta",type:"Lucha",category:"F√≠sico"},{name:"Pu√±o Hielo",type:"Hielo",category:"F√≠sico"},{name:"Danza Drag√≥n",type:"Drag√≥n",category:"Estado"}]},{name:"Archeops",id:567,types:["Rock","Flying"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/567.png",location:"F√≥sil",role:"üöÄ Atacante F√≠sico",item:"Gema Volad.",nature:"Alegre",moves:[{name:"Acr√≥bata",type:"Volador",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Zebstrika",id:523,types:["Electric"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/523.png",location:"Ruta 3",role:"‚ö° Velocidad",item:"Im√°n",nature:"Alegre",moves:[{name:"Voltio Cruel",type:"El√©ctrico",category:"F√≠sico"},{name:"Nitrocarga",type:"Fuego",category:"F√≠sico"},{name:"Voltiocambio",type:"El√©ctrico",category:"Especial"},{name:"Onda Trueno",type:"El√©ctrico",category:"Estado"}]}]},starter_tepig:{id:"starter_tepig",name:"üî• Team Tepig",category:"thematic",description:"Equipo basado en Emboar. Potencia bruta y cobertura ofensiva.",pokemon:[{name:"Emboar",id:500,types:["Fire","Fighting"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/500.png",location:"Inicial",role:"üî• L√≠der Potente",item:"Cintur√≥n Negro",nature:"Firme",moves:[{name:"Envite √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Machada",type:"Lucha",category:"F√≠sico"},{name:"Voltio Cruel",type:"El√©ctrico",category:"F√≠sico"},{name:"Testarazo",type:"Roca",category:"F√≠sico"}]},{name:"Seismitoad",id:537,types:["Water","Ground"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/537.png",location:"Bosque Azulejo",role:"üíß Cobertura Agua",item:"Arena Fina",nature:"Modesta",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Tierra Viva",type:"Tierra",category:"Especial"},{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Drenaje",type:"Planta",category:"Especial"}]},{name:"Leavanny",id:542,types:["Bug","Grass"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/542.png",location:"Bosque Azulejo",role:"‚úÇÔ∏è Atacante F√≠sico",item:"Semilla Milagro",nature:"Alegre",moves:[{name:"Tijera X",type:"Bicho",category:"F√≠sico"},{name:"Hoja Aguda",type:"Planta",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Garra Umbr√≠a",type:"Fantasma",category:"F√≠sico"}]},{name:"Sigilyph",id:561,types:["Psychic","Flying"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/561.png",location:"Zona Desierto",role:"üîÆ Muro M√°gico",item:"Llama Esfera",nature:"Miedosa",moves:[{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Tajo A√©reo",type:"Volador",category:"Especial"},{name:"Masa C√≥smica",type:"Ps√≠quico",category:"Estado"},{name:"Poderreserva",type:"Ps√≠quico",category:"Especial"}]},{name:"Krookodile",id:553,types:["Ground","Dark"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/553.png",location:"Castillo Ancestral",role:"üêä Autoestima",item:"Gafas de Sol",nature:"Alegre",moves:[{name:"Triturar",type:"Siniestro",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"}]},{name:"Galvantula",id:596,types:["Bug","Electric"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/596.png",location:"Cueva Electrorroca",role:"‚ö° Precisi√≥n",item:"Gafas Especiales",nature:"Miedosa",moves:[{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Zumbido",type:"Bicho",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Voltiocambio",type:"El√©ctrico",category:"Especial"}]}]},starter_oshawott:{id:"starter_oshawott",name:"üíß Team Oshawott",category:"thematic",description:"Equipo basado en Samurott. Versatilidad y equilibrio.",pokemon:[{name:"Samurott",id:503,types:["Water"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/503.png",location:"Inicial",role:"‚öîÔ∏è L√≠der Mixto",item:"Agua M√≠stica",nature:"Afable",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Rayo Hielo",type:"Hielo",category:"Especial"},{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Acua Jet",type:"Agua",category:"F√≠sico"}]},{name:"Simisear",id:514,types:["Fire"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/514.png",location:"Solar de los Sue√±os",role:"üî• Cobertura Fuego",item:"Carb√≥n",nature:"Modesta",moves:[{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"},{name:"Hierba Lazo",type:"Planta",category:"Especial"},{name:"Bostezo",type:"Normal",category:"Estado"}]},{name:"Lilligant",id:549,types:["Grass"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/549.png",location:"Bosque Azulejo",role:"üíÉ Danza Aleteo",item:"Semilla Milagro",nature:"Modesta",moves:[{name:"Danza Aleteo",type:"Bicho",category:"Estado"},{name:"Danza P√©talo",type:"Planta",category:"Especial"},{name:"Giga Drenado",type:"Planta",category:"Especial"},{name:"Somn√≠fero",type:"Planta",category:"Estado"}]},{name:"Excadrill",id:530,types:["Ground","Steel"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/530.png",location:"Cueva Manantial",role:"üí™ Topo de Acero",item:"Pa√±uelo Seda",nature:"Firme",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Avalancha",type:"Roca",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Tijera X",type:"Bicho",category:"F√≠sico"}]},{name:"Reuniclus",id:579,types:["Psychic"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/579.png",location:"Ruta 5",role:"üß† Tanque Ps√≠quico",item:"Restos",nature:"Modesta",moves:[{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"},{name:"Paz Mental",type:"Ps√≠quico",category:"Estado"}]},{name:"Braviary",id:628,types:["Normal","Flying"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/628.png",location:"Ruta 10",role:"ü¶Ö Ataque A√©reo",item:"Pico Afilado",nature:"Alegre",moves:[{name:"P√°jaro Osado",type:"Volador",category:"F√≠sico"},{name:"Retribuci√≥n",type:"Normal",category:"F√≠sico"},{name:"Fuerza Bruta",type:"Lucha",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]}]},monotype_bug:{id:"monotype_bug",name:"üêõ Monotype Bicho",category:"thematic",description:"Teselia tiene los mejores Pok√©mon tipo Bicho. Volcarona lidera el enjambre.",pokemon:[{name:"Volcarona",id:637,types:["Bug","Fire"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/637.png",location:"Castillo Ancestral",role:"‚òÄÔ∏è Sol del Enjambre",item:"Restos",nature:"Modesta",moves:[{name:"Danza Aleteo",type:"Bicho",category:"Estado"},{name:"Danza Llama",type:"Fuego",category:"Especial"},{name:"Zumbido",type:"Bicho",category:"Especial"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"}]},{name:"Galvantula",id:596,types:["Bug","Electric"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/596.png",location:"Cueva Electrorroca",role:"‚ö° Tar√°ntula Veloz",item:"Gafas Especiales",nature:"Miedosa",moves:[{name:"Trueno",type:"El√©ctrico",category:"Especial"},{name:"Zumbido",type:"Bicho",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Voltiocambio",type:"El√©ctrico",category:"Especial"}]},{name:"Scolipede",id:545,types:["Bug","Poison"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/545.png",location:"Bosque Azulejo",role:"‚ò£Ô∏è Ciempi√©s T√≥xico",item:"Lodo Negro",nature:"Alegre",moves:[{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Puya Nociva",type:"Veneno",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}]},{name:"Crustle",id:558,types:["Bug","Rock"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/558.png",location:"Desierto Recreo",role:"üè∞ Rompecoraza",item:"Hierba Blanca",nature:"Firme",moves:[{name:"Rompecoraza",type:"Normal",category:"Estado"},{name:"Tijera X",type:"Bicho",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"}]},{name:"Leavanny",id:542,types:["Bug","Grass"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/542.png",location:"Bosque Azulejo",role:"‚úÇÔ∏è Cortador",item:"Cintur√≥n Experto",nature:"Alegre",moves:[{name:"Tijera X",type:"Bicho",category:"F√≠sico"},{name:"Hoja Aguda",type:"Planta",category:"F√≠sico"},{name:"Golpe A√©reo",type:"Volador",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Escavalier",id:589,types:["Bug","Steel"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/589.png",location:"Ruta 6",role:"üõ°Ô∏è Caballero Acero",item:"Restos",nature:"Audaz",moves:[{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"},{name:"Taladradora",type:"Tierra",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]}]},dragons:{id:"dragons",name:"üêâ Poder Drag√≥n",category:"thematic",description:"Teselia es tierra de dragones. Aprovecha el poder de las leyendas.",pokemon:[{name:"Haxorus",id:612,types:["Dragon"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/612.png",location:"Cueva Loza",role:"‚öîÔ∏è F√≠sico",item:"Tabla Draco",nature:"Alegre",moves:[{name:"Enfado",type:"Drag√≥n",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Danza Drag√≥n",type:"Drag√≥n",category:"Estado"},{name:"Demolici√≥n",type:"Lucha",category:"F√≠sico"}]},{name:"Hydreigon",id:635,types:["Dark","Dragon"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/635.png",location:"Calle Victoria",role:"üë∫ Especial",item:"Gafas Elegid",nature:"Miedosa",moves:[{name:"Pulso Drag√≥n",type:"Drag√≥n",category:"Especial"},{name:"Pulso Umbr√≠o",type:"Siniestro",category:"Especial"},{name:"Lanzallamas",type:"Fuego",category:"Especial"},{name:"Surf",type:"Agua",category:"Especial"}]},{name:"Druddigon",id:621,types:["Dragon"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/621.png",location:"Torre Duodraco",role:"üß± Tanque F√≠sico",item:"Casco Dentado",nature:"Audaz",moves:[{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Fuerza Bruta",type:"Lucha",category:"F√≠sico"},{name:"Golpe Bajo",type:"Siniestro",category:"F√≠sico"},{name:"Trampa Rocas",type:"Roca",category:"Estado"}]},{name:"Zekrom",id:644,types:["Dragon","Electric"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/644.png",location:"Palacio de N",role:"‚ö° Legendario",item:"Gema Elec.",nature:"Firme",moves:[{name:"Ataque Fulgor",type:"El√©ctrico",category:"F√≠sico"},{name:"Garra Drag√≥n",type:"Drag√≥n",category:"F√≠sico"},{name:"Cabezazo Zen",type:"Ps√≠quico",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"}]},{name:"Archeops",id:567,types:["Rock","Flying"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/567.png",location:"F√≥sil",role:"üöÄ Cobertura",item:"Gema Volad.",nature:"Alegre",moves:[{name:"Acr√≥bata",type:"Volador",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Seismitoad",id:537,types:["Water","Ground"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/537.png",location:"Bosque Azulejo",role:"üíß Cobertura",item:"Arena Fina",nature:"Modesta",moves:[{name:"Surf",type:"Agua",category:"Especial"},{name:"Tierra Viva",type:"Tierra",category:"Especial"},{name:"Bomba Lodo",type:"Veneno",category:"Especial"},{name:"Drenaje",type:"Planta",category:"Especial"}]}]},weather_sun:{id:"weather_sun",name:"‚òÄÔ∏è Clima Soleado",category:"mechanic",description:"Equipo de Sol. Darmanitan potencia su Fuego, Lilligant y Sawsbuck aprovechan Clorofila.",pokemon:[{name:"Whimsicott",id:547,types:["Grass"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/547.png",location:"Bosque Azulejo",role:"‚òÄÔ∏è Setter Prioridad",item:"Roca Calor",nature:"Miedosa",moves:[{name:"D√≠a Soleado",type:"Fuego",category:"Estado"},{name:"Viento Af√≠n",type:"Volador",category:"Estado"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Otra Vez",type:"Normal",category:"Estado"}]},{name:"Darmanitan",id:555,types:["Fire"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/555.png",location:"Desierto Recreo",role:"üî• Potencia Solar",item:"Cinta Elegida",nature:"Firme",moves:[{name:"Envite √çgneo",type:"Fuego",category:"F√≠sico"},{name:"Fuerza Bruta",type:"Lucha",category:"F√≠sico"},{name:"Avalancha",type:"Roca",category:"F√≠sico"},{name:"Ida y Vuelta",type:"Bicho",category:"F√≠sico"}]},{name:"Lilligant",id:549,types:["Grass"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/549.png",location:"Bosque Azulejo",role:"üíÉ Clorofila",item:"Vidasfera",nature:"Modesta",moves:[{name:"Danza Aleteo",type:"Bicho",category:"Estado"},{name:"Rayo Solar",type:"Planta",category:"Especial"},{name:"Poder Oculto",type:"Normal",category:"Especial"},{name:"Somn√≠fero",type:"Planta",category:"Estado"}]},{name:"Sawsbuck",id:586,types:["Normal","Grass"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/586.png",location:"Torre Duodraco",role:"ü¶å Clorofila F√≠sico",item:"Cunta Vida",nature:"Firme",moves:[{name:"Asta Drenaje",type:"Planta",category:"F√≠sico"},{name:"Retribuci√≥n",type:"Normal",category:"F√≠sico"},{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"}]},{name:"Volcarona",id:637,types:["Bug","Fire"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/637.png",location:"Castillo Ancestral",role:"üî• Sol Especial",item:"Restos",nature:"Modesta",moves:[{name:"Danza Llama",type:"Fuego",category:"Especial"},{name:"Zumbido",type:"Bicho",category:"Especial"},{name:"Vendaval",type:"Volador",category:"Especial"},{name:"Danza Aleteo",type:"Bicho",category:"Estado"}]},{name:"Chandelure",id:609,types:["Ghost","Fire"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/609.png",location:"Torre de los Cielos",role:"üëª Fuego Fantasma",item:"Pa√±uelo Elegido",nature:"Miedosa",moves:[{name:"Llamarada",type:"Fuego",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Energibola",type:"Planta",category:"Especial"},{name:"Truco",type:"Ps√≠quico",category:"Estado"}]}]},trick_room:{id:"trick_room",name:"üåÄ Espacio Raro",category:"mechanic",description:"Pok√©mon lentos pero muy poderosos que atacan primero bajo Espacio Raro.",pokemon:[{name:"Reuniclus",id:579,types:["Psychic"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/579.png",location:"Ruta 5",role:"üß† Setter Principal",item:"Vidasfera",nature:"Mansa",moves:[{name:"Espacio Raro",type:"Ps√≠quico",category:"Estado"},{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"}]},{name:"Cofagrigus",id:563,types:["Ghost"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/563.png",location:"Castillo Ancestral",role:"‚ö∞Ô∏è Setter Defensivo",item:"Restos",nature:"Pl√°cida",moves:[{name:"Espacio Raro",type:"Ps√≠quico",category:"Estado"},{name:"Bola Sombra",type:"Fantasma",category:"Especial"},{name:"Fuego Fatuo",type:"Fuego",category:"Estado"},{name:"Infortunio",type:"Fantasma",category:"Especial"}]},{name:"Conkeldurr",id:534,types:["Fighting"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/534.png",location:"Monte Tuerca",role:"üëä Sweeper F√≠sico",item:"Llama Esfera",nature:"Audaz",moves:[{name:"Pu√±o Drenaje",type:"Lucha",category:"F√≠sico"},{name:"Ultrapu√±o",type:"Lucha",category:"F√≠sico"},{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Protecci√≥n",type:"Normal",category:"Estado"}]},{name:"Escavalier",id:589,types:["Bug","Steel"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/589.png",location:"Ruta 6",role:"üõ°Ô∏è Tanque Lento",item:"Cinta Elegida",nature:"Audaz",moves:[{name:"Megacuerno",type:"Bicho",category:"F√≠sico"},{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"},{name:"Taladradora",type:"Tierra",category:"F√≠sico"},{name:"Persecuci√≥n",type:"Siniestro",category:"F√≠sico"}]},{name:"Ferrothorn",id:598,types:["Grass","Steel"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/598.png",location:"Cueva Electrorroca",role:"üè∞ Giro Bola",item:"Casco Dentado",nature:"Pl√°cida",moves:[{name:"Giro Bola",type:"Acero",category:"F√≠sico"},{name:"Latigazo",type:"Planta",category:"F√≠sico"},{name:"Trampa Rocas",type:"Roca",category:"Estado"},{name:"Drenadoras",type:"Planta",category:"Estado"}]},{name:"Gigalith",id:526,types:["Rock"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/526.png",location:"Cueva Manantial",role:"ü™® Potencia Lenta",item:"Gema Roca",nature:"Audaz",moves:[{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Explosi√≥n",type:"Normal",category:"F√≠sico"},{name:"Fuerza Bruta",type:"Lucha",category:"F√≠sico"}]}]},weather_sand:{id:"weather_sand",name:"üå™Ô∏è Tormenta de Arena",category:"mechanic",description:"Aprovecha a Excadrill con √çmpetu Arena, aunque Tyranitar es post-game, Gigalith aguanta.",pokemon:[{name:"Gigalith",id:526,types:["Rock"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/526.png",location:"Cueva Manantial",role:"ü™® Setter F√≠sico",item:"Restos",nature:"Audaz",moves:[{name:"Roca Afilada",type:"Roca",category:"F√≠sico"},{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Explosi√≥n",type:"Normal",category:"F√≠sico"},{name:"Trampa Rocas",type:"Roca",category:"Estado"}]},{name:"Excadrill",id:530,types:["Ground","Steel"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/530.png",location:"Cueva Manantial",role:"üöÄ √çmpetu Arena",item:"Vida Orbe",nature:"Firme",moves:[{name:"Terremoto",type:"Tierra",category:"F√≠sico"},{name:"Avalancha",type:"Roca",category:"F√≠sico"},{name:"Danza Espada",type:"Normal",category:"Estado"},{name:"Cabeza de Hierro",type:"Acero",category:"F√≠sico"}]},{name:"Stoutland",id:508,types:["Normal"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/508.png",location:"Ruta 1",role:"üêï √çmpetu Arena",item:"Pa√±uelo Seda",nature:"Firme",moves:[{name:"Represalia",type:"Normal",category:"F√≠sico"},{name:"Colmillo Fuego",type:"Fuego",category:"F√≠sico"},{name:"Colmillo Hielo",type:"Hielo",category:"F√≠sico"},{name:"Triturar",type:"Siniestro",category:"F√≠sico"}]},{name:"Reuniclus",id:579,types:["Psychic"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/579.png",location:"Ruta 5",role:"‚ú® Muro M√°gico",item:"Restos",nature:"Modesta",moves:[{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Onda Certera",type:"Lucha",category:"Especial"},{name:"Recuperaci√≥n",type:"Normal",category:"Estado"},{name:"Paz Mental",type:"Ps√≠quico",category:"Estado"}]},{name:"Ferrothorn",id:598,types:["Grass","Steel"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/598.png",location:"Cueva Electrorroca",role:"üè∞ Defensor",item:"Casco Dentado",nature:"Pl√°cida",moves:[{name:"Latigazo",type:"Planta",category:"F√≠sico"},{name:"Giro Bola",type:"Acero",category:"F√≠sico"},{name:"Desrenadoras",type:"Planta",category:"Estado"},{name:"P√∫as",type:"Tierra",category:"Estado"}]},{name:"Sigilyph",id:561,types:["Psychic","Flying"],image:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/561.png",location:"Zona Desierto",role:"‚ú® Inmune Tierra",item:"Llama Esfera",nature:"Miedosa",moves:[{name:"Ps√≠quico",type:"Ps√≠quico",category:"Especial"},{name:"Tajo A√©reo",type:"Volador",category:"Especial"},{name:"Masa C√≥smica",type:"Ps√≠quico",category:"Estado"},{name:"Poderreserva",type:"Ps√≠quico",category:"Especial"}]}]}},wu={Normal:"Normal",Fire:"Fuego",Water:"Agua",Grass:"Planta",Electric:"El√©ctrico",Ice:"Hielo",Fighting:"Lucha",Poison:"Veneno",Ground:"Tierra",Flying:"Volador",Psychic:"Ps√≠quico",Bug:"Bicho",Rock:"Roca",Ghost:"Fantasma",Dragon:"Drag√≥n",Steel:"Acero",Dark:"Siniestro"};function Do(a){if(!a)return"";const e=a.charAt(0).toUpperCase()+a.slice(1).toLowerCase();return wu[e]||a}const Pu={Placaje:{type:"Normal",category:"F√≠sico",power:40,accuracy:100,desc:"Embiste al objetivo con todo el cuerpo."},Imagen:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Crea copias ilusorias que aumentan la Evasi√≥n."},Derribo:{type:"Normal",category:"F√≠sico",power:90,accuracy:100,desc:"Placaje potente que tambi√©n da√±a al atacante."},"Golpe Cuerpo":{type:"Normal",category:"F√≠sico",power:85,accuracy:100,desc:"Golpe con todo el cuerpo. Puede paralizar."},"Ataque R√°pido":{type:"Normal",category:"F√≠sico",power:40,accuracy:100,desc:"Ataque veloz que siempre golpea primero."},Rapidez:{type:"Normal",category:"Especial",power:60,accuracy:100,desc:"Lanza estrellas que nunca fallan."},"Otra Vez":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Obliga al rival a repetir su √∫ltimo movimiento."},Finta:{type:"Siniestro",category:"F√≠sico",power:60,accuracy:100,desc:"Ataque que ignora Protecci√≥n y Detecci√≥n."},Cuchillada:{type:"Normal",category:"F√≠sico",power:70,accuracy:100,desc:"Corte con garras. Alta prob. de golpe cr√≠tico."},Hiperrayo:{type:"Normal",category:"Especial",power:150,accuracy:90,desc:"Rayo devastador. Requiere recarga despu√©s."},"Doble Filo":{type:"Normal",category:"F√≠sico",power:120,accuracy:100,desc:"Ataque temerario que da√±a mucho al usuario."},S√≥nico:{type:"Normal",category:"Especial",power:null,accuracy:100,desc:"Onda s√≥nica que causa da√±o fijo de 20 PS."},Supers√≥nico:{type:"Normal",category:"Estado",power:null,accuracy:55,desc:"Ondas que confunden al objetivo."},Salpicar:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"No hace absolutamente nada."},"Rizo Defensa":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Se enrosca para subir la Defensa."},Fortaleza:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Tensa los m√∫sculos para subir la Defensa."},Bloqueo:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Impide que el objetivo huya o sea cambiado."},Malicioso:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Mirada intimidante que baja la Defensa rival."},Aullido:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"A√∫lla para subir el Ataque Especial."},Atracci√≥n:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Enamora al rival si es de sexo opuesto."},"Doble Equipo":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Crea copias para aumentar la Evasi√≥n."},Protecci√≥n:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Evita todos los ataques ese turno."},"Velo Sagrado":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Protege al equipo de estados alterados."},"Danza Caos":{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Danza que sube Ataque pero confunde."},Tambor:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Maximiza Ataque a costa de PS."},Relajo:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"No hace nada. Habilidad Ausente lo usa."},Bostezo:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Hace bostezar al rival. Dormir√° el siguiente turno."},Contoneo:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Sube el Ataque rival pero lo confunde."},Rugido:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Asusta al rival y lo cambia por otro."},"Beso Dulce":{type:"Normal",category:"Estado",power:null,accuracy:75,desc:"Beso que confunde al objetivo."},Recuperaci√≥n:{type:"Normal",category:"Estado",power:null,accuracy:100,desc:"Recupera la mitad de los PS m√°ximos."},Explosi√≥n:{type:"Normal",category:"F√≠sico",power:250,accuracy:100,desc:"Explosi√≥n masiva. El usuario se debilita."},Autodestrucci√≥n:{type:"Normal",category:"F√≠sico",power:200,accuracy:100,desc:"Explosi√≥n que debilita al usuario."},Lanzallamas:{type:"Fuego",category:"Especial",power:95,accuracy:100,desc:"Lanza llamas intensas. Puede quemar."},Sofoco:{type:"Fuego",category:"Especial",power:140,accuracy:90,desc:"Ataque devastador que baja At. Esp. propio."},"Fuego Fatuo":{type:"Fuego",category:"Estado",power:null,accuracy:75,desc:"Fuego fantasmal que quema al objetivo."},"D√≠a Soleado":{type:"Fuego",category:"Estado",power:null,accuracy:100,desc:"Intensifica el sol. Potencia ataques de Fuego."},Surf:{type:"Agua",category:"Especial",power:95,accuracy:100,desc:"Gran ola que golpea a todos en combate."},Hidropulso:{type:"Agua",category:"Especial",power:60,accuracy:100,desc:"Onda de agua. Puede confundir."},Hidrobomba:{type:"Agua",category:"Especial",power:120,accuracy:80,desc:"Potente chorro de agua a presi√≥n."},Buceo:{type:"Agua",category:"F√≠sico",power:60,accuracy:100,desc:"Se sumerge y ataca en el siguiente turno."},Cascada:{type:"Agua",category:"F√≠sico",power:80,accuracy:100,desc:"Carga con una cascada. Puede hacer retroceder."},Azote:{type:"Normal",category:"F√≠sico",power:null,accuracy:100,desc:"M√°s da√±o cuanto menos PS tenga el usuario."},"Danza Lluvia":{type:"Agua",category:"Estado",power:null,accuracy:100,desc:"Invoca lluvia. Potencia ataques de Agua."},Rayo:{type:"El√©ctrico",category:"Especial",power:95,accuracy:100,desc:"Descarga el√©ctrica potente. Puede paralizar."},"Onda Trueno":{type:"El√©ctrico",category:"Estado",power:null,accuracy:100,desc:"Onda el√©ctrica que paraliza al objetivo."},Chispa:{type:"El√©ctrico",category:"F√≠sico",power:65,accuracy:100,desc:"Placaje el√©ctrico. Puede paralizar."},"Onda Voltio":{type:"El√©ctrico",category:"Especial",power:60,accuracy:100,desc:"Descarga el√©ctrica que siempre paraliza."},"Giga Drenado":{type:"Planta",category:"Especial",power:60,accuracy:100,desc:"Absorbe PS del rival. Cura la mitad del da√±o."},"Rayo Solar":{type:"Planta",category:"Especial",power:120,accuracy:100,desc:"Carga luz solar y ataca. Instant√°neo con sol."},Drenadoras:{type:"Planta",category:"Estado",power:null,accuracy:100,desc:"Planta semillas que drenan PS cada turno."},"Espora Alg.":{type:"Planta",category:"Estado",power:null,accuracy:75,desc:"Esparce esporas que bajan la Velocidad."},"Brazo Pincho":{type:"Planta",category:"F√≠sico",power:60,accuracy:100,desc:"Golpea con brazo espinoso. Alta prob. cr√≠tico."},Espora:{type:"Planta",category:"Estado",power:null,accuracy:100,desc:"Esparce esporas que duermen al objetivo."},"Rayo Hielo":{type:"Hielo",category:"Especial",power:95,accuracy:100,desc:"Rayo helado que puede congelar al rival."},"Rayo Aurora":{type:"Hielo",category:"Especial",power:65,accuracy:100,desc:"Velo helado multicolor. Puede congelar."},Ventisca:{type:"Hielo",category:"Especial",power:120,accuracy:70,desc:"Tormenta de nieve brutal. Puede congelar."},"Bola Hielo":{type:"Hielo",category:"F√≠sico",power:30,accuracy:90,desc:"Bola de hielo que incrementa poder cada turno."},"Fr√≠o Agudo":{type:"Hielo",category:"Especial",power:null,accuracy:30,desc:"Ataque que debilita de un golpe si acierta."},Granizo:{type:"Hielo",category:"Estado",power:null,accuracy:100,desc:"Invoca granizo que da√±a a no-Hielo."},"Patada Baja":{type:"Lucha",category:"F√≠sico",power:65,accuracy:100,desc:"Patada baja. M√°s da√±o a rivales pesados."},"Karate-choque":{type:"Lucha",category:"F√≠sico",power:50,accuracy:100,desc:"Golpe certero con alta prob. de cr√≠tico."},"Mov. S√≠smico":{type:"Lucha",category:"F√≠sico",power:null,accuracy:100,desc:"Lanza al rival. Da√±o igual al nivel del usuario."},"Pu√±o Certero":{type:"Lucha",category:"F√≠sico",power:150,accuracy:50,desc:"Golpe devastador pero de baja precisi√≥n."},Corpulencia:{type:"Lucha",category:"Estado",power:null,accuracy:100,desc:"Tensa m√∫sculos. Sube Ataque y Defensa."},Empuj√≥n:{type:"Lucha",category:"F√≠sico",power:20,accuracy:100,desc:"Empuja con las palmas. Ataca primero."},"Tiro Vital":{type:"Lucha",category:"F√≠sico",power:70,accuracy:100,desc:"Ataca un punto vital. Alta prob. de cr√≠tico."},Inversi√≥n:{type:"Lucha",category:"F√≠sico",power:null,accuracy:100,desc:"M√°s da√±o cuanto menos PS tenga el usuario."},"Gancho Alto":{type:"Lucha",category:"F√≠sico",power:85,accuracy:100,desc:"Pu√±etazo ascendente muy potente."},Demolici√≥n:{type:"Lucha",category:"F√≠sico",power:75,accuracy:100,desc:"Pu√±etazo fuerte capaz de romper barreras."},Martillazo:{type:"Lucha",category:"F√≠sico",power:100,accuracy:100,desc:"Golpe con las pinzas muy potente."},Poluci√≥n:{type:"Veneno",category:"Especial",power:30,accuracy:75,desc:"Ba√±o de lodo. Puede envenenar."},"Bomba Lodo":{type:"Veneno",category:"Especial",power:90,accuracy:100,desc:"Lanza lodo t√≥xico. Puede envenenar."},T√≥xico:{type:"Veneno",category:"Estado",power:null,accuracy:90,desc:"Envenena gravemente. Da√±o crece cada turno."},Terremoto:{type:"Tierra",category:"F√≠sico",power:100,accuracy:100,desc:"Terremoto que golpea a todos los adyacentes."},Magnitud:{type:"Tierra",category:"F√≠sico",power:null,accuracy:100,desc:"Terremoto de intensidad variable (10-150)."},"Ataque Arena":{type:"Tierra",category:"Estado",power:null,accuracy:100,desc:"Lanza arena que baja la Precisi√≥n rival."},"Tormenta Arena":{type:"Roca",category:"Estado",power:null,accuracy:100,desc:"Tormenta de arena que da√±a a no-Tierra/Roca/Acero."},Vuelo:{type:"Volador",category:"F√≠sico",power:70,accuracy:100,desc:"Vuela alto y ataca en el siguiente turno."},"Golpe A√©reo":{type:"Volador",category:"F√≠sico",power:60,accuracy:100,desc:"Ataque a√©reo que nunca falla."},"Mov. Espejo":{type:"Volador",category:"Especial",power:null,accuracy:100,desc:"Devuelve el da√±o especial recibido x2."},Ps√≠quico:{type:"Ps√≠quico",category:"Especial",power:90,accuracy:100,desc:"Onda ps√≠quica potente. Puede bajar Def. Esp."},Psicorrayo:{type:"Ps√≠quico",category:"Especial",power:65,accuracy:100,desc:"Rayo ps√≠quico que puede confundir."},Reflejo:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Barrera que reduce da√±o f√≠sico al equipo."},"Pantalla Luz":{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Barrera que reduce da√±o especial al equipo."},"Paz Mental":{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Meditaci√≥n que sube At. Esp. y Def. Esp."},Descanso:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Duerme 2 turnos pero cura todos los PS."},Hipnosis:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:60,desc:"Ondas hipn√≥ticas que duermen al objetivo."},Paranormal:{type:"Ps√≠quico",category:"Especial",power:80,accuracy:100,desc:"Ataque con poderes ps√≠quicos extra√±os."},"Rayo Confuso":{type:"Fantasma",category:"Estado",power:null,accuracy:100,desc:"Luz siniestra que confunde al objetivo."},Agilidad:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Relaja el cuerpo para subir mucho la Velocidad."},Amnesia:{type:"Ps√≠quico",category:"Estado",power:null,accuracy:100,desc:"Vac√≠a la mente para subir mucho Def. Esp."},"Lanza Rocas":{type:"Roca",category:"F√≠sico",power:50,accuracy:90,desc:"Lanza rocas peque√±as al objetivo."},"Tumba Rocas":{type:"Roca",category:"F√≠sico",power:50,accuracy:80,desc:"Lanza rocas que bajan la Velocidad rival."},"Poder Pasado":{type:"Roca",category:"Especial",power:60,accuracy:100,desc:"Poder ancestral. Puede subir todas las stats."},Avalancha:{type:"Roca",category:"F√≠sico",power:75,accuracy:90,desc:"Lanza rocas. M√°s da√±o si el usuario fue da√±ado."},Desenrollar:{type:"Roca",category:"F√≠sico",power:30,accuracy:100,desc:"Rueda que incrementa poder cada turno."},"Bola Sombra":{type:"Fantasma",category:"Especial",power:80,accuracy:100,desc:"Lanza bola de sombras. Puede bajar Def. Esp."},"Pu√±o Sombra":{type:"Fantasma",category:"F√≠sico",power:60,accuracy:100,desc:"Pu√±etazo de sombras. Golpea primero."},Maldici√≥n:{type:"Fantasma",category:"Estado",power:null,accuracy:100,desc:"Fantasma: maldice a costa de PS. Otro: sube stats."},Tinieblas:{type:"Fantasma",category:"Especial",power:null,accuracy:100,desc:"M√°s da√±o cuanto m√°s PS tenga el usuario."},Dragoaliento:{type:"Drag√≥n",category:"Especial",power:60,accuracy:100,desc:"Aliento drag√≥n. Puede paralizar."},"Garra Drag√≥n":{type:"Drag√≥n",category:"F√≠sico",power:80,accuracy:100,desc:"Zarpazo con garras afiladas de drag√≥n."},"Danza Drag√≥n":{type:"Drag√≥n",category:"Estado",power:null,accuracy:100,desc:"Danza m√≠stica que sube Ataque y Velocidad."},Mordisco:{type:"Siniestro",category:"F√≠sico",power:60,accuracy:100,desc:"Muerde con colmillos. Puede hacer retroceder."},Triturar:{type:"Siniestro",category:"F√≠sico",power:80,accuracy:100,desc:"Tritura con mand√≠bulas. Puede bajar Defensa."},Acuchillar:{type:"Siniestro",category:"F√≠sico",power:70,accuracy:100,desc:"Corte siniestro. Alta prob. de cr√≠tico."},Mofa:{type:"Siniestro",category:"Estado",power:null,accuracy:100,desc:"Provoca al rival. Solo puede usar ataques."},"Ala de Acero":{type:"Acero",category:"F√≠sico",power:70,accuracy:100,desc:"Golpea con alas de acero. Puede subir Defensa."},Voltiocambio:{type:"El√©ctrico",category:"Especial",power:70,accuracy:100,desc:"Ataca y cambia al usuario por otro Pok√©mon."},Represalia:{type:"Normal",category:"F√≠sico",power:70,accuracy:100,desc:"Doble de potencia si un aliado cay√≥ el turno anterior."},Antia√©reo:{type:"Roca",category:"F√≠sico",power:50,accuracy:100,desc:"Derriba a objetivos en vuelo o levitaci√≥n."},Nitrocarga:{type:"Fuego",category:"F√≠sico",power:50,accuracy:100,desc:"Ataca y sube la Velocidad del usuario."},Terratemblor:{type:"Tierra",category:"F√≠sico",power:60,accuracy:100,desc:"Baja la Velocidad del objetivo."},Acr√≥bata:{type:"Volador",category:"F√≠sico",power:55,accuracy:100,desc:"Doble potencia si no lleva objeto."},"Vaho G√©lido":{type:"Hielo",category:"Especial",power:60,accuracy:90,desc:"Siempre resulta en golpe cr√≠tico."},"Cola Drag√≥n":{type:"Drag√≥n",category:"F√≠sico",power:60,accuracy:90,desc:"Obliga al objetivo a cambiar de Pok√©mon."},"Tajo Umbr√≠o":{type:"Siniestro",category:"F√≠sico",power:70,accuracy:100,desc:"Alta probabilidad de golpe cr√≠tico."},"Tijera X":{type:"Bicho",category:"F√≠sico",power:80,accuracy:100,desc:"Corte cruzado con guada√±as o garras."},Zumbido:{type:"Bicho",category:"Especial",power:90,accuracy:100,desc:"Vibraci√≥n s√≥nica. Puede bajar Def. Esp."},Energibola:{type:"Planta",category:"Especial",power:90,accuracy:100,desc:"Bola de energ√≠a natural. Puede bajar Def. Esp."},"Onda Certera":{type:"Lucha",category:"Especial",power:120,accuracy:70,desc:"Golpe certero pero poco preciso. Puede bajar Def. Esp."},"Foco Resplandor":{type:"Acero",category:"Especial",power:80,accuracy:100,desc:"Disparo de luz. Puede bajar Def. Esp."},Cabezahierro:{type:"Acero",category:"F√≠sico",power:80,accuracy:100,desc:"Cabezazo de acero. Puede hacer retroceder."},Escaldar:{type:"Agua",category:"Especial",power:80,accuracy:100,desc:"Chorro de agua hirviendo. Puede quemar."},"Ida y Vuelta":{type:"Bicho",category:"F√≠sico",power:70,accuracy:100,desc:"Ataca y cambia al usuario."},Picadura:{type:"Bicho",category:"F√≠sico",power:60,accuracy:100,desc:"Roba y come la baya del rival."},"Juego Sucio":{type:"Siniestro",category:"F√≠sico",power:95,accuracy:100,desc:"Usa el Ataque del rival para calcular el da√±o."}};function Tu(a){switch(a){case"F√≠sico":return"üí•";case"Especial":return"‚ú®";case"Estado":return"üîÑ";default:return"‚ùì"}}const qc={emerald:{"--primary-color":"#2d9e6d","--primary-rgb":"45, 158, 109","--primary-glow":"#6ee7b7","--ray-black":"#080a09","--ray-charcoal":"#111413","--glass-bg":"rgba(22, 26, 24, 0.6)","--glass-strong":"rgba(10, 15, 12, 0.85)","--bg-image":`radial-gradient(circle at 50% 0%, rgba(45, 158, 109, 0.15) 0%, transparent 50%),
                   radial-gradient(circle at 85% 90%, rgba(247, 207, 82, 0.05) 0%, transparent 40%)`},platinum:{"--primary-color":"#d4af37","--primary-rgb":"212, 175, 55","--primary-glow":"#f9e58b","--ray-black":"#0a0a0c","--ray-charcoal":"#141418","--glass-bg":"rgba(20, 20, 24, 0.6)","--glass-strong":"rgba(10, 10, 14, 0.85)","--bg-image":`radial-gradient(circle at 50% 0%, rgba(212, 175, 55, 0.15) 0%, transparent 60%),
                   radial-gradient(circle at 15% 90%, rgba(75, 75, 90, 0.1) 0%, transparent 40%)`},white:{"--primary-color":"#00d2ff","--primary-rgb":"0, 210, 255","--primary-glow":"#a3eaff","--ray-black":"#050510","--ray-charcoal":"#10101e","--glass-bg":"rgba(16, 20, 30, 0.6)","--glass-strong":"rgba(8, 10, 20, 0.85)","--bg-image":`radial-gradient(circle at 60% 0%, rgba(0, 210, 255, 0.15) 0%, transparent 60%),
                       radial-gradient(circle at 20% 90%, rgba(100, 100, 255, 0.1) 0%, transparent 50%)`}},pe={EMERALD:"emerald",PLATINUM:"platinum",WHITE:"white"};function ve(){return localStorage.getItem("selectedGame")||pe.EMERALD}function eh(a){Object.values(pe).includes(a)&&(localStorage.setItem("selectedGame",a),ah())}function th(a){switch(a){case pe.PLATINUM:return"Pok√©mon Platino";case pe.WHITE:return"Pok√©mon Blanco";default:return"Pok√©mon Esmeralda"}}function ah(){const a=ve();Iu(a),window.dispatchEvent(new CustomEvent("gameChanged",{detail:a}))}function Iu(a){const e=qc[a]||qc[pe.EMERALD];Object.entries(e).forEach(([t,r])=>{document.documentElement.style.setProperty(t,r)})}const ji="https://pokeapi.co/api/v2",an={pokemon:new Map,species:new Map,evolutionChain:new Map,moves:new Map},Mo={emerald:"emerald",platinum:"platinum"};async function rn(a,e,t){if(e.has(t))return e.get(t);try{const r=await fetch(a);if(!r.ok)throw new Error(`HTTP ${r.status}`);const o=await r.json();return e.set(t,o),o}catch(r){throw console.error(`PokeAPI fetch error for ${a}:`,r),r}}async function on(a){const e=String(a).toLowerCase(),t=`${ji}/pokemon/${e}`;return rn(t,an.pokemon,e)}async function ku(a){const e=String(a).toLowerCase(),t=`${ji}/pokemon-species/${e}`;return rn(t,an.species,e)}async function rh(a){try{const t=(await ku(a)).evolution_chain.url,r=t.split("/").filter(Boolean).pop(),o=await rn(t,an.evolutionChain,r);return Cu(o.chain)}catch(e){return console.error("Error fetching evolution chain:",e),[]}}function Cu(a,e=[]){const t=a.species.name,r=a.species.url.split("/").filter(Boolean).pop();let o=null;if(a.evolution_details&&a.evolution_details.length>0){const i=a.evolution_details[0];o={trigger:i.trigger?.name||null,minLevel:i.min_level||null,item:i.item?.name||null,heldItem:i.held_item?.name||null,timeOfDay:i.time_of_day||null,minHappiness:i.min_happiness||null,minAffection:i.min_affection||null,location:i.location?.name||null,knownMove:i.known_move?.name||null,knownMoveType:i.known_move_type?.name||null}}if(e.push({name:t,id:parseInt(r),sprite:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${r}.png`,evolutionDetails:o}),a.evolves_to&&a.evolves_to.length>0)for(const i of a.evolves_to)Cu(i,e);return e}async function Su(a,e){try{const t=await on(a),r=[];for(const o of t.moves){const i=o.version_group_details.find(s=>s.version_group.name===e&&s.move_learn_method.name==="level-up"&&s.level_learned_at>0);i&&r.push({name:o.move.name,level:i.level_learned_at,url:o.move.url})}return r.sort((o,i)=>o.level-i.level),r}catch(t){return console.error("Error fetching learnset:",t),[]}}async function oh(a,e){try{const t=await on(a),r=[];let o=!1;for(const l of t.moves){let d=l.version_group_details.find(m=>m.version_group.name===e);d?o=!0:l.version_group_details.length>0&&(d=l.version_group_details[l.version_group_details.length-1]),d&&r.push({name:l.move.name,method:d.move_learn_method.name,level:d.level_learned_at,url:l.move.url})}o||console.warn(`[PokeAPI] No moves found for version group "${e}". Falling back to latest available moves.`);const i=r.map(l=>nn(l.name)),s=await Promise.all(i);return r.map((l,d)=>{const m=s[d];return m?{...l,...m,displayName:m.displayName||Je(l.name)}:null}).filter(l=>l!==null)}catch(t){return console.error("Error getting all learnable moves",t),[]}}async function nn(a){const e=String(a).toLowerCase(),t=`${ji}/move/${e}`;try{const r=await rn(t,an.moves,e),o=r.names.find(m=>m.language.name==="es"),i=o?o.name:Fu[r.name]||Je(r.name);let s="";const l=r.flavor_text_entries.find(m=>m.language.name==="es"),d=r.flavor_text_entries.find(m=>m.language.name==="en");return s=l?.flavor_text||d?.flavor_text||"",{name:r.name,displayName:i,type:r.type.name,typeTranslated:Va[r.type.name]||r.type.name,power:r.power,accuracy:r.accuracy,pp:r.pp,damageClass:r.damage_class.name,damageClassTranslated:Du[r.damage_class.name]||r.damage_class.name,description:s.replace(/\n|\f/g," ")}}catch(r){return console.error(`Error fetching move ${a}:`,r),null}}async function Ru(a,e="emerald"){try{const[t,r,o,i]=await Promise.all([on(a),ku(a),rh(a),Su(a,e)]),l=r.names.find(p=>p.language.name==="es")?.name||t.name;let d="";const m=e==="platinum"?["platinum","diamond","pearl","heartgold","soulsilver"]:["emerald","ruby","sapphire","firered","leafgreen"];for(const p of m){const g=r.flavor_text_entries.find(E=>E.language.name==="es"&&E.version.name===p);if(g){d=g.flavor_text.replace(/\n|\f/g," ");break}}if(!d){const p=r.flavor_text_entries.find(g=>g.language.name==="es");p&&(d=p.flavor_text.replace(/\n|\f/g," "))}if(!d){const p=r.flavor_text_entries.find(g=>g.language.name==="en");p&&(d=p.flavor_text.replace(/\n|\f/g," "))}return{id:t.id,name:l,englishName:t.name,types:t.types.map(p=>p.type.name),sprite:t.sprites.front_default,spriteAnimated:t.sprites.versions?.["generation-v"]?.["black-white"]?.animated?.front_default,stats:{hp:t.stats.find(p=>p.stat.name==="hp").base_stat,attack:t.stats.find(p=>p.stat.name==="attack").base_stat,defense:t.stats.find(p=>p.stat.name==="defense").base_stat,spAttack:t.stats.find(p=>p.stat.name==="special-attack").base_stat,spDefense:t.stats.find(p=>p.stat.name==="special-defense").base_stat,speed:t.stats.find(p=>p.stat.name==="speed").base_stat},height:t.height/10,weight:t.weight/10,abilities:t.abilities.map(p=>({name:p.ability.name,isHidden:p.is_hidden})),flavorText:d,evolutionChain:o,learnset:i}}catch(t){throw console.error("Error fetching complete Pokemon info:",t),t}}function Je(a){return a.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}const Va={normal:"Normal",fire:"Fuego",water:"Agua",electric:"El√©ctrico",grass:"Planta",ice:"Hielo",fighting:"Lucha",poison:"Veneno",ground:"Tierra",flying:"Volador",psychic:"Ps√≠quico",bug:"Bicho",rock:"Roca",ghost:"Fantasma",dragon:"Drag√≥n",dark:"Siniestro",steel:"Acero",fairy:"Hada"},Du={physical:"F√≠sico",special:"Especial",status:"Estado"},Mu={"fire-stone":"Piedra Fuego","water-stone":"Piedra Agua","thunder-stone":"Piedra Trueno","leaf-stone":"Piedra Hoja","moon-stone":"Piedra Lunar","sun-stone":"Piedra Solar","shiny-stone":"Piedra D√≠a","dusk-stone":"Piedra Noche","dawn-stone":"Piedra Alba","oval-stone":"Piedra Oval",protector:"Protector",electirizer:"Electrizador",magmarizer:"Magmatizador","dubious-disc":"Disco Extra√±o","reaper-cloth":"Tela Terrible","razor-claw":"Garra Afilada","razor-fang":"Colmillo Agudo","prism-scale":"Escama Bella","kings-rock":"Roca del Rey","metal-coat":"Revest. Met√°l.","dragon-scale":"Escama Drag√≥n",upgrade:"Mejora","deep-sea-tooth":"Diente Marino","deep-sea-scale":"Escama Marina","link-cable":"Cable Link"},nh={"kings-rock":"Roca del Rey","metal-coat":"Revest. Met√°l.","dragon-scale":"Escama Drag√≥n","deep-sea-tooth":"Diente Marino","deep-sea-scale":"Escama Marina",electirizer:"Electrizador",magmarizer:"Magmatizador",protector:"Protector","dubious-disc":"Disco Extra√±o","reaper-cloth":"Tela Terrible","prism-scale":"Escama Bella","whipped-dream":"Dulce de Nata",sachet:"Saquito Aroma"},ih={"level-up":"Subir nivel",trade:"Intercambio","use-item":"Usar objeto",shed:"Muda",spin:"Girar","tower-of-darkness":"Torre Oscura","tower-of-waters":"Torre Agua","three-critical-hits":"3 Golpes Cr√≠ticos","take-damage":"Recibir da√±o",other:"Otro"},sh={"eterna-forest":"Bosque Eterno","pinwheel-forest":"Bosque Azulejo","kalos-route-20":"Ruta 20 (Kalos)","mt-coronet":"Monte Corona","chargestone-cave":"Cueva Electrorroca","new-mauville":"Nuevo Malvalona","twist-mountain":"Monte Tuerca","frost-cavern":"Cueva Helada","sinnoh-route-217":"Ruta 217 (Sinnoh)","mossy-rock":"Roca Musgo","icy-rock":"Roca Hielo","magnetic-field":"Campo Magn√©tico"},ch={overgrow:"Espesura",blaze:"Mar Llamas",torrent:"Torrente",swarm:"Enjambre",chlorophyll:"Clorofila","solar-power":"Poder Solar","swift-swim":"Nado R√°pido","rain-dish":"Cura Lluvia","sand-stream":"Chorro Arena","snow-warning":"Alerta Nieve",drought:"Sequ√≠a",drizzle:"Llovizna","flash-fire":"Absorbe Fuego",levitate:"Levitaci√≥n",intimidate:"Intimidaci√≥n","hyper-cutter":"Corte Fuerte","huge-power":"Potencia","pure-power":"Energ√≠a Pura","speed-boost":"Impulso",sturdy:"Robustez",static:"Elec. Est√°tica","lightning-rod":"Pararrayos","volt-absorb":"Absorbe Elec","water-absorb":"Absorbe Agua","natural-cure":"Cura Natural",synchronize:"Sincron√≠a",trace:"Rastro","clear-body":"Cuerpo Puro","thick-fat":"Grasa Espesa","marvel-scale":"Escama Especial","shed-skin":"Mudar",guts:"Agallas",pressure:"Presi√≥n","inner-focus":"Foco Interno","wonder-guard":"Superguarda","poison-point":"Punto T√≥xico","effect-spore":"Efecto Espora","flame-body":"Cuerpo Llama","magma-armor":"Armadura Magma","compound-eyes":"Ojo Compuesto","keen-eye":"Vista Lince","arena-trap":"Trampa Arena","shadow-tag":"Sombra Trampa","rough-skin":"Piel Tosca","sand-veil":"Velo Arena","snow-cloak":"Manto N√≠veo",pickup:"Recogida","run-away":"Fuga",hustle:"Entusiasmo",rivalry:"Rivalidad",adaptability:"Adaptable",technician:"Experto","skill-link":"Encadenado","serene-grace":"Dicha","shield-dust":"Polvo Escudo","magic-guard":"Muro M√°gico","mold-breaker":"Rompemoldes","iron-fist":"Pu√±o F√©rreo","sheer-force":"Potencia Bruta",prankster:"Bromista",defiant:"Competitivo",justified:"Justiciero",moody:"Veleta",multiscale:"Multiescamas",regenerator:"Regeneraci√≥n","poison-heal":"Ant√≠doto","magic-bounce":"Espejo M√°gico","sand-rush":"√çmpetu Arena",chlorophyl:"Clorofila","swift-swin":"Nado R√°pido",drizzle:"Llovizna",forecast:"Predicci√≥n","battle-armor":"Armadura Batalla","shell-armor":"Caparaz√≥n","air-lock":"Esclusa Aire","stance-change":"Cambio T√°ctico",protean:"Mutatipo",pixilate:"Piel Fe√©rica",aerilate:"Piel Celeste",refrigerate:"Piel Helada",galvanize:"Piel El√©ctrica","beast-boost":"Ultraimpulso","electric-surge":"Creador Campo El√©ctrico","grassy-surge":"Creador Campo de Hierba","misty-surge":"Creador Campo de Niebla","psychic-surge":"Creador Campo Ps√≠quico",damp:"Humedad",oblivious:"Despiste",immunity:"Inmunidad","own-tempo":"Ritmo Propio",limber:"Flexibilidad",insomnia:"Insomnio","vital-spirit":"Esp√≠ritu Vital","early-bird":"Madrugar","cute-charm":"Gran Encanto","rock-head":"Cabeza Roca",truant:"Ausente",stench:"Hedor","suction-cups":"Ventosas",illuminate:"Iluminaci√≥n",soundproof:"Insonorizar","sticky-hold":"Pegamento","magnet-pull":"Im√°n","color-change":"Cambiacolor","liquid-ooze":"Viscosidad",gluttony:"Gula","white-smoke":"Humo Blanco",hydration:"Hidrataci√≥n",filter:"Filtro","solid-rock":"Roca S√≥lida","anger-point":"Irascible",unaware:"Ignorante","tinted-lens":"Cromolente","super-luck":"Afortunado",aftermath:"Detonaci√≥n",sniper:"Francotirador","ice-body":"G√©lido",download:"Descarga",simple:"Simple","dry-skin":"Piel Seca",reckless:"Audaz",rivalry:"Rivalidad",steadfast:"Impasible","no-guard":"Indefenso",stall:"Rezagado","leaf-guard":"Defensa Hoja",klutz:"Zoquete","bad-dreams":"Mal Sue√±o","slow-start":"Inicio Lento",scrappy:"Agallas",normalize:"Normalizar","tangled-feet":"Pies Confusos","motor-drive":"Electromotor",unburden:"Liviano",heatproof:"Ign√≠fugo","honey-gather":"Recogemiel",frisk:"Cacheo"};function lh(a){return ch[a]||Je(a)}function uh(a){return Mu[a]||Je(a)}function dh(a){return nh[a]||Mu[a]||Je(a)}function mh(a){return sh[a]||Je(a)}function ph(a){return ih[a]||Je(a)}const Fu={tackle:"Placaje",scratch:"Ara√±azo",pound:"Destructor",slam:"Portazo",stomp:"Pisot√≥n","mega-punch":"Megapu√±o","mega-kick":"Megapatada","comet-punch":"Pu√±o Cometa","double-slap":"Doble Bofet√≥n",wrap:"Atadura",bind:"Constricci√≥n",clamp:"Tenaza","vice-grip":"Agarre",guillotine:"Guillotina","razor-wind":"Viento Cortante",gust:"Tornado","pay-day":"D√≠a de Pago","horn-attack":"Cornada","horn-drill":"Perforador","fury-attack":"Ataque Furia","fury-swipes":"Golpes Furia",barrage:"Bombardeo","spike-cannon":"Clavo Ca√±√≥n",bonemerang:"Huesomerang","bone-rush":"Ataque √ìseo","bone-club":"Hueso Palo","skull-bash":"Cabezazo",growl:"Gru√±ido",leer:"Malicioso","tail-whip":"L√°tigo","sand-attack":"Ataque Arena",smokescreen:"Pantalla Humo",harden:"Fortaleza",withdraw:"Refugio","defense-curl":"Rizo Defensa",minimize:"Reducci√≥n",growth:"Desarrollo",meditate:"Meditaci√≥n",sharpen:"Afilar",foresight:"Profec√≠a","odor-sleuth":"Rastreo","mud-sport":"Chapoteo Lodo","water-sport":"Hidrochorro",bide:"Venganza","focus-energy":"Foco Energ√≠a",stockpile:"Reserva","spit-up":"Escupir",swallow:"Tragar",conversion:"Conversi√≥n","conversion-2":"Conversi√≥n 2",camouflage:"Camuflaje",spite:"Rencor",powder:"Polvo","lucky-chant":"Conjuro","guard-swap":"Cambia Defensa","power-swap":"Cambia Fuerza","heart-swap":"Cambia Almas","skill-swap":"Intercambio","role-play":"Imitaci√≥n",ember:"Ascuas",flamethrower:"Lanzallamas","fire-blast":"Llamarada","fire-spin":"Giro Fuego","fire-punch":"Pu√±o Fuego","fire-fang":"Colmillo √çgneo","flame-wheel":"Rueda Fuego","blaze-kick":"Patada √çgnea","heat-wave":"Onda √çgnea",eruption:"Estallido","lava-plume":"Humareda","magma-storm":"Lluvia √çgnea",overheat:"Sofoco","will-o-wisp":"Fuego Fatuo","sunny-day":"D√≠a Soleado","flare-blitz":"Envite √çgneo","water-gun":"Pistola Agua","hydro-pump":"Hidrobomba",surf:"Surf",waterfall:"Cascada",bubble:"Burbuja","bubble-beam":"Rayo Burbuja","water-pulse":"Hidropulso","aqua-tail":"Acua Cola","aqua-jet":"Acua Jet","aqua-ring":"Acua Aro","muddy-water":"Agua Lodosa",dive:"Buceo","rain-dance":"Danza Lluvia","hydro-cannon":"Hidroca√±√≥n",whirlpool:"Torbellino",crabhammer:"Martillazo",clamp:"Tenaza",brine:"Salmuera",thunder:"Trueno",thunderbolt:"Rayo","thunder-shock":"Impactrueno","thunder-wave":"Onda Trueno","thunder-punch":"Pu√±o Trueno","thunder-fang":"Colmillo Rayo",spark:"Chispa",discharge:"Chispazo",charge:"Carga","charge-beam":"Rayo Carga","volt-tackle":"Placaje El√©c.","shock-wave":"Onda Voltio","zap-cannon":"Electroca√±√≥n","magnet-rise":"Magnetismo","razor-leaf":"Hoja Afilada","solar-beam":"Rayo Solar","vine-whip":"L√°tigo Cepa","giga-drain":"Giga Drenado","mega-drain":"Mega Agotar",absorb:"Absorber","leech-seed":"Drenadoras","leaf-blade":"Hoja Aguda","seed-bomb":"Bomba Germen","energy-ball":"Energibola","power-whip":"Latigazo",synthesis:"S√≠ntesis","grass-knot":"Hierba Lazo","leaf-storm":"Lluevehojas","bullet-seed":"Bala Semilla","petal-dance":"Danza P√©talo","magical-leaf":"Hoja M√°gica","worry-seed":"Abatidoras",ingrain:"Arraigo",aromatherapy:"Aromaterapia","frenzy-plant":"Planta Feroz","wood-hammer":"Mazazo","needle-arm":"Brazo Pincho","ice-beam":"Rayo Hielo",blizzard:"Ventisca","aurora-beam":"Rayo Aurora","icy-wind":"Viento Hielo","ice-punch":"Pu√±o Hielo","ice-fang":"Colmillo Hielo","ice-shard":"Esquirla Helada","ice-ball":"Bola Hielo","powder-snow":"Nieve Polvo","sheer-cold":"Fr√≠o Polar",hail:"Granizo",avalanche:"Avalancha",mist:"Neblina",haze:"Niebla","karate-chop":"Golpe K√°rate","cross-chop":"Tajo Cruzado","brick-break":"Demolici√≥n","sky-uppercut":"Gancho Alto","focus-punch":"Pu√±o Certero","focus-blast":"Onda Certera","mach-punch":"Ultrapu√±o","bullet-punch":"Pu√±o Bala","close-combat":"A Bocajarro",superpower:"Fuerza Bruta",reversal:"Inversi√≥n",counter:"Contraataque","seismic-toss":"Mov. S√≠smico",submission:"Sumisi√≥n","vital-throw":"Tiro Vital","low-kick":"Patada Baja","jump-kick":"Patada Salto","hi-jump-kick":"Pat. Salto Alta","rolling-kick":"Patada Giro","triple-kick":"Triple Patada","dynamic-punch":"Pu√±o Din√°mico","drain-punch":"Pu√±o Drenaje","hammer-arm":"Machada","aura-sphere":"Esfera Aural","force-palm":"Palmeo","rock-smash":"Golpe Roca","bulk-up":"Corpulencia",detect:"Detecci√≥n",earthquake:"Terremoto",dig:"Excavar","mud-slap":"Bofet√≥n Lodo","mud-shot":"Disparo Lodo","mud-bomb":"Bomba Fango","earth-power":"Tierra Viva",magnitude:"Magnitud",fissure:"Fisura","bone-rush":"Ataque √ìseo",spikes:"P√∫as","sand-tomb":"Bucle Arena",bulldoze:"Terratemblor",fly:"Vuelo","aerial-ace":"Golpe A√©reo","wing-attack":"Ataque Ala",peck:"Picotazo","drill-peck":"Pico Taladro","air-slash":"Tajo A√©reo","air-cutter":"Aire Afilado","brave-bird":"P√°jaro Osado","sky-attack":"Ataque A√©reo",bounce:"Bote",pluck:"Picoteo",roost:"Respiro",tailwind:"Viento Af√≠n",defog:"Despejar","mirror-move":"Mov. Espejo","feather-dance":"Danza Pluma",psychic:"Ps√≠quico",confusion:"Confusi√≥n",psybeam:"Psicorrayo",psywave:"Psicoonda",hypnosis:"Hipnosis","dream-eater":"Come Sue√±os","psycho-cut":"Psicocorte","psycho-boost":"Psicoataque","zen-headbutt":"Cabezazo Zen",extrasensory:"Paranormal","future-sight":"Premonici√≥n","light-screen":"Pantalla Luz",reflect:"Reflejo",barrier:"Barrera",amnesia:"Amnesia",agility:"Agilidad","calm-mind":"Paz Mental",kinesis:"Kin√©tico",teleport:"Teletransporte","trick-room":"Espacio Raro",trick:"Truco",rest:"Descanso","psycho-shift":"Psicocambio",gravity:"Gravedad","heal-block":"Anticura","miracle-eye":"Gran Ojo","luster-purge":"Resplandor","mist-ball":"Bola Neblina","shadow-ball":"Bola Sombra","shadow-claw":"Garra Umbr√≠a","night-shade":"Tinieblas","confuse-ray":"Rayo Confuso",lick:"Leng√ºetazo","shadow-punch":"Pu√±o Sombra","shadow-sneak":"Sombra Vil","shadow-force":"Golpe Umbr√≠o","destiny-bond":"Mismo Destino",grudge:"Rabia",curse:"Maldici√≥n",spite:"Rencor",nightmare:"Pesadilla",astonish:"Impresionar","ominous-wind":"Viento Aciago",bite:"Mordisco",crunch:"Triturar","faint-attack":"Finta","feint-attack":"Finta",pursuit:"Persecuci√≥n",thief:"Ladr√≥n","knock-off":"Desarme",taunt:"Mofa",torment:"Tormento","dark-pulse":"Pulso Umbr√≠o","night-slash":"Tajo Umbr√≠o","sucker-punch":"Golpe Bajo",payback:"Vendetta",assurance:"Buena Baza",embargo:"Embargo","foul-play":"Juego Sucio","nasty-plot":"Maquinaci√≥n",flatter:"Camelo",memento:"Legado",snatch:"Robo",switcheroo:"Trapicheo","beat-up":"Paliza","rock-throw":"Lanza Rocas","rock-slide":"Avalancha","rock-tomb":"Tumba Rocas","ancient-power":"Poder Pasado","stone-edge":"Roca Afilada","head-smash":"Testarazo","rock-blast":"Pedrada","power-gem":"Joya de Luz","stealth-rock":"Trampa Rocas",sandstorm:"Tormenta Arena",rollout:"Desenrollar","iron-tail":"Cola F√©rrea","metal-claw":"Garra Metal","steel-wing":"Ala de Acero","iron-head":"Cabeza Hierro","iron-defense":"Def. F√©rrea","meteor-mash":"Pu√±o Meteoro","flash-cannon":"Foco Resplandor","magnet-bomb":"Bomba Im√°n","gyro-ball":"Giro Bola","metal-sound":"Eco Met√°lico","metal-burst":"Represi√≥n Metal","doom-desire":"Deseo Oculto","mirror-shot":"Disparo Espejo","dragon-claw":"Garra Drag√≥n","dragon-breath":"Dragoaliento","dragon-rage":"Furia Drag√≥n","dragon-dance":"Danza Drag√≥n","dragon-pulse":"Pulso Drag√≥n","dragon-rush":"Carga Drag√≥n","draco-meteor":"Cometa Draco",outrage:"Enfado",twister:"Cicl√≥n","roar-of-time":"Distorsi√≥n","spacial-rend":"Corte Vac√≠o",sludge:"Residuos","sludge-bomb":"Bomba Lodo","sludge-wave":"Onda T√≥xica","poison-sting":"Picotazo Ven",toxic:"T√≥xico","poison-jab":"Puya Nociva","cross-poison":"Veneno X","poison-fang":"Colmillo Ven.","poison-tail":"Cola Veneno","poison-gas":"Gas Venenoso","poison-powder":"Polvo Veneno",acid:"√Åcido","acid-armor":"Armadura √Åcida","gastro-acid":"Bilis","gunk-shot":"Lanzamugre","toxic-spikes":"P√∫as T√≥xicas",venoshock:"Cargat√≥xica","pin-missile":"Misil Aguja",twineedle:"Doble Ataque","fury-cutter":"Corte Furia","x-scissor":"Tijera X","bug-bite":"Picadura","bug-buzz":"Zumbido","signal-beam":"Rayo Se√±al","silver-wind":"Viento Plata","u-turn":"Ida y Vuelta","string-shot":"Disparo Demora","spider-web":"Telara√±a","leech-life":"Chupavidas","hyper-beam":"Hiperrayo","giga-impact":"Giga Impacto","double-edge":"Doble Filo","take-down":"Derribo","body-slam":"Golpe Cuerpo","quick-attack":"Ataque R√°pido","extreme-speed":"Velocidad Extrema",slash:"Cuchillada",return:"Retribuci√≥n",frustration:"Frustraci√≥n",facade:"Fachada",protect:"Protecci√≥n","sleep-talk":"Son√°mbulo",snore:"Ronquido",substitute:"Sustituto",swagger:"Contoneo",attract:"Atracci√≥n","double-team":"Doble Equipo",endure:"Aguante",roar:"Rugido",whirlwind:"Remolino",safeguard:"Velo Sagrado",yawn:"Bostezo",spore:"Espora","sleep-powder":"Polvo Sue√±o","stun-spore":"Paralizador","focus-energy":"Foco Energ√≠a",explosion:"Explosi√≥n","self-destruct":"Autodestrucci√≥n","swords-dance":"Danza Espada","hidden-power":"Poder Oculto","secret-power":"Poder Secreto",strength:"Fuerza",cut:"Corte",flash:"Destello",supersonic:"Supers√≥nico",screech:"Chirrido",recover:"Recuperaci√≥n",moonlight:"Luz Lunar","morning-sun":"Sol Matinal",wish:"Deseo",refresh:"Alivio","heal-bell":"Campana Cura",softboiled:"Huevo Pasado",headbutt:"Golpe Cabeza","tri-attack":"Triataque","super-fang":"Superfang","hyper-fang":"Hiperfang",swift:"Rapidez",covet:"Antojo","false-swipe":"Falso Tortazo",encore:"Otra Vez","pain-split":"Divide Dolor","perish-song":"Canto Mortal","baton-pass":"Relevo","helping-hand":"Refuerzo",recycle:"Reciclaje","natural-gift":"Don Natural","last-resort":"√öltima Baza",feint:"Amago",acupressure:"Acupresi√≥n","me-first":"Yo Primero",copycat:"Copi√≥n","trump-card":"Baza Secreta","wring-out":"Estruj√≥n",captivate:"Seducci√≥n",rage:"Furia",thrash:"Golpe","belly-drum":"Tambor","milk-drink":"Beber Leche",present:"Presente",sketch:"Esquema",transform:"Transformaci√≥n",metronome:"Metr√≥nomo",mimic:"Mim√©tico",disable:"Anulaci√≥n",splash:"Salpicar","mean-look":"Mal de Ojo",block:"Bloqueo","lock-on":"Fijar Blanco",constrict:"Constricci√≥n","acid-spray":"Bomba √Åcida",astonish:"Impresionar","aurora-veil":"Velo Aurora","blast-burn":"Anillo √çgneo","blaze-kick":"Patada √çgnea",bounce:"Bote",camouflage:"Camuflaje",charge:"Carga","charge-beam":"Rayo Carga","defense-curl":"Rizo Defensa",discharge:"Chispazo","double-hit":"Doble Golpe","double-kick":"Doble Patada","dragon-pulse":"Pulso Drag√≥n","dragon-rush":"Carga Drag√≥n",dragonbreath:"Dragoaliento",dynamicpunch:"Pu√±o Din√°mico","egg-bomb":"Bomba Huevo","electro-ball":"Bola Voltio",electroweb:"Electrotela",ember:"Ascuas",endeavor:"Esfuerzo",facade:"Fachada","fake-out":"Sorpresa","fake-tears":"Llanto Falso","feint-attack":"Finta","fire-fang":"Colmillo √çgneo","fire-punch":"Pu√±o Fuego","fire-spin":"Giro Fuego",flail:"Azote","flame-burst":"Pirotecnia","flame-charge":"Nitrocarga","flame-wheel":"Rueda Fuego","flash-cannon":"Foco Resplandor",fling:"Lanzamiento","focus-blast":"Onda Certera","follow-me":"Se√±uelo","foul-play":"Juego Sucio","freeze-shock":"Rayo G√©lido","frost-breath":"Aliento G√©lido",frustration:"Frustraci√≥n","fury-cutter":"Corte Furia","gastro-acid":"Bilis","gear-grind":"Rueda Doble",glaciate:"Mundo G√©lido","grass-knot":"Hierba Lazo","grass-pledge":"Hierba Juramento",growl:"Gru√±ido",growth:"Desarrollo",grudge:"Rabia","guard-split":"Isodistribuci√≥n","guard-swap":"Cambia Defensa","gunk-shot":"Lanzamugre","gyro-ball":"Giro Bola","hammer-arm":"Machada",harden:"Fortaleza","head-charge":"Ariete","head-smash":"Testarazo","heal-order":"Auxilio","heal-pulse":"Pulso Cura","heart-stamp":"Matasellos","heart-swap":"Cambia Almas","heat-crash":"Golpe Calor","heavy-slam":"Cuerpo Pesado","helping-hand":"Refuerzo",hex:"Infortunio","hi-jump-kick":"Pat. Salto Alta","hold-back":"Clemencia","hone-claws":"Afilagarras","horn-leech":"Asta Drenaje",howl:"Aullido",hurricane:"Vendaval","hydro-cannon":"Hidroca√±√≥n","hyper-voice":"Vozarr√≥n","ice-ball":"Bola Hielo","ice-burn":"Llama G√©lida","ice-fang":"Colmillo Hielo","ice-punch":"Pu√±o Hielo","ice-shard":"Esquirla Helada","icicle-crash":"Car√°mbano","icicle-spear":"Chuzos","icy-wind":"Viento Hielo",imprison:"Sellar",inferno:"Infierno",ingrain:"Arraigo","iron-defense":"Def. F√©rrea","iron-head":"Cabeza Hierro","iron-tail":"Cola F√©rrea",judgment:"Sentencia","jump-kick":"Patada Salto","karate-chop":"Golpe K√°rate",kinesis:"Kin√©tico","knock-off":"Desarme","leaf-storm":"Lluevehojas","leaf-tornado":"Cicl√≥n Hojas","leech-life":"Chupavidas","leech-seed":"Drenadoras",leer:"Malicioso",lick:"Leng√ºetazo","light-screen":"Pantalla Luz","lock-on":"Fijar Blanco","lovely-kiss":"Beso Amoroso","low-kick":"Patada Baja","low-sweep":"Barrido","lucky-chant":"Conjuro","lunar-dance":"Danza Lunar","luster-purge":"Resplandor","mach-punch":"Ultrapu√±o","magic-coat":"Capa M√°gica","magic-room":"Zona M√°gica","magical-leaf":"Hoja M√°gica","magma-storm":"Lluvia √çgnea","magnet-bomb":"Bomba Im√°n","magnet-rise":"Magnetismo",magnitude:"Magnitud","me-first":"Yo Primero","mean-look":"Mal de Ojo",meditate:"Meditaci√≥n","mega-drain":"Mega Agotar","mega-kick":"Megapatada","mega-punch":"Megapu√±o",megahorn:"Megacuerno",memento:"Legado","metal-burst":"Represi√≥n Metal","metal-claw":"Garra Metal","metal-sound":"Eco Met√°lico","meteor-mash":"Pu√±o Meteoro","mind-reader":"Presciencia",minimize:"Reducci√≥n","miracle-eye":"Gran Ojo","mirror-coat":"Manto Espejo","mirror-move":"Mov. Espejo","mirror-shot":"Disparo Espejo",mist:"Neblina","mist-ball":"Bola Neblina",moonblast:"Fuerza Lunar","mud-bomb":"Bomba Fango","mud-shot":"Disparo Lodo","mud-slap":"Bofet√≥n Lodo","muddy-water":"Agua Lodosa","nasty-plot":"Maquinaci√≥n","natural-gift":"Don Natural","nature-power":"Adaptaci√≥n","needle-arm":"Brazo Pincho","night-daze":"Pulso Noche","night-shade":"Tinieblas","night-slash":"Tajo Umbr√≠o",nightmare:"Pesadilla","noble-roar":"Rugido Noble",octazooka:"Pulpo Ca√±√≥n","odor-sleuth":"Rastreo","ominous-wind":"Viento Aciago",outrage:"Enfado",overheat:"Sofoco",payback:"Vendetta",peck:"Picotazo","perish-song":"Canto Mortal","petal-blizzard":"Tormenta Flor","petal-dance":"Danza P√©talo","pin-missile":"Misil Aguja",pluck:"Picoteo","poison-fang":"Colmillo Ven.","poison-gas":"Gas Venenoso","poison-jab":"Puya Nociva","poison-powder":"Polvo Veneno","poison-sting":"Picotazo Ven","poison-tail":"Cola Veneno",pound:"Destructor",powder:"Polvo","powder-snow":"Nieve Polvo","power-gem":"Joya de Luz","power-split":"Isofuerza","power-swap":"Cambia Fuerza","power-trick":"Truco Fuerza","power-whip":"Latigazo",present:"Presente",protect:"Protecci√≥n","psych-up":"Autosugesti√≥n",psychic:"Ps√≠quico","psycho-boost":"Psicoataque","psycho-cut":"Psicocorte","psycho-shift":"Psicocambio",psyshock:"Psicocarga",psystrike:"Golpe Ps√≠quico",psywave:"Psicoonda",punishment:"Castigo",pursuit:"Persecuci√≥n","quick-attack":"Ataque R√°pido","quick-guard":"Anticipo",rage:"Furia","rage-powder":"Polvo Ira","rain-dance":"Danza Lluvia","rapid-spin":"Giro R√°pido","razor-leaf":"Hoja Afilada","razor-shell":"Concha Filo","razor-wind":"Viento Cortante",recover:"Recuperaci√≥n",recycle:"Reciclaje",reflect:"Reflejo",refresh:"Alivio","relic-song":"Canto Arcaico",rest:"Descanso",retaliate:"Represalia",return:"Retribuci√≥n",revenge:"Desquite",reversal:"Inversi√≥n",roar:"Rugido","roar-of-time":"Distorsi√≥n","rock-blast":"Pedrada","rock-climb":"Treparrocas","rock-polish":"Pulimento","rock-slide":"Avalancha","rock-smash":"Golpe Roca","rock-throw":"Lanza Rocas","rock-tomb":"Tumba Rocas","rock-wrecker":"Romperrocas","role-play":"Imitaci√≥n",rollout:"Desenrollar",roost:"Respiro",round:"Canon","sacred-fire":"Fuego Sagrado","sacred-sword":"Espada Santa",safeguard:"Velo Sagrado","sand-tomb":"Bucle Arena",sandstorm:"Tormenta Arena",scald:"Escaldar","scary-face":"Cara Susto",scratch:"Ara√±azo",screech:"Chirrido","seed-bomb":"Bomba Germen","seed-flare":"Estallido Floral","seismic-toss":"Mov. S√≠smico","self-destruct":"Autodestrucci√≥n","shadow-ball":"Bola Sombra","shadow-claw":"Garra Umbr√≠a","shadow-force":"Golpe Umbr√≠o","shadow-punch":"Pu√±o Sombra","shadow-sneak":"Sombra Vil",sharpen:"Afilar","sheer-cold":"Fr√≠o Polar","shell-smash":"Rompe Coraza","shift-gear":"Cambio Marcha","shock-wave":"Onda Voltio","signal-beam":"Rayo Se√±al","silver-wind":"Viento Plata","simple-beam":"Onda Simple",sing:"Canto",sketch:"Esquema","skill-swap":"Intercambio","skull-bash":"Cabezazo","sky-attack":"Ataque A√©reo","sky-drop":"Ca√≠da Libre","sky-uppercut":"Gancho Alto","slack-off":"Relajo",slam:"Portazo",slash:"Cuchillada","sleep-powder":"Polvo Sue√±o","sleep-talk":"Son√°mbulo",sludge:"Residuos","sludge-bomb":"Bomba Lodo","sludge-wave":"Onda T√≥xica","smack-down":"Antia√©reo","smart-strike":"Cuerno Certero","smelling-salts":"Est√≠mulo",smog:"Poluci√≥n",smokescreen:"Pantalla Humo",snarl:"Alarido",snatch:"Robo",snore:"Ronquido",soak:"Anegar","soft-boiled":"Huevo Pasado","solar-beam":"Rayo Solar",sonicboom:"S√≥nico","spacial-rend":"Corte Vac√≠o",spark:"Chispa","spider-web":"Telara√±a","spike-cannon":"Clavo Ca√±√≥n",spikes:"P√∫as","spit-up":"Escupir",spite:"Rencor",splash:"Salpicar",spore:"Espora","stealth-rock":"Trampa Rocas","steam-eruption":"Chorro Vapor","steel-wing":"Ala de Acero",stockpile:"Reserva",stomp:"Pisot√≥n","stone-edge":"Roca Afilada","stored-power":"Poder Reserva","storm-throw":"Tiro Llave","string-shot":"Disparo Demora",struggle:"Forcejeo","struggle-bug":"Estoicismo","stun-spore":"Paralizador",submission:"Sumisi√≥n",substitute:"Sustituto","sucker-punch":"Golpe Bajo","sunny-day":"D√≠a Soleado","super-fang":"Superfang",superpower:"Fuerza Bruta",supersonic:"Supers√≥nico",surf:"Surf",swagger:"Contoneo",swallow:"Tragar","sweet-kiss":"Beso Dulce","sweet-scent":"Dulce Aroma",swift:"Rapidez",switcheroo:"Trapicheo","swords-dance":"Danza Espada",synchronoise:"Sincrorruido",synthesis:"S√≠ntesis",tackle:"Placaje","tail-glow":"Luz Caudal","tail-slap":"L√°tigo Cola","tail-whip":"L√°tigo",tailwind:"Viento Af√≠n","take-down":"Derribo",taunt:"Mofa","techno-blast":"Tecnoblaster","teeter-dance":"Danza Caos",telekinesis:"Telequinesis",teleport:"Teletransporte",thief:"Ladr√≥n",thrash:"Golpe",thunder:"Trueno","thunder-fang":"Colmillo Rayo","thunder-punch":"Pu√±o Trueno","thunder-shock":"Impactrueno","thunder-wave":"Onda Trueno",thunderbolt:"Rayo",tickle:"Cosquillas",torment:"Tormento",toxic:"T√≥xico","toxic-spikes":"P√∫as T√≥xicas",transform:"Transformaci√≥n","tri-attack":"Triataque",trick:"Truco","trick-room":"Espacio Raro","triple-kick":"Triple Patada","trump-card":"Baza Secreta",twineedle:"Doble Ataque",twister:"Cicl√≥n","u-turn":"Ida y Vuelta",uproar:"Alboroto","v-create":"V-Cremaci√≥n","vacuum-wave":"Onda Vac√≠o",venoshock:"Cargat√≥xica","vice-grip":"Agarre","vine-whip":"L√°tigo Cepa","vital-throw":"Tiro Vital","volt-switch":"Voltio Cruento","volt-tackle":"Placaje El√©c.","wake-up-slap":"Espabila","water-gun":"Pistola Agua","water-pledge":"Agua Juramento","water-pulse":"Hidropulso","water-sport":"Hidrochorro","water-spout":"Salpicar",waterfall:"Cascada","weather-ball":"Bola Clim√°tica",whirlpool:"Torbellino",whirlwind:"Remolino","wide-guard":"Vasta Guardia","wild-charge":"Voltio Cruel","will-o-wisp":"Fuego Fatuo","wing-attack":"Ataque Ala",wish:"Deseo",withdraw:"Refugio","wonder-room":"Zona Extra√±a","wood-hammer":"Mazazo","work-up":"Avivar","worry-seed":"Abatidoras",wrap:"Atadura","wring-out":"Estruj√≥n","x-scissor":"Tijera X",yawn:"Bostezo","zap-cannon":"Electroca√±√≥n","zen-headbutt":"Cabezazo Zen"};function hh(a){const e=a.toLowerCase();return Fu[e]||Je(a)}const gh={134:{method:"üíß Piedra Agua",explanation:"Usa una Piedra Agua en Eevee para evolucionar."},135:{method:"‚ö° Piedra Trueno",explanation:"Usa una Piedra Trueno en Eevee para evolucionar."},136:{method:"üî• Piedra Fuego",explanation:"Usa una Piedra Fuego en Eevee para evolucionar."},196:{method:"‚òÄÔ∏è Felicidad de d√≠a",explanation:"Sube el nivel de Eevee con felicidad m√°xima durante el D√çA."},197:{method:"üåô Felicidad de noche",explanation:"Sube el nivel de Eevee con felicidad m√°xima durante la NOCHE."},470:{method:"üåø Roca Musgo",explanation:"Sube de nivel a Eevee cerca de una Roca Musgo."},471:{method:"‚ùÑÔ∏è Roca Hielo",explanation:"Sube de nivel a Eevee cerca de una Roca Hielo."},68:{method:"üîÑ Intercambio",explanation:"Intercambia Machoke con otro jugador."},76:{method:"üîÑ Intercambio",explanation:"Intercambia Graveler con otro jugador."},94:{method:"üîÑ Intercambio",explanation:"Intercambia Haunter con otro jugador."},65:{method:"üîÑ Intercambio",explanation:"Intercambia Kadabra con otro jugador."},186:{method:"üîÑ Intercambio + Roca del Rey",explanation:"Intercambia Poliwhirl mientras porta Roca del Rey."},199:{method:"üîÑ Intercambio + Roca del Rey",explanation:"Intercambia Slowpoke mientras porta Roca del Rey."},208:{method:"üîÑ Intercambio + Revest. Met√°lico",explanation:"Intercambia Onix mientras porta Revestimiento Met√°lico."},212:{method:"üîÑ Intercambio + Revest. Met√°lico",explanation:"Intercambia Scyther mientras porta Revestimiento Met√°lico."},230:{method:"üîÑ Intercambio + Escama Drag√≥n",explanation:"Intercambia Seadra mientras porta Escama Drag√≥n."},233:{method:"üîÑ Intercambio + Mejora",explanation:"Intercambia Porygon mientras porta Mejora."},474:{method:"üîÑ Intercambio + Disco Extra√±o",explanation:"Intercambia Porygon2 mientras porta Disco Extra√±o."},467:{method:"üîÑ Intercambio + Magmatizador",explanation:"Intercambia Magmar mientras porta Magmatizador."},466:{method:"üîÑ Intercambio + Electrizador",explanation:"Intercambia Electabuzz mientras porta Electrizador."},464:{method:"üîÑ Intercambio + Protector",explanation:"Intercambia Rhydon mientras porta Protector."},477:{method:"üîÑ Intercambio + Tela Terrible",explanation:"Intercambia Dusclops mientras porta Tela Terrible."},350:{method:"‚ú® Belleza m√°xima",explanation:"En Gen 3-4: Sube la Belleza de Feebas al m√°ximo con Pok√©cubos/Pokitos y luego sube de nivel. En Gen 5+: Intercambia Feebas con Escama Bella."},169:{method:"‚ù§Ô∏è Felicidad alta",explanation:"Sube de nivel a Golbat con felicidad m√°xima (220+)."},242:{method:"‚ù§Ô∏è Felicidad alta",explanation:"Sube de nivel a Chansey con felicidad m√°xima."},462:{method:"üìç Campo Magn√©tico",explanation:"Sube de nivel a Magneton en Monte Corona (Sinnoh) o zona con campo magn√©tico."},476:{method:"üìç Campo Magn√©tico",explanation:"Sube de nivel a Nosepass en Monte Corona (Sinnoh) o zona con campo magn√©tico."},463:{method:"üìñ Saber Desenrollar",explanation:"Sube de nivel a Lickitung sabiendo el movimiento Desenrollar."},469:{method:"üìñ Saber Poder Pasado",explanation:"Sube de nivel a Yanma sabiendo el movimiento Poder Pasado."},473:{method:"üìñ Saber Poder Pasado",explanation:"Sube de nivel a Piloswine sabiendo el movimiento Poder Pasado."},465:{method:"üìñ Saber Poder Pasado",explanation:"Sube de nivel a Tangela sabiendo el movimiento Poder Pasado."},468:{method:"üíé Piedra D√≠a",explanation:"Usa una Piedra D√≠a en Togetic."},292:{method:"üêõ Evoluci√≥n especial",explanation:"Aparece en tu equipo al evolucionar Nincada a Ninjask si tienes: espacio en el equipo + Pok√© Ball normal en la bolsa."}};function fh(a){return gh[a]||null}const yh=()=>{};var Uc={};const Vu=function(a){const e=[];let t=0;for(let r=0;r<a.length;r++){let o=a.charCodeAt(r);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&r+1<a.length&&(a.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(a.charCodeAt(++r)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},vh=function(a){const e=[];let t=0,r=0;for(;t<a.length;){const o=a[t++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const i=a[t++];e[r++]=String.fromCharCode((o&31)<<6|i&63)}else if(o>239&&o<365){const i=a[t++],s=a[t++],l=a[t++],d=((o&7)<<18|(i&63)<<12|(s&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const i=a[t++],s=a[t++];e[r++]=String.fromCharCode((o&15)<<12|(i&63)<<6|s&63)}}return e.join("")},xu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(a,e){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<a.length;o+=3){const i=a[o],s=o+1<a.length,l=s?a[o+1]:0,d=o+2<a.length,m=d?a[o+2]:0,p=i>>2,g=(i&3)<<4|l>>4;let E=(l&15)<<2|m>>6,C=m&63;d||(C=64,s||(E=64)),r.push(t[p],t[g],t[E],t[C])}return r.join("")},encodeString(a,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(a):this.encodeByteArray(Vu(a),e)},decodeString(a,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(a):vh(this.decodeStringToByteArray(a,e))},decodeStringToByteArray(a,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<a.length;){const i=t[a.charAt(o++)],l=o<a.length?t[a.charAt(o)]:0;++o;const m=o<a.length?t[a.charAt(o)]:64;++o;const g=o<a.length?t[a.charAt(o)]:64;if(++o,i==null||l==null||m==null||g==null)throw new Eh;const E=i<<2|l>>4;if(r.push(E),m!==64){const C=l<<4&240|m>>2;if(r.push(C),g!==64){const I=m<<6&192|g;r.push(I)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}};class Eh extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _h=function(a){const e=Vu(a);return xu.encodeByteArray(e,!0)},Fo=function(a){return _h(a).replace(/\./g,"")},Lu=function(a){try{return xu.decodeString(a,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function bh(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Ah=()=>bh().__FIREBASE_DEFAULTS__,wh=()=>{if(typeof process>"u"||typeof Uc>"u")return;const a=Uc.__FIREBASE_DEFAULTS__;if(a)return JSON.parse(a)},Ph=()=>{if(typeof document>"u")return;let a;try{a=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=a&&Lu(a[1]);return e&&JSON.parse(e)},sn=()=>{try{return yh()||Ah()||wh()||Ph()}catch(a){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${a}`);return}},Nu=a=>sn()?.emulatorHosts?.[a],Th=a=>{const e=Nu(a);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ou=()=>sn()?.config,Bu=a=>sn()?.[`_${a}`];class Ih{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function xa(a){try{return(a.startsWith("http://")||a.startsWith("https://")?new URL(a).hostname:a).endsWith(".cloudworkstations.dev")}catch{return!1}}async function zu(a){return(await fetch(a,{credentials:"include"})).ok}function kh(a,e){if(a.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",o=a.iat||0,i=a.sub||a.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...a};return[Fo(JSON.stringify(t)),Fo(JSON.stringify(s)),""].join(".")}const pr={};function Ch(){const a={prod:[],emulator:[]};for(const e of Object.keys(pr))pr[e]?a.emulator.push(e):a.prod.push(e);return a}function Sh(a){let e=document.getElementById(a),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",a),t=!0),{created:t,element:e}}let jc=!1;function qu(a,e){if(typeof window>"u"||typeof document>"u"||!xa(window.location.host)||pr[a]===e||pr[a]||jc)return;pr[a]=e;function t(E){return`__firebase__banner__${E}`}const r="__firebase__banner",i=Ch().prod.length>0;function s(){const E=document.getElementById(r);E&&E.remove()}function l(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function d(E,C){E.setAttribute("width","24"),E.setAttribute("id",C),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function m(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{jc=!0,s()},E}function p(E,C){E.setAttribute("id",C),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function g(){const E=Sh(r),C=t("text"),I=document.getElementById(C)||document.createElement("span"),R=t("learnmore"),k=document.getElementById(R)||document.createElement("a"),x=t("preprendIcon"),z=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const j=E.element;l(j),p(k,R);const Y=m();d(z,x),j.append(z,I,k,Y),document.body.appendChild(j)}i?(I.innerText="Preview backend disconnected.",z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Te(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Rh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Te())}function Dh(){const a=sn()?.forceEnvironment;if(a==="node")return!0;if(a==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Mh(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Fh(){const a=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof a=="object"&&a.id!==void 0}function Vh(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function xh(){const a=Te();return a.indexOf("MSIE ")>=0||a.indexOf("Trident/")>=0}function Lh(){return!Dh()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Nh(){try{return typeof indexedDB=="object"}catch{return!1}}function Oh(){return new Promise((a,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(r),a(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const Bh="FirebaseError";class it extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Bh,Object.setPrototypeOf(this,it.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fr.prototype.create)}}class Fr{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},o=`${this.service}/${e}`,i=this.errors[e],s=i?zh(i,r):"Error",l=`${this.serviceName}: ${s} (${o}).`;return new it(o,l,r)}}function zh(a,e){return a.replace(qh,(t,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const qh=/\{\$([^}]+)}/g;function Uh(a){for(const e in a)if(Object.prototype.hasOwnProperty.call(a,e))return!1;return!0}function Xt(a,e){if(a===e)return!0;const t=Object.keys(a),r=Object.keys(e);for(const o of t){if(!r.includes(o))return!1;const i=a[o],s=e[o];if($c(i)&&$c(s)){if(!Xt(i,s))return!1}else if(i!==s)return!1}for(const o of r)if(!t.includes(o))return!1;return!0}function $c(a){return a!==null&&typeof a=="object"}function Vr(a){const e=[];for(const[t,r]of Object.entries(a))Array.isArray(r)?r.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function jh(a,e){const t=new $h(a,e);return t.subscribe.bind(t)}class $h{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let o;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Gh(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:r},o.next===void 0&&(o.next=ei),o.error===void 0&&(o.error=ei),o.complete===void 0&&(o.complete=ei);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Gh(a,e){if(typeof a!="object"||a===null)return!1;for(const t of e)if(t in a&&typeof a[t]=="function")return!0;return!1}function ei(){}function Ee(a){return a&&a._delegate?a._delegate:a}class Yt{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Gt="[DEFAULT]";class Hh{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Ih;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Kh(e))try{this.getOrInitializeService({instanceIdentifier:Gt})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:o});r.resolve(i)}catch{}}}}clearInstance(e=Gt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gt){return this.instances.has(e)}getOptions(e=Gt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,s]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&s.resolve(o)}return o}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(r)??new Set;o.add(e),this.onInitCallbacks.set(r,o);const i=this.instances.get(r);return i&&e(i,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const o of r)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Wh(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Gt){return this.component?this.component.multipleInstances?e:Gt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Wh(a){return a===Gt?void 0:a}function Kh(a){return a.instantiationMode==="EAGER"}class Qh{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Hh(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var H;(function(a){a[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT"})(H||(H={}));const Jh={debug:H.DEBUG,verbose:H.VERBOSE,info:H.INFO,warn:H.WARN,error:H.ERROR,silent:H.SILENT},Xh=H.INFO,Yh={[H.DEBUG]:"log",[H.VERBOSE]:"log",[H.INFO]:"info",[H.WARN]:"warn",[H.ERROR]:"error"},Zh=(a,e,...t)=>{if(e<a.logLevel)return;const r=new Date().toISOString(),o=Yh[e];if(o)console[o](`[${r}]  ${a.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $i{constructor(e){this.name=e,this._logLevel=Xh,this._logHandler=Zh,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in H))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Jh[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,H.DEBUG,...e),this._logHandler(this,H.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,H.VERBOSE,...e),this._logHandler(this,H.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,H.INFO,...e),this._logHandler(this,H.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,H.WARN,...e),this._logHandler(this,H.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,H.ERROR,...e),this._logHandler(this,H.ERROR,...e)}}const eg=(a,e)=>e.some(t=>a instanceof t);let Gc,Hc;function tg(){return Gc||(Gc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ag(){return Hc||(Hc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Uu=new WeakMap,fi=new WeakMap,ju=new WeakMap,ti=new WeakMap,Gi=new WeakMap;function rg(a){const e=new Promise((t,r)=>{const o=()=>{a.removeEventListener("success",i),a.removeEventListener("error",s)},i=()=>{t(bt(a.result)),o()},s=()=>{r(a.error),o()};a.addEventListener("success",i),a.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&Uu.set(t,a)}).catch(()=>{}),Gi.set(e,a),e}function og(a){if(fi.has(a))return;const e=new Promise((t,r)=>{const o=()=>{a.removeEventListener("complete",i),a.removeEventListener("error",s),a.removeEventListener("abort",s)},i=()=>{t(),o()},s=()=>{r(a.error||new DOMException("AbortError","AbortError")),o()};a.addEventListener("complete",i),a.addEventListener("error",s),a.addEventListener("abort",s)});fi.set(a,e)}let yi={get(a,e,t){if(a instanceof IDBTransaction){if(e==="done")return fi.get(a);if(e==="objectStoreNames")return a.objectStoreNames||ju.get(a);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bt(a[e])},set(a,e,t){return a[e]=t,!0},has(a,e){return a instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in a}};function ng(a){yi=a(yi)}function ig(a){return a===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=a.call(ai(this),e,...t);return ju.set(r,e.sort?e.sort():[e]),bt(r)}:ag().includes(a)?function(...e){return a.apply(ai(this),e),bt(Uu.get(this))}:function(...e){return bt(a.apply(ai(this),e))}}function sg(a){return typeof a=="function"?ig(a):(a instanceof IDBTransaction&&og(a),eg(a,tg())?new Proxy(a,yi):a)}function bt(a){if(a instanceof IDBRequest)return rg(a);if(ti.has(a))return ti.get(a);const e=sg(a);return e!==a&&(ti.set(a,e),Gi.set(e,a)),e}const ai=a=>Gi.get(a);function cg(a,e,{blocked:t,upgrade:r,blocking:o,terminated:i}={}){const s=indexedDB.open(a,e),l=bt(s);return r&&s.addEventListener("upgradeneeded",d=>{r(bt(s.result),d.oldVersion,d.newVersion,bt(s.transaction),d)}),t&&s.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),l.then(d=>{i&&d.addEventListener("close",()=>i()),o&&d.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const lg=["get","getKey","getAll","getAllKeys","count"],ug=["put","add","delete","clear"],ri=new Map;function Wc(a,e){if(!(a instanceof IDBDatabase&&!(e in a)&&typeof e=="string"))return;if(ri.get(e))return ri.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,o=ug.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(o||lg.includes(t)))return;const i=async function(s,...l){const d=this.transaction(s,o?"readwrite":"readonly");let m=d.store;return r&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),o&&d.done]))[0]};return ri.set(e,i),i}ng(a=>({...a,get:(e,t,r)=>Wc(e,t)||a.get(e,t,r),has:(e,t)=>!!Wc(e,t)||a.has(e,t)}));class dg{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(mg(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function mg(a){return a.getComponent()?.type==="VERSION"}const vi="@firebase/app",Kc="0.14.6";const at=new $i("@firebase/app"),pg="@firebase/app-compat",hg="@firebase/analytics-compat",gg="@firebase/analytics",fg="@firebase/app-check-compat",yg="@firebase/app-check",vg="@firebase/auth",Eg="@firebase/auth-compat",_g="@firebase/database",bg="@firebase/data-connect",Ag="@firebase/database-compat",wg="@firebase/functions",Pg="@firebase/functions-compat",Tg="@firebase/installations",Ig="@firebase/installations-compat",kg="@firebase/messaging",Cg="@firebase/messaging-compat",Sg="@firebase/performance",Rg="@firebase/performance-compat",Dg="@firebase/remote-config",Mg="@firebase/remote-config-compat",Fg="@firebase/storage",Vg="@firebase/storage-compat",xg="@firebase/firestore",Lg="@firebase/ai",Ng="@firebase/firestore-compat",Og="firebase",Bg="12.6.0";const Ei="[DEFAULT]",zg={[vi]:"fire-core",[pg]:"fire-core-compat",[gg]:"fire-analytics",[hg]:"fire-analytics-compat",[yg]:"fire-app-check",[fg]:"fire-app-check-compat",[vg]:"fire-auth",[Eg]:"fire-auth-compat",[_g]:"fire-rtdb",[bg]:"fire-data-connect",[Ag]:"fire-rtdb-compat",[wg]:"fire-fn",[Pg]:"fire-fn-compat",[Tg]:"fire-iid",[Ig]:"fire-iid-compat",[kg]:"fire-fcm",[Cg]:"fire-fcm-compat",[Sg]:"fire-perf",[Rg]:"fire-perf-compat",[Dg]:"fire-rc",[Mg]:"fire-rc-compat",[Fg]:"fire-gcs",[Vg]:"fire-gcs-compat",[xg]:"fire-fst",[Ng]:"fire-fst-compat",[Lg]:"fire-vertex","fire-js":"fire-js",[Og]:"fire-js-all"};const Vo=new Map,qg=new Map,_i=new Map;function Qc(a,e){try{a.container.addComponent(e)}catch(t){at.debug(`Component ${e.name} failed to register with FirebaseApp ${a.name}`,t)}}function wa(a){const e=a.name;if(_i.has(e))return at.debug(`There were multiple attempts to register component ${e}.`),!1;_i.set(e,a);for(const t of Vo.values())Qc(t,a);for(const t of qg.values())Qc(t,a);return!0}function Hi(a,e){const t=a.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),a.container.getProvider(e)}function Fe(a){return a==null?!1:a.settings!==void 0}const Ug={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},At=new Fr("app","Firebase",Ug);class jg{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Yt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw At.create("app-deleted",{appName:this._name})}}const La=Bg;function $u(a,e={}){let t=a;typeof e!="object"&&(e={name:e});const r={name:Ei,automaticDataCollectionEnabled:!0,...e},o=r.name;if(typeof o!="string"||!o)throw At.create("bad-app-name",{appName:String(o)});if(t||(t=Ou()),!t)throw At.create("no-options");const i=Vo.get(o);if(i){if(Xt(t,i.options)&&Xt(r,i.config))return i;throw At.create("duplicate-app",{appName:o})}const s=new Qh(o);for(const d of _i.values())s.addComponent(d);const l=new jg(t,r,s);return Vo.set(o,l),l}function Gu(a=Ei){const e=Vo.get(a);if(!e&&a===Ei&&Ou())return $u();if(!e)throw At.create("no-app",{appName:a});return e}function wt(a,e,t){let r=zg[a]??a;t&&(r+=`-${t}`);const o=r.match(/\s|\//),i=e.match(/\s|\//);if(o||i){const s=[`Unable to register library "${r}" with version "${e}":`];o&&s.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&i&&s.push("and"),i&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),at.warn(s.join(" "));return}wa(new Yt(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const $g="firebase-heartbeat-database",Gg=1,br="firebase-heartbeat-store";let oi=null;function Hu(){return oi||(oi=cg($g,Gg,{upgrade:(a,e)=>{switch(e){case 0:try{a.createObjectStore(br)}catch(t){console.warn(t)}}}}).catch(a=>{throw At.create("idb-open",{originalErrorMessage:a.message})})),oi}async function Hg(a){try{const t=(await Hu()).transaction(br),r=await t.objectStore(br).get(Wu(a));return await t.done,r}catch(e){if(e instanceof it)at.warn(e.message);else{const t=At.create("idb-get",{originalErrorMessage:e?.message});at.warn(t.message)}}}async function Jc(a,e){try{const r=(await Hu()).transaction(br,"readwrite");await r.objectStore(br).put(e,Wu(a)),await r.done}catch(t){if(t instanceof it)at.warn(t.message);else{const r=At.create("idb-set",{originalErrorMessage:t?.message});at.warn(r.message)}}}function Wu(a){return`${a.name}!${a.options.appId}`}const Wg=1024,Kg=30;class Qg{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Xg(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Xc();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Kg){const o=Yg(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){at.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Xc(),{heartbeatsToSend:t,unsentEntries:r}=Jg(this._heartbeatsCache.heartbeats),o=Fo(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return at.warn(e),""}}}function Xc(){return new Date().toISOString().substring(0,10)}function Jg(a,e=Wg){const t=[];let r=a.slice();for(const o of a){const i=t.find(s=>s.agent===o.agent);if(i){if(i.dates.push(o.date),Yc(t)>e){i.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Yc(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Xg{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Nh()?Oh().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Hg(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Jc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Jc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Yc(a){return Fo(JSON.stringify({version:2,heartbeats:a})).length}function Yg(a){if(a.length===0)return-1;let e=0,t=a[0].date;for(let r=1;r<a.length;r++)a[r].date<t&&(t=a[r].date,e=r);return e}function Zg(a){wa(new Yt("platform-logger",e=>new dg(e),"PRIVATE")),wa(new Yt("heartbeat",e=>new Qg(e),"PRIVATE")),wt(vi,Kc,a),wt(vi,Kc,"esm2020"),wt("fire-js","")}Zg("");var ef="firebase",tf="12.7.0";wt(ef,tf,"app");function Ku(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const af=Ku,Qu=new Fr("auth","Firebase",Ku());const xo=new $i("@firebase/auth");function rf(a,...e){xo.logLevel<=H.WARN&&xo.warn(`Auth (${La}): ${a}`,...e)}function Eo(a,...e){xo.logLevel<=H.ERROR&&xo.error(`Auth (${La}): ${a}`,...e)}function We(a,...e){throw Ki(a,...e)}function Ne(a,...e){return Ki(a,...e)}function Wi(a,e,t){const r={...af(),[e]:t};return new Fr("auth","Firebase",r).create(e,{appName:a.name})}function Pt(a){return Wi(a,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ju(a,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&We(a,"argument-error"),Wi(a,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ki(a,...e){if(typeof a!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=a.name),a._errorFactory.create(t,...r)}return Qu.create(a,...e)}function B(a,e,...t){if(!a)throw Ki(e,...t)}function et(a){const e="INTERNAL ASSERTION FAILED: "+a;throw Eo(e),new Error(e)}function rt(a,e){a||et(e)}function bi(){return typeof self<"u"&&self.location?.href||""}function of(){return Zc()==="http:"||Zc()==="https:"}function Zc(){return typeof self<"u"&&self.location?.protocol||null}function nf(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(of()||Fh()||"connection"in navigator)?navigator.onLine:!0}function sf(){if(typeof navigator>"u")return null;const a=navigator;return a.languages&&a.languages[0]||a.language||null}class xr{constructor(e,t){this.shortDelay=e,this.longDelay=t,rt(t>e,"Short delay should be less than long delay!"),this.isMobile=Rh()||Vh()}get(){return nf()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Qi(a,e){rt(a.emulator,"Emulator should always be set here");const{url:t}=a.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Xu{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;et("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;et("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;et("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const cf={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const lf=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],uf=new xr(3e4,6e4);function Ji(a,e){return a.tenantId&&!e.tenantId?{...e,tenantId:a.tenantId}:e}async function Na(a,e,t,r,o={}){return Yu(a,o,async()=>{let i={},s={};r&&(e==="GET"?s=r:i={body:JSON.stringify(r)});const l=Vr({key:a.config.apiKey,...s}).slice(1),d=await a._getAdditionalHeaders();d["Content-Type"]="application/json",a.languageCode&&(d["X-Firebase-Locale"]=a.languageCode);const m={method:e,headers:d,...i};return Mh()||(m.referrerPolicy="no-referrer"),a.emulatorConfig&&xa(a.emulatorConfig.host)&&(m.credentials="include"),Xu.fetch()(await Zu(a,a.config.apiHost,t,l),m)})}async function Yu(a,e,t){a._canInitEmulator=!1;const r={...cf,...e};try{const o=new mf(a),i=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw mo(a,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const l=i.ok?s.errorMessage:s.error.message,[d,m]=l.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw mo(a,"credential-already-in-use",s);if(d==="EMAIL_EXISTS")throw mo(a,"email-already-in-use",s);if(d==="USER_DISABLED")throw mo(a,"user-disabled",s);const p=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw Wi(a,p,m);We(a,p)}}catch(o){if(o instanceof it)throw o;We(a,"network-request-failed",{message:String(o)})}}async function df(a,e,t,r,o={}){const i=await Na(a,e,t,r,o);return"mfaPendingCredential"in i&&We(a,"multi-factor-auth-required",{_serverResponse:i}),i}async function Zu(a,e,t,r){const o=`${e}${t}?${r}`,i=a,s=i.config.emulator?Qi(a.config,o):`${a.config.apiScheme}://${o}`;return lf.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(s).toString():s}class mf{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ne(this.auth,"network-request-failed")),uf.get())})}}function mo(a,e,t){const r={appName:a.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const o=Ne(a,e,r);return o.customData._tokenResponse=t,o}async function pf(a,e){return Na(a,"POST","/v1/accounts:delete",e)}async function Lo(a,e){return Na(a,"POST","/v1/accounts:lookup",e)}function hr(a){if(a)try{const e=new Date(Number(a));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hf(a,e=!1){const t=Ee(a),r=await t.getIdToken(e),o=Xi(r);B(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const i=typeof o.firebase=="object"?o.firebase:void 0,s=i?.sign_in_provider;return{claims:o,token:r,authTime:hr(ni(o.auth_time)),issuedAtTime:hr(ni(o.iat)),expirationTime:hr(ni(o.exp)),signInProvider:s||null,signInSecondFactor:i?.sign_in_second_factor||null}}function ni(a){return Number(a)*1e3}function Xi(a){const[e,t,r]=a.split(".");if(e===void 0||t===void 0||r===void 0)return Eo("JWT malformed, contained fewer than 3 sections"),null;try{const o=Lu(t);return o?JSON.parse(o):(Eo("Failed to decode base64 JWT payload"),null)}catch(o){return Eo("Caught error parsing JWT payload as JSON",o?.toString()),null}}function el(a){const e=Xi(a);return B(e,"internal-error"),B(typeof e.exp<"u","internal-error"),B(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ar(a,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof it&&gf(r)&&a.auth.currentUser===a&&await a.auth.signOut(),r}}function gf({code:a}){return a==="auth/user-disabled"||a==="auth/user-token-expired"}class ff{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ai{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=hr(this.lastLoginAt),this.creationTime=hr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function No(a){const e=a.auth,t=await a.getIdToken(),r=await Ar(a,Lo(e,{idToken:t}));B(r?.users.length,e,"internal-error");const o=r.users[0];a._notifyReloadListener(o);const i=o.providerUserInfo?.length?ed(o.providerUserInfo):[],s=vf(a.providerData,i),l=a.isAnonymous,d=!(a.email&&o.passwordHash)&&!s?.length,m=l?d:!1,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:s,metadata:new Ai(o.createdAt,o.lastLoginAt),isAnonymous:m};Object.assign(a,p)}async function yf(a){const e=Ee(a);await No(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function vf(a,e){return[...a.filter(r=>!e.some(o=>o.providerId===r.providerId)),...e]}function ed(a){return a.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function Ef(a,e){const t=await Yu(a,{},async()=>{const r=Vr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:i}=a.config,s=await Zu(a,o,"/v1/token",`key=${i}`),l=await a._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:l,body:r};return a.emulatorConfig&&xa(a.emulatorConfig.host)&&(d.credentials="include"),Xu.fetch()(s,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function _f(a,e){return Na(a,"POST","/v2/accounts:revokeToken",Ji(a,e))}class fa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){B(e.idToken,"internal-error"),B(typeof e.idToken<"u","internal-error"),B(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):el(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){B(e.length!==0,"internal-error");const t=el(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(B(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:o,expiresIn:i}=await Ef(e,t);this.updateTokensAndExpiration(r,o,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:o,expirationTime:i}=t,s=new fa;return r&&(B(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),o&&(B(typeof o=="string","internal-error",{appName:e}),s.accessToken=o),i&&(B(typeof i=="number","internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fa,this.toJSON())}_performRefresh(){return et("not implemented")}}function gt(a,e){B(typeof a=="string"||typeof a>"u","internal-error",{appName:e})}class Le{constructor({uid:e,auth:t,stsTokenManager:r,...o}){this.providerId="firebase",this.proactiveRefresh=new ff(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Ai(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Ar(this,this.stsTokenManager.getToken(this.auth,e));return B(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return hf(this,e)}reload(){return yf(this)}_assign(e){this!==e&&(B(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Le({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await No(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fe(this.auth.app))return Promise.reject(Pt(this.auth));const e=await this.getIdToken();return await Ar(this,pf(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,o=t.email??void 0,i=t.phoneNumber??void 0,s=t.photoURL??void 0,l=t.tenantId??void 0,d=t._redirectEventId??void 0,m=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:g,emailVerified:E,isAnonymous:C,providerData:I,stsTokenManager:R}=t;B(g&&R,e,"internal-error");const k=fa.fromJSON(this.name,R);B(typeof g=="string",e,"internal-error"),gt(r,e.name),gt(o,e.name),B(typeof E=="boolean",e,"internal-error"),B(typeof C=="boolean",e,"internal-error"),gt(i,e.name),gt(s,e.name),gt(l,e.name),gt(d,e.name),gt(m,e.name),gt(p,e.name);const x=new Le({uid:g,auth:e,email:o,emailVerified:E,displayName:r,isAnonymous:C,photoURL:s,phoneNumber:i,tenantId:l,stsTokenManager:k,createdAt:m,lastLoginAt:p});return I&&Array.isArray(I)&&(x.providerData=I.map(z=>({...z}))),d&&(x._redirectEventId=d),x}static async _fromIdTokenResponse(e,t,r=!1){const o=new fa;o.updateFromServerResponse(t);const i=new Le({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:r});return await No(i),i}static async _fromGetAccountInfoResponse(e,t,r){const o=t.users[0];B(o.localId!==void 0,"internal-error");const i=o.providerUserInfo!==void 0?ed(o.providerUserInfo):[],s=!(o.email&&o.passwordHash)&&!i?.length,l=new fa;l.updateFromIdToken(r);const d=new Le({uid:o.localId,auth:e,stsTokenManager:l,isAnonymous:s}),m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:i,metadata:new Ai(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!i?.length};return Object.assign(d,m),d}}const tl=new Map;function tt(a){rt(a instanceof Function,"Expected a class definition");let e=tl.get(a);return e?(rt(e instanceof a,"Instance stored in cache mismatched with class"),e):(e=new a,tl.set(a,e),e)}class td{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}td.type="NONE";const al=td;function _o(a,e,t){return`firebase:${a}:${e}:${t}`}class ya{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:o,name:i}=this.auth;this.fullUserKey=_o(this.userKey,o.apiKey,i),this.fullPersistenceKey=_o("persistence",o.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Lo(this.auth,{idToken:e}).catch(()=>{});return t?Le._fromGetAccountInfoResponse(this.auth,t,e):null}return Le._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ya(tt(al),e,r);const o=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let i=o[0]||tt(al);const s=_o(r,e.config.apiKey,e.name);let l=null;for(const m of t)try{const p=await m._get(s);if(p){let g;if(typeof p=="string"){const E=await Lo(e,{idToken:p}).catch(()=>{});if(!E)break;g=await Le._fromGetAccountInfoResponse(e,E,p)}else g=Le._fromJSON(e,p);m!==i&&(l=g),i=m;break}}catch{}const d=o.filter(m=>m._shouldAllowMigration);return!i._shouldAllowMigration||!d.length?new ya(i,e,r):(i=d[0],l&&await i._set(s,l.toJSON()),await Promise.all(t.map(async m=>{if(m!==i)try{await m._remove(s)}catch{}})),new ya(i,e,r))}}function rl(a){const e=a.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ad(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sd(e))return"Blackberry";if(cd(e))return"Webos";if(rd(e))return"Safari";if((e.includes("chrome/")||od(e))&&!e.includes("edge/"))return"Chrome";if(id(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=a.match(t);if(r?.length===2)return r[1]}return"Other"}function ad(a=Te()){return/firefox\//i.test(a)}function rd(a=Te()){const e=a.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function od(a=Te()){return/crios\//i.test(a)}function nd(a=Te()){return/iemobile/i.test(a)}function id(a=Te()){return/android/i.test(a)}function sd(a=Te()){return/blackberry/i.test(a)}function cd(a=Te()){return/webos/i.test(a)}function Yi(a=Te()){return/iphone|ipad|ipod/i.test(a)||/macintosh/i.test(a)&&/mobile/i.test(a)}function bf(a=Te()){return Yi(a)&&!!window.navigator?.standalone}function Af(){return xh()&&document.documentMode===10}function ld(a=Te()){return Yi(a)||id(a)||cd(a)||sd(a)||/windows phone/i.test(a)||nd(a)}function ud(a,e=[]){let t;switch(a){case"Browser":t=rl(Te());break;case"Worker":t=`${rl(Te())}-${a}`;break;default:t=a}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${La}/${r}`}class wf{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((s,l)=>{try{const d=e(i);s(d)}catch(d){l(d)}});r.onAbort=t,this.queue.push(r);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function Pf(a,e={}){return Na(a,"GET","/v2/passwordPolicy",Ji(a,e))}const Tf=6;class If{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Tf,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let o=0;o<e.length;o++)r=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,o,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class kf{constructor(e,t,r,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ol(this),this.idTokenSubscription=new ol(this),this.beforeStateQueue=new wf(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Qu,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=tt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ya.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Lo(this,{idToken:e}),r=await Le._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Fe(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(s,s))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,s=r?._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===s)&&l?.user&&(r=l.user,o=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return B(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await No(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sf()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fe(this.app))return Promise.reject(Pt(this));const t=e?Ee(e):null;return t&&B(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&B(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fe(this.app)?Promise.reject(Pt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fe(this.app)?Promise.reject(Pt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(tt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Pf(this),t=new If(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Fr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await _f(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&tt(e)||this._popupRedirectResolver;B(t,this,"argument-error"),this.redirectPersistenceManager=await ya.create(this,[tt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,o){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let s=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(B(l,this,"internal-error"),l.then(()=>{s||i(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,r,o);return()=>{s=!0,d()}}else{const d=e.addObserver(t);return()=>{s=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ud(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Fe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&rf(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Lr(a){return Ee(a)}class ol{constructor(e){this.auth=e,this.observer=null,this.addObserver=jh(t=>this.observer=t)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Zi={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Cf(a){Zi=a}function Sf(a){return Zi.loadJS(a)}function Rf(){return Zi.gapiScript}function Df(a){return`__${a}${Math.floor(Math.random()*1e6)}`}function Mf(a,e){const t=Hi(a,"auth");if(t.isInitialized()){const o=t.getImmediate(),i=t.getOptions();if(Xt(i,e??{}))return o;We(o,"already-initialized")}return t.initialize({options:e})}function Ff(a,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(tt);e?.errorMap&&a._updateErrorMap(e.errorMap),a._initializeWithPersistence(r,e?.popupRedirectResolver)}function Vf(a,e,t){const r=Lr(a);B(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const o=!1,i=dd(e),{host:s,port:l}=xf(e),d=l===null?"":`:${l}`,m={url:`${i}//${s}${d}/`},p=Object.freeze({host:s,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!r._canInitEmulator){B(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),B(Xt(m,r.config.emulator)&&Xt(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,xa(s)?(zu(`${i}//${s}${d}`),qu("Auth",!0)):Lf()}function dd(a){const e=a.indexOf(":");return e<0?"":a.substr(0,e+1)}function xf(a){const e=dd(a),t=/(\/\/)?([^?#/]+)/.exec(a.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(r);if(o){const i=o[1];return{host:i,port:nl(r.substr(i.length+1))}}else{const[i,s]=r.split(":");return{host:i,port:nl(s)}}}function nl(a){if(!a)return null;const e=Number(a);return isNaN(e)?null:e}function Lf(){function a(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",a):a())}class md{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return et("not implemented")}_getIdTokenResponse(e){return et("not implemented")}_linkToIdToken(e,t){return et("not implemented")}_getReauthenticationResolver(e){return et("not implemented")}}async function va(a,e){return df(a,"POST","/v1/accounts:signInWithIdp",Ji(a,e))}const Nf="http://localhost";class Zt extends md{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):We("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:o,...i}=t;if(!r||!o)return null;const s=new Zt(r,o);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){const t=this.buildRequest();return va(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,va(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,va(e,t)}buildRequest(){const e={requestUri:Nf,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Vr(t)}return e}}class cn{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Nr extends cn{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ft extends Nr{constructor(){super("facebook.com")}static credential(e){return Zt._fromParams({providerId:ft.PROVIDER_ID,signInMethod:ft.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ft.credentialFromTaggedObject(e)}static credentialFromError(e){return ft.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ft.credential(e.oauthAccessToken)}catch{return null}}}ft.FACEBOOK_SIGN_IN_METHOD="facebook.com";ft.PROVIDER_ID="facebook.com";class Ye extends Nr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zt._fromParams({providerId:Ye.PROVIDER_ID,signInMethod:Ye.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ye.credentialFromTaggedObject(e)}static credentialFromError(e){return Ye.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ye.credential(t,r)}catch{return null}}}Ye.GOOGLE_SIGN_IN_METHOD="google.com";Ye.PROVIDER_ID="google.com";class yt extends Nr{constructor(){super("github.com")}static credential(e){return Zt._fromParams({providerId:yt.PROVIDER_ID,signInMethod:yt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yt.credentialFromTaggedObject(e)}static credentialFromError(e){return yt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yt.credential(e.oauthAccessToken)}catch{return null}}}yt.GITHUB_SIGN_IN_METHOD="github.com";yt.PROVIDER_ID="github.com";class vt extends Nr{constructor(){super("twitter.com")}static credential(e,t){return Zt._fromParams({providerId:vt.PROVIDER_ID,signInMethod:vt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return vt.credentialFromTaggedObject(e)}static credentialFromError(e){return vt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return vt.credential(t,r)}catch{return null}}}vt.TWITTER_SIGN_IN_METHOD="twitter.com";vt.PROVIDER_ID="twitter.com";class Pa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,o=!1){const i=await Le._fromIdTokenResponse(e,r,o),s=il(r);return new Pa({user:i,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const o=il(r);return new Pa({user:e,providerId:o,_tokenResponse:r,operationType:t})}}function il(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}class Oo extends it{constructor(e,t,r,o){super(t.code,t.message),this.operationType=r,this.user=o,Object.setPrototypeOf(this,Oo.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,o){return new Oo(e,t,r,o)}}function pd(a,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(a):t._getIdTokenResponse(a)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Oo._fromErrorAndOperation(a,i,e,r):i})}async function Of(a,e,t=!1){const r=await Ar(a,e._linkToIdToken(a.auth,await a.getIdToken()),t);return Pa._forOperation(a,"link",r)}async function Bf(a,e,t=!1){const{auth:r}=a;if(Fe(r.app))return Promise.reject(Pt(r));const o="reauthenticate";try{const i=await Ar(a,pd(r,o,e,a),t);B(i.idToken,r,"internal-error");const s=Xi(i.idToken);B(s,r,"internal-error");const{sub:l}=s;return B(a.uid===l,r,"user-mismatch"),Pa._forOperation(a,o,i)}catch(i){throw i?.code==="auth/user-not-found"&&We(r,"user-mismatch"),i}}async function zf(a,e,t=!1){if(Fe(a.app))return Promise.reject(Pt(a));const r="signIn",o=await pd(a,r,e),i=await Pa._fromIdTokenResponse(a,r,o);return t||await a._updateCurrentUser(i.user),i}function qf(a,e,t,r){return Ee(a).onIdTokenChanged(e,t,r)}function Uf(a,e,t){return Ee(a).beforeAuthStateChanged(e,t)}function hd(a,e,t,r){return Ee(a).onAuthStateChanged(e,t,r)}function jf(a){return Ee(a).signOut()}const Bo="__sak";class gd{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Bo,"1"),this.storage.removeItem(Bo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const $f=1e3,Gf=10;class fd extends gd{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ld(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),o=this.localCache[t];r!==o&&e(t,o,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((s,l,d)=>{this.notifyListeners(s,d)});return}const r=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const s=this.storage.getItem(r);!t&&this.localCache[r]===s||this.notifyListeners(r,s)},i=this.storage.getItem(r);Af()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,Gf):o()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},$f)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}fd.type="LOCAL";const Hf=fd;class yd extends gd{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}yd.type="SESSION";const vd=yd;function Wf(a){return Promise.all(a.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ln{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const r=new ln(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:o,data:i}=t.data,s=this.handlersMap[o];if(!s?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:o});const l=Array.from(s).map(async m=>m(t.origin,i)),d=await Wf(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ln.receivers=[];function es(a="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return a+t}class Kf{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let i,s;return new Promise((l,d)=>{const m=es("",20);o.port1.start();const p=setTimeout(()=>{d(new Error("unsupported_event"))},r);s={messageChannel:o,onMessage(g){const E=g;if(E.data.eventId===m)switch(E.data.status){case"ack":clearTimeout(p),i=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(E.data.response);break;default:clearTimeout(p),clearTimeout(i),d(new Error("invalid_response"));break}}},this.handlers.add(s),o.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[o.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Ue(){return window}function Qf(a){Ue().location.href=a}function Ed(){return typeof Ue().WorkerGlobalScope<"u"&&typeof Ue().importScripts=="function"}async function Jf(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Xf(){return navigator?.serviceWorker?.controller||null}function Yf(){return Ed()?self:null}const _d="firebaseLocalStorageDb",Zf=1,zo="firebaseLocalStorage",bd="fbase_key";class Or{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function un(a,e){return a.transaction([zo],e?"readwrite":"readonly").objectStore(zo)}function ey(){const a=indexedDB.deleteDatabase(_d);return new Or(a).toPromise()}function wi(){const a=indexedDB.open(_d,Zf);return new Promise((e,t)=>{a.addEventListener("error",()=>{t(a.error)}),a.addEventListener("upgradeneeded",()=>{const r=a.result;try{r.createObjectStore(zo,{keyPath:bd})}catch(o){t(o)}}),a.addEventListener("success",async()=>{const r=a.result;r.objectStoreNames.contains(zo)?e(r):(r.close(),await ey(),e(await wi()))})})}async function sl(a,e,t){const r=un(a,!0).put({[bd]:e,value:t});return new Or(r).toPromise()}async function ty(a,e){const t=un(a,!1).get(e),r=await new Or(t).toPromise();return r===void 0?null:r.value}function cl(a,e){const t=un(a,!0).delete(e);return new Or(t).toPromise()}const ay=800,ry=3;class Ad{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await wi(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>ry)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ed()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ln._getInstance(Yf()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Jf(),!this.activeServiceWorker)return;this.sender=new Kf(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Xf()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wi();return await sl(e,Bo,"1"),await cl(e,Bo),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>sl(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>ty(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>cl(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const i=un(o,!1).getAll();return new Or(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:o,value:i}of e)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(i)&&(this.notifyListeners(o,i),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ay)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ad.type="LOCAL";const oy=Ad;new xr(3e4,6e4);function ts(a,e){return e?tt(e):(B(a._popupRedirectResolver,a,"argument-error"),a._popupRedirectResolver)}class as extends md{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return va(e,this._buildIdpRequest())}_linkToIdToken(e,t){return va(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return va(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ny(a){return zf(a.auth,new as(a),a.bypassAuthState)}function iy(a){const{auth:e,user:t}=a;return B(t,e,"internal-error"),Bf(t,new as(a),a.bypassAuthState)}async function sy(a){const{auth:e,user:t}=a;return B(t,e,"internal-error"),Of(t,new as(a),a.bypassAuthState)}class wd{constructor(e,t,r,o,i=!1){this.auth=e,this.resolver=r,this.user=o,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:o,tenantId:i,error:s,type:l}=e;if(s){this.reject(s);return}const d={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(d))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ny;case"linkViaPopup":case"linkViaRedirect":return sy;case"reauthViaPopup":case"reauthViaRedirect":return iy;default:We(this.auth,"internal-error")}}resolve(e){rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const cy=new xr(2e3,1e4);async function ly(a,e,t){if(Fe(a.app))return Promise.reject(Ne(a,"operation-not-supported-in-this-environment"));const r=Lr(a);Ju(a,e,cn);const o=ts(r,t);return new Wt(r,"signInViaPopup",e,o).executeNotNull()}class Wt extends wd{constructor(e,t,r,o,i){super(e,t,o,i),this.provider=r,this.authWindow=null,this.pollId=null,Wt.currentPopupAction&&Wt.currentPopupAction.cancel(),Wt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return B(e,this.auth,"internal-error"),e}async onExecution(){rt(this.filter.length===1,"Popup operations only handle one event");const e=es();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ne(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ne(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wt.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ne(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cy.get())};e()}}Wt.currentPopupAction=null;const uy="pendingRedirect",bo=new Map;class dy extends wd{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=bo.get(this.auth._key());if(!e){try{const r=await my(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}bo.set(this.auth._key(),e)}return this.bypassAuthState||bo.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function my(a,e){const t=Td(e),r=Pd(a);if(!await r._isAvailable())return!1;const o=await r._get(t)==="true";return await r._remove(t),o}async function py(a,e){return Pd(a)._set(Td(e),"true")}function hy(a,e){bo.set(a._key(),e)}function Pd(a){return tt(a._redirectPersistence)}function Td(a){return _o(uy,a.config.apiKey,a.name)}function ll(a,e,t){return gy(a,e,t)}async function gy(a,e,t){if(Fe(a.app))return Promise.reject(Pt(a));const r=Lr(a);Ju(a,e,cn),await r._initializationPromise;const o=ts(r,t);return await py(o,r),o._openRedirect(r,e,"signInViaRedirect")}async function fy(a,e,t=!1){if(Fe(a.app))return Promise.reject(Pt(a));const r=Lr(a),o=ts(r,e),s=await new dy(r,o,t).execute();return s&&!t&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}const yy=600*1e3;class vy{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ey(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Id(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ne(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=yy&&this.cachedEventUids.clear(),this.cachedEventUids.has(ul(e))}saveEventToCache(e){this.cachedEventUids.add(ul(e)),this.lastProcessedEventTime=Date.now()}}function ul(a){return[a.type,a.eventId,a.sessionId,a.tenantId].filter(e=>e).join("-")}function Id({type:a,error:e}){return a==="unknown"&&e?.code==="auth/no-auth-event"}function Ey(a){switch(a.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Id(a);default:return!1}}async function _y(a,e={}){return Na(a,"GET","/v1/projects",e)}const by=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ay=/^https?/;async function wy(a){if(a.config.emulator)return;const{authorizedDomains:e}=await _y(a);for(const t of e)try{if(Py(t))return}catch{}We(a,"unauthorized-domain")}function Py(a){const e=bi(),{protocol:t,hostname:r}=new URL(e);if(a.startsWith("chrome-extension://")){const s=new URL(a);return s.hostname===""&&r===""?t==="chrome-extension:"&&a.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!Ay.test(t))return!1;if(by.test(a))return r===a;const o=a.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(r)}const Ty=new xr(3e4,6e4);function dl(){const a=Ue().___jsl;if(a?.H){for(const e of Object.keys(a.H))if(a.H[e].r=a.H[e].r||[],a.H[e].L=a.H[e].L||[],a.H[e].r=[...a.H[e].L],a.CP)for(let t=0;t<a.CP.length;t++)a.CP[t]=null}}function Iy(a){return new Promise((e,t)=>{function r(){dl(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dl(),t(Ne(a,"network-request-failed"))},timeout:Ty.get()})}if(Ue().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ue().gapi?.load)r();else{const o=Df("iframefcb");return Ue()[o]=()=>{gapi.load?r():t(Ne(a,"network-request-failed"))},Sf(`${Rf()}?onload=${o}`).catch(i=>t(i))}}).catch(e=>{throw Ao=null,e})}let Ao=null;function ky(a){return Ao=Ao||Iy(a),Ao}const Cy=new xr(5e3,15e3),Sy="__/auth/iframe",Ry="emulator/auth/iframe",Dy={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},My=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fy(a){const e=a.config;B(e.authDomain,a,"auth-domain-config-required");const t=e.emulator?Qi(e,Ry):`https://${a.config.authDomain}/${Sy}`,r={apiKey:e.apiKey,appName:a.name,v:La},o=My.get(a.config.apiHost);o&&(r.eid=o);const i=a._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Vr(r).slice(1)}`}async function Vy(a){const e=await ky(a),t=Ue().gapi;return B(t,a,"internal-error"),e.open({where:document.body,url:Fy(a),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Dy,dontclear:!0},r=>new Promise(async(o,i)=>{await r.restyle({setHideOnLeave:!1});const s=Ne(a,"network-request-failed"),l=Ue().setTimeout(()=>{i(s)},Cy.get());function d(){Ue().clearTimeout(l),o(r)}r.ping(d).then(d,()=>{i(s)})}))}const xy={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ly=500,Ny=600,Oy="_blank",By="http://localhost";class ml{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zy(a,e,t,r=Ly,o=Ny){const i=Math.max((window.screen.availHeight-o)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const d={...xy,width:r.toString(),height:o.toString(),top:i,left:s},m=Te().toLowerCase();t&&(l=od(m)?Oy:t),ad(m)&&(e=e||By,d.scrollbars="yes");const p=Object.entries(d).reduce((E,[C,I])=>`${E}${C}=${I},`,"");if(bf(m)&&l!=="_self")return qy(e||"",l),new ml(null);const g=window.open(e||"",l,p);B(g,a,"popup-blocked");try{g.focus()}catch{}return new ml(g)}function qy(a,e){const t=document.createElement("a");t.href=a,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Uy="__/auth/handler",jy="emulator/auth/handler",$y=encodeURIComponent("fac");async function pl(a,e,t,r,o,i){B(a.config.authDomain,a,"auth-domain-config-required"),B(a.config.apiKey,a,"invalid-api-key");const s={apiKey:a.config.apiKey,appName:a.name,authType:t,redirectUrl:r,v:La,eventId:o};if(e instanceof cn){e.setDefaultLanguage(a.languageCode),s.providerId=e.providerId||"",Uh(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,g]of Object.entries({}))s[p]=g}if(e instanceof Nr){const p=e.getScopes().filter(g=>g!=="");p.length>0&&(s.scopes=p.join(","))}a.tenantId&&(s.tid=a.tenantId);const l=s;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const d=await a._getAppCheckToken(),m=d?`#${$y}=${encodeURIComponent(d)}`:"";return`${Gy(a)}?${Vr(l).slice(1)}${m}`}function Gy({config:a}){return a.emulator?Qi(a,jy):`https://${a.authDomain}/${Uy}`}const ii="webStorageSupport";class Hy{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vd,this._completeRedirectFn=fy,this._overrideRedirectResult=hy}async _openPopup(e,t,r,o){rt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await pl(e,t,r,bi(),o);return zy(e,i,es())}async _openRedirect(e,t,r,o){await this._originValidation(e);const i=await pl(e,t,r,bi(),o);return Qf(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:i}=this.eventManagers[t];return o?Promise.resolve(o):(rt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Vy(e),r=new vy(e);return t.register("authEvent",o=>(B(o?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ii,{type:ii},o=>{const i=o?.[0]?.[ii];i!==void 0&&t(!!i),We(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=wy(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ld()||rd()||Yi()}}const Wy=Hy;var hl="@firebase/auth",gl="1.12.0";class Ky{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Qy(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Jy(a){wa(new Yt("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:l}=r.options;B(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const d={apiKey:s,authDomain:l,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ud(a)},m=new kf(r,o,i,d);return Ff(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),wa(new Yt("auth-internal",e=>{const t=Lr(e.getProvider("auth").getImmediate());return(r=>new Ky(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),wt(hl,gl,Qy(a)),wt(hl,gl,"esm2020")}const Xy=300,Yy=Bu("authIdTokenMaxAge")||Xy;let fl=null;const Zy=a=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Yy)return;const o=t?.token;fl!==o&&(fl=o,await fetch(a,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function ev(a=Gu()){const e=Hi(a,"auth");if(e.isInitialized())return e.getImmediate();const t=Mf(a,{popupRedirectResolver:Wy,persistence:[oy,Hf,vd]}),r=Bu("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const s=Zy(i.toString());Uf(t,s,()=>s(t.currentUser)),qf(t,l=>s(l))}}const o=Nu("auth");return o&&Vf(t,`http://${o}`),t}function tv(){return document.getElementsByTagName("head")?.[0]??document}Cf({loadJS(a){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",a),r.onload=e,r.onerror=o=>{const i=Ne("internal-error");i.customData=o,t(i)},r.type="text/javascript",r.charset="UTF-8",tv().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Jy("Browser");var yl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Tt,kd;(function(){var a;function e(b,f){function v(){}v.prototype=f.prototype,b.F=f.prototype,b.prototype=new v,b.prototype.constructor=b,b.D=function(A,_,w){for(var y=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)y[ge-2]=arguments[ge];return f.prototype[_].apply(A,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(b,f,v){v||(v=0);const A=Array(16);if(typeof f=="string")for(var _=0;_<16;++_)A[_]=f.charCodeAt(v++)|f.charCodeAt(v++)<<8|f.charCodeAt(v++)<<16|f.charCodeAt(v++)<<24;else for(_=0;_<16;++_)A[_]=f[v++]|f[v++]<<8|f[v++]<<16|f[v++]<<24;f=b.g[0],v=b.g[1],_=b.g[2];let w=b.g[3],y;y=f+(w^v&(_^w))+A[0]+3614090360&4294967295,f=v+(y<<7&4294967295|y>>>25),y=w+(_^f&(v^_))+A[1]+3905402710&4294967295,w=f+(y<<12&4294967295|y>>>20),y=_+(v^w&(f^v))+A[2]+606105819&4294967295,_=w+(y<<17&4294967295|y>>>15),y=v+(f^_&(w^f))+A[3]+3250441966&4294967295,v=_+(y<<22&4294967295|y>>>10),y=f+(w^v&(_^w))+A[4]+4118548399&4294967295,f=v+(y<<7&4294967295|y>>>25),y=w+(_^f&(v^_))+A[5]+1200080426&4294967295,w=f+(y<<12&4294967295|y>>>20),y=_+(v^w&(f^v))+A[6]+2821735955&4294967295,_=w+(y<<17&4294967295|y>>>15),y=v+(f^_&(w^f))+A[7]+4249261313&4294967295,v=_+(y<<22&4294967295|y>>>10),y=f+(w^v&(_^w))+A[8]+1770035416&4294967295,f=v+(y<<7&4294967295|y>>>25),y=w+(_^f&(v^_))+A[9]+2336552879&4294967295,w=f+(y<<12&4294967295|y>>>20),y=_+(v^w&(f^v))+A[10]+4294925233&4294967295,_=w+(y<<17&4294967295|y>>>15),y=v+(f^_&(w^f))+A[11]+2304563134&4294967295,v=_+(y<<22&4294967295|y>>>10),y=f+(w^v&(_^w))+A[12]+1804603682&4294967295,f=v+(y<<7&4294967295|y>>>25),y=w+(_^f&(v^_))+A[13]+4254626195&4294967295,w=f+(y<<12&4294967295|y>>>20),y=_+(v^w&(f^v))+A[14]+2792965006&4294967295,_=w+(y<<17&4294967295|y>>>15),y=v+(f^_&(w^f))+A[15]+1236535329&4294967295,v=_+(y<<22&4294967295|y>>>10),y=f+(_^w&(v^_))+A[1]+4129170786&4294967295,f=v+(y<<5&4294967295|y>>>27),y=w+(v^_&(f^v))+A[6]+3225465664&4294967295,w=f+(y<<9&4294967295|y>>>23),y=_+(f^v&(w^f))+A[11]+643717713&4294967295,_=w+(y<<14&4294967295|y>>>18),y=v+(w^f&(_^w))+A[0]+3921069994&4294967295,v=_+(y<<20&4294967295|y>>>12),y=f+(_^w&(v^_))+A[5]+3593408605&4294967295,f=v+(y<<5&4294967295|y>>>27),y=w+(v^_&(f^v))+A[10]+38016083&4294967295,w=f+(y<<9&4294967295|y>>>23),y=_+(f^v&(w^f))+A[15]+3634488961&4294967295,_=w+(y<<14&4294967295|y>>>18),y=v+(w^f&(_^w))+A[4]+3889429448&4294967295,v=_+(y<<20&4294967295|y>>>12),y=f+(_^w&(v^_))+A[9]+568446438&4294967295,f=v+(y<<5&4294967295|y>>>27),y=w+(v^_&(f^v))+A[14]+3275163606&4294967295,w=f+(y<<9&4294967295|y>>>23),y=_+(f^v&(w^f))+A[3]+4107603335&4294967295,_=w+(y<<14&4294967295|y>>>18),y=v+(w^f&(_^w))+A[8]+1163531501&4294967295,v=_+(y<<20&4294967295|y>>>12),y=f+(_^w&(v^_))+A[13]+2850285829&4294967295,f=v+(y<<5&4294967295|y>>>27),y=w+(v^_&(f^v))+A[2]+4243563512&4294967295,w=f+(y<<9&4294967295|y>>>23),y=_+(f^v&(w^f))+A[7]+1735328473&4294967295,_=w+(y<<14&4294967295|y>>>18),y=v+(w^f&(_^w))+A[12]+2368359562&4294967295,v=_+(y<<20&4294967295|y>>>12),y=f+(v^_^w)+A[5]+4294588738&4294967295,f=v+(y<<4&4294967295|y>>>28),y=w+(f^v^_)+A[8]+2272392833&4294967295,w=f+(y<<11&4294967295|y>>>21),y=_+(w^f^v)+A[11]+1839030562&4294967295,_=w+(y<<16&4294967295|y>>>16),y=v+(_^w^f)+A[14]+4259657740&4294967295,v=_+(y<<23&4294967295|y>>>9),y=f+(v^_^w)+A[1]+2763975236&4294967295,f=v+(y<<4&4294967295|y>>>28),y=w+(f^v^_)+A[4]+1272893353&4294967295,w=f+(y<<11&4294967295|y>>>21),y=_+(w^f^v)+A[7]+4139469664&4294967295,_=w+(y<<16&4294967295|y>>>16),y=v+(_^w^f)+A[10]+3200236656&4294967295,v=_+(y<<23&4294967295|y>>>9),y=f+(v^_^w)+A[13]+681279174&4294967295,f=v+(y<<4&4294967295|y>>>28),y=w+(f^v^_)+A[0]+3936430074&4294967295,w=f+(y<<11&4294967295|y>>>21),y=_+(w^f^v)+A[3]+3572445317&4294967295,_=w+(y<<16&4294967295|y>>>16),y=v+(_^w^f)+A[6]+76029189&4294967295,v=_+(y<<23&4294967295|y>>>9),y=f+(v^_^w)+A[9]+3654602809&4294967295,f=v+(y<<4&4294967295|y>>>28),y=w+(f^v^_)+A[12]+3873151461&4294967295,w=f+(y<<11&4294967295|y>>>21),y=_+(w^f^v)+A[15]+530742520&4294967295,_=w+(y<<16&4294967295|y>>>16),y=v+(_^w^f)+A[2]+3299628645&4294967295,v=_+(y<<23&4294967295|y>>>9),y=f+(_^(v|~w))+A[0]+4096336452&4294967295,f=v+(y<<6&4294967295|y>>>26),y=w+(v^(f|~_))+A[7]+1126891415&4294967295,w=f+(y<<10&4294967295|y>>>22),y=_+(f^(w|~v))+A[14]+2878612391&4294967295,_=w+(y<<15&4294967295|y>>>17),y=v+(w^(_|~f))+A[5]+4237533241&4294967295,v=_+(y<<21&4294967295|y>>>11),y=f+(_^(v|~w))+A[12]+1700485571&4294967295,f=v+(y<<6&4294967295|y>>>26),y=w+(v^(f|~_))+A[3]+2399980690&4294967295,w=f+(y<<10&4294967295|y>>>22),y=_+(f^(w|~v))+A[10]+4293915773&4294967295,_=w+(y<<15&4294967295|y>>>17),y=v+(w^(_|~f))+A[1]+2240044497&4294967295,v=_+(y<<21&4294967295|y>>>11),y=f+(_^(v|~w))+A[8]+1873313359&4294967295,f=v+(y<<6&4294967295|y>>>26),y=w+(v^(f|~_))+A[15]+4264355552&4294967295,w=f+(y<<10&4294967295|y>>>22),y=_+(f^(w|~v))+A[6]+2734768916&4294967295,_=w+(y<<15&4294967295|y>>>17),y=v+(w^(_|~f))+A[13]+1309151649&4294967295,v=_+(y<<21&4294967295|y>>>11),y=f+(_^(v|~w))+A[4]+4149444226&4294967295,f=v+(y<<6&4294967295|y>>>26),y=w+(v^(f|~_))+A[11]+3174756917&4294967295,w=f+(y<<10&4294967295|y>>>22),y=_+(f^(w|~v))+A[2]+718787259&4294967295,_=w+(y<<15&4294967295|y>>>17),y=v+(w^(_|~f))+A[9]+3951481745&4294967295,b.g[0]=b.g[0]+f&4294967295,b.g[1]=b.g[1]+(_+(y<<21&4294967295|y>>>11))&4294967295,b.g[2]=b.g[2]+_&4294967295,b.g[3]=b.g[3]+w&4294967295}r.prototype.v=function(b,f){f===void 0&&(f=b.length);const v=f-this.blockSize,A=this.C;let _=this.h,w=0;for(;w<f;){if(_==0)for(;w<=v;)o(this,b,w),w+=this.blockSize;if(typeof b=="string"){for(;w<f;)if(A[_++]=b.charCodeAt(w++),_==this.blockSize){o(this,A),_=0;break}}else for(;w<f;)if(A[_++]=b[w++],_==this.blockSize){o(this,A),_=0;break}}this.h=_,this.o+=f},r.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var f=1;f<b.length-8;++f)b[f]=0;f=this.o*8;for(var v=b.length-8;v<b.length;++v)b[v]=f&255,f/=256;for(this.v(b),b=Array(16),f=0,v=0;v<4;++v)for(let A=0;A<32;A+=8)b[f++]=this.g[v]>>>A&255;return b};function i(b,f){var v=l;return Object.prototype.hasOwnProperty.call(v,b)?v[b]:v[b]=f(b)}function s(b,f){this.h=f;const v=[];let A=!0;for(let _=b.length-1;_>=0;_--){const w=b[_]|0;A&&w==f||(v[_]=w,A=!1)}this.g=v}var l={};function d(b){return-128<=b&&b<128?i(b,function(f){return new s([f|0],f<0?-1:0)}):new s([b|0],b<0?-1:0)}function m(b){if(isNaN(b)||!isFinite(b))return g;if(b<0)return k(m(-b));const f=[];let v=1;for(let A=0;b>=v;A++)f[A]=b/v|0,v*=4294967296;return new s(f,0)}function p(b,f){if(b.length==0)throw Error("number format error: empty string");if(f=f||10,f<2||36<f)throw Error("radix out of range: "+f);if(b.charAt(0)=="-")return k(p(b.substring(1),f));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=m(Math.pow(f,8));let A=g;for(let w=0;w<b.length;w+=8){var _=Math.min(8,b.length-w);const y=parseInt(b.substring(w,w+_),f);_<8?(_=m(Math.pow(f,_)),A=A.j(_).add(m(y))):(A=A.j(v),A=A.add(m(y)))}return A}var g=d(0),E=d(1),C=d(16777216);a=s.prototype,a.m=function(){if(R(this))return-k(this).m();let b=0,f=1;for(let v=0;v<this.g.length;v++){const A=this.i(v);b+=(A>=0?A:4294967296+A)*f,f*=4294967296}return b},a.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(I(this))return"0";if(R(this))return"-"+k(this).toString(b);const f=m(Math.pow(b,6));var v=this;let A="";for(;;){const _=Y(v,f).g;v=x(v,_.j(f));let w=((v.g.length>0?v.g[0]:v.h)>>>0).toString(b);if(v=_,I(v))return w+A;for(;w.length<6;)w="0"+w;A=w+A}},a.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function I(b){if(b.h!=0)return!1;for(let f=0;f<b.g.length;f++)if(b.g[f]!=0)return!1;return!0}function R(b){return b.h==-1}a.l=function(b){return b=x(this,b),R(b)?-1:I(b)?0:1};function k(b){const f=b.g.length,v=[];for(let A=0;A<f;A++)v[A]=~b.g[A];return new s(v,~b.h).add(E)}a.abs=function(){return R(this)?k(this):this},a.add=function(b){const f=Math.max(this.g.length,b.g.length),v=[];let A=0;for(let _=0;_<=f;_++){let w=A+(this.i(_)&65535)+(b.i(_)&65535),y=(w>>>16)+(this.i(_)>>>16)+(b.i(_)>>>16);A=y>>>16,w&=65535,y&=65535,v[_]=y<<16|w}return new s(v,v[v.length-1]&-2147483648?-1:0)};function x(b,f){return b.add(k(f))}a.j=function(b){if(I(this)||I(b))return g;if(R(this))return R(b)?k(this).j(k(b)):k(k(this).j(b));if(R(b))return k(this.j(k(b)));if(this.l(C)<0&&b.l(C)<0)return m(this.m()*b.m());const f=this.g.length+b.g.length,v=[];for(var A=0;A<2*f;A++)v[A]=0;for(A=0;A<this.g.length;A++)for(let _=0;_<b.g.length;_++){const w=this.i(A)>>>16,y=this.i(A)&65535,ge=b.i(_)>>>16,Oe=b.i(_)&65535;v[2*A+2*_]+=y*Oe,z(v,2*A+2*_),v[2*A+2*_+1]+=w*Oe,z(v,2*A+2*_+1),v[2*A+2*_+1]+=y*ge,z(v,2*A+2*_+1),v[2*A+2*_+2]+=w*ge,z(v,2*A+2*_+2)}for(b=0;b<f;b++)v[b]=v[2*b+1]<<16|v[2*b];for(b=f;b<2*f;b++)v[b]=0;return new s(v,0)};function z(b,f){for(;(b[f]&65535)!=b[f];)b[f+1]+=b[f]>>>16,b[f]&=65535,f++}function j(b,f){this.g=b,this.h=f}function Y(b,f){if(I(f))throw Error("division by zero");if(I(b))return new j(g,g);if(R(b))return f=Y(k(b),f),new j(k(f.g),k(f.h));if(R(f))return f=Y(b,k(f)),new j(k(f.g),f.h);if(b.g.length>30){if(R(b)||R(f))throw Error("slowDivide_ only works with positive integers.");for(var v=E,A=f;A.l(b)<=0;)v=G(v),A=G(A);var _=Q(v,1),w=Q(A,1);for(A=Q(A,2),v=Q(v,2);!I(A);){var y=w.add(A);y.l(b)<=0&&(_=_.add(v),w=y),A=Q(A,1),v=Q(v,1)}return f=x(b,_.j(f)),new j(_,f)}for(_=g;b.l(f)>=0;){for(v=Math.max(1,Math.floor(b.m()/f.m())),A=Math.ceil(Math.log(v)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),w=m(v),y=w.j(f);R(y)||y.l(b)>0;)v-=A,w=m(v),y=w.j(f);I(w)&&(w=E),_=_.add(w),b=x(b,y)}return new j(_,b)}a.B=function(b){return Y(this,b).h},a.and=function(b){const f=Math.max(this.g.length,b.g.length),v=[];for(let A=0;A<f;A++)v[A]=this.i(A)&b.i(A);return new s(v,this.h&b.h)},a.or=function(b){const f=Math.max(this.g.length,b.g.length),v=[];for(let A=0;A<f;A++)v[A]=this.i(A)|b.i(A);return new s(v,this.h|b.h)},a.xor=function(b){const f=Math.max(this.g.length,b.g.length),v=[];for(let A=0;A<f;A++)v[A]=this.i(A)^b.i(A);return new s(v,this.h^b.h)};function G(b){const f=b.g.length+1,v=[];for(let A=0;A<f;A++)v[A]=b.i(A)<<1|b.i(A-1)>>>31;return new s(v,b.h)}function Q(b,f){const v=f>>5;f%=32;const A=b.g.length-v,_=[];for(let w=0;w<A;w++)_[w]=f>0?b.i(w+v)>>>f|b.i(w+v+1)<<32-f:b.i(w+v);return new s(_,b.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,kd=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=m,s.fromString=p,Tt=s}).apply(typeof yl<"u"?yl:typeof self<"u"?self:typeof window<"u"?window:{});var po=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Cd,ur,Sd,wo,Pi,Rd,Dd,Md;(function(){var a,e=Object.defineProperty;function t(n){n=[typeof globalThis=="object"&&globalThis,n,typeof window=="object"&&window,typeof self=="object"&&self,typeof po=="object"&&po];for(var c=0;c<n.length;++c){var u=n[c];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var r=t(this);function o(n,c){if(c)e:{var u=r;n=n.split(".");for(var h=0;h<n.length-1;h++){var P=n[h];if(!(P in u))break e;u=u[P]}n=n[n.length-1],h=u[n],c=c(h),c!=h&&c!=null&&e(u,n,{configurable:!0,writable:!0,value:c})}}o("Symbol.dispose",function(n){return n||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(n){return n||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(n){return n||function(c){var u=[],h;for(h in c)Object.prototype.hasOwnProperty.call(c,h)&&u.push([h,c[h]]);return u}});var i=i||{},s=this||self;function l(n){var c=typeof n;return c=="object"&&n!=null||c=="function"}function d(n,c,u){return n.call.apply(n.bind,arguments)}function m(n,c,u){return m=d,m.apply(null,arguments)}function p(n,c){var u=Array.prototype.slice.call(arguments,1);return function(){var h=u.slice();return h.push.apply(h,arguments),n.apply(this,h)}}function g(n,c){function u(){}u.prototype=c.prototype,n.Z=c.prototype,n.prototype=new u,n.prototype.constructor=n,n.Ob=function(h,P,T){for(var M=Array(arguments.length-2),$=2;$<arguments.length;$++)M[$-2]=arguments[$];return c.prototype[P].apply(h,M)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?n=>n&&AsyncContext.Snapshot.wrap(n):n=>n;function C(n){const c=n.length;if(c>0){const u=Array(c);for(let h=0;h<c;h++)u[h]=n[h];return u}return[]}function I(n,c){for(let h=1;h<arguments.length;h++){const P=arguments[h];var u=typeof P;if(u=u!="object"?u:P?Array.isArray(P)?"array":u:"null",u=="array"||u=="object"&&typeof P.length=="number"){u=n.length||0;const T=P.length||0;n.length=u+T;for(let M=0;M<T;M++)n[u+M]=P[M]}else n.push(P)}}class R{constructor(c,u){this.i=c,this.j=u,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function k(n){s.setTimeout(()=>{throw n},0)}function x(){var n=b;let c=null;return n.g&&(c=n.g,n.g=n.g.next,n.g||(n.h=null),c.next=null),c}class z{constructor(){this.h=this.g=null}add(c,u){const h=j.get();h.set(c,u),this.h?this.h.next=h:this.g=h,this.h=h}}var j=new R(()=>new Y,n=>n.reset());class Y{constructor(){this.next=this.g=this.h=null}set(c,u){this.h=c,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let G,Q=!1,b=new z,f=()=>{const n=Promise.resolve(void 0);G=()=>{n.then(v)}};function v(){for(var n;n=x();){try{n.h.call(n.g)}catch(u){k(u)}var c=j;c.j(n),c.h<100&&(c.h++,n.next=c.g,c.g=n)}Q=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _(n,c){this.type=n,this.g=this.target=c,this.defaultPrevented=!1}_.prototype.h=function(){this.defaultPrevented=!0};var w=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var n=!1,c=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const u=()=>{};s.addEventListener("test",u,c),s.removeEventListener("test",u,c)}catch{}return n})();function y(n){return/^[\s\xa0]*$/.test(n)}function ge(n,c){_.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n&&this.init(n,c)}g(ge,_),ge.prototype.init=function(n,c){const u=this.type=n.type,h=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;this.target=n.target||n.srcElement,this.g=c,c=n.relatedTarget,c||(u=="mouseover"?c=n.fromElement:u=="mouseout"&&(c=n.toElement)),this.relatedTarget=c,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=n.pointerType,this.state=n.state,this.i=n,n.defaultPrevented&&ge.Z.h.call(this)},ge.prototype.h=function(){ge.Z.h.call(this);const n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Oe="closure_listenable_"+(Math.random()*1e6|0),Gr=0;function Hr(n,c,u,h,P){this.listener=n,this.proxy=null,this.src=c,this.type=u,this.capture=!!h,this.ha=P,this.key=++Gr,this.da=this.fa=!1}function Ot(n){n.da=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function ia(n,c,u){for(const h in n)c.call(u,n[h],h,n)}function Fn(n,c){for(const u in n)c.call(void 0,n[u],u,n)}function Vn(n){const c={};for(const u in n)c[u]=n[u];return c}const Wr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Kr(n,c){let u,h;for(let P=1;P<arguments.length;P++){h=arguments[P];for(u in h)n[u]=h[u];for(let T=0;T<Wr.length;T++)u=Wr[T],Object.prototype.hasOwnProperty.call(h,u)&&(n[u]=h[u])}}function sa(n){this.src=n,this.g={},this.h=0}sa.prototype.add=function(n,c,u,h,P){const T=n.toString();n=this.g[T],n||(n=this.g[T]=[],this.h++);const M=Ga(n,c,h,P);return M>-1?(c=n[M],u||(c.fa=!1)):(c=new Hr(c,this.src,T,!!h,P),c.fa=u,n.push(c)),c};function $a(n,c){const u=c.type;if(u in n.g){var h=n.g[u],P=Array.prototype.indexOf.call(h,c,void 0),T;(T=P>=0)&&Array.prototype.splice.call(h,P,1),T&&(Ot(c),n.g[u].length==0&&(delete n.g[u],n.h--))}}function Ga(n,c,u,h){for(let P=0;P<n.length;++P){const T=n[P];if(!T.da&&T.listener==c&&T.capture==!!u&&T.ha==h)return P}return-1}var Qr="closure_lm_"+(Math.random()*1e6|0),Ha={};function Jr(n,c,u,h,P){if(Array.isArray(c)){for(let T=0;T<c.length;T++)Jr(n,c[T],u,h,P);return null}return u=Hs(u),n&&n[Oe]?n.J(c,u,l(h)?!!h.capture:!1,P):st(n,c,u,!1,h,P)}function st(n,c,u,h,P,T){if(!c)throw Error("Invalid event type");const M=l(P)?!!P.capture:!!P;let $=Bt(n);if($||(n[Qr]=$=new sa(n)),u=$.add(c,u,h,M,T),u.proxy)return u;if(h=Xr(),u.proxy=h,h.src=n,h.listener=u,n.addEventListener)w||(P=M),P===void 0&&(P=!1),n.addEventListener(c.toString(),h,P);else if(n.attachEvent)n.attachEvent(xn(c.toString()),h);else if(n.addListener&&n.removeListener)n.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return u}function Xr(){function n(u){return c.call(n.src,n.listener,u)}const c=Wa;return n}function ct(n,c,u,h,P){if(Array.isArray(c))for(var T=0;T<c.length;T++)ct(n,c[T],u,h,P);else h=l(h)?!!h.capture:!!h,u=Hs(u),n&&n[Oe]?(n=n.i,T=String(c).toString(),T in n.g&&(c=n.g[T],u=Ga(c,u,h,P),u>-1&&(Ot(c[u]),Array.prototype.splice.call(c,u,1),c.length==0&&(delete n.g[T],n.h--)))):n&&(n=Bt(n))&&(c=n.g[c.toString()],n=-1,c&&(n=Ga(c,u,h,P)),(u=n>-1?c[n]:null)&&Yr(u))}function Yr(n){if(typeof n!="number"&&n&&!n.da){var c=n.src;if(c&&c[Oe])$a(c.i,n);else{var u=n.type,h=n.proxy;c.removeEventListener?c.removeEventListener(u,h,n.capture):c.detachEvent?c.detachEvent(xn(u),h):c.addListener&&c.removeListener&&c.removeListener(h),(u=Bt(c))?($a(u,n),u.h==0&&(u.src=null,c[Qr]=null)):Ot(n)}}}function xn(n){return n in Ha?Ha[n]:Ha[n]="on"+n}function Wa(n,c){if(n.da)n=!0;else{c=new ge(c,this);const u=n.listener,h=n.ha||n.src;n.fa&&Yr(n),n=u.call(h,c)}return n}function Bt(n){return n=n[Qr],n instanceof sa?n:null}var Ln="__closure_events_fn_"+(Math.random()*1e9>>>0);function Hs(n){return typeof n=="function"?n:(n[Ln]||(n[Ln]=function(c){return n.handleEvent(c)}),n[Ln])}function be(){A.call(this),this.i=new sa(this),this.M=this,this.G=null}g(be,A),be.prototype[Oe]=!0,be.prototype.removeEventListener=function(n,c,u,h){ct(this,n,c,u,h)};function Ie(n,c){var u,h=n.G;if(h)for(u=[];h;h=h.G)u.push(h);if(n=n.M,h=c.type||c,typeof c=="string")c=new _(c,n);else if(c instanceof _)c.target=c.target||n;else{var P=c;c=new _(h,n),Kr(c,P)}P=!0;let T,M;if(u)for(M=u.length-1;M>=0;M--)T=c.g=u[M],P=Zr(T,h,!0,c)&&P;if(T=c.g=n,P=Zr(T,h,!0,c)&&P,P=Zr(T,h,!1,c)&&P,u)for(M=0;M<u.length;M++)T=c.g=u[M],P=Zr(T,h,!1,c)&&P}be.prototype.N=function(){if(be.Z.N.call(this),this.i){var n=this.i;for(const c in n.g){const u=n.g[c];for(let h=0;h<u.length;h++)Ot(u[h]);delete n.g[c],n.h--}}this.G=null},be.prototype.J=function(n,c,u,h){return this.i.add(String(n),c,!1,u,h)},be.prototype.K=function(n,c,u,h){return this.i.add(String(n),c,!0,u,h)};function Zr(n,c,u,h){if(c=n.i.g[String(c)],!c)return!0;c=c.concat();let P=!0;for(let T=0;T<c.length;++T){const M=c[T];if(M&&!M.da&&M.capture==u){const $=M.listener,ce=M.ha||M.src;M.fa&&$a(n.i,M),P=$.call(ce,h)!==!1&&P}}return P&&!h.defaultPrevented}function Ap(n,c){if(typeof n!="function")if(n&&typeof n.handleEvent=="function")n=m(n.handleEvent,n);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:s.setTimeout(n,c||0)}function Ws(n){n.g=Ap(()=>{n.g=null,n.i&&(n.i=!1,Ws(n))},n.l);const c=n.h;n.h=null,n.m.apply(null,c)}class wp extends A{constructor(c,u){super(),this.m=c,this.l=u,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Ws(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ka(n){A.call(this),this.h=n,this.g={}}g(Ka,A);var Ks=[];function Qs(n){ia(n.g,function(c,u){this.g.hasOwnProperty(u)&&Yr(c)},n),n.g={}}Ka.prototype.N=function(){Ka.Z.N.call(this),Qs(this)},Ka.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Nn=s.JSON.stringify,Pp=s.JSON.parse,Tp=class{stringify(n){return s.JSON.stringify(n,void 0)}parse(n){return s.JSON.parse(n,void 0)}};function Js(){}function Xs(){}var Qa={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function On(){_.call(this,"d")}g(On,_);function Bn(){_.call(this,"c")}g(Bn,_);var zt={},Ys=null;function eo(){return Ys=Ys||new be}zt.Ia="serverreachability";function Zs(n){_.call(this,zt.Ia,n)}g(Zs,_);function Ja(n){const c=eo();Ie(c,new Zs(c))}zt.STAT_EVENT="statevent";function ec(n,c){_.call(this,zt.STAT_EVENT,n),this.stat=c}g(ec,_);function ke(n){const c=eo();Ie(c,new ec(c,n))}zt.Ja="timingevent";function tc(n,c){_.call(this,zt.Ja,n),this.size=c}g(tc,_);function Xa(n,c){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){n()},c)}function Ya(){this.g=!0}Ya.prototype.ua=function(){this.g=!1};function Ip(n,c,u,h,P,T){n.info(function(){if(n.g)if(T){var M="",$=T.split("&");for(let Z=0;Z<$.length;Z++){var ce=$[Z].split("=");if(ce.length>1){const de=ce[0];ce=ce[1];const ze=de.split("_");M=ze.length>=2&&ze[1]=="type"?M+(de+"="+ce+"&"):M+(de+"=redacted&")}}}else M=null;else M=T;return"XMLHTTP REQ ("+h+") [attempt "+P+"]: "+c+`
`+u+`
`+M})}function kp(n,c,u,h,P,T,M){n.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+P+"]: "+c+`
`+u+`
`+T+" "+M})}function ca(n,c,u,h){n.info(function(){return"XMLHTTP TEXT ("+c+"): "+Sp(n,u)+(h?" "+h:"")})}function Cp(n,c){n.info(function(){return"TIMEOUT: "+c})}Ya.prototype.info=function(){};function Sp(n,c){if(!n.g)return c;if(!c)return null;try{const T=JSON.parse(c);if(T){for(n=0;n<T.length;n++)if(Array.isArray(T[n])){var u=T[n];if(!(u.length<2)){var h=u[1];if(Array.isArray(h)&&!(h.length<1)){var P=h[0];if(P!="noop"&&P!="stop"&&P!="close")for(let M=1;M<h.length;M++)h[M]=""}}}}return Nn(T)}catch{return c}}var to={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ac={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},rc;function zn(){}g(zn,Js),zn.prototype.g=function(){return new XMLHttpRequest},rc=new zn;function Za(n){return encodeURIComponent(String(n))}function Rp(n){var c=1;n=n.split(":");const u=[];for(;c>0&&n.length;)u.push(n.shift()),c--;return n.length&&u.push(n.join(":")),u}function lt(n,c,u,h){this.j=n,this.i=c,this.l=u,this.S=h||1,this.V=new Ka(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new oc}function oc(){this.i=null,this.g="",this.h=!1}var nc={},qn={};function Un(n,c,u){n.M=1,n.A=ro(Be(c)),n.u=u,n.R=!0,ic(n,null)}function ic(n,c){n.F=Date.now(),ao(n),n.B=Be(n.A);var u=n.B,h=n.S;Array.isArray(h)||(h=[String(h)]),Ec(u.i,"t",h),n.C=0,u=n.j.L,n.h=new oc,n.g=Nc(n.j,u?c:null,!n.u),n.P>0&&(n.O=new wp(m(n.Y,n,n.g),n.P)),c=n.V,u=n.g,h=n.ba;var P="readystatechange";Array.isArray(P)||(P&&(Ks[0]=P.toString()),P=Ks);for(let T=0;T<P.length;T++){const M=Jr(u,P[T],h||c.handleEvent,!1,c.h||c);if(!M)break;c.g[M.key]=M}c=n.J?Vn(n.J):{},n.u?(n.v||(n.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.B,n.v,n.u,c)):(n.v="GET",n.g.ea(n.B,n.v,null,c)),Ja(),Ip(n.i,n.v,n.B,n.l,n.S,n.u)}lt.prototype.ba=function(n){n=n.target;const c=this.O;c&&mt(n)==3?c.j():this.Y(n)},lt.prototype.Y=function(n){try{if(n==this.g)e:{const $=mt(this.g),ce=this.g.ya(),Z=this.g.ca();if(!($<3)&&($!=3||this.g&&(this.h.h||this.g.la()||Ic(this.g)))){this.K||$!=4||ce==7||(ce==8||Z<=0?Ja(3):Ja(2)),jn(this);var c=this.g.ca();this.X=c;var u=Dp(this);if(this.o=c==200,kp(this.i,this.v,this.B,this.l,this.S,$,c),this.o){if(this.U&&!this.L){t:{if(this.g){var h,P=this.g;if((h=P.g?P.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(h)){var T=h;break t}}T=null}if(n=T)ca(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,$n(this,n);else{this.o=!1,this.m=3,ke(12),qt(this),er(this);break e}}if(this.R){n=!0;let de;for(;!this.K&&this.C<u.length;)if(de=Mp(this,u),de==qn){$==4&&(this.m=4,ke(14),n=!1),ca(this.i,this.l,null,"[Incomplete Response]");break}else if(de==nc){this.m=4,ke(15),ca(this.i,this.l,u,"[Invalid Chunk]"),n=!1;break}else ca(this.i,this.l,de,null),$n(this,de);if(sc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$!=4||u.length!=0||this.h.h||(this.m=1,ke(16),n=!1),this.o=this.o&&n,!n)ca(this.i,this.l,u,"[Invalid Chunked Response]"),qt(this),er(this);else if(u.length>0&&!this.W){this.W=!0;var M=this.j;M.g==this&&M.aa&&!M.P&&(M.j.info("Great, no buffering proxy detected. Bytes received: "+u.length),Yn(M),M.P=!0,ke(11))}}else ca(this.i,this.l,u,null),$n(this,u);$==4&&qt(this),this.o&&!this.K&&($==4?Fc(this.j,this):(this.o=!1,ao(this)))}else Hp(this.g),c==400&&u.indexOf("Unknown SID")>0?(this.m=3,ke(12)):(this.m=0,ke(13)),qt(this),er(this)}}}catch{}};function Dp(n){if(!sc(n))return n.g.la();const c=Ic(n.g);if(c==="")return"";let u="";const h=c.length,P=mt(n.g)==4;if(!n.h.i){if(typeof TextDecoder>"u")return qt(n),er(n),"";n.h.i=new s.TextDecoder}for(let T=0;T<h;T++)n.h.h=!0,u+=n.h.i.decode(c[T],{stream:!(P&&T==h-1)});return c.length=0,n.h.g+=u,n.C=0,n.h.g}function sc(n){return n.g?n.v=="GET"&&n.M!=2&&n.j.Aa:!1}function Mp(n,c){var u=n.C,h=c.indexOf(`
`,u);return h==-1?qn:(u=Number(c.substring(u,h)),isNaN(u)?nc:(h+=1,h+u>c.length?qn:(c=c.slice(h,h+u),n.C=h+u,c)))}lt.prototype.cancel=function(){this.K=!0,qt(this)};function ao(n){n.T=Date.now()+n.H,cc(n,n.H)}function cc(n,c){if(n.D!=null)throw Error("WatchDog timer not null");n.D=Xa(m(n.aa,n),c)}function jn(n){n.D&&(s.clearTimeout(n.D),n.D=null)}lt.prototype.aa=function(){this.D=null;const n=Date.now();n-this.T>=0?(Cp(this.i,this.B),this.M!=2&&(Ja(),ke(17)),qt(this),this.m=2,er(this)):cc(this,this.T-n)};function er(n){n.j.I==0||n.K||Fc(n.j,n)}function qt(n){jn(n);var c=n.O;c&&typeof c.dispose=="function"&&c.dispose(),n.O=null,Qs(n.V),n.g&&(c=n.g,n.g=null,c.abort(),c.dispose())}function $n(n,c){try{var u=n.j;if(u.I!=0&&(u.g==n||Gn(u.h,n))){if(!n.L&&Gn(u.h,n)&&u.I==3){try{var h=u.Ba.g.parse(c)}catch{h=null}if(Array.isArray(h)&&h.length==3){var P=h;if(P[0]==0){e:if(!u.v){if(u.g)if(u.g.F+3e3<n.F)co(u),io(u);else break e;Xn(u),ke(18)}}else u.xa=P[1],0<u.xa-u.K&&P[2]<37500&&u.F&&u.A==0&&!u.C&&(u.C=Xa(m(u.Va,u),6e3));dc(u.h)<=1&&u.ta&&(u.ta=void 0)}else jt(u,11)}else if((n.L||u.g==n)&&co(u),!y(c))for(P=u.Ba.g.parse(c),c=0;c<P.length;c++){let Z=P[c];const de=Z[0];if(!(de<=u.K))if(u.K=de,Z=Z[1],u.I==2)if(Z[0]=="c"){u.M=Z[1],u.ba=Z[2];const ze=Z[3];ze!=null&&(u.ka=ze,u.j.info("VER="+u.ka));const $t=Z[4];$t!=null&&(u.za=$t,u.j.info("SVER="+u.za));const pt=Z[5];pt!=null&&typeof pt=="number"&&pt>0&&(h=1.5*pt,u.O=h,u.j.info("backChannelRequestTimeoutMs_="+h)),h=u;const ht=n.g;if(ht){const uo=ht.g?ht.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(uo){var T=h.h;T.g||uo.indexOf("spdy")==-1&&uo.indexOf("quic")==-1&&uo.indexOf("h2")==-1||(T.j=T.l,T.g=new Set,T.h&&(Hn(T,T.h),T.h=null))}if(h.G){const Zn=ht.g?ht.g.getResponseHeader("X-HTTP-Session-Id"):null;Zn&&(h.wa=Zn,ee(h.J,h.G,Zn))}}u.I=3,u.l&&u.l.ra(),u.aa&&(u.T=Date.now()-n.F,u.j.info("Handshake RTT: "+u.T+"ms")),h=u;var M=n;if(h.na=Lc(h,h.L?h.ba:null,h.W),M.L){mc(h.h,M);var $=M,ce=h.O;ce&&($.H=ce),$.D&&(jn($),ao($)),h.g=M}else Dc(h);u.i.length>0&&so(u)}else Z[0]!="stop"&&Z[0]!="close"||jt(u,7);else u.I==3&&(Z[0]=="stop"||Z[0]=="close"?Z[0]=="stop"?jt(u,7):Jn(u):Z[0]!="noop"&&u.l&&u.l.qa(Z),u.A=0)}}Ja(4)}catch{}}var Fp=class{constructor(n,c){this.g=n,this.map=c}};function lc(n){this.l=n||10,s.PerformanceNavigationTiming?(n=s.performance.getEntriesByType("navigation"),n=n.length>0&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=n?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function uc(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function dc(n){return n.h?1:n.g?n.g.size:0}function Gn(n,c){return n.h?n.h==c:n.g?n.g.has(c):!1}function Hn(n,c){n.g?n.g.add(c):n.h=c}function mc(n,c){n.h&&n.h==c?n.h=null:n.g&&n.g.has(c)&&n.g.delete(c)}lc.prototype.cancel=function(){if(this.i=pc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function pc(n){if(n.h!=null)return n.i.concat(n.h.G);if(n.g!=null&&n.g.size!==0){let c=n.i;for(const u of n.g.values())c=c.concat(u.G);return c}return C(n.i)}var hc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vp(n,c){if(n){n=n.split("&");for(let u=0;u<n.length;u++){const h=n[u].indexOf("=");let P,T=null;h>=0?(P=n[u].substring(0,h),T=n[u].substring(h+1)):P=n[u],c(P,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function ut(n){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;n instanceof ut?(this.l=n.l,tr(this,n.j),this.o=n.o,this.g=n.g,ar(this,n.u),this.h=n.h,Wn(this,_c(n.i)),this.m=n.m):n&&(c=String(n).match(hc))?(this.l=!1,tr(this,c[1]||"",!0),this.o=rr(c[2]||""),this.g=rr(c[3]||"",!0),ar(this,c[4]),this.h=rr(c[5]||"",!0),Wn(this,c[6]||"",!0),this.m=rr(c[7]||"")):(this.l=!1,this.i=new nr(null,this.l))}ut.prototype.toString=function(){const n=[];var c=this.j;c&&n.push(or(c,gc,!0),":");var u=this.g;return(u||c=="file")&&(n.push("//"),(c=this.o)&&n.push(or(c,gc,!0),"@"),n.push(Za(u).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.u,u!=null&&n.push(":",String(u))),(u=this.h)&&(this.g&&u.charAt(0)!="/"&&n.push("/"),n.push(or(u,u.charAt(0)=="/"?Np:Lp,!0))),(u=this.i.toString())&&n.push("?",u),(u=this.m)&&n.push("#",or(u,Bp)),n.join("")},ut.prototype.resolve=function(n){const c=Be(this);let u=!!n.j;u?tr(c,n.j):u=!!n.o,u?c.o=n.o:u=!!n.g,u?c.g=n.g:u=n.u!=null;var h=n.h;if(u)ar(c,n.u);else if(u=!!n.h){if(h.charAt(0)!="/")if(this.g&&!this.h)h="/"+h;else{var P=c.h.lastIndexOf("/");P!=-1&&(h=c.h.slice(0,P+1)+h)}if(P=h,P==".."||P==".")h="";else if(P.indexOf("./")!=-1||P.indexOf("/.")!=-1){h=P.lastIndexOf("/",0)==0,P=P.split("/");const T=[];for(let M=0;M<P.length;){const $=P[M++];$=="."?h&&M==P.length&&T.push(""):$==".."?((T.length>1||T.length==1&&T[0]!="")&&T.pop(),h&&M==P.length&&T.push("")):(T.push($),h=!0)}h=T.join("/")}else h=P}return u?c.h=h:u=n.i.toString()!=="",u?Wn(c,_c(n.i)):u=!!n.m,u&&(c.m=n.m),c};function Be(n){return new ut(n)}function tr(n,c,u){n.j=u?rr(c,!0):c,n.j&&(n.j=n.j.replace(/:$/,""))}function ar(n,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);n.u=c}else n.u=null}function Wn(n,c,u){c instanceof nr?(n.i=c,zp(n.i,n.l)):(u||(c=or(c,Op)),n.i=new nr(c,n.l))}function ee(n,c,u){n.i.set(c,u)}function ro(n){return ee(n,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),n}function rr(n,c){return n?c?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function or(n,c,u){return typeof n=="string"?(n=encodeURI(n).replace(c,xp),u&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function xp(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var gc=/[#\/\?@]/g,Lp=/[#\?:]/g,Np=/[#\?]/g,Op=/[#\?@]/g,Bp=/#/g;function nr(n,c){this.h=this.g=null,this.i=n||null,this.j=!!c}function Ut(n){n.g||(n.g=new Map,n.h=0,n.i&&Vp(n.i,function(c,u){n.add(decodeURIComponent(c.replace(/\+/g," ")),u)}))}a=nr.prototype,a.add=function(n,c){Ut(this),this.i=null,n=la(this,n);let u=this.g.get(n);return u||this.g.set(n,u=[]),u.push(c),this.h+=1,this};function fc(n,c){Ut(n),c=la(n,c),n.g.has(c)&&(n.i=null,n.h-=n.g.get(c).length,n.g.delete(c))}function yc(n,c){return Ut(n),c=la(n,c),n.g.has(c)}a.forEach=function(n,c){Ut(this),this.g.forEach(function(u,h){u.forEach(function(P){n.call(c,P,h,this)},this)},this)};function vc(n,c){Ut(n);let u=[];if(typeof c=="string")yc(n,c)&&(u=u.concat(n.g.get(la(n,c))));else for(n=Array.from(n.g.values()),c=0;c<n.length;c++)u=u.concat(n[c]);return u}a.set=function(n,c){return Ut(this),this.i=null,n=la(this,n),yc(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[c]),this.h+=1,this},a.get=function(n,c){return n?(n=vc(this,n),n.length>0?String(n[0]):c):c};function Ec(n,c,u){fc(n,c),u.length>0&&(n.i=null,n.g.set(la(n,c),C(u)),n.h+=u.length)}a.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],c=Array.from(this.g.keys());for(let h=0;h<c.length;h++){var u=c[h];const P=Za(u);u=vc(this,u);for(let T=0;T<u.length;T++){let M=P;u[T]!==""&&(M+="="+Za(u[T])),n.push(M)}}return this.i=n.join("&")};function _c(n){const c=new nr;return c.i=n.i,n.g&&(c.g=new Map(n.g),c.h=n.h),c}function la(n,c){return c=String(c),n.j&&(c=c.toLowerCase()),c}function zp(n,c){c&&!n.j&&(Ut(n),n.i=null,n.g.forEach(function(u,h){const P=h.toLowerCase();h!=P&&(fc(this,h),Ec(this,P,u))},n)),n.j=c}function qp(n,c){const u=new Ya;if(s.Image){const h=new Image;h.onload=p(dt,u,"TestLoadImage: loaded",!0,c,h),h.onerror=p(dt,u,"TestLoadImage: error",!1,c,h),h.onabort=p(dt,u,"TestLoadImage: abort",!1,c,h),h.ontimeout=p(dt,u,"TestLoadImage: timeout",!1,c,h),s.setTimeout(function(){h.ontimeout&&h.ontimeout()},1e4),h.src=n}else c(!1)}function Up(n,c){const u=new Ya,h=new AbortController,P=setTimeout(()=>{h.abort(),dt(u,"TestPingServer: timeout",!1,c)},1e4);fetch(n,{signal:h.signal}).then(T=>{clearTimeout(P),T.ok?dt(u,"TestPingServer: ok",!0,c):dt(u,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(P),dt(u,"TestPingServer: error",!1,c)})}function dt(n,c,u,h,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),h(u)}catch{}}function jp(){this.g=new Tp}function Kn(n){this.i=n.Sb||null,this.h=n.ab||!1}g(Kn,Js),Kn.prototype.g=function(){return new oo(this.i,this.h)};function oo(n,c){be.call(this),this.H=n,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(oo,be),a=oo.prototype,a.open=function(n,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=n,this.D=c,this.readyState=1,sr(this)},a.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};n&&(c.body=n),(this.H||s).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},a.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ir(this)),this.readyState=0},a.Pa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,sr(this)),this.g&&(this.readyState=3,sr(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;bc(this)}else n.text().then(this.Oa.bind(this),this.ga.bind(this))};function bc(n){n.j.read().then(n.Ma.bind(n)).catch(n.ga.bind(n))}a.Ma=function(n){if(this.g){if(this.o&&n.value)this.response.push(n.value);else if(!this.o){var c=n.value?n.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!n.done}))&&(this.response=this.responseText+=c)}n.done?ir(this):sr(this),this.readyState==3&&bc(this)}},a.Oa=function(n){this.g&&(this.response=this.responseText=n,ir(this))},a.Na=function(n){this.g&&(this.response=n,ir(this))},a.ga=function(){this.g&&ir(this)};function ir(n){n.readyState=4,n.l=null,n.j=null,n.B=null,sr(n)}a.setRequestHeader=function(n,c){this.A.append(n,c)},a.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},a.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],c=this.h.entries();for(var u=c.next();!u.done;)u=u.value,n.push(u[0]+": "+u[1]),u=c.next();return n.join(`\r
`)};function sr(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(oo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});function Ac(n){let c="";return ia(n,function(u,h){c+=h,c+=":",c+=u,c+=`\r
`}),c}function Qn(n,c,u){e:{for(h in u){var h=!1;break e}h=!0}h||(u=Ac(u),typeof n=="string"?u!=null&&Za(u):ee(n,c,u))}function oe(n){be.call(this),this.headers=new Map,this.L=n||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(oe,be);var $p=/^https?$/i,Gp=["POST","PUT"];a=oe.prototype,a.Fa=function(n){this.H=n},a.ea=function(n,c,u,h){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+n);c=c?c.toUpperCase():"GET",this.D=n,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():rc.g(),this.g.onreadystatechange=E(m(this.Ca,this));try{this.B=!0,this.g.open(c,String(n),!0),this.B=!1}catch(T){wc(this,T);return}if(n=u||"",u=new Map(this.headers),h)if(Object.getPrototypeOf(h)===Object.prototype)for(var P in h)u.set(P,h[P]);else if(typeof h.keys=="function"&&typeof h.get=="function")for(const T of h.keys())u.set(T,h.get(T));else throw Error("Unknown input type for opt_headers: "+String(h));h=Array.from(u.keys()).find(T=>T.toLowerCase()=="content-type"),P=s.FormData&&n instanceof s.FormData,!(Array.prototype.indexOf.call(Gp,c,void 0)>=0)||h||P||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[T,M]of u)this.g.setRequestHeader(T,M);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(n),this.v=!1}catch(T){wc(this,T)}};function wc(n,c){n.h=!1,n.g&&(n.j=!0,n.g.abort(),n.j=!1),n.l=c,n.o=5,Pc(n),no(n)}function Pc(n){n.A||(n.A=!0,Ie(n,"complete"),Ie(n,"error"))}a.abort=function(n){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=n||7,Ie(this,"complete"),Ie(this,"abort"),no(this))},a.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),no(this,!0)),oe.Z.N.call(this)},a.Ca=function(){this.u||(this.B||this.v||this.j?Tc(this):this.Xa())},a.Xa=function(){Tc(this)};function Tc(n){if(n.h&&typeof i<"u"){if(n.v&&mt(n)==4)setTimeout(n.Ca.bind(n),0);else if(Ie(n,"readystatechange"),mt(n)==4){n.h=!1;try{const T=n.ca();e:switch(T){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var u;if(!(u=c)){var h;if(h=T===0){let M=String(n.D).match(hc)[1]||null;!M&&s.self&&s.self.location&&(M=s.self.location.protocol.slice(0,-1)),h=!$p.test(M?M.toLowerCase():"")}u=h}if(u)Ie(n,"complete"),Ie(n,"success");else{n.o=6;try{var P=mt(n)>2?n.g.statusText:""}catch{P=""}n.l=P+" ["+n.ca()+"]",Pc(n)}}finally{no(n)}}}}function no(n,c){if(n.g){n.m&&(clearTimeout(n.m),n.m=null);const u=n.g;n.g=null,c||Ie(n,"ready");try{u.onreadystatechange=null}catch{}}}a.isActive=function(){return!!this.g};function mt(n){return n.g?n.g.readyState:0}a.ca=function(){try{return mt(this)>2?this.g.status:-1}catch{return-1}},a.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},a.La=function(n){if(this.g){var c=this.g.responseText;return n&&c.indexOf(n)==0&&(c=c.substring(n.length)),Pp(c)}};function Ic(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.F){case"":case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Hp(n){const c={};n=(n.g&&mt(n)>=2&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let h=0;h<n.length;h++){if(y(n[h]))continue;var u=Rp(n[h]);const P=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();const T=c[P]||[];c[P]=T,T.push(u)}Fn(c,function(h){return h.join(", ")})}a.ya=function(){return this.o},a.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function cr(n,c,u){return u&&u.internalChannelParams&&u.internalChannelParams[n]||c}function kc(n){this.za=0,this.i=[],this.j=new Ya,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=cr("failFast",!1,n),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=cr("baseRetryDelayMs",5e3,n),this.Za=cr("retryDelaySeedMs",1e4,n),this.Ta=cr("forwardChannelMaxRetries",2,n),this.va=cr("forwardChannelRequestTimeoutMs",2e4,n),this.ma=n&&n.xmlHttpFactory||void 0,this.Ua=n&&n.Rb||void 0,this.Aa=n&&n.useFetchStreams||!1,this.O=void 0,this.L=n&&n.supportsCrossDomainXhr||!1,this.M="",this.h=new lc(n&&n.concurrentRequestLimit),this.Ba=new jp,this.S=n&&n.fastHandshake||!1,this.R=n&&n.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=n&&n.Pb||!1,n&&n.ua&&this.j.ua(),n&&n.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&n&&n.detectBufferingProxy||!1,this.ia=void 0,n&&n.longPollingTimeout&&n.longPollingTimeout>0&&(this.ia=n.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}a=kc.prototype,a.ka=8,a.I=1,a.connect=function(n,c,u,h){ke(0),this.W=n,this.H=c||{},u&&h!==void 0&&(this.H.OSID=u,this.H.OAID=h),this.F=this.X,this.J=Lc(this,null,this.W),so(this)};function Jn(n){if(Cc(n),n.I==3){var c=n.V++,u=Be(n.J);if(ee(u,"SID",n.M),ee(u,"RID",c),ee(u,"TYPE","terminate"),lr(n,u),c=new lt(n,n.j,c),c.M=2,c.A=ro(Be(u)),u=!1,s.navigator&&s.navigator.sendBeacon)try{u=s.navigator.sendBeacon(c.A.toString(),"")}catch{}!u&&s.Image&&(new Image().src=c.A,u=!0),u||(c.g=Nc(c.j,null),c.g.ea(c.A)),c.F=Date.now(),ao(c)}xc(n)}function io(n){n.g&&(Yn(n),n.g.cancel(),n.g=null)}function Cc(n){io(n),n.v&&(s.clearTimeout(n.v),n.v=null),co(n),n.h.cancel(),n.m&&(typeof n.m=="number"&&s.clearTimeout(n.m),n.m=null)}function so(n){if(!uc(n.h)&&!n.m){n.m=!0;var c=n.Ea;G||f(),Q||(G(),Q=!0),b.add(c,n),n.D=0}}function Wp(n,c){return dc(n.h)>=n.h.j-(n.m?1:0)?!1:n.m?(n.i=c.G.concat(n.i),!0):n.I==1||n.I==2||n.D>=(n.Sa?0:n.Ta)?!1:(n.m=Xa(m(n.Ea,n,c),Vc(n,n.D)),n.D++,!0)}a.Ea=function(n){if(this.m)if(this.m=null,this.I==1){if(!n){this.V=Math.floor(Math.random()*1e5),n=this.V++;const P=new lt(this,this.j,n);let T=this.o;if(this.U&&(T?(T=Vn(T),Kr(T,this.U)):T=this.U),this.u!==null||this.R||(P.J=T,T=null),this.S)e:{for(var c=0,u=0;u<this.i.length;u++){t:{var h=this.i[u];if("__data__"in h.map&&(h=h.map.__data__,typeof h=="string")){h=h.length;break t}h=void 0}if(h===void 0)break;if(c+=h,c>4096){c=u;break e}if(c===4096||u===this.i.length-1){c=u+1;break e}}c=1e3}else c=1e3;c=Rc(this,P,c),u=Be(this.J),ee(u,"RID",n),ee(u,"CVER",22),this.G&&ee(u,"X-HTTP-Session-Id",this.G),lr(this,u),T&&(this.R?c="headers="+Za(Ac(T))+"&"+c:this.u&&Qn(u,this.u,T)),Hn(this.h,P),this.Ra&&ee(u,"TYPE","init"),this.S?(ee(u,"$req",c),ee(u,"SID","null"),P.U=!0,Un(P,u,null)):Un(P,u,c),this.I=2}}else this.I==3&&(n?Sc(this,n):this.i.length==0||uc(this.h)||Sc(this))};function Sc(n,c){var u;c?u=c.l:u=n.V++;const h=Be(n.J);ee(h,"SID",n.M),ee(h,"RID",u),ee(h,"AID",n.K),lr(n,h),n.u&&n.o&&Qn(h,n.u,n.o),u=new lt(n,n.j,u,n.D+1),n.u===null&&(u.J=n.o),c&&(n.i=c.G.concat(n.i)),c=Rc(n,u,1e3),u.H=Math.round(n.va*.5)+Math.round(n.va*.5*Math.random()),Hn(n.h,u),Un(u,h,c)}function lr(n,c){n.H&&ia(n.H,function(u,h){ee(c,h,u)}),n.l&&ia({},function(u,h){ee(c,h,u)})}function Rc(n,c,u){u=Math.min(n.i.length,u);const h=n.l?m(n.l.Ka,n.l,n):null;e:{var P=n.i;let $=-1;for(;;){const ce=["count="+u];$==-1?u>0?($=P[0].g,ce.push("ofs="+$)):$=0:ce.push("ofs="+$);let Z=!0;for(let de=0;de<u;de++){var T=P[de].g;const ze=P[de].map;if(T-=$,T<0)$=Math.max(0,P[de].g-100),Z=!1;else try{T="req"+T+"_"||"";try{var M=ze instanceof Map?ze:Object.entries(ze);for(const[$t,pt]of M){let ht=pt;l(pt)&&(ht=Nn(pt)),ce.push(T+$t+"="+encodeURIComponent(ht))}}catch($t){throw ce.push(T+"type="+encodeURIComponent("_badmap")),$t}}catch{h&&h(ze)}}if(Z){M=ce.join("&");break e}}M=void 0}return n=n.i.splice(0,u),c.G=n,M}function Dc(n){if(!n.g&&!n.v){n.Y=1;var c=n.Da;G||f(),Q||(G(),Q=!0),b.add(c,n),n.A=0}}function Xn(n){return n.g||n.v||n.A>=3?!1:(n.Y++,n.v=Xa(m(n.Da,n),Vc(n,n.A)),n.A++,!0)}a.Da=function(){if(this.v=null,Mc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var n=4*this.T;this.j.info("BP detection timer enabled: "+n),this.B=Xa(m(this.Wa,this),n)}},a.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ke(10),io(this),Mc(this))};function Yn(n){n.B!=null&&(s.clearTimeout(n.B),n.B=null)}function Mc(n){n.g=new lt(n,n.j,"rpc",n.Y),n.u===null&&(n.g.J=n.o),n.g.P=0;var c=Be(n.na);ee(c,"RID","rpc"),ee(c,"SID",n.M),ee(c,"AID",n.K),ee(c,"CI",n.F?"0":"1"),!n.F&&n.ia&&ee(c,"TO",n.ia),ee(c,"TYPE","xmlhttp"),lr(n,c),n.u&&n.o&&Qn(c,n.u,n.o),n.O&&(n.g.H=n.O);var u=n.g;n=n.ba,u.M=1,u.A=ro(Be(c)),u.u=null,u.R=!0,ic(u,n)}a.Va=function(){this.C!=null&&(this.C=null,io(this),Xn(this),ke(19))};function co(n){n.C!=null&&(s.clearTimeout(n.C),n.C=null)}function Fc(n,c){var u=null;if(n.g==c){co(n),Yn(n),n.g=null;var h=2}else if(Gn(n.h,c))u=c.G,mc(n.h,c),h=1;else return;if(n.I!=0){if(c.o)if(h==1){u=c.u?c.u.length:0,c=Date.now()-c.F;var P=n.D;h=eo(),Ie(h,new tc(h,u)),so(n)}else Dc(n);else if(P=c.m,P==3||P==0&&c.X>0||!(h==1&&Wp(n,c)||h==2&&Xn(n)))switch(u&&u.length>0&&(c=n.h,c.i=c.i.concat(u)),P){case 1:jt(n,5);break;case 4:jt(n,10);break;case 3:jt(n,6);break;default:jt(n,2)}}}function Vc(n,c){let u=n.Qa+Math.floor(Math.random()*n.Za);return n.isActive()||(u*=2),u*c}function jt(n,c){if(n.j.info("Error code "+c),c==2){var u=m(n.bb,n),h=n.Ua;const P=!h;h=new ut(h||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||tr(h,"https"),ro(h),P?qp(h.toString(),u):Up(h.toString(),u)}else ke(2);n.I=0,n.l&&n.l.pa(c),xc(n),Cc(n)}a.bb=function(n){n?(this.j.info("Successfully pinged google.com"),ke(2)):(this.j.info("Failed to ping google.com"),ke(1))};function xc(n){if(n.I=0,n.ja=[],n.l){const c=pc(n.h);(c.length!=0||n.i.length!=0)&&(I(n.ja,c),I(n.ja,n.i),n.h.i.length=0,C(n.i),n.i.length=0),n.l.oa()}}function Lc(n,c,u){var h=u instanceof ut?Be(u):new ut(u);if(h.g!="")c&&(h.g=c+"."+h.g),ar(h,h.u);else{var P=s.location;h=P.protocol,c=c?c+"."+P.hostname:P.hostname,P=+P.port;const T=new ut(null);h&&tr(T,h),c&&(T.g=c),P&&ar(T,P),u&&(T.h=u),h=T}return u=n.G,c=n.wa,u&&c&&ee(h,u,c),ee(h,"VER",n.ka),lr(n,h),h}function Nc(n,c,u){if(c&&!n.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=n.Aa&&!n.ma?new oe(new Kn({ab:u})):new oe(n.ma),c.Fa(n.L),c}a.isActive=function(){return!!this.l&&this.l.isActive(this)};function Oc(){}a=Oc.prototype,a.ra=function(){},a.qa=function(){},a.pa=function(){},a.oa=function(){},a.isActive=function(){return!0},a.Ka=function(){};function lo(){}lo.prototype.g=function(n,c){return new Re(n,c)};function Re(n,c){be.call(this),this.g=new kc(c),this.l=n,this.h=c&&c.messageUrlParams||null,n=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.o=n,n=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(n?n["X-WebChannel-Content-Type"]=c.messageContentType:n={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(n?n["X-WebChannel-Client-Profile"]=c.sa:n={"X-WebChannel-Client-Profile":c.sa}),this.g.U=n,(n=c&&c.Qb)&&!y(n)&&(this.g.u=n),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!y(c)&&(this.g.G=c,n=this.h,n!==null&&c in n&&(n=this.h,c in n&&delete n[c])),this.j=new ua(this)}g(Re,be),Re.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Re.prototype.close=function(){Jn(this.g)},Re.prototype.o=function(n){var c=this.g;if(typeof n=="string"){var u={};u.__data__=n,n=u}else this.v&&(u={},u.__data__=Nn(n),n=u);c.i.push(new Fp(c.Ya++,n)),c.I==3&&so(c)},Re.prototype.N=function(){this.g.l=null,delete this.j,Jn(this.g),delete this.g,Re.Z.N.call(this)};function Bc(n){On.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var c=n.__sm__;if(c){e:{for(const u in c){n=u;break e}n=void 0}(this.i=n)&&(n=this.i,c=c!==null&&n in c?c[n]:void 0),this.data=c}else this.data=n}g(Bc,On);function zc(){Bn.call(this),this.status=1}g(zc,Bn);function ua(n){this.g=n}g(ua,Oc),ua.prototype.ra=function(){Ie(this.g,"a")},ua.prototype.qa=function(n){Ie(this.g,new Bc(n))},ua.prototype.pa=function(n){Ie(this.g,new zc)},ua.prototype.oa=function(){Ie(this.g,"b")},lo.prototype.createWebChannel=lo.prototype.g,Re.prototype.send=Re.prototype.o,Re.prototype.open=Re.prototype.m,Re.prototype.close=Re.prototype.close,Md=function(){return new lo},Dd=function(){return eo()},Rd=zt,Pi={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},to.NO_ERROR=0,to.TIMEOUT=8,to.HTTP_ERROR=6,wo=to,ac.COMPLETE="complete",Sd=ac,Xs.EventType=Qa,Qa.OPEN="a",Qa.CLOSE="b",Qa.ERROR="c",Qa.MESSAGE="d",be.prototype.listen=be.prototype.J,ur=Xs,oe.prototype.listenOnce=oe.prototype.K,oe.prototype.getLastError=oe.prototype.Ha,oe.prototype.getLastErrorCode=oe.prototype.ya,oe.prototype.getStatus=oe.prototype.ca,oe.prototype.getResponseJson=oe.prototype.La,oe.prototype.getResponseText=oe.prototype.la,oe.prototype.send=oe.prototype.ea,oe.prototype.setWithCredentials=oe.prototype.Fa,Cd=oe}).apply(typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{});const vl="@firebase/firestore",El="4.9.3";class we{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}we.UNAUTHENTICATED=new we(null),we.GOOGLE_CREDENTIALS=new we("google-credentials-uid"),we.FIRST_PARTY=new we("first-party-uid"),we.MOCK_USER=new we("mock-user");let Oa="12.7.0";const ea=new $i("@firebase/firestore");function ma(){return ea.logLevel}function V(a,...e){if(ea.logLevel<=H.DEBUG){const t=e.map(rs);ea.debug(`Firestore (${Oa}): ${a}`,...t)}}function ot(a,...e){if(ea.logLevel<=H.ERROR){const t=e.map(rs);ea.error(`Firestore (${Oa}): ${a}`,...t)}}function Ta(a,...e){if(ea.logLevel<=H.WARN){const t=e.map(rs);ea.warn(`Firestore (${Oa}): ${a}`,...t)}}function rs(a){if(typeof a=="string")return a;try{return(function(t){return JSON.stringify(t)})(a)}catch{return a}}function O(a,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Fd(a,r,t)}function Fd(a,e,t){let r=`FIRESTORE (${Oa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${a.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ot(r),new Error(r)}function X(a,e,t,r){let o="Unexpected state";typeof t=="string"?o=t:r=t,a||Fd(e,o,r)}function U(a,e){return a}const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends it{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class It{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Vd{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class av{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(we.UNAUTHENTICATED)))}shutdown(){}}class rv{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class ov{constructor(e){this.t=e,this.currentUser=we.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){X(this.o===void 0,42304);let r=this.i;const o=d=>this.i!==r?(r=this.i,t(d)):Promise.resolve();let i=new It;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new It,e.enqueueRetryable((()=>o(this.currentUser)))};const s=()=>{const d=i;e.enqueueRetryable((async()=>{await d.promise,await o(this.currentUser)}))},l=d=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((d=>l(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?l(d):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new It)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(X(typeof r.accessToken=="string",31837,{l:r}),new Vd(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return X(e===null||typeof e=="string",2055,{h:e}),new we(e)}}class nv{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=we.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class iv{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new nv(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(we.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class _l{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sv{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Fe(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){X(this.o===void 0,3512);const r=i=>{i.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const s=i.token!==this.m;return this.m=i.token,V("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const o=i=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>o(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?o(i):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new _l(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(X(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new _l(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function cv(a){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(a);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<a;r++)t[r]=Math.floor(256*Math.random());return t}class os{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=cv(40);for(let i=0;i<o.length;++i)r.length<20&&o[i]<t&&(r+=e.charAt(o[i]%62))}return r}}function W(a,e){return a<e?-1:a>e?1:0}function Ti(a,e){const t=Math.min(a.length,e.length);for(let r=0;r<t;r++){const o=a.charAt(r),i=e.charAt(r);if(o!==i)return si(o)===si(i)?W(o,i):si(o)?1:-1}return W(a.length,e.length)}const lv=55296,uv=57343;function si(a){const e=a.charCodeAt(0);return e>=lv&&e<=uv}function Ia(a,e,t){return a.length===e.length&&a.every(((r,o)=>t(r,e[o])))}const bl="__name__";class qe{constructor(e,t,r){t===void 0?t=0:t>e.length&&O(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&O(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return qe.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qe?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let o=0;o<r;o++){const i=qe.compareSegments(e.get(o),t.get(o));if(i!==0)return i}return W(e.length,t.length)}static compareSegments(e,t){const r=qe.isNumericId(e),o=qe.isNumericId(t);return r&&!o?-1:!r&&o?1:r&&o?qe.extractNumericId(e).compare(qe.extractNumericId(t)):Ti(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Tt.fromString(e.substring(4,e.length-2))}}class te extends qe{construct(e,t,r){return new te(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new L(D.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((o=>o.length>0)))}return new te(t)}static emptyPath(){return new te([])}}const dv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ye extends qe{construct(e,t,r){return new ye(e,t,r)}static isValidIdentifier(e){return dv.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ye.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bl}static keyField(){return new ye([bl])}static fromServerFormat(e){const t=[];let r="",o=0;const i=()=>{if(r.length===0)throw new L(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let s=!1;for(;o<e.length;){const l=e[o];if(l==="\\"){if(o+1===e.length)throw new L(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[o+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new L(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,o+=2}else l==="`"?(s=!s,o++):l!=="."||s?(r+=l,o++):(i(),o++)}if(i(),s)throw new L(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ye(t)}static emptyPath(){return new ye([])}}class N{constructor(e){this.path=e}static fromPath(e){return new N(te.fromString(e))}static fromName(e){return new N(te.fromString(e).popFirst(5))}static empty(){return new N(te.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&te.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return te.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new N(new te(e.slice()))}}function xd(a,e,t){if(!t)throw new L(D.INVALID_ARGUMENT,`Function ${a}() cannot be called with an empty ${e}.`)}function mv(a,e,t,r){if(e===!0&&r===!0)throw new L(D.INVALID_ARGUMENT,`${a} and ${t} cannot be used together.`)}function Al(a){if(!N.isDocumentKey(a))throw new L(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${a} has ${a.length}.`)}function wl(a){if(N.isDocumentKey(a))throw new L(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${a} has ${a.length}.`)}function Ld(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}function ns(a){if(a===void 0)return"undefined";if(a===null)return"null";if(typeof a=="string")return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if(typeof a=="number"||typeof a=="boolean")return""+a;if(typeof a=="object"){if(a instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(a);return e?`a custom ${e} object`:"an object"}}return typeof a=="function"?"a function":O(12329,{type:typeof a})}function ta(a,e){if("_delegate"in a&&(a=a._delegate),!(a instanceof e)){if(e.name===a.constructor.name)throw new L(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ns(a);throw new L(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return a}function se(a,e){const t={typeString:a};return e&&(t.value=e),t}function Br(a,e){if(!Ld(a))throw new L(D.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const o=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in a)){t=`JSON missing required field: '${r}'`;break}const s=a[r];if(o&&typeof s!==o){t=`JSON field '${r}' must be a ${o}.`;break}if(i!==void 0&&s!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new L(D.INVALID_ARGUMENT,t);return!0}const Pl=-62135596800,Tl=1e6;class ae{static now(){return ae.fromMillis(Date.now())}static fromDate(e){return ae.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Tl);return new ae(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Pl)throw new L(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Tl}_compareTo(e){return this.seconds===e.seconds?W(this.nanoseconds,e.nanoseconds):W(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ae._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Br(e,ae._jsonSchema))return new ae(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Pl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ae._jsonSchemaVersion="firestore/timestamp/1.0",ae._jsonSchema={type:se("string",ae._jsonSchemaVersion),seconds:se("number"),nanoseconds:se("number")};class q{static fromTimestamp(e){return new q(e)}static min(){return new q(new ae(0,0))}static max(){return new q(new ae(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const wr=-1;function pv(a,e){const t=a.toTimestamp().seconds,r=a.toTimestamp().nanoseconds+1,o=q.fromTimestamp(r===1e9?new ae(t+1,0):new ae(t,r));return new Ct(o,N.empty(),e)}function hv(a){return new Ct(a.readTime,a.key,wr)}class Ct{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ct(q.min(),N.empty(),wr)}static max(){return new Ct(q.max(),N.empty(),wr)}}function gv(a,e){let t=a.readTime.compareTo(e.readTime);return t!==0?t:(t=N.comparator(a.documentKey,e.documentKey),t!==0?t:W(a.largestBatchId,e.largestBatchId))}const fv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ba(a){if(a.code!==D.FAILED_PRECONDITION||a.message!==fv)throw a;V("LocalStore","Unexpectedly lost primary lease")}class S{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&O(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new S(((r,o)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,o)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof S?t:S.resolve(t)}catch(t){return S.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):S.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):S.reject(t)}static resolve(e){return new S(((t,r)=>{t(e)}))}static reject(e){return new S(((t,r)=>{r(e)}))}static waitFor(e){return new S(((t,r)=>{let o=0,i=0,s=!1;e.forEach((l=>{++o,l.next((()=>{++i,s&&i===o&&t()}),(d=>r(d)))})),s=!0,i===o&&t()}))}static or(e){let t=S.resolve(!1);for(const r of e)t=t.next((o=>o?S.resolve(o):r()));return t}static forEach(e,t){const r=[];return e.forEach(((o,i)=>{r.push(t.call(this,o,i))})),this.waitFor(r)}static mapArray(e,t){return new S(((r,o)=>{const i=e.length,s=new Array(i);let l=0;for(let d=0;d<i;d++){const m=d;t(e[m]).next((p=>{s[m]=p,++l,l===i&&r(s)}),(p=>o(p)))}}))}static doWhile(e,t){return new S(((r,o)=>{const i=()=>{e()===!0?t().next((()=>{i()}),o):r()};i()}))}}function vv(a){const e=a.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function za(a){return a.name==="IndexedDbTransactionError"}class dn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}dn.ce=-1;const is=-1;function mn(a){return a==null}function qo(a){return a===0&&1/a==-1/0}function Ev(a){return typeof a=="number"&&Number.isInteger(a)&&!qo(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER}const Nd="";function _v(a){let e="";for(let t=0;t<a.length;t++)e.length>0&&(e=Il(e)),e=bv(a.get(t),e);return Il(e)}function bv(a,e){let t=e;const r=a.length;for(let o=0;o<r;o++){const i=a.charAt(o);switch(i){case"\0":t+="";break;case Nd:t+="";break;default:t+=i}}return t}function Il(a){return a+Nd+""}function kl(a){let e=0;for(const t in a)Object.prototype.hasOwnProperty.call(a,t)&&e++;return e}function xt(a,e){for(const t in a)Object.prototype.hasOwnProperty.call(a,t)&&e(t,a[t])}function Od(a){for(const e in a)if(Object.prototype.hasOwnProperty.call(a,e))return!1;return!0}class re{constructor(e,t){this.comparator=e,this.root=t||fe.EMPTY}insert(e,t){return new re(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,fe.BLACK,null,null))}remove(e){return new re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fe.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(o===0)return t+r.left.size;o<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ho(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ho(this.root,e,this.comparator,!1)}getReverseIterator(){return new ho(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ho(this.root,e,this.comparator,!0)}}class ho{constructor(e,t,r,o){this.isReverse=o,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&o&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fe{constructor(e,t,r,o,i){this.key=e,this.value=t,this.color=r??fe.RED,this.left=o??fe.EMPTY,this.right=i??fe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,o,i){return new fe(e??this.key,t??this.value,r??this.color,o??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let o=this;const i=r(e,o.key);return o=i<0?o.copy(null,null,null,o.left.insert(e,t,r),null):i===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return fe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return fe.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw O(43730,{key:this.key,value:this.value});if(this.right.isRed())throw O(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw O(27949);return e+(this.isRed()?0:1)}}fe.EMPTY=null,fe.RED=!0,fe.BLACK=!1;fe.EMPTY=new class{constructor(){this.size=0}get key(){throw O(57766)}get value(){throw O(16141)}get color(){throw O(16727)}get left(){throw O(29726)}get right(){throw O(36894)}copy(e,t,r,o,i){return this}insert(e,t,r){return new fe(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ue{constructor(e){this.comparator=e,this.data=new re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Cl(this.data.getIterator())}getIteratorFrom(e){return new Cl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof ue)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,i=r.getNext().key;if(this.comparator(o,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ue(this.comparator);return t.data=e,t}}class Cl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class De{constructor(e){this.fields=e,e.sort(ye.comparator)}static empty(){return new De([])}unionWith(e){let t=new ue(ye.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new De(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ia(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class Bd extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class _e{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Bd("Invalid base64 string: "+i):i}})(e);return new _e(t)}static fromUint8Array(e){const t=(function(o){let i="";for(let s=0;s<o.length;++s)i+=String.fromCharCode(o[s]);return i})(e);return new _e(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return W(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_e.EMPTY_BYTE_STRING=new _e("");const Av=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function St(a){if(X(!!a,39018),typeof a=="string"){let e=0;const t=Av.exec(a);if(X(!!t,46558,{timestamp:a}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(a);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ne(a.seconds),nanos:ne(a.nanos)}}function ne(a){return typeof a=="number"?a:typeof a=="string"?Number(a):0}function Rt(a){return typeof a=="string"?_e.fromBase64String(a):_e.fromUint8Array(a)}const zd="server_timestamp",qd="__type__",Ud="__previous_value__",jd="__local_write_time__";function ss(a){return(a?.mapValue?.fields||{})[qd]?.stringValue===zd}function pn(a){const e=a.mapValue.fields[Ud];return ss(e)?pn(e):e}function Pr(a){const e=St(a.mapValue.fields[jd].timestampValue);return new ae(e.seconds,e.nanos)}class wv{constructor(e,t,r,o,i,s,l,d,m,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=o,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=l,this.longPollingOptions=d,this.useFetchStreams=m,this.isUsingEmulator=p}}const Uo="(default)";class Tr{constructor(e,t){this.projectId=e,this.database=t||Uo}static empty(){return new Tr("","")}get isDefaultDatabase(){return this.database===Uo}isEqual(e){return e instanceof Tr&&e.projectId===this.projectId&&e.database===this.database}}const $d="__type__",Pv="__max__",go={mapValue:{}},Gd="__vector__",jo="value";function Dt(a){return"nullValue"in a?0:"booleanValue"in a?1:"integerValue"in a||"doubleValue"in a?2:"timestampValue"in a?3:"stringValue"in a?5:"bytesValue"in a?6:"referenceValue"in a?7:"geoPointValue"in a?8:"arrayValue"in a?9:"mapValue"in a?ss(a)?4:Iv(a)?9007199254740991:Tv(a)?10:11:O(28295,{value:a})}function Ke(a,e){if(a===e)return!0;const t=Dt(a);if(t!==Dt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return a.booleanValue===e.booleanValue;case 4:return Pr(a).isEqual(Pr(e));case 3:return(function(o,i){if(typeof o.timestampValue=="string"&&typeof i.timestampValue=="string"&&o.timestampValue.length===i.timestampValue.length)return o.timestampValue===i.timestampValue;const s=St(o.timestampValue),l=St(i.timestampValue);return s.seconds===l.seconds&&s.nanos===l.nanos})(a,e);case 5:return a.stringValue===e.stringValue;case 6:return(function(o,i){return Rt(o.bytesValue).isEqual(Rt(i.bytesValue))})(a,e);case 7:return a.referenceValue===e.referenceValue;case 8:return(function(o,i){return ne(o.geoPointValue.latitude)===ne(i.geoPointValue.latitude)&&ne(o.geoPointValue.longitude)===ne(i.geoPointValue.longitude)})(a,e);case 2:return(function(o,i){if("integerValue"in o&&"integerValue"in i)return ne(o.integerValue)===ne(i.integerValue);if("doubleValue"in o&&"doubleValue"in i){const s=ne(o.doubleValue),l=ne(i.doubleValue);return s===l?qo(s)===qo(l):isNaN(s)&&isNaN(l)}return!1})(a,e);case 9:return Ia(a.arrayValue.values||[],e.arrayValue.values||[],Ke);case 10:case 11:return(function(o,i){const s=o.mapValue.fields||{},l=i.mapValue.fields||{};if(kl(s)!==kl(l))return!1;for(const d in s)if(s.hasOwnProperty(d)&&(l[d]===void 0||!Ke(s[d],l[d])))return!1;return!0})(a,e);default:return O(52216,{left:a})}}function Ir(a,e){return(a.values||[]).find((t=>Ke(t,e)))!==void 0}function ka(a,e){if(a===e)return 0;const t=Dt(a),r=Dt(e);if(t!==r)return W(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return W(a.booleanValue,e.booleanValue);case 2:return(function(i,s){const l=ne(i.integerValue||i.doubleValue),d=ne(s.integerValue||s.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1})(a,e);case 3:return Sl(a.timestampValue,e.timestampValue);case 4:return Sl(Pr(a),Pr(e));case 5:return Ti(a.stringValue,e.stringValue);case 6:return(function(i,s){const l=Rt(i),d=Rt(s);return l.compareTo(d)})(a.bytesValue,e.bytesValue);case 7:return(function(i,s){const l=i.split("/"),d=s.split("/");for(let m=0;m<l.length&&m<d.length;m++){const p=W(l[m],d[m]);if(p!==0)return p}return W(l.length,d.length)})(a.referenceValue,e.referenceValue);case 8:return(function(i,s){const l=W(ne(i.latitude),ne(s.latitude));return l!==0?l:W(ne(i.longitude),ne(s.longitude))})(a.geoPointValue,e.geoPointValue);case 9:return Rl(a.arrayValue,e.arrayValue);case 10:return(function(i,s){const l=i.fields||{},d=s.fields||{},m=l[jo]?.arrayValue,p=d[jo]?.arrayValue,g=W(m?.values?.length||0,p?.values?.length||0);return g!==0?g:Rl(m,p)})(a.mapValue,e.mapValue);case 11:return(function(i,s){if(i===go.mapValue&&s===go.mapValue)return 0;if(i===go.mapValue)return 1;if(s===go.mapValue)return-1;const l=i.fields||{},d=Object.keys(l),m=s.fields||{},p=Object.keys(m);d.sort(),p.sort();for(let g=0;g<d.length&&g<p.length;++g){const E=Ti(d[g],p[g]);if(E!==0)return E;const C=ka(l[d[g]],m[p[g]]);if(C!==0)return C}return W(d.length,p.length)})(a.mapValue,e.mapValue);default:throw O(23264,{he:t})}}function Sl(a,e){if(typeof a=="string"&&typeof e=="string"&&a.length===e.length)return W(a,e);const t=St(a),r=St(e),o=W(t.seconds,r.seconds);return o!==0?o:W(t.nanos,r.nanos)}function Rl(a,e){const t=a.values||[],r=e.values||[];for(let o=0;o<t.length&&o<r.length;++o){const i=ka(t[o],r[o]);if(i)return i}return W(t.length,r.length)}function Ca(a){return Ii(a)}function Ii(a){return"nullValue"in a?"null":"booleanValue"in a?""+a.booleanValue:"integerValue"in a?""+a.integerValue:"doubleValue"in a?""+a.doubleValue:"timestampValue"in a?(function(t){const r=St(t);return`time(${r.seconds},${r.nanos})`})(a.timestampValue):"stringValue"in a?a.stringValue:"bytesValue"in a?(function(t){return Rt(t).toBase64()})(a.bytesValue):"referenceValue"in a?(function(t){return N.fromName(t).toString()})(a.referenceValue):"geoPointValue"in a?(function(t){return`geo(${t.latitude},${t.longitude})`})(a.geoPointValue):"arrayValue"in a?(function(t){let r="[",o=!0;for(const i of t.values||[])o?o=!1:r+=",",r+=Ii(i);return r+"]"})(a.arrayValue):"mapValue"in a?(function(t){const r=Object.keys(t.fields||{}).sort();let o="{",i=!0;for(const s of r)i?i=!1:o+=",",o+=`${s}:${Ii(t.fields[s])}`;return o+"}"})(a.mapValue):O(61005,{value:a})}function Po(a){switch(Dt(a)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=pn(a);return e?16+Po(e):16;case 5:return 2*a.stringValue.length;case 6:return Rt(a.bytesValue).approximateByteSize();case 7:return a.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((o,i)=>o+Po(i)),0)})(a.arrayValue);case 10:case 11:return(function(r){let o=0;return xt(r.fields,((i,s)=>{o+=i.length+Po(s)})),o})(a.mapValue);default:throw O(13486,{value:a})}}function ki(a){return!!a&&"integerValue"in a}function cs(a){return!!a&&"arrayValue"in a}function Dl(a){return!!a&&"nullValue"in a}function Ml(a){return!!a&&"doubleValue"in a&&isNaN(Number(a.doubleValue))}function To(a){return!!a&&"mapValue"in a}function Tv(a){return(a?.mapValue?.fields||{})[$d]?.stringValue===Gd}function gr(a){if(a.geoPointValue)return{geoPointValue:{...a.geoPointValue}};if(a.timestampValue&&typeof a.timestampValue=="object")return{timestampValue:{...a.timestampValue}};if(a.mapValue){const e={mapValue:{fields:{}}};return xt(a.mapValue.fields,((t,r)=>e.mapValue.fields[t]=gr(r))),e}if(a.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(a.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gr(a.arrayValue.values[t]);return e}return{...a}}function Iv(a){return(((a.mapValue||{}).fields||{}).__type__||{}).stringValue===Pv}class Se{constructor(e){this.value=e}static empty(){return new Se({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!To(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gr(t)}setAll(e){let t=ye.emptyPath(),r={},o=[];e.forEach(((s,l)=>{if(!t.isImmediateParentOf(l)){const d=this.getFieldsMap(t);this.applyChanges(d,r,o),r={},o=[],t=l.popLast()}s?r[l.lastSegment()]=gr(s):o.push(l.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,o)}delete(e){const t=this.field(e.popLast());To(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ke(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=t.mapValue.fields[e.get(r)];To(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,r){xt(t,((o,i)=>e[o]=i));for(const o of r)delete e[o]}clone(){return new Se(gr(this.value))}}function Hd(a){const e=[];return xt(a.fields,((t,r)=>{const o=new ye([t]);if(To(r)){const i=Hd(r.mapValue).fields;if(i.length===0)e.push(o);else for(const s of i)e.push(o.child(s))}else e.push(o)})),new De(e)}class Pe{constructor(e,t,r,o,i,s,l){this.key=e,this.documentType=t,this.version=r,this.readTime=o,this.createTime=i,this.data=s,this.documentState=l}static newInvalidDocument(e){return new Pe(e,0,q.min(),q.min(),q.min(),Se.empty(),0)}static newFoundDocument(e,t,r,o){return new Pe(e,1,t,q.min(),r,o,0)}static newNoDocument(e,t){return new Pe(e,2,t,q.min(),q.min(),Se.empty(),0)}static newUnknownDocument(e,t){return new Pe(e,3,t,q.min(),q.min(),Se.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Se.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Se.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class $o{constructor(e,t){this.position=e,this.inclusive=t}}function Fl(a,e,t){let r=0;for(let o=0;o<a.position.length;o++){const i=e[o],s=a.position[o];if(i.field.isKeyField()?r=N.comparator(N.fromName(s.referenceValue),t.key):r=ka(s,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Vl(a,e){if(a===null)return e===null;if(e===null||a.inclusive!==e.inclusive||a.position.length!==e.position.length)return!1;for(let t=0;t<a.position.length;t++)if(!Ke(a.position[t],e.position[t]))return!1;return!0}class Go{constructor(e,t="asc"){this.field=e,this.dir=t}}function kv(a,e){return a.dir===e.dir&&a.field.isEqual(e.field)}class Wd{}class le extends Wd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Sv(e,t,r):t==="array-contains"?new Mv(e,r):t==="in"?new Fv(e,r):t==="not-in"?new Vv(e,r):t==="array-contains-any"?new xv(e,r):new le(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Rv(e,r):new Dv(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ka(t,this.value)):t!==null&&Dt(this.value)===Dt(t)&&this.matchesComparison(ka(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return O(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qe extends Wd{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Qe(e,t)}matches(e){return Kd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Kd(a){return a.op==="and"}function Qd(a){return Cv(a)&&Kd(a)}function Cv(a){for(const e of a.filters)if(e instanceof Qe)return!1;return!0}function Ci(a){if(a instanceof le)return a.field.canonicalString()+a.op.toString()+Ca(a.value);if(Qd(a))return a.filters.map((e=>Ci(e))).join(",");{const e=a.filters.map((t=>Ci(t))).join(",");return`${a.op}(${e})`}}function Jd(a,e){return a instanceof le?(function(r,o){return o instanceof le&&r.op===o.op&&r.field.isEqual(o.field)&&Ke(r.value,o.value)})(a,e):a instanceof Qe?(function(r,o){return o instanceof Qe&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce(((i,s,l)=>i&&Jd(s,o.filters[l])),!0):!1})(a,e):void O(19439)}function Xd(a){return a instanceof le?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ca(t.value)}`})(a):a instanceof Qe?(function(t){return t.op.toString()+" {"+t.getFilters().map(Xd).join(" ,")+"}"})(a):"Filter"}class Sv extends le{constructor(e,t,r){super(e,t,r),this.key=N.fromName(r.referenceValue)}matches(e){const t=N.comparator(e.key,this.key);return this.matchesComparison(t)}}class Rv extends le{constructor(e,t){super(e,"in",t),this.keys=Yd("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Dv extends le{constructor(e,t){super(e,"not-in",t),this.keys=Yd("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Yd(a,e){return(e.arrayValue?.values||[]).map((t=>N.fromName(t.referenceValue)))}class Mv extends le{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return cs(t)&&Ir(t.arrayValue,this.value)}}class Fv extends le{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ir(this.value.arrayValue,t)}}class Vv extends le{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ir(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ir(this.value.arrayValue,t)}}class xv extends le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!cs(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Ir(this.value.arrayValue,r)))}}class Lv{constructor(e,t=null,r=[],o=[],i=null,s=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=o,this.limit=i,this.startAt=s,this.endAt=l,this.Te=null}}function xl(a,e=null,t=[],r=[],o=null,i=null,s=null){return new Lv(a,e,t,r,o,i,s)}function ls(a){const e=U(a);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Ci(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),mn(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Ca(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Ca(r))).join(",")),e.Te=t}return e.Te}function us(a,e){if(a.limit!==e.limit||a.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<a.orderBy.length;t++)if(!kv(a.orderBy[t],e.orderBy[t]))return!1;if(a.filters.length!==e.filters.length)return!1;for(let t=0;t<a.filters.length;t++)if(!Jd(a.filters[t],e.filters[t]))return!1;return a.collectionGroup===e.collectionGroup&&!!a.path.isEqual(e.path)&&!!Vl(a.startAt,e.startAt)&&Vl(a.endAt,e.endAt)}function Si(a){return N.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}class hn{constructor(e,t=null,r=[],o=[],i=null,s="F",l=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=o,this.limit=i,this.limitType=s,this.startAt=l,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Nv(a,e,t,r,o,i,s,l){return new hn(a,e,t,r,o,i,s,l)}function Zd(a){return new hn(a)}function Ll(a){return a.filters.length===0&&a.limit===null&&a.startAt==null&&a.endAt==null&&(a.explicitOrderBy.length===0||a.explicitOrderBy.length===1&&a.explicitOrderBy[0].field.isKeyField())}function Ov(a){return a.collectionGroup!==null}function fr(a){const e=U(a);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let l=new ue(ye.comparator);return s.filters.forEach((d=>{d.getFlattenedFilters().forEach((m=>{m.isInequality()&&(l=l.add(m.field))}))})),l})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Go(i,r))})),t.has(ye.keyField().canonicalString())||e.Ie.push(new Go(ye.keyField(),r))}return e.Ie}function je(a){const e=U(a);return e.Ee||(e.Ee=Bv(e,fr(a))),e.Ee}function Bv(a,e){if(a.limitType==="F")return xl(a.path,a.collectionGroup,e,a.filters,a.limit,a.startAt,a.endAt);{e=e.map((o=>{const i=o.dir==="desc"?"asc":"desc";return new Go(o.field,i)}));const t=a.endAt?new $o(a.endAt.position,a.endAt.inclusive):null,r=a.startAt?new $o(a.startAt.position,a.startAt.inclusive):null;return xl(a.path,a.collectionGroup,e,a.filters,a.limit,t,r)}}function Ri(a,e,t){return new hn(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),e,t,a.startAt,a.endAt)}function gn(a,e){return us(je(a),je(e))&&a.limitType===e.limitType}function em(a){return`${ls(je(a))}|lt:${a.limitType}`}function pa(a){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((o=>Xd(o))).join(", ")}]`),mn(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((o=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(o))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((o=>Ca(o))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((o=>Ca(o))).join(",")),`Target(${r})`})(je(a))}; limitType=${a.limitType})`}function fn(a,e){return e.isFoundDocument()&&(function(r,o){const i=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):N.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(a,e)&&(function(r,o){for(const i of fr(r))if(!i.field.isKeyField()&&o.data.field(i.field)===null)return!1;return!0})(a,e)&&(function(r,o){for(const i of r.filters)if(!i.matches(o))return!1;return!0})(a,e)&&(function(r,o){return!(r.startAt&&!(function(s,l,d){const m=Fl(s,l,d);return s.inclusive?m<=0:m<0})(r.startAt,fr(r),o)||r.endAt&&!(function(s,l,d){const m=Fl(s,l,d);return s.inclusive?m>=0:m>0})(r.endAt,fr(r),o))})(a,e)}function zv(a){return a.collectionGroup||(a.path.length%2==1?a.path.lastSegment():a.path.get(a.path.length-2))}function tm(a){return(e,t)=>{let r=!1;for(const o of fr(a)){const i=qv(o,e,t);if(i!==0)return i;r=r||o.field.isKeyField()}return 0}}function qv(a,e,t){const r=a.field.isKeyField()?N.comparator(e.key,t.key):(function(i,s,l){const d=s.data.field(i),m=l.data.field(i);return d!==null&&m!==null?ka(d,m):O(42886)})(a.field,e,t);switch(a.dir){case"asc":return r;case"desc":return-1*r;default:return O(19790,{direction:a.dir})}}class oa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[o,i]of r)if(this.equalsFn(o,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),o=this.inner[r];if(o===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<o.length;i++)if(this.equalsFn(o[i][0],e))return void(o[i]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[t]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(e){xt(this.inner,((t,r)=>{for(const[o,i]of r)e(o,i)}))}isEmpty(){return Od(this.inner)}size(){return this.innerSize}}const Uv=new re(N.comparator);function nt(){return Uv}const am=new re(N.comparator);function dr(...a){let e=am;for(const t of a)e=e.insert(t.key,t);return e}function rm(a){let e=am;return a.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Kt(){return yr()}function om(){return yr()}function yr(){return new oa((a=>a.toString()),((a,e)=>a.isEqual(e)))}const jv=new re(N.comparator),$v=new ue(N.comparator);function K(...a){let e=$v;for(const t of a)e=e.add(t);return e}const Gv=new ue(W);function Hv(){return Gv}function ds(a,e){if(a.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qo(e)?"-0":e}}function nm(a){return{integerValue:""+a}}function Wv(a,e){return Ev(e)?nm(e):ds(a,e)}class yn{constructor(){this._=void 0}}function Kv(a,e,t){return a instanceof kr?(function(o,i){const s={fields:{[qd]:{stringValue:zd},[jd]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return i&&ss(i)&&(i=pn(i)),i&&(s.fields[Ud]=i),{mapValue:s}})(t,e):a instanceof Cr?sm(a,e):a instanceof Sr?cm(a,e):(function(o,i){const s=im(o,i),l=Nl(s)+Nl(o.Ae);return ki(s)&&ki(o.Ae)?nm(l):ds(o.serializer,l)})(a,e)}function Qv(a,e,t){return a instanceof Cr?sm(a,e):a instanceof Sr?cm(a,e):t}function im(a,e){return a instanceof Ho?(function(r){return ki(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class kr extends yn{}class Cr extends yn{constructor(e){super(),this.elements=e}}function sm(a,e){const t=lm(e);for(const r of a.elements)t.some((o=>Ke(o,r)))||t.push(r);return{arrayValue:{values:t}}}class Sr extends yn{constructor(e){super(),this.elements=e}}function cm(a,e){let t=lm(e);for(const r of a.elements)t=t.filter((o=>!Ke(o,r)));return{arrayValue:{values:t}}}class Ho extends yn{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Nl(a){return ne(a.integerValue||a.doubleValue)}function lm(a){return cs(a)&&a.arrayValue.values?a.arrayValue.values.slice():[]}class Jv{constructor(e,t){this.field=e,this.transform=t}}function Xv(a,e){return a.field.isEqual(e.field)&&(function(r,o){return r instanceof Cr&&o instanceof Cr||r instanceof Sr&&o instanceof Sr?Ia(r.elements,o.elements,Ke):r instanceof Ho&&o instanceof Ho?Ke(r.Ae,o.Ae):r instanceof kr&&o instanceof kr})(a.transform,e.transform)}class Yv{constructor(e,t){this.version=e,this.transformResults=t}}class Me{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Me}static exists(e){return new Me(void 0,e)}static updateTime(e){return new Me(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Io(a,e){return a.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(a.updateTime):a.exists===void 0||a.exists===e.isFoundDocument()}class vn{}function um(a,e){if(!a.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return a.isNoDocument()?new En(a.key,Me.none()):new zr(a.key,a.data,Me.none());{const t=a.data,r=Se.empty();let o=new ue(ye.comparator);for(let i of e.fields)if(!o.has(i)){let s=t.field(i);s===null&&i.length>1&&(i=i.popLast(),s=t.field(i)),s===null?r.delete(i):r.set(i,s),o=o.add(i)}return new Lt(a.key,r,new De(o.toArray()),Me.none())}}function Zv(a,e,t){a instanceof zr?(function(o,i,s){const l=o.value.clone(),d=Bl(o.fieldTransforms,i,s.transformResults);l.setAll(d),i.convertToFoundDocument(s.version,l).setHasCommittedMutations()})(a,e,t):a instanceof Lt?(function(o,i,s){if(!Io(o.precondition,i))return void i.convertToUnknownDocument(s.version);const l=Bl(o.fieldTransforms,i,s.transformResults),d=i.data;d.setAll(dm(o)),d.setAll(l),i.convertToFoundDocument(s.version,d).setHasCommittedMutations()})(a,e,t):(function(o,i,s){i.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function vr(a,e,t,r){return a instanceof zr?(function(i,s,l,d){if(!Io(i.precondition,s))return l;const m=i.value.clone(),p=zl(i.fieldTransforms,d,s);return m.setAll(p),s.convertToFoundDocument(s.version,m).setHasLocalMutations(),null})(a,e,t,r):a instanceof Lt?(function(i,s,l,d){if(!Io(i.precondition,s))return l;const m=zl(i.fieldTransforms,d,s),p=s.data;return p.setAll(dm(i)),p.setAll(m),s.convertToFoundDocument(s.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((g=>g.field)))})(a,e,t,r):(function(i,s,l){return Io(i.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):l})(a,e,t)}function eE(a,e){let t=null;for(const r of a.fieldTransforms){const o=e.data.field(r.field),i=im(r.transform,o||null);i!=null&&(t===null&&(t=Se.empty()),t.set(r.field,i))}return t||null}function Ol(a,e){return a.type===e.type&&!!a.key.isEqual(e.key)&&!!a.precondition.isEqual(e.precondition)&&!!(function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&Ia(r,o,((i,s)=>Xv(i,s)))})(a.fieldTransforms,e.fieldTransforms)&&(a.type===0?a.value.isEqual(e.value):a.type!==1||a.data.isEqual(e.data)&&a.fieldMask.isEqual(e.fieldMask))}class zr extends vn{constructor(e,t,r,o=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Lt extends vn{constructor(e,t,r,o,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=o,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function dm(a){const e=new Map;return a.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=a.data.field(t);e.set(t,r)}})),e}function Bl(a,e,t){const r=new Map;X(a.length===t.length,32656,{Re:t.length,Ve:a.length});for(let o=0;o<t.length;o++){const i=a[o],s=i.transform,l=e.data.field(i.field);r.set(i.field,Qv(s,l,t[o]))}return r}function zl(a,e,t){const r=new Map;for(const o of a){const i=o.transform,s=t.data.field(o.field);r.set(o.field,Kv(i,s,e))}return r}class En extends vn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tE extends vn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class aE{constructor(e,t,r,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const i=this.mutations[o];i.key.isEqual(e.key)&&Zv(i,e,r[o])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=vr(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=vr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=om();return this.mutations.forEach((o=>{const i=e.get(o.key),s=i.overlayedDocument;let l=this.applyToLocalView(s,i.mutatedFields);l=t.has(o.key)?null:l;const d=um(s,l);d!==null&&r.set(o.key,d),s.isValidDocument()||s.convertToNoDocument(q.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),K())}isEqual(e){return this.batchId===e.batchId&&Ia(this.mutations,e.mutations,((t,r)=>Ol(t,r)))&&Ia(this.baseMutations,e.baseMutations,((t,r)=>Ol(t,r)))}}class ms{constructor(e,t,r,o){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=o}static from(e,t,r){X(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let o=(function(){return jv})();const i=e.mutations;for(let s=0;s<i.length;s++)o=o.insert(i[s].key,r[s].version);return new ms(e,t,r,o)}}class rE{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class oE{constructor(e,t){this.count=e,this.unchangedNames=t}}var ie,J;function nE(a){switch(a){case D.OK:return O(64938);case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0;default:return O(15467,{code:a})}}function mm(a){if(a===void 0)return ot("GRPC error has no .code"),D.UNKNOWN;switch(a){case ie.OK:return D.OK;case ie.CANCELLED:return D.CANCELLED;case ie.UNKNOWN:return D.UNKNOWN;case ie.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case ie.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case ie.INTERNAL:return D.INTERNAL;case ie.UNAVAILABLE:return D.UNAVAILABLE;case ie.UNAUTHENTICATED:return D.UNAUTHENTICATED;case ie.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case ie.NOT_FOUND:return D.NOT_FOUND;case ie.ALREADY_EXISTS:return D.ALREADY_EXISTS;case ie.PERMISSION_DENIED:return D.PERMISSION_DENIED;case ie.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case ie.ABORTED:return D.ABORTED;case ie.OUT_OF_RANGE:return D.OUT_OF_RANGE;case ie.UNIMPLEMENTED:return D.UNIMPLEMENTED;case ie.DATA_LOSS:return D.DATA_LOSS;default:return O(39323,{code:a})}}(J=ie||(ie={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";function iE(){return new TextEncoder}const sE=new Tt([4294967295,4294967295],0);function ql(a){const e=iE().encode(a),t=new kd;return t.update(e),new Uint8Array(t.digest())}function Ul(a){const e=new DataView(a.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),o=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Tt([t,r],0),new Tt([o,i],0)]}class ps{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new mr(`Invalid padding: ${t}`);if(r<0)throw new mr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new mr(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Tt.fromNumber(this.ge)}ye(e,t,r){let o=e.add(t.multiply(Tt.fromNumber(r)));return o.compare(sE)===1&&(o=new Tt([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=ql(e),[r,o]=Ul(t);for(let i=0;i<this.hashCount;i++){const s=this.ye(r,o,i);if(!this.we(s))return!1}return!0}static create(e,t,r){const o=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new ps(i,o,t);return r.forEach((l=>s.insert(l))),s}insert(e){if(this.ge===0)return;const t=ql(e),[r,o]=Ul(t);for(let i=0;i<this.hashCount;i++){const s=this.ye(r,o,i);this.Se(s)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class mr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class _n{constructor(e,t,r,o,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const o=new Map;return o.set(e,qr.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new _n(q.min(),o,new re(W),nt(),K())}}class qr{constructor(e,t,r,o,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new qr(r,t,K(),K(),K())}}class ko{constructor(e,t,r,o){this.be=e,this.removedTargetIds=t,this.key=r,this.De=o}}class pm{constructor(e,t){this.targetId=e,this.Ce=t}}class hm{constructor(e,t,r=_e.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=o}}class jl{constructor(){this.ve=0,this.Fe=$l(),this.Me=_e.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=K(),t=K(),r=K();return this.Fe.forEach(((o,i)=>{switch(i){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:r=r.add(o);break;default:O(38017,{changeType:i})}})),new qr(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=$l()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,X(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class cE{constructor(e){this.Ge=e,this.ze=new Map,this.je=nt(),this.Je=fo(),this.He=fo(),this.Ye=new re(W)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:O(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,r=e.Ce.count,o=this.ot(t);if(o){const i=o.target;if(Si(i))if(r===0){const s=new N(i.path);this.et(t,s,Pe.newNoDocument(s,q.min()))}else X(r===1,20013,{expectedCount:r});else{const s=this._t(t);if(s!==r){const l=this.ut(e),d=l?this.ct(l,e,s):1;if(d!==0){this.it(t);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:i=0}=t;let s,l;try{s=Rt(r).toUint8Array()}catch(d){if(d instanceof Bd)return Ta("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{l=new ps(s,o,i)}catch(d){return Ta(d instanceof mr?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return l.ge===0?null:l}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let o=0;return r.forEach((i=>{const s=this.Ge.ht(),l=`projects/${s.projectId}/databases/${s.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((i,s)=>{const l=this.ot(s);if(l){if(i.current&&Si(l.target)){const d=new N(l.target.path);this.It(d).has(s)||this.Et(s,d)||this.et(s,d,Pe.newNoDocument(d,e))}i.Be&&(t.set(s,i.ke()),i.qe())}}));let r=K();this.He.forEach(((i,s)=>{let l=!0;s.forEachWhile((d=>{const m=this.ot(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(r=r.add(i))})),this.je.forEach(((i,s)=>s.setReadTime(e)));const o=new _n(e,t,this.Ye,this.je,r);return this.je=nt(),this.Je=fo(),this.He=fo(),this.Ye=new re(W),o}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new jl,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ue(W),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ue(W),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new jl),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function fo(){return new re(N.comparator)}function $l(){return new re(N.comparator)}const lE={asc:"ASCENDING",desc:"DESCENDING"},uE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dE={and:"AND",or:"OR"};class mE{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Di(a,e){return a.useProto3Json||mn(e)?e:{value:e}}function Wo(a,e){return a.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function gm(a,e){return a.useProto3Json?e.toBase64():e.toUint8Array()}function pE(a,e){return Wo(a,e.toTimestamp())}function $e(a){return X(!!a,49232),q.fromTimestamp((function(t){const r=St(t);return new ae(r.seconds,r.nanos)})(a))}function hs(a,e){return Mi(a,e).canonicalString()}function Mi(a,e){const t=(function(o){return new te(["projects",o.projectId,"databases",o.database])})(a).child("documents");return e===void 0?t:t.child(e)}function fm(a){const e=te.fromString(a);return X(bm(e),10190,{key:e.toString()}),e}function Fi(a,e){return hs(a.databaseId,e.path)}function ci(a,e){const t=fm(e);if(t.get(1)!==a.databaseId.projectId)throw new L(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+a.databaseId.projectId);if(t.get(3)!==a.databaseId.database)throw new L(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+a.databaseId.database);return new N(vm(t))}function ym(a,e){return hs(a.databaseId,e)}function hE(a){const e=fm(a);return e.length===4?te.emptyPath():vm(e)}function Vi(a){return new te(["projects",a.databaseId.projectId,"databases",a.databaseId.database]).canonicalString()}function vm(a){return X(a.length>4&&a.get(4)==="documents",29091,{key:a.toString()}),a.popFirst(5)}function Gl(a,e,t){return{name:Fi(a,e),fields:t.value.mapValue.fields}}function gE(a,e){let t;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:O(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],i=(function(m,p){return m.useProto3Json?(X(p===void 0||typeof p=="string",58123),_e.fromBase64String(p||"")):(X(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),_e.fromUint8Array(p||new Uint8Array))})(a,e.targetChange.resumeToken),s=e.targetChange.cause,l=s&&(function(m){const p=m.code===void 0?D.UNKNOWN:mm(m.code);return new L(p,m.message||"")})(s);t=new hm(r,o,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const o=ci(a,r.document.name),i=$e(r.document.updateTime),s=r.document.createTime?$e(r.document.createTime):q.min(),l=new Se({mapValue:{fields:r.document.fields}}),d=Pe.newFoundDocument(o,i,s,l),m=r.targetIds||[],p=r.removedTargetIds||[];t=new ko(m,p,d.key,d)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const o=ci(a,r.document),i=r.readTime?$e(r.readTime):q.min(),s=Pe.newNoDocument(o,i),l=r.removedTargetIds||[];t=new ko([],l,s.key,s)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const o=ci(a,r.document),i=r.removedTargetIds||[];t=new ko([],i,o,null)}else{if(!("filter"in e))return O(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:o=0,unchangedNames:i}=r,s=new oE(o,i),l=r.targetId;t=new pm(l,s)}}return t}function fE(a,e){let t;if(e instanceof zr)t={update:Gl(a,e.key,e.value)};else if(e instanceof En)t={delete:Fi(a,e.key)};else if(e instanceof Lt)t={update:Gl(a,e.key,e.data),updateMask:TE(e.fieldMask)};else{if(!(e instanceof tE))return O(16599,{Vt:e.type});t={verify:Fi(a,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,s){const l=s.transform;if(l instanceof kr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Cr)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Sr)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ho)return{fieldPath:s.field.canonicalString(),increment:l.Ae};throw O(20930,{transform:s.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(o,i){return i.updateTime!==void 0?{updateTime:pE(o,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:O(27497)})(a,e.precondition)),t}function yE(a,e){return a&&a.length>0?(X(e!==void 0,14353),a.map((t=>(function(o,i){let s=o.updateTime?$e(o.updateTime):$e(i);return s.isEqual(q.min())&&(s=$e(i)),new Yv(s,o.transformResults||[])})(t,e)))):[]}function vE(a,e){return{documents:[ym(a,e.path)]}}function EE(a,e){const t={structuredQuery:{}},r=e.path;let o;e.collectionGroup!==null?(o=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=ym(a,o);const i=(function(m){if(m.length!==0)return _m(Qe.create(m,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const s=(function(m){if(m.length!==0)return m.map((p=>(function(E){return{field:ha(E.field),direction:AE(E.dir)}})(p)))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);const l=Di(a,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:o}}function _E(a){let e=hE(a.parent);const t=a.structuredQuery,r=t.from?t.from.length:0;let o=null;if(r>0){X(r===1,65062);const p=t.from[0];p.allDescendants?o=p.collectionId:e=e.child(p.collectionId)}let i=[];t.where&&(i=(function(g){const E=Em(g);return E instanceof Qe&&Qd(E)?E.getFilters():[E]})(t.where));let s=[];t.orderBy&&(s=(function(g){return g.map((E=>(function(I){return new Go(ga(I.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(E)))})(t.orderBy));let l=null;t.limit&&(l=(function(g){let E;return E=typeof g=="object"?g.value:g,mn(E)?null:E})(t.limit));let d=null;t.startAt&&(d=(function(g){const E=!!g.before,C=g.values||[];return new $o(C,E)})(t.startAt));let m=null;return t.endAt&&(m=(function(g){const E=!g.before,C=g.values||[];return new $o(C,E)})(t.endAt)),Nv(e,o,s,i,l,"F",d,m)}function bE(a,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return O(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Em(a){return a.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ga(t.unaryFilter.field);return le.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=ga(t.unaryFilter.field);return le.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ga(t.unaryFilter.field);return le.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=ga(t.unaryFilter.field);return le.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return O(61313);default:return O(60726)}})(a):a.fieldFilter!==void 0?(function(t){return le.create(ga(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return O(58110);default:return O(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(a):a.compositeFilter!==void 0?(function(t){return Qe.create(t.compositeFilter.filters.map((r=>Em(r))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return O(1026)}})(t.compositeFilter.op))})(a):O(30097,{filter:a})}function AE(a){return lE[a]}function wE(a){return uE[a]}function PE(a){return dE[a]}function ha(a){return{fieldPath:a.canonicalString()}}function ga(a){return ye.fromServerFormat(a.fieldPath)}function _m(a){return a instanceof le?(function(t){if(t.op==="=="){if(Ml(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NAN"}};if(Dl(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ml(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NOT_NAN"}};if(Dl(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ha(t.field),op:wE(t.op),value:t.value}}})(a):a instanceof Qe?(function(t){const r=t.getFilters().map((o=>_m(o)));return r.length===1?r[0]:{compositeFilter:{op:PE(t.op),filters:r}}})(a):O(54877,{filter:a})}function TE(a){const e=[];return a.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function bm(a){return a.length>=4&&a.get(0)==="projects"&&a.get(2)==="databases"}class _t{constructor(e,t,r,o,i=q.min(),s=q.min(),l=_e.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=l,this.expectedCount=d}withSequenceNumber(e){return new _t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _t(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class IE{constructor(e){this.yt=e}}function kE(a){const e=_E({parent:a.parent,structuredQuery:a.structuredQuery});return a.limitType==="LAST"?Ri(e,e.limit,"L"):e}class CE{constructor(){this.Cn=new SE}addToCollectionParentIndex(e,t){return this.Cn.add(t),S.resolve()}getCollectionParents(e,t){return S.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return S.resolve()}deleteFieldIndex(e,t){return S.resolve()}deleteAllFieldIndexes(e){return S.resolve()}createTargetIndexes(e,t){return S.resolve()}getDocumentsMatchingTarget(e,t){return S.resolve(null)}getIndexType(e,t){return S.resolve(0)}getFieldIndexes(e,t){return S.resolve([])}getNextCollectionGroupToUpdate(e){return S.resolve(null)}getMinOffset(e,t){return S.resolve(Ct.min())}getMinOffsetFromCollectionGroup(e,t){return S.resolve(Ct.min())}updateCollectionGroup(e,t,r){return S.resolve()}updateIndexEntries(e,t){return S.resolve()}}class SE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t]||new ue(te.comparator),i=!o.has(r);return this.index[t]=o.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t];return o&&o.has(r)}getEntries(e){return(this.index[e]||new ue(te.comparator)).toArray()}}const Hl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Am=41943040;class Ce{static withCacheSize(e){return new Ce(e,Ce.DEFAULT_COLLECTION_PERCENTILE,Ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}Ce.DEFAULT_COLLECTION_PERCENTILE=10,Ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ce.DEFAULT=new Ce(Am,Ce.DEFAULT_COLLECTION_PERCENTILE,Ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ce.DISABLED=new Ce(-1,0,0);class Sa{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Sa(0)}static cr(){return new Sa(-1)}}const Wl="LruGarbageCollector",RE=1048576;function Kl([a,e],[t,r]){const o=W(a,t);return o===0?W(e,r):o}class DE{constructor(e){this.Ir=e,this.buffer=new ue(Kl),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Kl(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ME{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){V(Wl,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){za(t)?V(Wl,"Ignoring IndexedDB error during garbage collection: ",t):await Ba(t)}await this.Vr(3e5)}))}}class FE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return S.resolve(dn.ce);const r=new DE(t);return this.mr.forEachTarget(e,(o=>r.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>r.Ar(o))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve(Hl)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Hl):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,o,i,s,l,d,m;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),o=this.params.maximumSequenceNumbersToCollect):o=g,s=Date.now(),this.nthSequenceNumber(e,o)))).next((g=>(r=g,l=Date.now(),this.removeTargets(e,r,t)))).next((g=>(i=g,d=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(m=Date.now(),ma()<=H.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-p}ms
	Determined least recently used ${o} in `+(l-s)+`ms
	Removed ${i} targets in `+(d-l)+`ms
	Removed ${g} documents in `+(m-d)+`ms
Total Duration: ${m-p}ms`),S.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:i,documentsRemoved:g}))))}}function VE(a,e){return new FE(a,e)}class xE{constructor(){this.changes=new oa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Pe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?S.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class LE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class NE{constructor(e,t,r,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=o}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(r=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(r!==null&&vr(r.mutation,o,De.empty(),ae.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,K()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=K()){const o=Kt();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,r).next((i=>{let s=dr();return i.forEach(((l,d)=>{s=s.insert(l,d.overlayedDocument)})),s}))))}getOverlayedDocuments(e,t){const r=Kt();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,K())))}populateOverlays(e,t,r){const o=[];return r.forEach((i=>{t.has(i)||o.push(i)})),this.documentOverlayCache.getOverlays(e,o).next((i=>{i.forEach(((s,l)=>{t.set(s,l)}))}))}computeViews(e,t,r,o){let i=nt();const s=yr(),l=(function(){return yr()})();return t.forEach(((d,m)=>{const p=r.get(m.key);o.has(m.key)&&(p===void 0||p.mutation instanceof Lt)?i=i.insert(m.key,m):p!==void 0?(s.set(m.key,p.mutation.getFieldMask()),vr(p.mutation,m,p.mutation.getFieldMask(),ae.now())):s.set(m.key,De.empty())})),this.recalculateAndSaveOverlays(e,i).next((d=>(d.forEach(((m,p)=>s.set(m,p))),t.forEach(((m,p)=>l.set(m,new LE(p,s.get(m)??null)))),l)))}recalculateAndSaveOverlays(e,t){const r=yr();let o=new re(((s,l)=>s-l)),i=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((s=>{for(const l of s)l.keys().forEach((d=>{const m=t.get(d);if(m===null)return;let p=r.get(d)||De.empty();p=l.applyToLocalView(m,p),r.set(d,p);const g=(o.get(l.batchId)||K()).add(d);o=o.insert(l.batchId,g)}))})).next((()=>{const s=[],l=o.getReverseIterator();for(;l.hasNext();){const d=l.getNext(),m=d.key,p=d.value,g=om();p.forEach((E=>{if(!i.has(E)){const C=um(t.get(E),r.get(E));C!==null&&g.set(E,C),i=i.add(E)}})),s.push(this.documentOverlayCache.saveOverlays(e,m,g))}return S.waitFor(s)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,o){return(function(s){return N.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ov(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,o):this.getDocumentsMatchingCollectionQuery(e,t,r,o)}getNextDocuments(e,t,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,o).next((i=>{const s=o-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,o-i.size):S.resolve(Kt());let l=wr,d=i;return s.next((m=>S.forEach(m,((p,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(p)?S.resolve():this.remoteDocumentCache.getEntry(e,p).next((E=>{d=d.insert(p,E)}))))).next((()=>this.populateOverlays(e,m,i))).next((()=>this.computeViews(e,d,m,K()))).next((p=>({batchId:l,changes:rm(p)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new N(t)).next((r=>{let o=dr();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,o){const i=t.collectionGroup;let s=dr();return this.indexManager.getCollectionParents(e,i).next((l=>S.forEach(l,(d=>{const m=(function(g,E){return new hn(E,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,d.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,r,o).next((p=>{p.forEach(((g,E)=>{s=s.insert(g,E)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,r,o){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,o)))).next((s=>{i.forEach(((d,m)=>{const p=m.getKey();s.get(p)===null&&(s=s.insert(p,Pe.newInvalidDocument(p)))}));let l=dr();return s.forEach(((d,m)=>{const p=i.get(d);p!==void 0&&vr(p.mutation,m,De.empty(),ae.now()),fn(t,m)&&(l=l.insert(d,m))})),l}))}}class OE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return S.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:$e(o.createTime)}})(t)),S.resolve()}getNamedQuery(e,t){return S.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:kE(o.bundledQuery),readTime:$e(o.readTime)}})(t)),S.resolve()}}class BE{constructor(){this.overlays=new re(N.comparator),this.qr=new Map}getOverlay(e,t){return S.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Kt();return S.forEach(t,(o=>this.getOverlay(e,o).next((i=>{i!==null&&r.set(o,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((o,i)=>{this.St(e,t,i)})),S.resolve()}removeOverlaysForBatchId(e,t,r){const o=this.qr.get(r);return o!==void 0&&(o.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),S.resolve()}getOverlaysForCollection(e,t,r){const o=Kt(),i=t.length+1,s=new N(t.child("")),l=this.overlays.getIteratorFrom(s);for(;l.hasNext();){const d=l.getNext().value,m=d.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&d.largestBatchId>r&&o.set(d.getKey(),d)}return S.resolve(o)}getOverlaysForCollectionGroup(e,t,r,o){let i=new re(((m,p)=>m-p));const s=this.overlays.getIterator();for(;s.hasNext();){const m=s.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let p=i.get(m.largestBatchId);p===null&&(p=Kt(),i=i.insert(m.largestBatchId,p)),p.set(m.getKey(),m)}}const l=Kt(),d=i.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((m,p)=>l.set(m,p))),!(l.size()>=o)););return S.resolve(l)}St(e,t,r){const o=this.overlays.get(r.key);if(o!==null){const s=this.qr.get(o.largestBatchId).delete(r.key);this.qr.set(o.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new rE(t,r));let i=this.qr.get(t);i===void 0&&(i=K(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class zE{constructor(){this.sessionToken=_e.EMPTY_BYTE_STRING}getSessionToken(e){return S.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,S.resolve()}}class gs{constructor(){this.Qr=new ue(me.$r),this.Ur=new ue(me.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new me(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new me(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new N(new te([])),r=new me(t,e),o=new me(t,e+1),i=[];return this.Ur.forEachInRange([r,o],(s=>{this.Gr(s),i.push(s.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new N(new te([])),r=new me(t,e),o=new me(t,e+1);let i=K();return this.Ur.forEachInRange([r,o],(s=>{i=i.add(s.key)})),i}containsKey(e){const t=new me(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class me{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return N.comparator(e.key,t.key)||W(e.Yr,t.Yr)}static Kr(e,t){return W(e.Yr,t.Yr)||N.comparator(e.key,t.key)}}class qE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ue(me.$r)}checkEmpty(e){return S.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,o){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new aE(i,t,r,o);this.mutationQueue.push(s);for(const l of o)this.Zr=this.Zr.add(new me(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return S.resolve(s)}lookupMutationBatch(e,t){return S.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,o=this.ei(r),i=o<0?0:o;return S.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(this.mutationQueue.length===0?is:this.tr-1)}getAllMutationBatches(e){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new me(t,0),o=new me(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,o],(s=>{const l=this.Xr(s.Yr);i.push(l)})),S.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ue(W);return t.forEach((o=>{const i=new me(o,0),s=new me(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,s],(l=>{r=r.add(l.Yr)}))})),S.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,o=r.length+1;let i=r;N.isDocumentKey(i)||(i=i.child(""));const s=new me(new N(i),0);let l=new ue(W);return this.Zr.forEachWhile((d=>{const m=d.key.path;return!!r.isPrefixOf(m)&&(m.length===o&&(l=l.add(d.Yr)),!0)}),s),S.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((r=>{const o=this.Xr(r);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){X(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return S.forEach(t.mutations,(o=>{const i=new me(o.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new me(t,0),o=this.Zr.firstAfterOrEqual(r);return S.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,S.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class UE{constructor(e){this.ri=e,this.docs=(function(){return new re(N.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,o=this.docs.get(r),i=o?o.size:0,s=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return S.resolve(r?r.document.mutableCopy():Pe.newInvalidDocument(t))}getEntries(e,t){let r=nt();return t.forEach((o=>{const i=this.docs.get(o);r=r.insert(o,i?i.document.mutableCopy():Pe.newInvalidDocument(o))})),S.resolve(r)}getDocumentsMatchingQuery(e,t,r,o){let i=nt();const s=t.path,l=new N(s.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(l);for(;d.hasNext();){const{key:m,value:{document:p}}=d.getNext();if(!s.isPrefixOf(m.path))break;m.path.length>s.length+1||gv(hv(p),r)<=0||(o.has(p.key)||fn(t,p))&&(i=i.insert(p.key,p.mutableCopy()))}return S.resolve(i)}getAllFromCollectionGroup(e,t,r,o){O(9500)}ii(e,t){return S.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new jE(this)}getSize(e){return S.resolve(this.size)}}class jE extends xE{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(r)})),S.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class $E{constructor(e){this.persistence=e,this.si=new oa((t=>ls(t)),us),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.oi=0,this._i=new gs,this.targetCount=0,this.ai=Sa.ur()}forEachTarget(e,t){return this.si.forEach(((r,o)=>t(o))),S.resolve()}getLastRemoteSnapshotVersion(e){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return S.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),S.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Sa(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,S.resolve()}updateTargetData(e,t){return this.Pr(t),S.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,S.resolve()}removeTargets(e,t,r){let o=0;const i=[];return this.si.forEach(((s,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.si.delete(s),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),o++)})),S.waitFor(i).next((()=>o))}getTargetCount(e){return S.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return S.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),S.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const o=this.persistence.referenceDelegate,i=[];return o&&t.forEach((s=>{i.push(o.markPotentiallyOrphaned(e,s))})),S.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),S.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return S.resolve(r)}containsKey(e,t){return S.resolve(this._i.containsKey(t))}}class wm{constructor(e,t){this.ui={},this.overlays={},this.ci=new dn(0),this.li=!1,this.li=!0,this.hi=new zE,this.referenceDelegate=e(this),this.Pi=new $E(this),this.indexManager=new CE,this.remoteDocumentCache=(function(o){return new UE(o)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new IE(t),this.Ii=new OE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new BE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new qE(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);const o=new GE(this.ci.next());return this.referenceDelegate.Ei(),r(o).next((i=>this.referenceDelegate.di(o).next((()=>i)))).toPromise().then((i=>(o.raiseOnCommittedEvent(),i)))}Ai(e,t){return S.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class GE extends yv{constructor(e){super(),this.currentSequenceNumber=e}}class fs{constructor(e){this.persistence=e,this.Ri=new gs,this.Vi=null}static mi(e){return new fs(e)}get fi(){if(this.Vi)return this.Vi;throw O(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),S.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),S.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),S.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.fi,(r=>{const o=N.fromPath(r);return this.gi(e,o).next((i=>{i||t.removeEntry(o,q.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return S.or([()=>S.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ko{constructor(e,t){this.persistence=e,this.pi=new oa((r=>_v(r.path)),((r,o)=>r.isEqual(o))),this.garbageCollector=VE(this,t)}static mi(e,t){return new Ko(e,t)}Ei(){}di(e){return S.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((o=>r+o))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return S.forEach(this.pi,((r,o)=>this.br(e,r,o).next((i=>i?S.resolve():t(o)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const o=this.persistence.getRemoteDocumentCache(),i=o.newChangeBuffer();return o.ii(e,(s=>this.br(e,s,t).next((l=>{l||(r++,i.removeEntry(s,q.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),S.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),S.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),S.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),S.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Po(e.data.value)),t}br(e,t,r){return S.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return S.resolve(o!==void 0&&o>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ys{constructor(e,t,r,o){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=o}static As(e,t){let r=K(),o=K();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:o=o.add(i.doc.key)}return new ys(e,t.fromCache,r,o)}}class HE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class WE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Lh()?8:vv(Te())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,o){const i={result:null};return this.ys(e,t).next((s=>{i.result=s})).next((()=>{if(!i.result)return this.ws(e,t,o,r).next((s=>{i.result=s}))})).next((()=>{if(i.result)return;const s=new HE;return this.Ss(e,t,s).next((l=>{if(i.result=l,this.Vs)return this.bs(e,t,s,l.size)}))})).next((()=>i.result))}bs(e,t,r,o){return r.documentReadCount<this.fs?(ma()<=H.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",pa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),S.resolve()):(ma()<=H.DEBUG&&V("QueryEngine","Query:",pa(t),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.gs*o?(ma()<=H.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",pa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,je(t))):S.resolve())}ys(e,t){if(Ll(t))return S.resolve(null);let r=je(t);return this.indexManager.getIndexType(e,r).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=Ri(t,null,"F"),r=je(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const s=K(...i);return this.ps.getDocuments(e,s).next((l=>this.indexManager.getMinOffset(e,r).next((d=>{const m=this.Ds(t,l);return this.Cs(t,m,s,d.readTime)?this.ys(e,Ri(t,null,"F")):this.vs(e,m,t,d)}))))})))))}ws(e,t,r,o){return Ll(t)||o.isEqual(q.min())?S.resolve(null):this.ps.getDocuments(e,r).next((i=>{const s=this.Ds(t,i);return this.Cs(t,s,r,o)?S.resolve(null):(ma()<=H.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),pa(t)),this.vs(e,s,t,pv(o,wr)).next((l=>l)))}))}Ds(e,t){let r=new ue(tm(e));return t.forEach(((o,i)=>{fn(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,o){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(o)>0)}Ss(e,t,r){return ma()<=H.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",pa(t)),this.ps.getDocumentsMatchingQuery(e,t,Ct.min(),r)}vs(e,t,r,o){return this.ps.getDocumentsMatchingQuery(e,r,o).next((i=>(t.forEach((s=>{i=i.insert(s.key,s)})),i)))}}const vs="LocalStore",KE=3e8;class QE{constructor(e,t,r,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new re(W),this.xs=new oa((i=>ls(i)),us),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new NE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function JE(a,e,t,r){return new QE(a,e,t,r)}async function Pm(a,e){const t=U(a);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let o;return t.mutationQueue.getAllMutationBatches(r).next((i=>(o=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const s=[],l=[];let d=K();for(const m of o){s.push(m.batchId);for(const p of m.mutations)d=d.add(p.key)}for(const m of i){l.push(m.batchId);for(const p of m.mutations)d=d.add(p.key)}return t.localDocuments.getDocuments(r,d).next((m=>({Ls:m,removedBatchIds:s,addedBatchIds:l})))}))}))}function XE(a,e){const t=U(a);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const o=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,d,m,p){const g=m.batch,E=g.keys();let C=S.resolve();return E.forEach((I=>{C=C.next((()=>p.getEntry(d,I))).next((R=>{const k=m.docVersions.get(I);X(k!==null,48541),R.version.compareTo(k)<0&&(g.applyToRemoteDocument(R,m),R.isValidDocument()&&(R.setReadTime(m.commitVersion),p.addEntry(R)))}))})),C.next((()=>l.mutationQueue.removeMutationBatch(d,g)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(l){let d=K();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(d=d.add(l.batch.mutations[m].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(r,o)))}))}function Tm(a){const e=U(a);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function YE(a,e){const t=U(a),r=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const s=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const l=[];e.targetChanges.forEach(((p,g)=>{const E=o.get(g);if(!E)return;l.push(t.Pi.removeMatchingKeys(i,p.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(i,p.addedDocuments,g))));let C=E.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?C=C.withResumeToken(_e.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):p.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(p.resumeToken,r)),o=o.insert(g,C),(function(R,k,x){return R.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=KE?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0})(E,C,p)&&l.push(t.Pi.updateTargetData(i,C))}));let d=nt(),m=K();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,p))})),l.push(ZE(i,s,e.documentUpdates).next((p=>{d=p.ks,m=p.qs}))),!r.isEqual(q.min())){const p=t.Pi.getLastRemoteSnapshotVersion(i).next((g=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));l.push(p)}return S.waitFor(l).next((()=>s.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,d,m))).next((()=>d))})).then((i=>(t.Ms=o,i)))}function ZE(a,e,t){let r=K(),o=K();return t.forEach((i=>r=r.add(i))),e.getEntries(a,r).next((i=>{let s=nt();return t.forEach(((l,d)=>{const m=i.get(l);d.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(l)),d.isNoDocument()&&d.version.isEqual(q.min())?(e.removeEntry(l,d.readTime),s=s.insert(l,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(d),s=s.insert(l,d)):V(vs,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",d.version)})),{ks:s,qs:o}}))}function e_(a,e){const t=U(a);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=is),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function t_(a,e){const t=U(a);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let o;return t.Pi.getTargetData(r,e).next((i=>i?(o=i,S.resolve(o)):t.Pi.allocateTargetId(r).next((s=>(o=new _t(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,o).next((()=>o)))))))})).then((r=>{const o=t.Ms.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function xi(a,e,t){const r=U(a),o=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(s=>r.persistence.referenceDelegate.removeTarget(s,o)))}catch(s){if(!za(s))throw s;V(vs,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Ms=r.Ms.remove(e),r.xs.delete(o.target)}function Ql(a,e,t){const r=U(a);let o=q.min(),i=K();return r.persistence.runTransaction("Execute query","readwrite",(s=>(function(d,m,p){const g=U(d),E=g.xs.get(p);return E!==void 0?S.resolve(g.Ms.get(E)):g.Pi.getTargetData(m,p)})(r,s,je(e)).next((l=>{if(l)return o=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(s,l.targetId).next((d=>{i=d}))})).next((()=>r.Fs.getDocumentsMatchingQuery(s,e,t?o:q.min(),t?i:K()))).next((l=>(a_(r,zv(e),l),{documents:l,Qs:i})))))}function a_(a,e,t){let r=a.Os.get(e)||q.min();t.forEach(((o,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),a.Os.set(e,r)}class Jl{constructor(){this.activeTargetIds=Hv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class r_{constructor(){this.Mo=new Jl,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Jl,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class o_{Oo(e){}shutdown(){}}const Xl="ConnectivityMonitor";class Yl{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){V(Xl,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){V(Xl,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let yo=null;function Li(){return yo===null?yo=(function(){return 268435456+Math.round(2147483648*Math.random())})():yo++,"0x"+yo.toString(16)}const li="RestConnection",n_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class i_{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${o}`,this.Wo=this.databaseId.database===Uo?`project_id=${r}`:`project_id=${r}&database_id=${o}`}Go(e,t,r,o,i){const s=Li(),l=this.zo(e,t.toUriEncodedString());V(li,`Sending RPC '${e}' ${s}:`,l,r);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,o,i);const{host:m}=new URL(l),p=xa(m);return this.Jo(e,l,d,r,p).then((g=>(V(li,`Received RPC '${e}' ${s}: `,g),g)),(g=>{throw Ta(li,`RPC '${e}' ${s} failed with error: `,g,"url: ",l,"request:",r),g}))}Ho(e,t,r,o,i,s){return this.Go(e,t,r,o,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Oa})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,i)=>e[i]=o)),r&&r.headers.forEach(((o,i)=>e[i]=o))}zo(e,t){const r=n_[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class s_{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ae="WebChannelConnection";class c_ extends i_{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,o,i){const s=Li();return new Promise(((l,d)=>{const m=new Cd;m.setWithCredentials(!0),m.listenOnce(Sd.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case wo.NO_ERROR:const g=m.getResponseJson();V(Ae,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(g)),l(g);break;case wo.TIMEOUT:V(Ae,`RPC '${e}' ${s} timed out`),d(new L(D.DEADLINE_EXCEEDED,"Request time out"));break;case wo.HTTP_ERROR:const E=m.getStatus();if(V(Ae,`RPC '${e}' ${s} failed with status:`,E,"response text:",m.getResponseText()),E>0){let C=m.getResponseJson();Array.isArray(C)&&(C=C[0]);const I=C?.error;if(I&&I.status&&I.message){const R=(function(x){const z=x.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(z)>=0?z:D.UNKNOWN})(I.status);d(new L(R,I.message))}else d(new L(D.UNKNOWN,"Server responded with status "+m.getStatus()))}else d(new L(D.UNAVAILABLE,"Connection failed."));break;default:O(9055,{l_:e,streamId:s,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{V(Ae,`RPC '${e}' ${s} completed.`)}}));const p=JSON.stringify(o);V(Ae,`RPC '${e}' ${s} sending request:`,o),m.send(t,"POST",p,r,15)}))}T_(e,t,r){const o=Li(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Md(),l=Dd(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;const p=i.join("");V(Ae,`Creating RPC '${e}' stream ${o}: ${p}`,d);const g=s.createWebChannel(p,d);this.I_(g);let E=!1,C=!1;const I=new s_({Yo:k=>{C?V(Ae,`Not sending because RPC '${e}' stream ${o} is closed:`,k):(E||(V(Ae,`Opening RPC '${e}' stream ${o} transport.`),g.open(),E=!0),V(Ae,`RPC '${e}' stream ${o} sending:`,k),g.send(k))},Zo:()=>g.close()}),R=(k,x,z)=>{k.listen(x,(j=>{try{z(j)}catch(Y){setTimeout((()=>{throw Y}),0)}}))};return R(g,ur.EventType.OPEN,(()=>{C||(V(Ae,`RPC '${e}' stream ${o} transport opened.`),I.o_())})),R(g,ur.EventType.CLOSE,(()=>{C||(C=!0,V(Ae,`RPC '${e}' stream ${o} transport closed`),I.a_(),this.E_(g))})),R(g,ur.EventType.ERROR,(k=>{C||(C=!0,Ta(Ae,`RPC '${e}' stream ${o} transport errored. Name:`,k.name,"Message:",k.message),I.a_(new L(D.UNAVAILABLE,"The operation could not be completed")))})),R(g,ur.EventType.MESSAGE,(k=>{if(!C){const x=k.data[0];X(!!x,16349);const z=x,j=z?.error||z[0]?.error;if(j){V(Ae,`RPC '${e}' stream ${o} received error:`,j);const Y=j.status;let G=(function(f){const v=ie[f];if(v!==void 0)return mm(v)})(Y),Q=j.message;G===void 0&&(G=D.INTERNAL,Q="Unknown error status: "+Y+" with message "+j.message),C=!0,I.a_(new L(G,Q)),g.close()}else V(Ae,`RPC '${e}' stream ${o} received:`,x),I.u_(x)}})),R(l,Rd.STAT_EVENT,(k=>{k.stat===Pi.PROXY?V(Ae,`RPC '${e}' stream ${o} detected buffering proxy`):k.stat===Pi.NOPROXY&&V(Ae,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{I.__()}),0),I}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function ui(){return typeof document<"u"?document:null}function bn(a){return new mE(a,!0)}class Im{constructor(e,t,r=1e3,o=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=o,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-r);o>0&&V("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Zl="PersistentStream";class km{constructor(e,t,r,o,i,s,l,d){this.Mi=e,this.S_=r,this.b_=o,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=l,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Im(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===D.RESOURCE_EXHAUSTED?(ot(t.toString()),ot("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,o])=>{this.D_===t&&this.G_(r,o)}),(r=>{e((()=>{const o=new L(D.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(o)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{r((()=>this.z_(o)))})),this.stream.onMessage((o=>{r((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return V(Zl,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(V(Zl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class l_ extends km{constructor(e,t,r,o,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,o,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=gE(this.serializer,e),r=(function(i){if(!("targetChange"in i))return q.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?q.min():s.readTime?$e(s.readTime):q.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Vi(this.serializer),t.addTarget=(function(i,s){let l;const d=s.target;if(l=Si(d)?{documents:vE(i,d)}:{query:EE(i,d).ft},l.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){l.resumeToken=gm(i,s.resumeToken);const m=Di(i,s.expectedCount);m!==null&&(l.expectedCount=m)}else if(s.snapshotVersion.compareTo(q.min())>0){l.readTime=Wo(i,s.snapshotVersion.toTimestamp());const m=Di(i,s.expectedCount);m!==null&&(l.expectedCount=m)}return l})(this.serializer,e);const r=bE(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Vi(this.serializer),t.removeTarget=e,this.q_(t)}}class u_ extends km{constructor(e,t,r,o,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,o,s),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return X(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,X(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){X(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=yE(e.writeResults,e.commitTime),r=$e(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Vi(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>fE(this.serializer,r)))};this.q_(t)}}class d_{}class m_ extends d_{constructor(e,t,r,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new L(D.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.Go(e,Mi(t,r),o,i,s))).catch((i=>{throw i.name==="FirebaseError"?(i.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new L(D.UNKNOWN,i.toString())}))}Ho(e,t,r,o,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,l])=>this.connection.Ho(e,Mi(t,r),o,s,l,i))).catch((s=>{throw s.name==="FirebaseError"?(s.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(D.UNKNOWN,s.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class p_{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ot(t),this.aa=!1):V("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const aa="RemoteStore";class h_{constructor(e,t,r,o,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((s=>{r.enqueueAndForget((async()=>{na(this)&&(V(aa,"Restarting streams for network reachability change."),await(async function(d){const m=U(d);m.Ea.add(4),await Ur(m),m.Ra.set("Unknown"),m.Ea.delete(4),await An(m)})(this))}))})),this.Ra=new p_(r,o)}}async function An(a){if(na(a))for(const e of a.da)await e(!0)}async function Ur(a){for(const e of a.da)await e(!1)}function Cm(a,e){const t=U(a);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),As(t)?bs(t):qa(t).O_()&&_s(t,e))}function Es(a,e){const t=U(a),r=qa(t);t.Ia.delete(e),r.O_()&&Sm(t,e),t.Ia.size===0&&(r.O_()?r.L_():na(t)&&t.Ra.set("Unknown"))}function _s(a,e){if(a.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){const t=a.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}qa(a).Y_(e)}function Sm(a,e){a.Va.Ue(e),qa(a).Z_(e)}function bs(a){a.Va=new cE({getRemoteKeysForTarget:e=>a.remoteSyncer.getRemoteKeysForTarget(e),At:e=>a.Ia.get(e)||null,ht:()=>a.datastore.serializer.databaseId}),qa(a).start(),a.Ra.ua()}function As(a){return na(a)&&!qa(a).x_()&&a.Ia.size>0}function na(a){return U(a).Ea.size===0}function Rm(a){a.Va=void 0}async function g_(a){a.Ra.set("Online")}async function f_(a){a.Ia.forEach(((e,t)=>{_s(a,e)}))}async function y_(a,e){Rm(a),As(a)?(a.Ra.ha(e),bs(a)):a.Ra.set("Unknown")}async function v_(a,e,t){if(a.Ra.set("Online"),e instanceof hm&&e.state===2&&e.cause)try{await(async function(o,i){const s=i.cause;for(const l of i.targetIds)o.Ia.has(l)&&(await o.remoteSyncer.rejectListen(l,s),o.Ia.delete(l),o.Va.removeTarget(l))})(a,e)}catch(r){V(aa,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qo(a,r)}else if(e instanceof ko?a.Va.Ze(e):e instanceof pm?a.Va.st(e):a.Va.tt(e),!t.isEqual(q.min()))try{const r=await Tm(a.localStore);t.compareTo(r)>=0&&await(function(i,s){const l=i.Va.Tt(s);return l.targetChanges.forEach(((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const p=i.Ia.get(m);p&&i.Ia.set(m,p.withResumeToken(d.resumeToken,s))}})),l.targetMismatches.forEach(((d,m)=>{const p=i.Ia.get(d);if(!p)return;i.Ia.set(d,p.withResumeToken(_e.EMPTY_BYTE_STRING,p.snapshotVersion)),Sm(i,d);const g=new _t(p.target,d,m,p.sequenceNumber);_s(i,g)})),i.remoteSyncer.applyRemoteEvent(l)})(a,t)}catch(r){V(aa,"Failed to raise snapshot:",r),await Qo(a,r)}}async function Qo(a,e,t){if(!za(e))throw e;a.Ea.add(1),await Ur(a),a.Ra.set("Offline"),t||(t=()=>Tm(a.localStore)),a.asyncQueue.enqueueRetryable((async()=>{V(aa,"Retrying IndexedDB access"),await t(),a.Ea.delete(1),await An(a)}))}function Dm(a,e){return e().catch((t=>Qo(a,t,e)))}async function wn(a){const e=U(a),t=Mt(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:is;for(;E_(e);)try{const o=await e_(e.localStore,r);if(o===null){e.Ta.length===0&&t.L_();break}r=o.batchId,__(e,o)}catch(o){await Qo(e,o)}Mm(e)&&Fm(e)}function E_(a){return na(a)&&a.Ta.length<10}function __(a,e){a.Ta.push(e);const t=Mt(a);t.O_()&&t.X_&&t.ea(e.mutations)}function Mm(a){return na(a)&&!Mt(a).x_()&&a.Ta.length>0}function Fm(a){Mt(a).start()}async function b_(a){Mt(a).ra()}async function A_(a){const e=Mt(a);for(const t of a.Ta)e.ea(t.mutations)}async function w_(a,e,t){const r=a.Ta.shift(),o=ms.from(r,e,t);await Dm(a,(()=>a.remoteSyncer.applySuccessfulWrite(o))),await wn(a)}async function P_(a,e){e&&Mt(a).X_&&await(async function(r,o){if((function(s){return nE(s)&&s!==D.ABORTED})(o.code)){const i=r.Ta.shift();Mt(r).B_(),await Dm(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,o))),await wn(r)}})(a,e),Mm(a)&&Fm(a)}async function eu(a,e){const t=U(a);t.asyncQueue.verifyOperationInProgress(),V(aa,"RemoteStore received new credentials");const r=na(t);t.Ea.add(3),await Ur(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await An(t)}async function T_(a,e){const t=U(a);e?(t.Ea.delete(2),await An(t)):e||(t.Ea.add(2),await Ur(t),t.Ra.set("Unknown"))}function qa(a){return a.ma||(a.ma=(function(t,r,o){const i=U(t);return i.sa(),new l_(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)})(a.datastore,a.asyncQueue,{Xo:g_.bind(null,a),t_:f_.bind(null,a),r_:y_.bind(null,a),H_:v_.bind(null,a)}),a.da.push((async e=>{e?(a.ma.B_(),As(a)?bs(a):a.Ra.set("Unknown")):(await a.ma.stop(),Rm(a))}))),a.ma}function Mt(a){return a.fa||(a.fa=(function(t,r,o){const i=U(t);return i.sa(),new u_(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)})(a.datastore,a.asyncQueue,{Xo:()=>Promise.resolve(),t_:b_.bind(null,a),r_:P_.bind(null,a),ta:A_.bind(null,a),na:w_.bind(null,a)}),a.da.push((async e=>{e?(a.fa.B_(),await wn(a)):(await a.fa.stop(),a.Ta.length>0&&(V(aa,`Stopping write stream with ${a.Ta.length} pending writes`),a.Ta=[]))}))),a.fa}class ws{constructor(e,t,r,o,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=o,this.removalCallback=i,this.deferred=new It,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((s=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,o,i){const s=Date.now()+r,l=new ws(e,t,s,o,i);return l.start(r),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ps(a,e){if(ot("AsyncQueue",`${e}: ${a}`),za(a))return new L(D.UNAVAILABLE,`${e}: ${a}`);throw a}class Ea{static emptySet(e){return new Ea(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||N.comparator(t.key,r.key):(t,r)=>N.comparator(t.key,r.key),this.keyedMap=dr(),this.sortedSet=new re(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ea)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,i=r.getNext().key;if(!o.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Ea;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class tu{constructor(){this.ga=new re(N.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):O(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Ra{constructor(e,t,r,o,i,s,l,d,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=l,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,o,i){const s=[];return t.forEach((l=>{s.push({type:0,doc:l})})),new Ra(e,t,Ea.emptySet(t),s,r,o,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==r[o].type||!t[o].doc.isEqual(r[o].doc))return!1;return!0}}class I_{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class k_{constructor(){this.queries=au(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const o=U(t),i=o.queries;o.queries=au(),i.forEach(((s,l)=>{for(const d of l.Sa)d.onError(r)}))})(this,new L(D.ABORTED,"Firestore shutting down"))}}function au(){return new oa((a=>em(a)),gn)}async function C_(a,e){const t=U(a);let r=3;const o=e.query;let i=t.queries.get(o);i?!i.ba()&&e.Da()&&(r=2):(i=new I_,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(o,!0);break;case 1:i.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(s){const l=Ps(s,`Initialization of query '${pa(e.query)}' failed`);return void e.onError(l)}t.queries.set(o,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Ts(t)}async function S_(a,e){const t=U(a),r=e.query;let o=3;const i=t.queries.get(r);if(i){const s=i.Sa.indexOf(e);s>=0&&(i.Sa.splice(s,1),i.Sa.length===0?o=e.Da()?0:1:!i.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function R_(a,e){const t=U(a);let r=!1;for(const o of e){const i=o.query,s=t.queries.get(i);if(s){for(const l of s.Sa)l.Fa(o)&&(r=!0);s.wa=o}}r&&Ts(t)}function D_(a,e,t){const r=U(a),o=r.queries.get(e);if(o)for(const i of o.Sa)i.onError(t);r.queries.delete(e)}function Ts(a){a.Ca.forEach((e=>{e.next()}))}var Ni,ru;(ru=Ni||(Ni={})).Ma="default",ru.Cache="cache";class M_{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)o.type!==3&&r.push(o);e=new Ra(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ra.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ni.Cache}}class Vm{constructor(e){this.key=e}}class xm{constructor(e){this.key=e}}class F_{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=K(),this.mutatedKeys=K(),this.eu=tm(e),this.tu=new Ea(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new tu,o=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,s=o,l=!1;const d=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((p,g)=>{const E=o.get(p),C=fn(this.query,g)?g:null,I=!!E&&this.mutatedKeys.has(E.key),R=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let k=!1;E&&C?E.data.isEqual(C.data)?I!==R&&(r.track({type:3,doc:C}),k=!0):this.su(E,C)||(r.track({type:2,doc:C}),k=!0,(d&&this.eu(C,d)>0||m&&this.eu(C,m)<0)&&(l=!0)):!E&&C?(r.track({type:0,doc:C}),k=!0):E&&!C&&(r.track({type:1,doc:E}),k=!0,(d||m)&&(l=!0)),k&&(C?(s=s.add(C),i=R?i.add(p):i.delete(p)):(s=s.delete(p),i=i.delete(p)))})),this.query.limit!==null)for(;s.size>this.query.limit;){const p=this.query.limitType==="F"?s.last():s.first();s=s.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{tu:s,iu:r,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,o){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort(((p,g)=>(function(C,I){const R=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return O(20277,{Rt:k})}};return R(C)-R(I)})(p.type,g.type)||this.eu(p.doc,g.doc))),this.ou(r),o=o??!1;const l=t&&!o?this._u():[],d=this.Xa.size===0&&this.current&&!o?1:0,m=d!==this.Za;return this.Za=d,s.length!==0||m?{snapshot:new Ra(this.query,e.tu,i,s,e.mutatedKeys,d===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new tu,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=K(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new xm(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new Vm(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=K();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ra.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Is="SyncEngine";class V_{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class x_{constructor(e){this.key=e,this.hu=!1}}class L_{constructor(e,t,r,o,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=o,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new oa((l=>em(l)),gn),this.Iu=new Map,this.Eu=new Set,this.du=new re(N.comparator),this.Au=new Map,this.Ru=new gs,this.Vu={},this.mu=new Map,this.fu=Sa.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function N_(a,e,t=!0){const r=qm(a);let o;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),o=i.view.lu()):o=await Lm(r,e,t,!0),o}async function O_(a,e){const t=qm(a);await Lm(t,e,!0,!1)}async function Lm(a,e,t,r){const o=await t_(a.localStore,je(e)),i=o.targetId,s=a.sharedClientState.addLocalQueryTarget(i,t);let l;return r&&(l=await B_(a,e,i,s==="current",o.resumeToken)),a.isPrimaryClient&&t&&Cm(a.remoteStore,o),l}async function B_(a,e,t,r,o){a.pu=(g,E,C)=>(async function(R,k,x,z){let j=k.view.ru(x);j.Cs&&(j=await Ql(R.localStore,k.query,!1).then((({documents:b})=>k.view.ru(b,j))));const Y=z&&z.targetChanges.get(k.targetId),G=z&&z.targetMismatches.get(k.targetId)!=null,Q=k.view.applyChanges(j,R.isPrimaryClient,Y,G);return nu(R,k.targetId,Q.au),Q.snapshot})(a,g,E,C);const i=await Ql(a.localStore,e,!0),s=new F_(e,i.Qs),l=s.ru(i.documents),d=qr.createSynthesizedTargetChangeForCurrentChange(t,r&&a.onlineState!=="Offline",o),m=s.applyChanges(l,a.isPrimaryClient,d);nu(a,t,m.au);const p=new V_(e,t,s);return a.Tu.set(e,p),a.Iu.has(t)?a.Iu.get(t).push(e):a.Iu.set(t,[e]),m.snapshot}async function z_(a,e,t){const r=U(a),o=r.Tu.get(e),i=r.Iu.get(o.targetId);if(i.length>1)return r.Iu.set(o.targetId,i.filter((s=>!gn(s,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await xi(r.localStore,o.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(o.targetId),t&&Es(r.remoteStore,o.targetId),Oi(r,o.targetId)})).catch(Ba)):(Oi(r,o.targetId),await xi(r.localStore,o.targetId,!0))}async function q_(a,e){const t=U(a),r=t.Tu.get(e),o=t.Iu.get(r.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Es(t.remoteStore,r.targetId))}async function U_(a,e,t){const r=Q_(a);try{const o=await(function(s,l){const d=U(s),m=ae.now(),p=l.reduce(((C,I)=>C.add(I.key)),K());let g,E;return d.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let I=nt(),R=K();return d.Ns.getEntries(C,p).next((k=>{I=k,I.forEach(((x,z)=>{z.isValidDocument()||(R=R.add(x))}))})).next((()=>d.localDocuments.getOverlayedDocuments(C,I))).next((k=>{g=k;const x=[];for(const z of l){const j=eE(z,g.get(z.key).overlayedDocument);j!=null&&x.push(new Lt(z.key,j,Hd(j.value.mapValue),Me.exists(!0)))}return d.mutationQueue.addMutationBatch(C,m,x,l)})).next((k=>{E=k;const x=k.applyToLocalDocumentSet(g,R);return d.documentOverlayCache.saveOverlays(C,k.batchId,x)}))})).then((()=>({batchId:E.batchId,changes:rm(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(o.batchId),(function(s,l,d){let m=s.Vu[s.currentUser.toKey()];m||(m=new re(W)),m=m.insert(l,d),s.Vu[s.currentUser.toKey()]=m})(r,o.batchId,t),await jr(r,o.changes),await wn(r.remoteStore)}catch(o){const i=Ps(o,"Failed to persist write");t.reject(i)}}async function Nm(a,e){const t=U(a);try{const r=await YE(t.localStore,e);e.targetChanges.forEach(((o,i)=>{const s=t.Au.get(i);s&&(X(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?s.hu=!0:o.modifiedDocuments.size>0?X(s.hu,14607):o.removedDocuments.size>0&&(X(s.hu,42227),s.hu=!1))})),await jr(t,r,e)}catch(r){await Ba(r)}}function ou(a,e,t){const r=U(a);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const o=[];r.Tu.forEach(((i,s)=>{const l=s.view.va(e);l.snapshot&&o.push(l.snapshot)})),(function(s,l){const d=U(s);d.onlineState=l;let m=!1;d.queries.forEach(((p,g)=>{for(const E of g.Sa)E.va(l)&&(m=!0)})),m&&Ts(d)})(r.eventManager,e),o.length&&r.Pu.H_(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function j_(a,e,t){const r=U(a);r.sharedClientState.updateQueryState(e,"rejected",t);const o=r.Au.get(e),i=o&&o.key;if(i){let s=new re(N.comparator);s=s.insert(i,Pe.newNoDocument(i,q.min()));const l=K().add(i),d=new _n(q.min(),new Map,new re(W),s,l);await Nm(r,d),r.du=r.du.remove(i),r.Au.delete(e),ks(r)}else await xi(r.localStore,e,!1).then((()=>Oi(r,e,t))).catch(Ba)}async function $_(a,e){const t=U(a),r=e.batch.batchId;try{const o=await XE(t.localStore,e);Bm(t,r,null),Om(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await jr(t,o)}catch(o){await Ba(o)}}async function G_(a,e,t){const r=U(a);try{const o=await(function(s,l){const d=U(s);return d.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let p;return d.mutationQueue.lookupMutationBatch(m,l).next((g=>(X(g!==null,37113),p=g.keys(),d.mutationQueue.removeMutationBatch(m,g)))).next((()=>d.mutationQueue.performConsistencyCheck(m))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(m,p,l))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,p))).next((()=>d.localDocuments.getDocuments(m,p)))}))})(r.localStore,e);Bm(r,e,t),Om(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await jr(r,o)}catch(o){await Ba(o)}}function Om(a,e){(a.mu.get(e)||[]).forEach((t=>{t.resolve()})),a.mu.delete(e)}function Bm(a,e,t){const r=U(a);let o=r.Vu[r.currentUser.toKey()];if(o){const i=o.get(e);i&&(t?i.reject(t):i.resolve(),o=o.remove(e)),r.Vu[r.currentUser.toKey()]=o}}function Oi(a,e,t=null){a.sharedClientState.removeLocalQueryTarget(e);for(const r of a.Iu.get(e))a.Tu.delete(r),t&&a.Pu.yu(r,t);a.Iu.delete(e),a.isPrimaryClient&&a.Ru.jr(e).forEach((r=>{a.Ru.containsKey(r)||zm(a,r)}))}function zm(a,e){a.Eu.delete(e.path.canonicalString());const t=a.du.get(e);t!==null&&(Es(a.remoteStore,t),a.du=a.du.remove(e),a.Au.delete(t),ks(a))}function nu(a,e,t){for(const r of t)r instanceof Vm?(a.Ru.addReference(r.key,e),H_(a,r)):r instanceof xm?(V(Is,"Document no longer in limbo: "+r.key),a.Ru.removeReference(r.key,e),a.Ru.containsKey(r.key)||zm(a,r.key)):O(19791,{wu:r})}function H_(a,e){const t=e.key,r=t.path.canonicalString();a.du.get(t)||a.Eu.has(r)||(V(Is,"New document in limbo: "+t),a.Eu.add(r),ks(a))}function ks(a){for(;a.Eu.size>0&&a.du.size<a.maxConcurrentLimboResolutions;){const e=a.Eu.values().next().value;a.Eu.delete(e);const t=new N(te.fromString(e)),r=a.fu.next();a.Au.set(r,new x_(t)),a.du=a.du.insert(t,r),Cm(a.remoteStore,new _t(je(Zd(t.path)),r,"TargetPurposeLimboResolution",dn.ce))}}async function jr(a,e,t){const r=U(a),o=[],i=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach(((l,d)=>{s.push(r.pu(d,e,t).then((m=>{if((m||t)&&r.isPrimaryClient){const p=m?!m.fromCache:t?.targetChanges.get(d.targetId)?.current;r.sharedClientState.updateQueryState(d.targetId,p?"current":"not-current")}if(m){o.push(m);const p=ys.As(d.targetId,m);i.push(p)}})))})),await Promise.all(s),r.Pu.H_(o),await(async function(d,m){const p=U(d);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>S.forEach(m,(E=>S.forEach(E.Es,(C=>p.persistence.referenceDelegate.addReference(g,E.targetId,C))).next((()=>S.forEach(E.ds,(C=>p.persistence.referenceDelegate.removeReference(g,E.targetId,C)))))))))}catch(g){if(!za(g))throw g;V(vs,"Failed to update sequence numbers: "+g)}for(const g of m){const E=g.targetId;if(!g.fromCache){const C=p.Ms.get(E),I=C.snapshotVersion,R=C.withLastLimboFreeSnapshotVersion(I);p.Ms=p.Ms.insert(E,R)}}})(r.localStore,i))}async function W_(a,e){const t=U(a);if(!t.currentUser.isEqual(e)){V(Is,"User change. New user:",e.toKey());const r=await Pm(t.localStore,e);t.currentUser=e,(function(i,s){i.mu.forEach((l=>{l.forEach((d=>{d.reject(new L(D.CANCELLED,s))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await jr(t,r.Ls)}}function K_(a,e){const t=U(a),r=t.Au.get(e);if(r&&r.hu)return K().add(r.key);{let o=K();const i=t.Iu.get(e);if(!i)return o;for(const s of i){const l=t.Tu.get(s);o=o.unionWith(l.view.nu)}return o}}function qm(a){const e=U(a);return e.remoteStore.remoteSyncer.applyRemoteEvent=Nm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=K_.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=j_.bind(null,e),e.Pu.H_=R_.bind(null,e.eventManager),e.Pu.yu=D_.bind(null,e.eventManager),e}function Q_(a){const e=U(a);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$_.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=G_.bind(null,e),e}class Jo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bn(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return JE(this.persistence,new WE,e.initialUser,this.serializer)}Cu(e){return new wm(fs.mi,this.serializer)}Du(e){return new r_}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jo.provider={build:()=>new Jo};class J_ extends Jo{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){X(this.persistence.referenceDelegate instanceof Ko,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ME(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ce.withCacheSize(this.cacheSizeBytes):Ce.DEFAULT;return new wm((r=>Ko.mi(r,t)),this.serializer)}}class Bi{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ou(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=W_.bind(null,this.syncEngine),await T_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new k_})()}createDatastore(e){const t=bn(e.databaseInfo.databaseId),r=(function(i){return new c_(i)})(e.databaseInfo);return(function(i,s,l,d){return new m_(i,s,l,d)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,o,i,s,l){return new h_(r,o,i,s,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>ou(this.syncEngine,t,0)),(function(){return Yl.v()?new Yl:new o_})())}createSyncEngine(e,t){return(function(o,i,s,l,d,m,p){const g=new L_(o,i,s,l,d,m);return p&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=U(t);V(aa,"RemoteStore shutting down."),r.Ea.add(5),await Ur(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Bi.provider={build:()=>new Bi};class X_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ot("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Ft="FirestoreClient";class Y_{constructor(e,t,r,o,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=o,this.user=we.UNAUTHENTICATED,this.clientId=os.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async s=>{V(Ft,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,(s=>(V(Ft,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new It;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ps(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function di(a,e){a.asyncQueue.verifyOperationInProgress(),V(Ft,"Initializing OfflineComponentProvider");const t=a.configuration;await e.initialize(t);let r=t.initialUser;a.setCredentialChangeListener((async o=>{r.isEqual(o)||(await Pm(e.localStore,o),r=o)})),e.persistence.setDatabaseDeletedListener((()=>a.terminate())),a._offlineComponents=e}async function iu(a,e){a.asyncQueue.verifyOperationInProgress();const t=await Z_(a);V(Ft,"Initializing OnlineComponentProvider"),await e.initialize(t,a.configuration),a.setCredentialChangeListener((r=>eu(e.remoteStore,r))),a.setAppCheckTokenChangeListener(((r,o)=>eu(e.remoteStore,o))),a._onlineComponents=e}async function Z_(a){if(!a._offlineComponents)if(a._uninitializedComponentsProvider){V(Ft,"Using user provided OfflineComponentProvider");try{await di(a,a._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===D.FAILED_PRECONDITION||o.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Ta("Error using user provided cache. Falling back to memory cache: "+t),await di(a,new Jo)}}else V(Ft,"Using default OfflineComponentProvider"),await di(a,new J_(void 0));return a._offlineComponents}async function Um(a){return a._onlineComponents||(a._uninitializedComponentsProvider?(V(Ft,"Using user provided OnlineComponentProvider"),await iu(a,a._uninitializedComponentsProvider._online)):(V(Ft,"Using default OnlineComponentProvider"),await iu(a,new Bi))),a._onlineComponents}function eb(a){return Um(a).then((e=>e.syncEngine))}async function tb(a){const e=await Um(a),t=e.eventManager;return t.onListen=N_.bind(null,e.syncEngine),t.onUnlisten=z_.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=O_.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=q_.bind(null,e.syncEngine),t}function ab(a,e,t={}){const r=new It;return a.asyncQueue.enqueueAndForget((async()=>(function(i,s,l,d,m){const p=new X_({next:E=>{p.Nu(),s.enqueueAndForget((()=>S_(i,g))),E.fromCache&&d.source==="server"?m.reject(new L(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(E)},error:E=>m.reject(E)}),g=new M_(l,p,{includeMetadataChanges:!0,qa:!0});return C_(i,g)})(await tb(a),a.asyncQueue,e,t,r))),r.promise}function jm(a){const e={};return a.timeoutSeconds!==void 0&&(e.timeoutSeconds=a.timeoutSeconds),e}const su=new Map;const $m="firestore.googleapis.com",cu=!0;class lu{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new L(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$m,this.ssl=cu}else this.host=e.host,this.ssl=e.ssl??cu;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Am;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<RE)throw new L(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jm(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,o){return r.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Pn{constructor(e,t,r,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lu(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new av;switch(r.type){case"firstParty":return new iv(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=su.get(t);r&&(V("ComponentProvider","Removing Datastore"),su.delete(t),r.terminate())})(this),Promise.resolve()}}function rb(a,e,t,r={}){a=ta(a,Pn);const o=xa(e),i=a._getSettings(),s={...i,emulatorOptions:a._getEmulatorOptions()},l=`${e}:${t}`;o&&(zu(`https://${l}`),qu("Firestore",!0)),i.host!==$m&&i.host!==l&&Ta("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...i,host:l,ssl:o,emulatorOptions:r};if(!Xt(d,s)&&(a._setSettings(d),r.mockUserToken)){let m,p;if(typeof r.mockUserToken=="string")m=r.mockUserToken,p=we.MOCK_USER;else{m=kh(r.mockUserToken,a._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new L(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new we(g)}a._authCredentials=new rv(new Vd(m,p))}}class Tn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Tn(this.firestore,e,this._query)}}class he{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new he(this.firestore,e,this._key)}toJSON(){return{type:he._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Br(t,he._jsonSchema))return new he(e,r||null,new N(te.fromString(t.referencePath)))}}he._jsonSchemaVersion="firestore/documentReference/1.0",he._jsonSchema={type:se("string",he._jsonSchemaVersion),referencePath:se("string")};class kt extends Tn{constructor(e,t,r){super(e,t,Zd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new he(this.firestore,null,new N(e))}withConverter(e){return new kt(this.firestore,e,this._path)}}function ob(a,e,...t){if(a=Ee(a),xd("collection","path",e),a instanceof Pn){const r=te.fromString(e,...t);return wl(r),new kt(a,null,r)}{if(!(a instanceof he||a instanceof kt))throw new L(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=a._path.child(te.fromString(e,...t));return wl(r),new kt(a.firestore,null,r)}}function Cs(a,e,...t){if(a=Ee(a),arguments.length===1&&(e=os.newId()),xd("doc","path",e),a instanceof Pn){const r=te.fromString(e,...t);return Al(r),new he(a,null,new N(r))}{if(!(a instanceof he||a instanceof kt))throw new L(D.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=a._path.child(te.fromString(e,...t));return Al(r),new he(a.firestore,a instanceof kt?a.converter:null,new N(r))}}const uu="AsyncQueue";class du{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Im(this,"async_queue_retry"),this._c=()=>{const r=ui();r&&V(uu,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=ui();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ui();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new It;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!za(e))throw e;V(uu,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,ot("INTERNAL UNHANDLED ERROR: ",mu(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=ws.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(o),o}uc(){this.nc&&O(47125,{Pc:mu(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function mu(a){let e=a.message||"";return a.stack&&(e=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),e}class $r extends Pn{constructor(e,t,r,o){super(e,t,r,o),this.type="firestore",this._queue=new du,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new du(e),this._firestoreClient=void 0,await e}}}function nb(a,e){const t=typeof a=="object"?a:Gu(),r=typeof a=="string"?a:Uo,o=Hi(t,"firestore").getImmediate({identifier:r});if(!o._initialized){const i=Th("firestore");i&&rb(o,...i)}return o}function Ss(a){if(a._terminated)throw new L(D.FAILED_PRECONDITION,"The client has already been terminated.");return a._firestoreClient||ib(a),a._firestoreClient}function ib(a){const e=a._freezeSettings(),t=(function(o,i,s,l){return new wv(o,i,s,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,jm(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(a._databaseId,a._app?.options.appId||"",a._persistenceKey,e);a._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(a._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),a._firestoreClient=new Y_(a._authCredentials,a._appCheckCredentials,a._queue,t,a._componentsProvider&&(function(o){const i=o?._online.build();return{_offline:o?._offline.build(i),_online:i}})(a._componentsProvider))}class Ve{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ve(_e.fromBase64String(e))}catch(t){throw new L(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ve(_e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ve._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Br(e,Ve._jsonSchema))return Ve.fromBase64String(e.bytes)}}Ve._jsonSchemaVersion="firestore/bytes/1.0",Ve._jsonSchema={type:se("string",Ve._jsonSchemaVersion),bytes:se("string")};class In{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ye(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class kn{constructor(e){this._methodName=e}}class Ge{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return W(this._lat,e._lat)||W(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ge._jsonSchemaVersion}}static fromJSON(e){if(Br(e,Ge._jsonSchema))return new Ge(e.latitude,e.longitude)}}Ge._jsonSchemaVersion="firestore/geoPoint/1.0",Ge._jsonSchema={type:se("string",Ge._jsonSchemaVersion),latitude:se("number"),longitude:se("number")};class He{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,o){if(r.length!==o.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==o[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:He._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Br(e,He._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new He(e.vectorValues);throw new L(D.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}He._jsonSchemaVersion="firestore/vectorValue/1.0",He._jsonSchema={type:se("string",He._jsonSchemaVersion),vectorValues:se("object")};const sb=/^__.*__$/;class cb{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Lt(e,this.data,this.fieldMask,t,this.fieldTransforms):new zr(e,this.data,t,this.fieldTransforms)}}class Gm{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Lt(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Hm(a){switch(a){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw O(40011,{Ac:a})}}class Rs{constructor(e,t,r,o,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=o,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Rs({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Xo(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Hm(this.Ac)&&sb.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class lb{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||bn(e)}Cc(e,t,r,o=!1){return new Rs({Ac:e,methodName:t,Dc:r,path:ye.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wm(a){const e=a._freezeSettings(),t=bn(a._databaseId);return new lb(a._databaseId,!!e.ignoreUndefinedProperties,t)}function Km(a,e,t,r,o,i={}){const s=a.Cc(i.merge||i.mergeFields?2:0,e,t,o);Ms("Data must be an object, but it was:",s,r);const l=Qm(r,s);let d,m;if(i.merge)d=new De(s.fieldMask),m=s.fieldTransforms;else if(i.mergeFields){const p=[];for(const g of i.mergeFields){const E=zi(e,g,t);if(!s.contains(E))throw new L(D.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);Xm(p,E)||p.push(E)}d=new De(p),m=s.fieldTransforms.filter((g=>d.covers(g.field)))}else d=null,m=s.fieldTransforms;return new cb(new Se(l),d,m)}class Cn extends kn{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cn}}class Ds extends kn{_toFieldTransform(e){return new Jv(e.path,new kr)}isEqual(e){return e instanceof Ds}}function ub(a,e,t,r){const o=a.Cc(1,e,t);Ms("Data must be an object, but it was:",o,r);const i=[],s=Se.empty();xt(r,((d,m)=>{const p=Fs(e,d,t);m=Ee(m);const g=o.yc(p);if(m instanceof Cn)i.push(p);else{const E=Sn(m,g);E!=null&&(i.push(p),s.set(p,E))}}));const l=new De(i);return new Gm(s,l,o.fieldTransforms)}function db(a,e,t,r,o,i){const s=a.Cc(1,e,t),l=[zi(e,r,t)],d=[o];if(i.length%2!=0)throw new L(D.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<i.length;E+=2)l.push(zi(e,i[E])),d.push(i[E+1]);const m=[],p=Se.empty();for(let E=l.length-1;E>=0;--E)if(!Xm(m,l[E])){const C=l[E];let I=d[E];I=Ee(I);const R=s.yc(C);if(I instanceof Cn)m.push(C);else{const k=Sn(I,R);k!=null&&(m.push(C),p.set(C,k))}}const g=new De(m);return new Gm(p,g,s.fieldTransforms)}function Sn(a,e){if(Jm(a=Ee(a)))return Ms("Unsupported field value:",e,a),Qm(a,e);if(a instanceof kn)return(function(r,o){if(!Hm(o.Ac))throw o.Sc(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(o);i&&o.fieldTransforms.push(i)})(a,e),null;if(a===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),a instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,o){const i=[];let s=0;for(const l of r){let d=Sn(l,o.wc(s));d==null&&(d={nullValue:"NULL_VALUE"}),i.push(d),s++}return{arrayValue:{values:i}}})(a,e)}return(function(r,o){if((r=Ee(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Wv(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ae.fromDate(r);return{timestampValue:Wo(o.serializer,i)}}if(r instanceof ae){const i=new ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Wo(o.serializer,i)}}if(r instanceof Ge)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ve)return{bytesValue:gm(o.serializer,r._byteString)};if(r instanceof he){const i=o.databaseId,s=r.firestore._databaseId;if(!s.isEqual(i))throw o.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:hs(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof He)return(function(s,l){return{mapValue:{fields:{[$d]:{stringValue:Gd},[jo]:{arrayValue:{values:s.toArray().map((m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return ds(l.serializer,m)}))}}}}}})(r,o);throw o.Sc(`Unsupported field value: ${ns(r)}`)})(a,e)}function Qm(a,e){const t={};return Od(a)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xt(a,((r,o)=>{const i=Sn(o,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function Jm(a){return!(typeof a!="object"||a===null||a instanceof Array||a instanceof Date||a instanceof ae||a instanceof Ge||a instanceof Ve||a instanceof he||a instanceof kn||a instanceof He)}function Ms(a,e,t){if(!Jm(t)||!Ld(t)){const r=ns(t);throw r==="an object"?e.Sc(a+" a custom object"):e.Sc(a+" "+r)}}function zi(a,e,t){if((e=Ee(e))instanceof In)return e._internalPath;if(typeof e=="string")return Fs(a,e);throw Xo("Field path arguments must be of type string or ",a,!1,void 0,t)}const mb=new RegExp("[~\\*/\\[\\]]");function Fs(a,e,t){if(e.search(mb)>=0)throw Xo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,a,!1,void 0,t);try{return new In(...e.split("."))._internalPath}catch{throw Xo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a,!1,void 0,t)}}function Xo(a,e,t,r,o){const i=r&&!r.isEmpty(),s=o!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let d="";return(i||s)&&(d+=" (found",i&&(d+=` in field ${r}`),s&&(d+=` in document ${o}`),d+=")"),new L(D.INVALID_ARGUMENT,l+a+d)}function Xm(a,e){return a.some((t=>t.isEqual(e)))}class Ym{constructor(e,t,r,o,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=o,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new he(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new pb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Zm("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class pb extends Ym{data(){return super.data()}}function Zm(a,e){return typeof e=="string"?Fs(a,e):e instanceof In?e._internalPath:e._delegate._internalPath}function hb(a){if(a.limitType==="L"&&a.explicitOrderBy.length===0)throw new L(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gb{convertValue(e,t="none"){switch(Dt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ne(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Rt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw O(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return xt(e,((o,i)=>{r[o]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[jo].arrayValue?.values?.map((r=>ne(r.doubleValue)));return new He(t)}convertGeoPoint(e){return new Ge(ne(e.latitude),ne(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=pn(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Pr(e));default:return null}}convertTimestamp(e){const t=St(e);return new ae(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=te.fromString(e);X(bm(r),9688,{name:e});const o=new Tr(r.get(1),r.get(3)),i=new N(r.popFirst(5));return o.isEqual(t)||ot(`Document ${i} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function ep(a,e,t){let r;return r=a?t&&(t.merge||t.mergeFields)?a.toFirestore(e,t):a.toFirestore(e):e,r}class vo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _a extends Ym{constructor(e,t,r,o,i,s){super(e,t,r,o,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Co(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Zm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(D.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=_a._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}_a._jsonSchemaVersion="firestore/documentSnapshot/1.0",_a._jsonSchema={type:se("string",_a._jsonSchemaVersion),bundleSource:se("string","DocumentSnapshot"),bundleName:se("string"),bundle:se("string")};class Co extends _a{data(e={}){return super.data(e)}}class ba{constructor(e,t,r,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new vo(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Co(this._firestore,this._userDataWriter,r.key,r,new vo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,i){if(o._snapshot.oldDocs.isEmpty()){let s=0;return o._snapshot.docChanges.map((l=>{const d=new Co(o._firestore,o._userDataWriter,l.doc.key,l.doc,new vo(o._snapshot.mutatedKeys.has(l.doc.key),o._snapshot.fromCache),o.query.converter);return l.doc,{type:"added",doc:d,oldIndex:-1,newIndex:s++}}))}{let s=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((l=>i||l.type!==3)).map((l=>{const d=new Co(o._firestore,o._userDataWriter,l.doc.key,l.doc,new vo(o._snapshot.mutatedKeys.has(l.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,p=-1;return l.type!==0&&(m=s.indexOf(l.doc.key),s=s.delete(l.doc.key)),l.type!==1&&(s=s.add(l.doc),p=s.indexOf(l.doc.key)),{type:fb(l.type),doc:d,oldIndex:m,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(D.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ba._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=os.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],o=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),o.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function fb(a){switch(a){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return O(61501,{type:a})}}ba._jsonSchemaVersion="firestore/querySnapshot/1.0",ba._jsonSchema={type:se("string",ba._jsonSchemaVersion),bundleSource:se("string","QuerySnapshot"),bundleName:se("string"),bundle:se("string")};class yb extends gb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ve(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new he(this.firestore,null,t)}}function vb(a){a=ta(a,Tn);const e=ta(a.firestore,$r),t=Ss(e),r=new yb(e);return hb(a._query),ab(t,a._query).then((o=>new ba(e,r,a,o)))}function Eb(a,e,t){a=ta(a,he);const r=ta(a.firestore,$r),o=ep(a.converter,e,t);return Vs(r,[Km(Wm(r),"setDoc",a._key,o,a.converter!==null,t).toMutation(a._key,Me.none())])}function _b(a){return Vs(ta(a.firestore,$r),[new En(a._key,Me.none())])}function Vs(a,e){return(function(r,o){const i=new It;return r.asyncQueue.enqueueAndForget((async()=>U_(await eb(r),o,i))),i.promise})(Ss(a),e)}class bb{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wm(e)}set(e,t,r){this._verifyNotCommitted();const o=mi(e,this._firestore),i=ep(o.converter,t,r),s=Km(this._dataReader,"WriteBatch.set",o._key,i,o.converter!==null,r);return this._mutations.push(s.toMutation(o._key,Me.none())),this}update(e,t,r,...o){this._verifyNotCommitted();const i=mi(e,this._firestore);let s;return s=typeof(t=Ee(t))=="string"||t instanceof In?db(this._dataReader,"WriteBatch.update",i._key,t,r,o):ub(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,Me.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=mi(e,this._firestore);return this._mutations=this._mutations.concat(new En(t._key,Me.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new L(D.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function mi(a,e){if((a=Ee(a)).firestore!==e)throw new L(D.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return a}function tp(){return new Ds("serverTimestamp")}function Ab(a){return Ss(a=ta(a,$r)),new bb(a,(e=>Vs(a,e)))}(function(e,t=!0){(function(o){Oa=o})(La),wa(new Yt("firestore",((r,{instanceIdentifier:o,options:i})=>{const s=r.getProvider("app").getImmediate(),l=new $r(new ov(r.getProvider("auth-internal")),new sv(s,r.getProvider("app-check-internal")),(function(m,p){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new L(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tr(m.options.projectId,p)})(s,o),s);return i={useFetchStreams:t,...i},l._setSettings(i),l}),"PUBLIC").setMultipleInstances(!0)),wt(vl,El,e),wt(vl,El,"esm2020")})();const wb={apiKey:"AIzaSyAqeZ8V87ZxTCaqkhVY0cH43plER_7L_Fs",authDomain:"pokemon-companion-pro.firebaseapp.com",projectId:"pokemon-companion-pro",storageBucket:"pokemon-companion-pro.firebasestorage.app",messagingSenderId:"113946186968",appId:"1:113946186968:web:3200750a74f649681ab3ad",measurementId:"G-LHLX84RZQK"},ap=$u(wb),Jt=ev(ap),Rr=nb(ap),pi=new Ye;let Ht=null;hd(Jt,a=>{Ht=a,window.dispatchEvent(new CustomEvent("authStateChanged",{detail:a}))});async function Pb(){try{return(await ly(Jt,pi)).user}catch(a){return console.error("Error signing in with Google:",a),a.code==="auth/popup-closed-by-user"?(console.log("User closed the popup"),null):a.code==="auth/popup-blocked"?(alert("El popup fue bloqueado. Por favor, permite popups para este sitio."),await ll(Jt,pi),null):a.code==="auth/cancelled-popup-request"?(await ll(Jt,pi),null):(a.code==="auth/unauthorized-domain"&&alert("Este dominio no est√° autorizado para el inicio de sesi√≥n con Google. Revisa la configuraci√≥n de Firebase."),null)}}async function Tb(){try{return await jf(Jt),!0}catch(a){return console.error("Error signing out:",a),!1}}function rp(){return Ht||Jt.currentUser}function Ib(a){return hd(Jt,a)}function kb(){return Ht?{uid:Ht.uid,displayName:Ht.displayName||"Usuario",email:Ht.email,photoURL:Ht.photoURL||null}:null}async function op(a,e){try{const t=Ab(Rr);return e.forEach(r=>{const o=Cs(Rr,"users",a,"teams",r.id);t.set(o,{...r,updatedAt:tp()})}),await t.commit(),!0}catch(t){return console.error("Error saving teams to cloud:",t),!1}}async function xs(a){try{const e=ob(Rr,"users",a,"teams"),t=await vb(e),r=[];return t.forEach(o=>{r.push({id:o.id,...o.data()})}),r.sort((o,i)=>(o.createdAt||0)-(i.createdAt||0)),r}catch(e){return console.error("Error getting teams from cloud:",e),[]}}async function Cb(a,e){try{const t=Cs(Rr,"users",a,"teams",e);return await _b(t),!0}catch(t){return console.error("Error deleting team from cloud:",t),!1}}async function Sb(a,e){try{const t=Cs(Rr,"users",a,"settings","preferences");return await Eb(t,{...e,updatedAt:tp()}),!0}catch(t){return console.error("Error saving preferences to cloud:",t),!1}}async function Rb(a,e,t){try{return(await xs(a)).length===0&&e.length>0&&(console.log("Migrating local teams to cloud..."),await op(a,e)),t&&await Sb(a,t),!0}catch(r){return console.error("Error migrating data to cloud:",r),!1}}const Db="poke_companion_teams_",Ls="poke_companion_active_team_id";function Ns(){return Db+ve()}function Mb(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function pu(a){return a.trim().toLowerCase()}function np(a,e=null){const t=pu(a);return Nt().some(r=>e&&r.id===e?!1:pu(r.name)===t)}function Nt(){try{const a=localStorage.getItem(Ns());return a?JSON.parse(a):[]}catch(a){return console.error("Error loading teams",a),[]}}function Os(){localStorage.removeItem(Ns()),localStorage.removeItem(Ls)}function Ua(a){localStorage.setItem(Ns(),JSON.stringify(a));const e=rp();console.log("[TeamManager] Saving teams. User authenticated:",!!e,e?.uid),e&&(console.log("[TeamManager] Syncing",a.length,"teams to cloud for user:",e.uid),op(e.uid,a).then(()=>console.log("[TeamManager] ‚úÖ Cloud sync successful")).catch(t=>{console.warn("[TeamManager] ‚ùå Failed to sync teams to cloud:",t)}))}function ip(a="Nuevo Equipo"){if(np(a))return alert("Ya existe un equipo con ese nombre."),null;const e=Nt(),t={id:Mb(),name:a,game:ve(),slots:Array(6).fill(null),createdAt:Date.now()};return e.push(t),Ua(e),ja(t.id),t}function Rn(){return localStorage.getItem(Ls)}function ja(a){localStorage.setItem(Ls,a),window.dispatchEvent(new CustomEvent("teamChanged",{detail:a}))}function xe(){const a=Nt(),e=Rn();let t=a.find(r=>r.id===e);return!t&&a.length>0&&(t=a[0],ja(t.id)),t||(t=ip("Mi Equipo Principal")),t}function Dn(a){const e=Nt(),t=Rn(),r=e.findIndex(o=>o.id===t);r!==-1&&(e[r].slots=a,Ua(e))}function Fb(a,e){if(np(e,a))return alert("Ya existe un equipo con ese nombre."),!1;const t=Nt(),r=t.find(o=>o.id===a);return r?(r.name=e,Ua(t),window.dispatchEvent(new CustomEvent("teamListUpdated")),!0):!1}function Vb(a){let e=Nt();if(e.length<=1){alert("No puedes borrar el √∫ltimo equipo.");return}e=e.filter(r=>r.id!==a),Ua(e),Rn()===a?ja(e[0].id):window.dispatchEvent(new CustomEvent("teamListUpdated"));const t=rp();t&&Cb(t.uid,a).then(()=>console.log("[TeamManager] ‚úÖ Cloud delete successful")).catch(r=>{console.warn("[TeamManager] ‚ùå Failed to delete team from cloud:",r)})}const Dr=[{name:"Piedra Fuego",category:"Evoluci√≥n",loc:"Senda √çgnea (Fuerza) / Parte Roja",img:"fire-stone",desc:"Evoluciona a Vulpix, Growlithe, Eevee."},{name:"Piedra Agua",category:"Evoluci√≥n",loc:"Nao Abandonada / Parte Azul",img:"water-stone",desc:"Evoluciona a Poliwhirl, Shellder, Staryu, Eevee, Lombre."},{name:"Piedra Trueno",category:"Evoluci√≥n",loc:"Malvalanova / Parte Amarilla",img:"thunder-stone",desc:"Evoluciona a Pikachu, Eevee."},{name:"Piedra Hoja",category:"Evoluci√≥n",loc:"Ruta 119 / Parte Verde",img:"leaf-stone",desc:"Evoluciona a Gloom, Weepinbell, Exeggcute, Nuzleaf."},{name:"Piedra Lunar",category:"Evoluci√≥n",loc:"Cascada Meteoro / Lunatone (5%)",img:"moon-stone",desc:"Evoluciona a Nidorina/o, Clefairy, Jigglypuff, Skitty."},{name:"Piedra Solar",category:"Evoluci√≥n",loc:"Centro Espacial / Solrock (5%)",img:"sun-stone",desc:"Evoluciona a Gloom, Sunkern."},{name:"Escama Drag√≥n",category:"Evoluci√≥n",loc:"Bagon/Horsea (5%) / Pilar Celeste",img:"dragon-scale",desc:"Evoluciona Seadra a Kingdra (Intercambio)."},{name:"Revestimiento Met√°lico",category:"Evoluci√≥n",loc:"Malvalanova / Magnemite (5%)",img:"metal-coat",desc:"Evoluciona Onix/Scyther (Intercambio). Potencia Acero."},{name:"Roca del Rey",category:"Evoluci√≥n",loc:"Ciudad Algaria (M√°ximo) / Recogida",img:"kings-rock",desc:"Evoluciona Poliwhirl/Slowpoke (Intercambio). Puede hacer retroceder."},{name:"Mejora",category:"Evoluci√≥n",loc:"Torre Batalla (Premio)",img:"up-grade",desc:"Evoluciona Porygon a Porygon2."},{name:"Diente Marino",category:"Evoluci√≥n",loc:"Ciudad Portual (Esc√°ner)",img:"deep-sea-tooth",desc:"Evoluciona Clamperl a Huntail. Dobla At. Esp de Clamperl."},{name:"Escama Marina",category:"Evoluci√≥n",loc:"Ciudad Portual (Esc√°ner)",img:"deep-sea-scale",desc:"Evoluciona Clamperl a Gorebyss. Dobla Def. Esp de Clamperl."},{name:"Restos",category:"Combate",loc:"S.S. Tidal (Basura) / Torre Batalla",img:"leftovers",desc:"Recupera 1/16 PS cada turno."},{name:"Cinta Elegida",category:"Combate",loc:"Torre Batalla (64 BP)",img:"choice-band",desc:"Sube Ataque x1.5 pero bloquea movimiento."},{name:"Banda Focus",category:"Combate",loc:"Torre Batalla (64 BP)",img:"focus-band",desc:"10% probabilidad de aguantar con 1 PS."},{name:"Periscopio",category:"Combate",loc:"Torre Batalla (64 BP)",img:"scope-lens",desc:"Aumenta √≠ndice de golpe cr√≠tico."},{name:"Hierba Blanca",category:"Combate",loc:"Torre Batalla (48 BP)",img:"white-herb",desc:"Restaura stats bajados una vez."},{name:"Hierba Mental",category:"Combate",loc:"Ciudad Arborada / Torre Batalla",img:"mental-herb",desc:"Cura atracci√≥n y mofa."},{name:"Garra R√°pida",category:"Combate",loc:"Ciudad F√©rrica (Escuela)",img:"quick-claw",desc:"20% probabilidad de atacar primero."},{name:"Campana Concha",category:"Combate",loc:"Cueva Cardumen (4 Sales/Conchas)",img:"shell-bell",desc:"Cura 1/8 del da√±o infligido."},{name:"Polvo Brillo",category:"Combate",loc:"Torre Batalla (64 BP)",img:"bright-powder",desc:"Baja la precisi√≥n del rival."},{name:"Lodo Negro",category:"Combate",loc:"Grimer/Muk (5%)",img:"black-sludge",desc:"Cura a Veneno, da√±a a otros."},{name:"Cintur√≥n Negro",category:"Combate",loc:"Ruta 115",img:"black-belt",desc:"Potencia tipo Lucha (+10%)."},{name:"Gafas de Sol",category:"Combate",loc:"Ruta 116",img:"black-glasses",desc:"Potencia tipo Siniestro (+10%)."},{name:"Carb√≥n",category:"Combate",loc:"Lavacalda (Herborister√≠a)",img:"charcoal",desc:"Potencia tipo Fuego (+10%)."},{name:"Colmillo Drag√≥n",category:"Combate",loc:"Cascada Meteoro (Drac√≥nida)",img:"dragon-fang",desc:"Potencia tipo Drag√≥n (+10%)."},{name:"Piedra Dura",category:"Combate",loc:"Casa Treta / Nao Abandonada",img:"hard-stone",desc:"Potencia tipo Roca (+10%)."},{name:"Im√°n",category:"Combate",loc:"Malvalanova",img:"magnet",desc:"Potencia tipo El√©ctrico (+10%)."},{name:"Semilla Milagro",category:"Combate",loc:"Ruta 104 (Bosque Petalia)",img:"miracle-seed",desc:"Potencia tipo Planta (+10%)."},{name:"Agua M√≠stica",category:"Combate",loc:"Forma Castform (Instituto Meteorol√≥gico)",img:"mystic-water",desc:"Potencia tipo Agua (+10%)."},{name:"Antiderretir",category:"Combate",loc:"Cueva Cardumen",img:"never-melt-ice",desc:"Potencia tipo Hielo (+10%)."},{name:"Flecha Venenosa",category:"Combate",loc:"Roselia/Cacnea salvaje (5%)",img:"poison-barb",desc:"Potencia tipo Veneno (+10%)."},{name:"Pico Afilado",category:"Combate",loc:"Ruta 124 / Doduo salvaje",img:"sharp-beak",desc:"Potencia tipo Volador (+10%)."},{name:"Pa√±uelo Seda",category:"Combate",loc:"Pueblo Azuliza",img:"silk-scarf",desc:"Potencia tipo Normal (+10%)."},{name:"Polvo Plata",category:"Combate",loc:"Ruta 120 / Masquerain salvaje",img:"silver-powder",desc:"Potencia tipo Bicho (+10%)."},{name:"Arena Fina",category:"Combate",loc:"Ruta 109 / Trapinch salvaje",img:"soft-sand",desc:"Potencia tipo Tierra (+10%)."},{name:"Hechizo",category:"Combate",loc:"Monte P√≠rico / Shuppet salvaje",img:"spell-tag",desc:"Potencia tipo Fantasma (+10%)."},{name:"Cuchara Torcida",category:"Combate",loc:"Abra salvaje (5%)",img:"twisted-spoon",desc:"Potencia tipo Ps√≠quico (+10%)."},{name:"Repartir Exp",category:"Utilidad",loc:"Ciudad F√©rrica (Sr. Pe√±as)",img:"exp-share",desc:"Comparte experiencia con el equipo."},{name:"Moneda Amuleto",category:"Utilidad",loc:"Vila Raiz (Tras 5¬™ medalla)",img:"amulet-coin",desc:"Doble dinero si participa en combate."},{name:"Huevo Suerte",category:"Utilidad",loc:"Raro (Chansey Salvaje)",img:"lucky-egg",desc:"Gana +50% experiencia."},{name:"Piedra Eterna",category:"Utilidad",loc:"Cueva Granito / Geodude (5%)",img:"everstone",desc:"Impide evoluci√≥n / Hereda naturaleza."},{name:"Campana Alivio",category:"Utilidad",loc:"Club Fans (Portual)",img:"soothe-bell",desc:"Aumenta ganancia de amistad."},{name:"Bola de Humo",category:"Utilidad",loc:"Casa Treta / Koffing (5%)",img:"smoke-ball",desc:"Huida garantizada de salvajes."},{name:"Amuleto",category:"Utilidad",loc:"Monte P√≠rico",img:"cleanse-tag",desc:"Reduce encuentros salvajes (1er slot)."},{name:"Vestidura",category:"Utilidad",loc:"Ruta 111 (Familia Estrate)",img:"macho-brace",desc:"Doble EVs ganados, mitad velocidad."},{name:"Bici Carrera",category:"Clave",loc:"Ciudad Malvalona (Rydel)",img:"mach-bike",desc:"Sube pendientes de barro."},{name:"Bici Acrob√°tica",category:"Clave",loc:"Ciudad Malvalona (Rydel)",img:"acro-bike",desc:"Salta piedras y rieles."},{name:"Ca√±a Vieja",category:"Clave",loc:"Pueblo Azuliza",img:"old-rod",desc:"Pesca Magikarp."},{name:"Ca√±a Buena",category:"Clave",loc:"Ruta 118",img:"good-rod",desc:"Pesca Pok√©mon de nivel medio."},{name:"Superca√±a",category:"Clave",loc:"Ciudad Algaria",img:"super-rod",desc:"Pesca Pok√©mon fuertes."},{name:"Buscaobjetos",category:"Clave",loc:"Ruta 110",img:"itemfinder",desc:"Detecta objetos invisibles."},{name:"Gafas Aislantes",category:"Clave",loc:"Lavacalda (Rival)",img:"go-goggles",desc:"Permite cruzar el desierto."},{name:"Saco Holl√≠n",category:"Clave",loc:"Ruta 113",img:"soot-sack",desc:"Recoge ceniza para flautas/objetos."},{name:"Baya Zidra",category:"Baya",loc:"Rutas / Recogida",img:"sitrus-berry",desc:"Recupera 30 PS."},{name:"Baya Ziuela",category:"Baya",loc:"Rutas / Recogida",img:"lum-berry",desc:"Cura cualquier estado."},{name:"Baya Atania",category:"Baya",loc:"Rutas",img:"chesto-berry",desc:"Despierta al Pok√©mon."},{name:"Baya Caquic",category:"Baya",loc:"Rutas",img:"leppa-berry",desc:"Restaura 10 PP."},{name:"Baya Lichi",category:"Baya",loc:"Isla Espejismo",img:"liechi-berry",desc:"Sube Ataque con PS bajos."},{name:"Baya Gonlan",category:"Baya",loc:"Coliseo / XD",img:"ganlon-berry",desc:"Sube Defensa con PS bajos."},{name:"Baya Aslac",category:"Baya",loc:"Coliseo / XD",img:"salac-berry",desc:"Sube Velocidad con PS bajos."},{name:"Baya Petasi",category:"Baya",loc:"Coliseo / XD",img:"petaya-berry",desc:"Sube At. Esp con PS bajos."},{name:"Baya Yapati",category:"Baya",loc:"Coliseo / XD",img:"apicot-berry",desc:"Sube Def. Esp con PS bajos."},{name:"Pa√±uelo Rojo",category:"Concurso",loc:"Portual (Max Carisma)",img:"red-scarf",desc:"Mejora Carisma en Concursos."},{name:"Pa√±uelo Azul",category:"Concurso",loc:"Portual (Max Belleza)",img:"blue-scarf",desc:"Mejora Belleza en Concursos."},{name:"Pa√±uelo Rosa",category:"Concurso",loc:"Portual (Max Dulzura)",img:"pink-scarf",desc:"Mejora Dulzura en Concursos."},{name:"Pa√±uelo Verde",category:"Concurso",loc:"Portual (Max Ingenio)",img:"green-scarf",desc:"Mejora Ingenio en Concursos."},{name:"Pa√±uelo Amarillo",category:"Concurso",loc:"Portual (Max Dureza)",img:"yellow-scarf",desc:"Mejora Dureza en Concursos."}],Bs=[{name:"Hura√±a (Lonely)",up:"Atk",down:"Def"},{name:"Audaz (Brave)",up:"Atk",down:"Spe"},{name:"Firme (Adamant)",up:"Atk",down:"SpA"},{name:"P√≠cara (Naughty)",up:"Atk",down:"SpD"},{name:"Osada (Bold)",up:"Def",down:"Atk"},{name:"Pl√°cida (Relaxed)",up:"Def",down:"Spe"},{name:"Agitada (Impish)",up:"Def",down:"SpA"},{name:"Floja (Lax)",up:"Def",down:"SpD"},{name:"Miedosa (Timid)",up:"Spe",down:"Atk"},{name:"Activa (Hasty)",up:"Spe",down:"Def"},{name:"Alegre (Jolly)",up:"Spe",down:"SpA"},{name:"Ingenua (Naive)",up:"Spe",down:"SpD"},{name:"Modesta (Modest)",up:"SpA",down:"Atk"},{name:"Afable (Mild)",up:"SpA",down:"Def"},{name:"Mansa (Quiet)",up:"SpA",down:"Spe"},{name:"Alocada (Rash)",up:"SpA",down:"SpD"},{name:"Serena (Calm)",up:"SpD",down:"Atk"},{name:"Amable (Gentle)",up:"SpD",down:"Def"},{name:"Grosera (Sassy)",up:"SpD",down:"Spe"},{name:"Cauta (Careful)",up:"SpD",down:"SpA"},{name:"Fuerte (Hardy)",up:"---",down:"---"},{name:"D√≥cil (Docile)",up:"---",down:"---"},{name:"Seria (Serious)",up:"---",down:"---"},{name:"T√≠mida (Bashful)",up:"---",down:"---"},{name:"Rara (Quirky)",up:"---",down:"---"}],xb=Bs.map(a=>({name:a.name.split(" (")[0],name:a.name,plus:a.up==="---"?"-":a.up,minus:a.down==="---"?"-":a.down}));let Mr=[],Aa=[],Er=!1,So="";const hu={emerald:386,platinum:493,white:649},ra=a=>a?a.charAt(0).toUpperCase()+a.slice(1):"";function Lb(a){const e=a.target,t=e.closest(".slot-remove-btn");t&&t.closest(".team-slot");const r=e.closest(".team-tab");if(r){console.log("Tab Clicked:",r);let o=r.dataset.id;if(!isNaN(o)&&!o.includes("-")&&!o.includes("_")){const i=parseInt(o);String(i)===o&&(o=i)}else{const i=Number(o);isNaN(i)||(o=i)}console.log("Switching to team ID:",o),ja(o),Vt();return}if(e.closest("#btn-new-team")){Ui("create");return}if(e.closest("#btn-rename-team")){const o=xe();Ui("rename",o.name);return}if(e.closest("#btn-delete-team")){zs("team");return}if(e.matches(".btn-retry")){Er=!1,lp();return}}function sp(){const a=document.querySelector(".builder-container");if(!a)return;console.log("Hydrating Team Builder Events..."),a.onclick=Lb;const e=document.getElementById("builder-search");e&&(e.oninput=t=>{qb(t.target.value)}),Nb()}function Nb(){const a=document.getElementById("pokemon-source-list"),e=document.querySelector(".team-slots-container");a&&a.addEventListener("dragstart",t=>{const r=t.target.closest(".source-pokemon-card");if(!r)return;const o=r.dataset.id;console.log("Drag Start Source:",o),t.dataTransfer.setData("text/plain",JSON.stringify({type:"new",id:o})),t.dataTransfer.effectAllowed="copyMove"}),e&&(e.addEventListener("dragstart",t=>{const r=t.target.closest(".team-slot");if(!r||!r.classList.contains("filled"))return;const o=r.dataset.index;console.log("Drag Start Team:",o),t.dataTransfer.setData("text/plain",JSON.stringify({type:"move",index:o})),t.dataTransfer.effectAllowed="copyMove"}),e.addEventListener("dragover",t=>{t.preventDefault(),t.dataTransfer.dropEffect="copy";const r=t.target.closest(".team-slot");r&&r.classList.add("drag-over")}),e.addEventListener("dragleave",t=>{const r=t.target.closest(".team-slot");r&&r.classList.remove("drag-over")}),e.addEventListener("drop",async t=>{t.preventDefault();const r=t.target.closest(".team-slot");if(!r)return;r.classList.remove("drag-over");const o=parseInt(r.dataset.index),i=t.dataTransfer.getData("text/plain");if(i)try{const s=JSON.parse(i);s.type==="new"?await Ub(s.id,o):s.type==="move"&&dp(s.index,o)}catch(s){console.error("Drop Error:",s)}}))}function Ob(){return Mr.length===0&&setTimeout(lp,0),Bb()}function Vt(){const a=document.querySelector(".builder-container");a&&(a.innerHTML=cp(),sp(),up())}function Bb(){return`
        <div class="builder-container" style="display: block; opacity: 1; visibility: visible; min-height: 500px;">
           ${cp()}
        </div>
    `}function cp(){const a=xe(),e=Nt();return`
    <div class="builder-header" style="flex-direction: column; gap:1.5rem; align-items: flex-start;">
        <div style="display:flex; justify-content:space-between; align-items:center; width:100%;">
             <h2 style="margin:0; font-size:1.5rem; background: linear-gradient(to right, #4ade80, #3b82f6); -webkit-background-clip: text; color: transparent;">Constructor de Equipos</h2>
             <div class="team-summary" style="font-size:0.9rem; color:var(--text-muted); background:rgba(255,255,255,0.05); padding:0.3rem 0.8rem; border-radius:100px;">
                ${a.slots.filter(t=>t).length}/6 Pok√©mon
            </div>
        </div>

        <div class="team-selector-wrapper-fix">
            <div class="team-tabs-container-fix">
                ${e.map(t=>`
                    <div class="team-tab ${t.id===a.id?"active":""}" data-id="${t.id}">
                        <span class="tab-name">${t.name}</span>
                        ${t.id===a.id?'<span class="tab-indicator"></span>':""}
                    </div>
                `).join("")}
                <button id="btn-new-team" class="new-team-tab" title="Nuevo Equipo">+</button>
            </div>
            
            <div class="team-actions-fix">
                 <button id="btn-rename-team" class="action-btn-icon" title="Renombrar Equipo">‚úèÔ∏è</button>
                 <button id="btn-delete-team" class="action-btn-icon danger" title="Borrar Equipo">üóëÔ∏è</button>
            </div>
        </div>
    </div>

    <!-- Custom Confirmation Modal -->
    <div id="confirm-modal-overlay" class="modal-overlay hidden" style="z-index: 10000;">
        <div class="confirm-modal">
            <div class="confirm-modal-icon">‚ö†Ô∏è</div>
            <h3>¬øEst√°s seguro?</h3>
            <p id="confirm-modal-text">¬øQuieres eliminar este Pok√©mon del equipo?</p>
            <div class="confirm-actions">
                <button class="btn-cancel" onclick="closeConfirmationModal()">Cancelar</button>
                <button class="btn-confirm-delete" onclick="confirmDelete()">Eliminar</button>
            </div>
        </div>
    </div>

    <!-- Custom Prompt Modal -->
    <div id="prompt-modal-overlay" class="modal-overlay hidden" style="z-index: 10000;">
        <div class="confirm-modal">
            <h3 id="prompt-modal-title">T√≠tulo</h3>
            <div style="width:100%; display:flex; justify-content:center;">
                <input type="text" id="prompt-modal-input" class="prompt-input" placeholder="Nombre..." onkeydown="handlePromptKeydown(event)">
            </div>
            <div class="confirm-actions">
                <button class="btn-cancel" onclick="closePromptModal()">Cancelar</button>
                <button class="btn-confirm-delete" onclick="confirmPrompt()" id="btn-confirm-prompt">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal Placeholder -->
    <div id="edit-modal-overlay" class="modal-overlay hidden">
        <div class="edit-modal">
            <!-- Content injected via JS -->
        </div>
    </div>

    <div class="builder-workspace">
        <div class="team-slots-container">
            ${a.slots.map((t,r)=>zb(t,r)).join("")}
        </div>

        <div class="pokemon-source-panel" style="margin-top: 1.1rem;">
            <div class="search-box-container-fix">
                    <input type="text" id="builder-search" class="search-input-fix" placeholder="Buscar por nombre...">
            </div>
            <div id="pokemon-source-list" class="pokemon-source-list">
                ${Mr.length===0?'<div class="loading-spinner">Cargando Pok√©mon...</div>':""}
            </div>
        </div>
    </div>
    `}function zb(a,e){if(!a)return`
            <div class="team-slot empty" data-index="${e}">
                <div class="slot-empty-content">
                    <span class="slot-number">${e+1}</span>
                    <span class="plus-icon">+</span>
                    <span class="drag-hint">A√±adir</span>
                </div>
            </div>
        `;const t=a.nature?a.nature.name.split("(")[0].trim():"-",r=a.item?a.item.name:"-",o=a.types.map(s=>{const l=s.english?s.english.toLowerCase():(s.spanish||"").toLowerCase(),d=Va[l]||s.spanish||s.english||"???";return`<span class="type-badge-modern type-${l}" title="${d}">
            ${d.substring(0,3).toUpperCase()}
         </span>`}).join(""),i=a.moves?a.moves.map(s=>{if(!s)return"";const l=s.type?`type-${s.type.toLowerCase()}`:"",d=s.displayName||s.name||"???",m=s.typeTranslated||s.type||"???",p=s.power||"-",g=s.accuracy||"-",E=s.damageClassTranslated||s.damageClass||"-",C=s.description||"";return`<div class="move-wrapper">
            <div class="move-pill ${l}">
                <span class="move-type-label">${m.substring(0,3).toUpperCase()}</span>
                <span class="move-name-text">${d}</span>
            </div>
            <div class="move-tooltip">
                <div class="tooltip-header">
                    <span class="tooltip-name">${d}</span>
                    <span class="tooltip-type type-pill ${l}">${m}</span>
                </div>
                <div class="tooltip-category">${E} ¬∑ Pot: ${p} ¬∑ Pre: ${g}%</div>
                <p class="tooltip-desc">${C||"Sin descripci√≥n disponible."}</p>
            </div>
        </div>`}).filter(s=>s).join(""):'<span class="no-moves">Sin ataques</span>';return`
        <div class="team-slot filled slot-card-premium" draggable="true" data-index="${e}" onclick="handleSlotClick(event, ${a.id})">
            <button class="slot-remove-btn" type="button" title="Eliminar" style="z-index: 10;" onclick="event.stopPropagation(); window.openConfirmationModal('pokemon', ${e})">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <button class="slot-edit-btn-ghost" type="button" title="Editar" style="z-index: 10;" onclick="event.stopPropagation(); window.openEditModal(${e})">‚úèÔ∏è</button>
            
            <div class="slot-premium-content">
                <!-- Background Gradient/Effect derived from primary type? -->
                <div class="slot-bg-effect"></div>

                <div class="slot-visual-container">
                    <img src="${a.sprite}" alt="${a.name}" class="slot-sprite-premium" draggable="false">
                </div>

                <div class="slot-info-premium">
                    <div class="slot-header-premium">
                        <span class="slot-name-premium">${a.nickname||a.name}</span>
                        <div class="slot-types-premium">${o}</div>
                    </div>

                    <div class="slot-stats-row">
                        <div class="stat-pill" title="Naturaleza">
                            <span class="stat-icon">üß¨</span>
                            <span class="stat-val">${t}</span>
                        </div>
                        <div class="stat-pill" title="Objeto">
                            <span class="stat-icon">üéí</span>
                            <span class="stat-val">${r}</span>
                        </div>
                    </div>
                    
                    <div class="slot-moves-row">
                        ${i}
                    </div>
                </div>
            </div>
        </div>
    `}function gu(){document.getElementById("edit-modal-overlay").classList.add("hidden")}async function lp(){if(Mr.length>0){qi();return}if(!Er){Er=!0;try{Mr=(await(await fetch("https://pokeapi.co/api/v2/pokemon?limit=649")).json()).results.map((t,r)=>({id:r+1,name:t.name,url:t.url,sprite:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${r+1}.png`})),qi()}catch(a){console.error("Fetch error",a)}finally{Er=!1}}}function up(){const a=document.getElementById("pokemon-source-list");if(!a)return;if(Aa.length===0&&!Er){a.innerHTML='<div class="no-results">No se encontraron</div>';return}const e=Aa.slice(0,100);a.innerHTML=e.map(t=>`
        <div class="source-pokemon-card" draggable="true" data-id="${t.id}">
            <img src="${t.sprite}" class="source-sprite" loading="lazy" draggable="false">
            <span class="source-name">${ra(t.name)}</span>
        </div>
    `).join("")+(Aa.length>100?'<div style="opacity:0.5; text-align:center;">...</div>':"")}function qb(a){So=a.toLowerCase(),qi()}function qi(){const a=ve(),e=hu[a]||hu.emerald;Aa=Mr.filter(t=>t.id<=e),So&&(Aa=Aa.filter(t=>t.name.includes(So)||String(t.id).includes(So))),up()}async function Ub(a,e){try{const t=await on(a),r=t.types.map(l=>({english:l.type.name,spanish:Va[l.type.name]||ra(l.type.name)}));let o=[null,null,null,null];try{const l=ve(),d=await Su(a,l);if(d.length>0){const p=d.slice(-4).reverse().map(E=>nn(E.name));o=[...await Promise.all(p),null,null,null,null].slice(0,4)}}catch(l){console.warn("Auto-suggest moves failed:",l)}const i={id:t.id,name:ra(t.name),nickname:"",sprite:t.sprites.other["official-artwork"].front_default||t.sprites.front_default,types:r,nature:null,item:null,moves:o,image:t.sprites.other["official-artwork"].front_default},s=xe();s.slots[e]=i,Dn(s.slots),Vt()}catch(t){console.error("Add Pokemon Error",t)}}function jb(a,e){a.target.closest(".slot-remove-btn")||a.target.closest(".slot-edit-btn")||window.openPokemonModal&&window.openPokemonModal(e)}window.handleSlotClick=jb;function $b(a){console.log("Function removePokemon called for index:",a),zs("pokemon",a)}window.removePokemon=$b;function dp(a,e){const t=xe();if(a===e)return;const r=t.slots[e];t.slots[e]=t.slots[a],t.slots[a]=r,Dn(t.slots),Vt()}window.movePokemon=dp;function zs(a,e){Zo=a,Us=e;const t=document.getElementById("confirm-modal-overlay"),r=document.getElementById("confirm-modal-text"),o=xe();if(a==="pokemon"){if(!o.slots[e])return;const i=o.slots[e].nickname||o.slots[e].name;r&&(r.textContent=`¬øQuieres eliminar a ${i} del equipo?`)}else a==="team"&&r&&(r.textContent=`¬øQuieres borrar el equipo "${o.name}"? Esta acci√≥n no se puede deshacer.`);t&&t.classList.remove("hidden")}window.openConfirmationModal=zs;function mp(){Us=null,Zo=null;const a=document.getElementById("confirm-modal-overlay");a&&a.classList.add("hidden")}window.closeConfirmationModal=mp;function Gb(){const a=xe();if(Zo==="pokemon"){const e=Us;e!==null&&a.slots[e]&&(a.slots[e]=null,Dn(a.slots),Vt())}else Zo==="team"&&(Vb(a.id),Vt());mp()}window.confirmDelete=Gb;let Yo=null;function Ui(a,e=""){Yo=a;const t=document.getElementById("prompt-modal-overlay"),r=document.getElementById("prompt-modal-title"),o=document.getElementById("prompt-modal-input"),i=document.getElementById("btn-confirm-prompt");a==="create"?(r.textContent="Nuevo Equipo",i.textContent="Crear"):(r.textContent="Renombrar Equipo",i.textContent="Guardar"),o.value=e,t&&t.classList.remove("hidden"),o.focus()}window.openPromptModal=Ui;function qs(){Yo=null;const a=document.getElementById("prompt-modal-overlay");a&&a.classList.add("hidden")}window.closePromptModal=qs;function pp(){const e=document.getElementById("prompt-modal-input").value.trim();if(e){if(Yo==="create"){if(!ip(e))return;Vt()}else if(Yo==="rename"){const t=xe();if(!Fb(t.id,e))return;Vt()}qs()}}window.confirmPrompt=pp;function Hb(a){a.key==="Enter"&&pp(),a.key==="Escape"&&qs()}window.handlePromptKeydown=Hb;let Da=-1,Us=null,Zo=null,Qt=[],Ma=null,Et=null,en=[];window.openEditModal=async a=>{const t=xe().slots[a];if(!t)return;Da=a,Qt=[...t.moves],Ma=t.nature,Et=t.item;let r=document.getElementById("edit-team-modal");r||(document.body.insertAdjacentHTML("beforeend",`
            <div id="edit-team-modal" class="pokemon-modal-container" style="z-index: 2000; display: none;">
                <div class="pokemon-modal-backdrop" onclick="closeEditModal()"></div>
                <div class="pokemon-modal" style="max-width: 600px;">
                    <button class="pokemon-modal-close" onclick="closeEditModal()">‚úï</button>
                    <div class="pokemon-modal-content" id="edit-modal-content">
                        <!-- Content -->
                    </div>
                </div>
            </div>
        `),r=document.getElementById("edit-team-modal"));const o=document.getElementById("edit-modal-content");o.innerHTML='<div style="text-align:center; padding:2rem;">Cargando movimientos...</div>',r.style.display="flex";const i=ve();en=await oh(t.id,i),js(t)};window.closeEditModal=()=>{document.getElementById("edit-team-modal").classList.add("hidden"),Da=-1};function js(a){const e=document.getElementById("edit-modal-content"),t=Qt.map((l,d)=>{const m=l?l.displayName||ra(l.name):"Vac√≠o",p=l?l.type:"normal",g=l&&l.typeTranslated?l.typeTranslated:ra(p),E=l?`<span class="type-badge-modern type-${p}" style="font-size:0.7rem; padding: 2px 6px;">${g.substring(0,3).toUpperCase()}</span>`:"";return`
        <div class="edit-move-slot" onclick="openMoveSelector(${d})">
            <div class="edit-move-label">Movimiento ${d+1}</div>
            <div class="edit-move-card ${l?"filled":"empty"}">
                ${E}
                <span class="move-name-display" style="margin-left:8px;">${m}</span>
                ${l?`<span class="move-power-badge">${l.power||"-"}</span>`:'<span class="move-chevron">‚ñº</span>'}
            </div>
        </div>
        `}).join(""),r=Bs.map(l=>{const d=Wb(l);return`<option value="${l.name}" ${Ma&&Ma.name===l.name?"selected":""}>${d}</option>`}).join(""),o=Et?Et.name:"Sin Objeto",i=Et?`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/${Et.img}.png`:null,s=Et?`<img src="${i}" style="width:24px; margin-right:8px;"> <span>${o}</span>`:`<span>${o}</span>`;e.innerHTML=`
        <div class="edit-modal-header">
            <img src="${a.sprite}" class="edit-sprite">
            <div class="edit-info">
                <h3>${a.name}</h3>
                <input type="text" class="edit-nickname" value="${a.nickname}" placeholder="Apodo" onchange="updateMemberNickname(this.value)">
            </div>
        </div>

        <!-- Info Section (Nature / Item) -->
        <div class="edit-section-row">
            <div class="edit-field-group">
                <label>Naturaleza</label>
                <select class="edit-select" onchange="updateMemberNature(this.value)">
                    <option value="">Neutro</option>
                    ${r}
                </select>
            </div>
            <div class="edit-field-group">
                <label>Objeto</label>
                <div class="edit-item-trigger" onclick="openItemSelector()">
                    ${s}
                    <span class="move-chevron">‚ñº</span>
                </div>
            </div>
        </div>

        <div class="edit-section">
            <h4>Movimientos</h4>
            <div class="edit-moves-grid">
                ${t}
            </div>
        </div>
        
        <div class="edit-actions">
           <button class="save-btn" onclick="saveEditChanges(); document.getElementById('edit-team-modal').style.display='none';" style="font-family: inherit;">Guardar Cambios</button>
        </div>
    `}window.updateMemberNature=a=>{if(!a){Ma=null;return}Ma=Bs.find(t=>t.name===a)};window.openItemSelector=()=>{const a=document.getElementById("item-selector-overlay");a&&a.remove();const e=document.createElement("div");e.id="item-selector-overlay",e.className="move-selector-overlay",e.innerHTML=`
        <div class="move-selector-modal">
            <div class="move-search-header">
                <input type="text" id="item-search-input" placeholder="Buscar objeto..." autofocus>
                <button onclick="document.getElementById('item-selector-overlay').remove()" class="close-overlay-btn">‚úï</button>
            </div>
            <div class="move-list-container" id="item-list-container">
                <!-- Items injected here -->
            </div>
        </div>
    `,document.body.appendChild(e);const t=document.getElementById("item-search-input"),r=document.getElementById("item-list-container");fu(Dr,r),t.addEventListener("input",o=>{const i=o.target.value.toLowerCase(),s=Dr.filter(l=>l.name.toLowerCase().includes(i));fu(s,r)}),t.focus()};function fu(a,e){if(a.length===0){e.innerHTML='<div class="no-moves">No se encontraron objetos.</div>';return}e.innerHTML=a.map(t=>{const r=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/${t.img}.png`;return`
        <div class="move-option-item" style="border-left-color: #ffd700;" onclick="selectItem('${t.name}')">
            <div class="move-opt-header" style="align-items: center; justify-content: flex-start; gap: 10px;">
                <img src="${r}" style="width: 30px; height: 30px; object-fit: contain;" onerror="this.style.display='none'">
                <span class="move-opt-name">${t.name}</span>
                <span class="move-opt-power" style="font-size:0.7rem; opacity:0.8; margin-left: auto;">${t.category}</span>
            </div>
            <div class="move-opt-details">
                <span class="move-opt-acc" style="width:100%">${t.desc}</span>
            </div>
        </div>
        `}).join("")}window.selectItem=a=>{const e=Dr.find(t=>t.name===a);if(e){Et=e;const t=xe().slots[Da];js({...t,nickname:document.querySelector(".edit-nickname").value})}document.getElementById("item-selector-overlay").remove()};window.openMoveSelector=a=>{const e=document.getElementById("move-selector-overlay");e&&e.remove();const t=document.createElement("div");t.id="move-selector-overlay",t.className="move-selector-overlay",t.innerHTML=`
        <div class="move-selector-modal">
            <div class="move-search-header">
                <input type="text" id="move-search-input" placeholder="Buscar movimiento..." autofocus>
                <button onclick="document.getElementById('move-selector-overlay').remove()" class="close-overlay-btn">‚úï</button>
            </div>
            <div class="move-list-container" id="move-list-container">
                <!-- Moves injected here -->
            </div>
        </div>
    `,document.body.appendChild(t);const r=document.getElementById("move-search-input"),o=document.getElementById("move-list-container");yu(en,o,a),r.addEventListener("input",i=>{const s=i.target.value.toLowerCase(),l=en.filter(d=>d.name.includes(s)||d.displayName.toLowerCase().includes(s));yu(l,o,a)}),r.focus()};function yu(a,e,t){if(a.length===0){e.innerHTML='<div class="no-moves">No se encontraron movimientos.</div>';return}e.innerHTML=a.map(r=>`
        <div class="move-option-item type-${r.type}" onclick="selectMoveForSlot(${t}, '${r.name}')">
            <div class="move-opt-header">
                <span class="move-opt-name">${r.displayName||ra(r.name)}</span>
                <span class="move-opt-power">Pot: ${r.power||"-"}</span>
            </div>
            <div class="move-opt-details">
                <span class="type-badge-modern type-${r.type}" style="font-size:0.7rem; padding: 2px 6px; margin-right: 0.5rem;">${(r.typeTranslated||ra(r.type)).substring(0,3).toUpperCase()}</span>
                <img src="https://play.pokemonshowdown.com/sprites/categories/${r.damageClassTranslated==="F√≠sico"?"Physical":r.damageClassTranslated==="Especial"?"Special":"Status"}.png" alt="${r.damageClassTranslated}" title="${r.damageClassTranslated}" style="width: 32px; height: 14px; object-fit: contain;">
                <span class="move-opt-acc" style="margin-left:auto">Pre: ${r.accuracy||"-"}%</span>
            </div>
        </div>
    `).join("")}window.selectMoveForSlot=(a,e)=>{const t=Qt.some(i=>i&&i.name===e),r=Qt[a]&&Qt[a].name===e;if(t&&!r){alert("¬°Este movimiento ya est√° seleccionado!");return}const o=en.find(i=>i.name===e);if(o){Qt[a]=o;const i=xe().slots[Da];js({...i,nickname:document.querySelector(".edit-nickname").value})}document.getElementById("move-selector-overlay").remove()};function Wb(a){if(a.up==="---")return a.name.split(" (")[0];const e={Atk:"Ataque",Def:"Defensa",SpA:"At. Esp",SpD:"Def. Esp",Spe:"Velocidad"};return`${a.name.split(" (")[0]} (+${e[a.up]} / -${e[a.down]})`}window.updateMemberNickname=a=>{};window.saveEditChanges=()=>{try{const a=xe(),e=a.slots[Da];if(!e){console.error("No member found at index",Da),gu();return}const t=document.querySelector(".edit-nickname");t&&(e.nickname=t.value),e.moves=Qt,e.nature=Ma,e.item=Et,Dn(a.slots),Vt()}catch(a){console.error("Error saving changes:",a)}gu()};window.closeEditModal=()=>{const a=document.getElementById("edit-team-modal");a&&(a.style.display="none")};function hp(){const a=ve();return a===pe.PLATINUM?{teams:Xp,categories:Jp}:a===pe.WHITE?{teams:Zp,categories:Yp}:{teams:Qp,categories:Kp}}function gp(){return localStorage.getItem("selectedTeamId")||"competitive"}function fp(a){localStorage.setItem("selectedTeamId",a)}function Kb(){return localStorage.getItem("selectedCategoryId")||"difficulty"}function Qb(a){localStorage.setItem("selectedCategoryId",a)}let Fa=!1;function Jb(){if(Fa)try{return Ob()}catch(s){return console.error("Error rendering TeamBuilder:",s),`<div class="error-banner">Error cargando el constructor de equipos: ${s.message}</div>`}const{teams:a,categories:e}=hp(),t=Kb(),r=gp();let o=a[r];if(!o){const s=Object.keys(a)[0];o=a[s],fp(s)}const i=Object.values(a).filter(s=>s.category===t);return`
    <div class="team-selector-container">
      <h2 style="margin-bottom: 1.5rem; text-align: center;">üéÆ Elige tu Estilo de Juego</h2>
      
      <!-- Category Tabs -->
      <div class="category-tabs">
        ${e.map(s=>`
          <button 
            class="category-tab ${s.id===t?"active":""}"
            data-category-id="${s.id}"
            onclick="handleCategoryChange('${s.id}')"
          >
            ${s.icon} ${s.name}
          </button>
        `).join("")}
      </div>

      <!-- Team Selection Pills -->
      <div class="team-pills-container">
        ${i.map(s=>`
          <button
            class="team-pill ${s.id===r?"active":""}"
            data-team-id="${s.id}"
            onclick="handleTeamChange('${s.id}')"
            title="${s.description}"
          >
            ${s.name}
          </button>
        `).join("")}
      </div>

      <!-- Team Description -->
      <div class="team-description">
        <p>${o.description}</p>
      </div>
    </div>
  `}function Xb(a){return`
    <div class="team-grid">
      ${a.pokemon.map(e=>`
        <div class="pokemon-card clickable" onclick="openPokemonModal(${e.id})" title="Haz clic para ver detalles">
          <div class="card-header">
            <span class="poke-name">${e.name}</span>
            <div class="poke-types">
              ${e.types.map(t=>`<span class="type-${t.toLowerCase()}">${Do(t)}</span>`).join("")}
            </div>
          </div>
          <div class="poke-img-container">
            <img src="${e.image}" alt="${e.name}" class="poke-img">
          </div>
          <div class="poke-details">
            <div class="detail-row">
              <span class="detail-label">Rol</span>
              <span>${e.role}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Objeto</span>
              <span>${e.item}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Naturaleza</span>
              <span>${e.nature}</span>
            </div>
          </div>
          <div class="moves-list">
            ${e.moves.filter(t=>t).map(t=>{const r=Pu[t.name]||{type:t.type,category:t.category,desc:"Movimiento desconocido",power:null,accuracy:100},o=Tu(r.category),i=r.power?`Potencia: ${r.power}`:"Sin potencia",s=r.accuracy?`Precisi√≥n: ${r.accuracy}%`:"Precisi√≥n: 100%";return`
                <div class="move-wrapper">
                  <div class="move-tag">
                    <span class="move-type-indicator type-${r.type.toLowerCase()}">${r.type.substring(0,3).toUpperCase()}</span>
                    <span style="font-weight:bold; flex:1;">${t.name}</span>
                  </div>
                  <div class="move-tooltip">
                    <div class="tooltip-header">
                      <span class="tooltip-name">${t.name}</span>
                      <span class="tooltip-type type-pill type-${r.type.toLowerCase()}">${r.type}</span>
                    </div>
                    <div class="tooltip-category">${o} ${r.category} ¬∑ ${i} ¬∑ ${s}</div>
                    <p class="tooltip-desc">${r.desc}</p>
                  </div>
                </div>
              `}).join("")}
          </div>
          <div style="margin-top:1rem; font-size:0.85rem; color:var(--text-secondary); text-align:center;">
             üìç ${e.location}
          </div>
        </div>
      `).join("")}
    </div>
  `}function Yb(){return`
      <div class="team-mode-toggle" style="display: flex; justify-content: center; margin-bottom: 2rem; gap: 1rem;">
          <button class="nav-btn ${Fa?"":"active"}" onclick="window.setSafeBuilderMode(false)">
            üìã Recomendados
          </button>
          <button class="nav-btn ${Fa?"active":""}" onclick="window.setSafeBuilderMode(true)">
            üõ†Ô∏è Crear Equipo
          </button>
      </div>
    `}function _r(){const a=document.getElementById("team");if(!a)return;const{teams:e}=hp(),t=gp(),r=e[t];a.innerHTML=`
    ${Yb()}
    ${Jb()}
    <div style="margin-top: 2rem;">
      ${Fa?"":Xb(r)}
    </div>
  `,Zb(),Fa&&setTimeout(()=>sp(),0)}function Zb(){window.handleCategoryChange=function(a){Qb(a),_r()},window.handleTeamChange=function(a){fp(a),_r()},window.setSafeBuilderMode=function(a){Fa=a,_r()}}function vu(){const a=document.getElementById("reference");if(!a)return;a.innerHTML=`
    <h2>Referencia de Mec√°nicas</h2>
    
    <div class="calculator-container" style="max-width:1200px;">
      
      <!-- Search -->
      <div style="max-width:600px; margin:0 auto 2rem auto; position:relative;">
        <input type="text" id="ref-search" class="search-input" placeholder="Buscar naturaleza..." style="padding-left: 3.5rem; height:3.5rem; font-size:1.2rem;">
        <span style="position:absolute; left:1.2rem; top:50%; transform:translateY(-50%); font-size:1.4rem; opacity:0.5;">üîç</span>
      </div>

      <!-- Natures Grid -->
      <div class="emulator-box" style="margin-bottom:2rem;">
        <h3 style="margin-bottom:1.5rem;">Naturalezas</h3>
        <div id="natures-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 1rem;">
          <!-- JS Populated -->
        </div>
      </div>

      <!-- Catch Rate Info -->
      <div class="guide-card">
        <h3 style="margin-bottom:1.5rem;">Ratios de Captura (F√≥rmula Simplificada)</h3>
        
        <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:1.5rem;">
           <div style="background:rgba(255,255,255,0.03); padding:1rem; border-radius:12px; border:1px solid var(--glass-border);">
              <h4 style="color:var(--ray-red); margin-bottom:0.5rem; font-size:1.1rem;">‚ù§Ô∏è 1. Vida (HP)</h4>
              <p style="font-size:0.9rem; color:var(--text-muted); line-height:1.5;">Bajar la vida es lo m√°s efectivo. En rojo (1 HP), el ratio de captura se multiplica hasta por <strong>x3</strong>.</p>
           </div>
           
           <div style="background:rgba(255,255,255,0.03); padding:1rem; border-radius:12px; border:1px solid var(--glass-border);">
              <h4 style="color:var(--ray-yellow); margin-bottom:0.5rem; font-size:1.1rem;">üí§ 2. Estados</h4>
              <p style="font-size:0.9rem; color:var(--text-muted); line-height:1.5;">
                <strong style="color:var(--text-main)">Dormir / Congelar:</strong> x2 (Lo mejor)<br>
                <strong style="color:var(--text-main)">Par√°lisis / Veneno / Quemado:</strong> x1.5
              </p>
           </div>
           
           <div style="background:rgba(255,255,255,0.03); padding:1rem; border-radius:12px; border:1px solid var(--glass-border);">
              <h4 style="color:var(--primary-color); margin-bottom:0.5rem; font-size:1.1rem;">üèê 3. Pok√©ball</h4>
              <p style="font-size:0.9rem; color:var(--text-muted); line-height:1.5;">
                <strong style="color:var(--text-main)">Ultra Ball:</strong> x2<br>
                <strong style="color:var(--text-main)">Malla Ball / Buceo Ball:</strong> x3 (En condiciones espec√≠ficas)<br>
                <strong style="color:var(--text-main)">Turno Ball:</strong> x4 (Tras turno 30)
              </p>
           </div>
        </div>

        <div style="margin-top:1.5rem; background:rgba(var(--primary-rgb),0.1); padding:1rem; border-radius:12px; border-left:3px solid var(--primary-color);">
            <p style="font-size:0.95rem; color:var(--text-main); margin:0;">
                <span style="font-size:1.2rem; margin-right:0.5rem;">üí°</span>
                <strong>Pro Tip:</strong> Usa a <strong>Breloom</strong> con <em>Espora</em> (100% Sue√±o) y <em>Falsotortazo</em> (Deja a 1 HP) para garantizar capturas.
            </p>
        </div>
      </div>
    </div>
  `;const e=document.getElementById("natures-grid"),t=document.getElementById("ref-search");function r(o=""){const i=o.toLowerCase(),s=xb.filter(l=>l.name.toLowerCase().includes(i));if(s.length===0){e.innerHTML='<p style="grid-column: 1/-1; text-align: center; color: var(--text-muted);">No se encontraron naturalezas.</p>';return}e.innerHTML=s.map(l=>{const d=l.plus==="-"&&l.minus==="-";return`
            <div class="interactive-card" style="
                background: rgba(255, 255, 255, 0.03);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 16px;
                padding: 1.25rem 1rem;
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
                cursor: default;
            ">
               
               <h4 style="font-size: 1.1rem; margin-bottom: 0.75rem; color: ${d?"var(--text-muted)":"var(--text-main)"}; font-weight:700;">${l.name}</h4>
               
               ${d?'<span style="color: var(--text-muted); font-size: 0.85rem; padding: 0.25rem 0.75rem; background:rgba(255,255,255,0.05); border-radius:100px;">Neutra</span>':`
                   <div style="width:100%; display:flex; flex-direction:column; gap:0.4rem; font-size:0.85rem;">
                     <div style="color: var(--primary-glow); display:flex; justify-content:space-between; width:100%;">
                        <span>‚ñ≤ Sube</span> <strong>${l.plus}</strong>
                     </div>
                     <div style="color: var(--ray-red); display:flex; justify-content:space-between; width:100%;">
                        <span>‚ñº Baja</span> <strong>${l.minus}</strong>
                     </div>
                   </div>
                 `}
            </div>
        `}).join("")}r(),t.addEventListener("input",o=>{r(o.target.value)})}const eA=[{name:"MO01 Corte",location:"Ciudad F√©rrica (Casa del Cortador)"},{name:"MO02 Vuelo",location:"Ruta 119 (Tras vencer al Rival)"},{name:"MO03 Surf",location:"Gimnasio de Petalia (Tras vencer a Norman)"},{name:"MO04 Fuerza",location:"T√∫nel Verdegal (Tras romper las rocas)"},{name:"MO05 Destello",location:"Cueva Granito (Monta√±ero en la entrada)"},{name:"MO06 Golpe Roca",location:"Ciudad Malvalona (Casa al sureste)"},{name:"MO07 Cascada",location:"Gimnasio de Arrec√≠polis (Tras el evento del despertar)"},{name:"MO08 Buceo",location:"Ciudad Algaria (Casa de M√°ximo)"}],tA=[{name:"MT26 Terremoto",location:"Caverna Abisal (Cueva) / Recogida (Nivel 91+)"},{name:"MT13 Rayo Hielo",location:"Nao Abandonada / Casino de Malvalona (4000 fichas)"},{name:"MT24 Rayo",location:"Ciudad Malvalona (Misi√≥n de Erico) / Casino"},{name:"MT35 Lanzallamas",location:"Casino de Malvalona (4000 fichas)"},{name:"MT30 Bola Sombra",location:"Monte P√≠rico"},{name:"MT06 T√≥xico",location:"Senda √çgnea"},{name:"MT02 Garra Drag√≥n",location:"Cascada Meteoro (Requiere Surf/Cascada)"},{name:"MT31 Demolici√≥n",location:"Ciudad Arrec√≠polis / Nao Abandonada"},{name:"MT40 Golpe A√©reo",location:"Gimnasio de Arborada (Premio)"}],Eu=["Treecko","Grovyle","Sceptile","Torchic","Combusken","Blaziken","Mudkip","Marshtomp","Swampert","Poochyena","Mightyena","Zigzagoon","Linoone","Wurmple","Silcoon","Beautifly","Cascoon","Dustox","Lotad","Lombre","Ludicolo","Seedot","Nuzleaf","Shiftry","Nincada","Ninjask","Shedinja","Taillow","Swellow","Shroomish","Breloom","Spinda","Wingull","Pelipper","Surskit","Masquerain","Wailmer","Wailord","Skitty","Delcatty","Kecleon","Baltoy","Claydol","Nosepass","Torkoal","Sableye","Barboach","Whiscash","Luvdisc","Corphish","Crawdaunt","Feebas","Milotic","Carvanha","Sharpedo","Trapinch","Vibrava","Flygon","Makuhita","Hariyama","Electrike","Manectric","Numel","Camerupt","Spheal","Sealeo","Walrein","Cacnea","Cacturne","Snorunt","Glalie","Lunatone","Solrock","Azurill","Spoink","Grumpig","Plusle","Minun","Mawile","Meditite","Medicham","Swablu","Altaria","Wynaut","Duskull","Dusclops","Roselia","Slakoth","Vigoroth","Slaking","Gulpin","Swalot","Tropius","Whismur","Loudred","Exploud","Clamperl","Huntail","Gorebyss","Absol","Shuppet","Banette","Seviper","Zangoose","Relicanth","Aron","Lairon","Aggron","Castform","Volbeat","Illumise","Lileep","Cradily","Anorith","Armaldo","Ralts","Kirlia","Gardevoir","Bagon","Shelgon","Salamence","Beldum","Metang","Metagross","Regirock","Regice","Registeel","Kyogre","Groudon","Rayquaza","Latias","Latios","Jirachi","Deoxys","Chimecho"],Mn=new Array(412).fill(0);for(let a=1;a<=251;a++)Mn[a]=a;for(let a=252;a<=276;a++)Mn[a]=201;const aA={Treecko:252,Grovyle:253,Sceptile:254,Torchic:255,Combusken:256,Blaziken:257,Mudkip:258,Marshtomp:259,Swampert:260,Poochyena:261,Mightyena:262,Zigzagoon:263,Linoone:264,Wurmple:265,Silcoon:266,Beautifly:267,Cascoon:268,Dustox:269,Lotad:270,Lombre:271,Ludicolo:272,Seedot:273,Nuzleaf:274,Shiftry:275,Taillow:276,Swellow:277,Wingull:278,Pelipper:279,Ralts:280,Kirlia:281,Gardevoir:282,Surskit:283,Masquerain:284,Shroomish:285,Breloom:286,Slakoth:287,Vigoroth:288,Slaking:289,Nincada:290,Ninjask:291,Shedinja:292,Whismur:293,Loudred:294,Exploud:295,Makuhita:296,Hariyama:297,Azurill:298,Nosepass:299,Skitty:300,Delcatty:301,Sableye:302,Mawile:303,Aron:304,Lairon:305,Aggron:306,Meditite:307,Medicham:308,Electrike:309,Manectric:310,Plusle:311,Minun:312,Volbeat:313,Illumise:314,Roselia:315,Gulpin:316,Swalot:317,Carvanha:318,Sharpedo:319,Wailmer:320,Wailord:321,Numel:322,Camerupt:323,Torkoal:324,Spoink:325,Grumpig:326,Spinda:327,Trapinch:328,Vibrava:329,Flygon:330,Cacnea:331,Cacturne:332,Swablu:333,Altaria:334,Zangoose:335,Seviper:336,Lunatone:337,Solrock:338,Barboach:339,Whiscash:340,Corphish:341,Crawdaunt:342,Baltoy:343,Claydol:344,Lileep:345,Cradily:346,Anorith:347,Armaldo:348,Feebas:349,Milotic:350,Castform:351,Kecleon:352,Shuppet:353,Banette:354,Duskull:355,Dusclops:356,Tropius:357,Chimecho:358,Absol:359,Wynaut:360,Snorunt:361,Glalie:362,Spheal:363,Sealeo:364,Walrein:365,Clamperl:366,Huntail:367,Gorebyss:368,Relicanth:369,Luvdisc:370,Bagon:371,Shelgon:372,Salamence:373,Beldum:374,Metang:375,Metagross:376,Regirock:377,Regice:378,Registeel:379,Latias:380,Latios:381,Kyogre:382,Groudon:383,Rayquaza:384,Jirachi:385,Deoxys:386};for(let a=0;a<Eu.length;a++){const e=277+a,t=Eu[a],r=aA[t];r&&(Mn[e]=r)}const rA={0:" ",1:"√Ä",2:"√Å",3:"√Ç",4:"√á",5:"√à",6:"√â",7:"√ä",8:"√ã",9:"√å",11:"√é",12:"√è",13:"√í",14:"√ì",15:"√î",16:"≈í",17:"√ô",18:"√ö",19:"√õ",20:"√ë",21:"√ü",22:"√†",23:"√°",25:"√ß",26:"√®",27:"√©",28:"√™",29:"√´",30:"√¨",32:"√Æ",33:"√Ø",34:"√≤",35:"√≥",36:"√¥",37:"≈ì",38:"√π",39:"√∫",40:"√ª",41:"√±",45:"&",46:"+",53:"=",80:"‚ñØ",81:"¬ø",82:"¬°",90:"√ç",91:"%",92:"(",93:")",104:"√¢",111:"√≠",121:"‚¨Ü",122:"‚¨á",123:"‚¨Ö",124:"‚û°",133:"<",134:">",161:"0",162:"1",163:"2",164:"3",165:"4",166:"5",167:"6",168:"7",169:"8",170:"9",171:"!",172:"?",173:".",174:"-",176:"...",177:'"',178:'"',179:"'",180:"'",181:"M",182:"F",184:",",185:"x",186:"/",187:"A",188:"B",189:"C",190:"D",191:"E",192:"F",193:"G",194:"H",195:"I",196:"J",197:"K",198:"L",199:"M",200:"N",201:"O",202:"P",203:"Q",204:"R",205:"S",206:"T",207:"U",208:"V",209:"W",210:"X",211:"Y",212:"Z",213:"a",214:"b",215:"c",216:"d",217:"e",218:"f",219:"g",220:"h",221:"i",222:"j",223:"k",224:"l",225:"m",226:"n",227:"o",228:"p",229:"q",230:"r",231:"s",232:"t",233:"u",234:"v",235:"w",236:"x",237:"y",238:"z",239:"‚ñ∂",240:":",241:"√Ñ",242:"√ñ",243:"√ú",244:"√§",245:"√∂",246:"√º",255:"",0:" "};function oA(a){let e="";for(let t=0;t<a.length&&a[t]!==255;t++)e+=rA[a[t]]||"";return e.trim()}class nA{constructor(e){this.data=new DataView(e),this.buffer=e}parse(){const e=this.getGlobalSaveIndex(0),t=this.getGlobalSaveIndex(57344);let r=0;if(e===-1&&t===-1)throw new Error("No se encontr√≥ un archivo de guardado v√°lido (Gen 3).");e>t?r=0:r=57344;const o=new Uint8Array(57344);for(let p=0;p<14;p++){const g=r+p*4096,E=this.data.getUint16(g+4084,!0),C=new Uint8Array(this.buffer,g,4096);o.set(C,E*4096)}const l=new DataView(o.buffer).getUint32(4660,!0),d=4664,m=[];if(l>6)return{error:"Datos corruptos o versi√≥n no soportada."};for(let p=0;p<l;p++){const g=d+p*100,E=new Uint8Array(o.buffer,g,100);m.push(this.parsePokemon(E))}return{team:m,gameCode:"Emerald"}}getGlobalSaveIndex(e){let t=-1;for(let r=0;r<14;r++){const o=e+r*4096;if(this.data.getUint32(o+4088,!0)!==134291493)return-1;const s=this.data.getUint32(o+4092,!0);s>t&&(t=s)}return t}parsePokemon(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=t.getUint32(0,!0),o=t.getUint32(4,!0),i=oA(e.slice(8,18)),s=r^o,l=new Uint8Array(48);for(let st=0;st<12;st++){const ct=t.getUint32(32+st*4,!0)^s;l.set(new Uint8Array(new Int32Array([ct]).buffer),st*4)}const d=r%24,p=["GAEM","GAME","GEAM","GEMA","GMAE","GMEA","AGEM","AGME","AEGM","AEMG","AMGE","AMEG","EGAM","EGMA","EAGM","EAMG","EMGA","EMAG","MGAE","MGEA","MAGE","MAEG","MEGA","MEAG"][d],g=(st,Xr,ct)=>{const Wa=p.indexOf(st)*12+Xr,Bt=new DataView(l.buffer);return ct==="u16"?Bt.getUint16(Wa,!0):ct==="u8"?Bt.getUint8(Wa):ct==="u32"?Bt.getUint32(Wa,!0):0},E=g("G",0,"u16"),C=g("G",9,"u8"),I=g("E",0,"u8"),R=g("E",1,"u8"),k=g("E",2,"u8"),x=g("E",3,"u8"),z=g("E",4,"u8"),j=g("E",5,"u8"),Y=g("M",4,"u32"),G=g("M",0,"u8"),Q=Y>>0&31,b=Y>>5&31,f=Y>>10&31,v=Y>>15&31,A=Y>>20&31,_=Y>>25&31,w=(Y>>30&1)===1,y=Q%2,ge=b%2,Oe=f%2,Gr=v%2,Hr=A%2,Ot=_%2,ia=Math.floor((y+2*ge+4*Oe+8*Gr+16*Hr+32*Ot)*15/63),Fn=Math.floor((y+2*ge+4*Oe+8*Gr+16*Hr+32*Ot)*40/63)+30,Wr=["Lucha","Volador","Veneno","Tierra","Roca","Bicho","Fantasma","Acero","Fuego","Agua","Planta","El√©ctrico","Ps√≠quico","Hielo","Drag√≥n","Siniestro"][ia],Kr=o&65535,sa=o>>16&65535,$a=r>>16&65535,Ga=r&65535,Ha=(Kr^sa^$a^Ga)<8,Jr=Mn[E]||E;return{nickname:i.trim(),speciesId:E,nationalId:Jr,isEgg:w,isShiny:Ha,pokerusStatus:G,friendship:C,ivs:{hp:Q,atk:b,def:f,spd:v,spa:A,spdef:_},evs:{hp:I,atk:R,def:k,spd:x,spa:z,spdef:j},hiddenPower:{type:Wr,power:Fn},pid:r}}}function iA(){const a=document.getElementById("save-scanner-root");if(!a)return;const e=th(ve());a.innerHTML=`
    <div style="text-align:center; padding: 2rem; animation: fadeIn 0.5s;">
      <h2 style="color:var(--ray-yellow); text-shadow:0 0 10px var(--ray-green);">Esc√°ner de Partida (.sav)</h2>
      <p style="color:#ccc; margin-bottom:2rem;">Arrastra tu archivo .sav de ${e} para ver lo invisible.</p>
      
      <div id="drop-zone" style="
          border: 2px dashed var(--primary-color); 
          border-radius: 16px; 
          padding: 3rem; 
          background: rgba(var(--primary-rgb), 0.05); 
          cursor: pointer;
          transition: all 0.3s;
          margin-bottom: 2rem;
      ">
        <p style="font-size:1.2rem; color:#fff;">üìÇ Arrastra tu .sav aqu√≠ o haz clic</p>
        <input type="file" id="file-input" accept=".sav" style="display:none;">
      </div>

      <div id="scanner-results" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:1rem;"></div>
      <div id="error-msg" style="color:#ff6b81; margin-top:1rem; font-weight:bold;"></div>
    </div>
  `;const t=document.getElementById("drop-zone"),r=document.getElementById("file-input"),o=document.getElementById("scanner-results"),i=document.getElementById("error-msg");t.addEventListener("click",()=>r.click()),t.addEventListener("dragover",p=>{p.preventDefault(),t.style.background="rgba(var(--primary-rgb), 0.2)",t.style.borderColor="#fff"}),t.addEventListener("dragleave",p=>{p.preventDefault(),t.style.background="rgba(var(--primary-rgb), 0.05)",t.style.borderColor="var(--primary-color)"}),t.addEventListener("drop",p=>{p.preventDefault(),t.style.background="rgba(var(--primary-rgb), 0.05)",t.style.borderColor="var(--primary-color)",p.dataTransfer.files.length&&s(p.dataTransfer.files[0])}),r.addEventListener("change",p=>{p.target.files.length&&s(p.target.files[0])});function s(p){i.innerText="",o.innerHTML="<p style='color:var(--primary-color); width:100%; text-align:center;'>Analizando estructura binaria...</p>";const g=new FileReader;g.onload=E=>{try{const C=E.target.result,R=new nA(C).parse();if(R.error)throw new Error(R.error);l(R.team)}catch(C){console.error(C),i.innerText="Error: "+C.message,o.innerHTML=""}},g.readAsArrayBuffer(p)}function l(p){o.innerHTML=p.map(g=>{if(g.speciesId===0)return"";const E=g.isEgg?"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/egg.png":`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${g.isShiny?"shiny/":""}${g.nationalId}.png`;return`
        <div class="emulator-box clickable" style="text-align:left; position:relative; overflow:hidden; border: 1px solid ${g.isShiny?"#ffd700":"rgba(255,255,255,0.1)"}; cursor:pointer;" onclick="openPokemonModal(${g.nationalId})" title="Haz clic para ver detalles">
            ${g.isShiny?'<div style="position:absolute; top:5px; right:5px; font-size:1.2rem; animation: pulse 2s infinite;">‚ú®</div>':""}
            
            <div style="display:flex; gap:1rem; align-items:center; margin-bottom:1rem; padding-bottom:1rem; border-bottom:1px solid rgba(255,255,255,0.05);">
                 <div style="width:64px; height:64px; background:rgba(0,0,0,0.2); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                    <img src="${E}" style="width:64px; height:64px; image-rendering:pixelated;" onerror="this.src='https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png'">
                 </div>
                 <div>
                    <h3 style="margin:0; color:${g.isShiny?"#ffd700":"var(--ray-yellow)"}; font-size:1.2rem;">
                        ${g.isEgg?"Huevo":g.nickname||"Pok√©mon"}
                    </h3>
                    <span class="type-pill" style="font-size:0.75rem; opacity:0.7;">Dex #${g.nationalId} ${g.pokerusStatus?"‚Ä¢ ü¶† Pok√©rus":""}</span>
                 </div>
            </div>
            
            ${g.isEgg?'<p style="color:#ccc; text-align:center;">Un huevo misterioso...</p>':`
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:0.5rem; font-size:0.85rem; color:#ccc;">
                <div>
                    <strong style="color:var(--ray-green);">IVs (Gen√©tica):</strong><br>
                    PS: <span style="${d(g.ivs.hp)}">${g.ivs.hp}</span><br>
                    Ataque: <span style="${d(g.ivs.atk)}">${g.ivs.atk}</span><br>
                    Defensa: <span style="${d(g.ivs.def)}">${g.ivs.def}</span><br>
                    Velocid: <span style="${d(g.ivs.spd)}">${g.ivs.spd}</span><br>
                    At.Esp: <span style="${d(g.ivs.spa)}">${g.ivs.spa}</span><br>
                    Df.Esp: <span style="${d(g.ivs.spdef)}">${g.ivs.spdef}</span>
                </div>
                <div>
                    <strong style="color:var(--ray-green);">EVs (Esfuerzo):</strong><br>
                    PS: ${g.evs.hp}<br>
                    Ataque: ${g.evs.atk}<br>
                    Defensa: ${g.evs.def}<br>
                    Velocid: ${g.evs.spd}<br>
                    At.Esp: ${g.evs.spa}<br>
                    Df.Esp: ${g.evs.spdef}
                </div>
            </div>

            <div style="margin-top:0.75rem; padding-top:0.75rem; border-top:1px solid rgba(255,255,255,0.1); display:grid; grid-template-columns: 1fr 1fr; gap:0.5rem;">
                <p style="font-size:0.9rem; margin:0;">
                   üîÆ <strong>Poder Oculto:</strong><br> 
                   <span style="color:${m(g.hiddenPower.type)}">${g.hiddenPower.type}</span> (${g.hiddenPower.power})
                </p>
                <p style="font-size:0.9rem; margin:0;">
                   ‚ù§Ô∏è <strong>Felicidad:</strong><br>
                   ${g.friendship} / 255
                </p>
            </div>
            `}
        </div>
      `}).join("")}function d(p){return p===31?"color:#ffeb3b; font-weight:bold; text-shadow:0 0 5px #ffeb3b;":p>=25?"color:#4cd137; font-weight:bold;":p<=5?"color:#e84118;":"color:#fff;"}function m(p){return{Lucha:"#c0392b",Volador:"#a29bfe",Veneno:"#8e44ad",Tierra:"#d35400",Roca:"#7f8c8d",Bicho:"#2ecc71",Fantasma:"#34495e",Acero:"#95a5a6",Fuego:"#e74c3c",Agua:"#3498db",Planta:"#27ae60",El√©ctrico:"#f1c40f",Ps√≠quico:"#9b59b6",Hielo:"#74b9ff",Drag√≥n:"#4834d4",Siniestro:"#2c3e50"}[p]||"#ccc"}}const sA=[{name:"Petra",city:"Ciudad F√©rrica",type:"Roca",badge:"Medalla Piedra",strategy:"Los ataques de tipo Agua y Planta son debilidades x4 para sus Geodude. Ten cuidado con Tumba Rocas, que reduce tu Velocidad.",pokemon:[{name:"Geodude",id:74,level:12,types:["Roca","Tierra"],moves:["Placaje","Rizo Defensa","Lanza Rocas","Tumba Rocas"]},{name:"Geodude",id:74,level:12,types:["Roca","Tierra"],moves:["Placaje","Rizo Defensa","Lanza Rocas","Tumba Rocas"]},{name:"Nosepass",id:299,level:15,types:["Roca"],moves:["Bloqueo","Fortaleza","Placaje","Tumba Rocas"],item:"Baya Aranja"}]},{name:"Marcial",city:"Pueblo Azuliza",type:"Lucha",badge:"Medalla Pu√±o",strategy:"Usa tipos Volador o Ps√≠quico. Meditite puede usar Reflejo, lo que reduce el da√±o f√≠sico que recibe su equipo.",pokemon:[{name:"Machop",id:66,level:16,types:["Lucha"],moves:["Patada Baja","Corpulencia","Foco Energ√≠a","Venganza"]},{name:"Meditite",id:307,level:16,types:["Lucha","Ps√≠quico"],moves:["Foco Energ√≠a","Confusi√≥n","Detecci√≥n","Corpulencia"]},{name:"Makuhita",id:296,level:19,types:["Lucha"],moves:["Empuj√≥n","Vigor","Corpulencia","Tiro Vital"],item:"Baya Aranja"}]},{name:"Erico",city:"Ciudad Malvalona",type:"El√©ctrico",badge:"Medalla Dinamo",strategy:"Un tipo Tierra es indispensable aqu√≠ para ser inmune a sus ataques el√©ctricos. Cuidado con el Autodestrucci√≥n de Voltorb.",pokemon:[{name:"Voltorb",id:100,level:20,types:["El√©ctrico"],moves:["Desenrollar","Chispa","Autodestrucci√≥n","Onda Voltio"]},{name:"Electrike",id:309,level:20,types:["El√©ctrico"],moves:["Ataque R√°pido","Malicioso","Aullido","Onda Voltio"]},{name:"Magneton",id:82,level:22,types:["El√©ctrico","Acero"],moves:["Supers√≥nico","Onda Trueno","Bomba S√≥nica","Onda Voltio"]},{name:"Manectric",id:310,level:24,types:["El√©ctrico"],moves:["Ataque R√°pido","Onda Trueno","Aullido","Onda Voltio"]}]},{name:"Candela",city:"Pueblo Lavacalda",type:"Fuego",badge:"Medalla Calor",strategy:"El movimiento Sofoco es devastador pero reduce su Ataque Especial. El clima soleado de Sequ√≠a potencia sus ataques.",pokemon:[{name:"Numel",id:322,level:24,types:["Fuego","Tierra"],moves:["D√≠a Soleado","Velo Sagrado","Magnitud","Sofoco"]},{name:"Slugma",id:218,level:24,types:["Fuego"],moves:["D√≠a Soleado","Poluci√≥n","Pantalla Luz","Sofoco"]},{name:"Camerupt",id:323,level:26,types:["Fuego","Tierra"],moves:["D√≠a Soleado","Atracci√≥n","Magnitud","Sofoco"]},{name:"Torkoal",id:324,level:29,types:["Fuego"],moves:["D√≠a Soleado","Cuerpo Llama","Atracci√≥n","Sofoco"],item:"Hierba Blanca"}]},{name:"Norman",city:"Ciudad Petalia",type:"Normal",badge:"Medalla Equilibrio",strategy:"Usa ataques de tipo Lucha. Slaking tiene estad√≠sticas de legendario pero solo ataca cada dos turnos por Ausente.",pokemon:[{name:"Spinda",id:327,level:27,types:["Normal"],moves:["Psicorrayo","Otra Vez","Danza Caos","Imagen"]},{name:"Vigoroth",id:288,level:27,types:["Normal"],moves:["Cuchillada","Finta","Otra Vez","Imagen"]},{name:"Linoone",id:264,level:29,types:["Normal"],moves:["Cuchillada","Tambor","Golpe Cabeza","Imagen"]},{name:"Slaking",id:289,level:31,types:["Normal"],moves:["Bostezo","Finta","Contador","Imagen"],item:"Baya Ziuela"}]},{name:"Alana",city:"Ciudad Arborada",type:"Volador",badge:"Medalla Pluma",strategy:"Altaria con Danza Drag√≥n es el mayor peligro. Un ataque de Hielo fuerte puede acabar con ella r√°pidamente.",pokemon:[{name:"Swablu",id:333,level:29,types:["Normal","Volador"],moves:["Golpe A√©reo","Mov. Espejo","Velo Sagrado","Canto Mortal"]},{name:"Tropius",id:357,level:29,types:["Planta","Volador"],moves:["D√≠a Soleado","Rayo Solar","Golpe A√©reo","S√≠ntesis"]},{name:"Pelipper",id:279,level:30,types:["Agua","Volador"],moves:["Pistola Agua","Protecci√≥n","Supers√≥nico","Golpe A√©reo"]},{name:"Skarmory",id:227,level:31,types:["Acero","Volador"],moves:["Ataque Arena","Ala de Acero","Ataque Furia","Golpe A√©reo"]},{name:"Altaria",id:334,level:33,types:["Drag√≥n","Volador"],moves:["Dragoaliento","Danza Drag√≥n","Terremoto","Golpe A√©reo"],item:"Baya Ziuela"}]},{name:"Vito y Leti",city:"Ciudad Algaria",type:"Ps√≠quico",badge:"Medalla Mente",strategy:"Combate Doble. Claydol puede usar Terremoto sin da√±ar a sus aliados si son tipo Volador o tienen Levitaci√≥n.",pokemon:[{name:"Claydol",id:344,level:41,types:["Tierra","Ps√≠quico"],moves:["Poder Pasado","Ps√≠quico","Terremoto","Pantalla Luz"]},{name:"Xatu",id:178,level:41,types:["Ps√≠quico","Volador"],moves:["Ps√≠quico","Rayo Confuso","Paz Mental","Teletransporte"]},{name:"Lunatone",id:337,level:42,types:["Roca","Ps√≠quico"],moves:["Ps√≠quico","Hipnosis","Pantalla Luz","Rayo Confuso"]},{name:"Solrock",id:338,level:42,types:["Roca","Ps√≠quico"],moves:["Ps√≠quico","Lanzallamas","D√≠a Soleado","Reflejo"]}]},{name:"Galano",city:"Arrec√≠polis",type:"Agua",badge:"Medalla Lluvia",strategy:"Kingdra es su as. Usa Doble Equipo y Descanso para desesperarte. Los ataques de tipo Drag√≥n son los √∫nicos efectivos.",pokemon:[{name:"Luvdisc",id:370,level:41,types:["Agua"],moves:["Hidropulso","Atracci√≥n","Beso Dulce","Azote"]},{name:"Whiscash",id:340,level:41,types:["Agua","Tierra"],moves:["Danza Lluvia","Hidropulso","Amnesia","Terremoto"]},{name:"Sealeo",id:364,level:43,types:["Hielo","Agua"],moves:["Otra Vez","Golpe Cuerpo","Rayo Aurora","Hidropulso"]},{name:"Crawdaunt",id:342,level:43,types:["Agua","Siniestro"],moves:["Martillazo","Hidropulso","Malicioso","Mofa"]},{name:"Kingdra",id:230,level:46,types:["Agua","Drag√≥n"],moves:["Hidropulso","Doble Equipo","Rayo Hielo","Descanso"],item:"Baya Atania"}]}],cA=[{name:"Sixto",type:"Siniestro",strategy:"Usa tipos Lucha o Bicho. Ten cuidado con Intimidaci√≥n de Mightyena y los counters de Absol.",pokemon:[{name:"Mightyena",id:262,level:46,types:["Siniestro"],moves:["Triturar","Doble Filo","Ataque Arena","Rugido"]},{name:"Cacturne",id:332,level:46,types:["Planta","Siniestro"],moves:["Finta","Brazo Pincho","Drenadoras","Espora Alg."]},{name:"Shiftry",id:275,level:48,types:["Planta","Siniestro"],moves:["Paranormal","Doble Equipo","Contoneo","Tormento"]},{name:"Crawdaunt",id:342,level:48,types:["Agua","Siniestro"],moves:["Danza Espada","Fuerza","Imagen","Surf"]},{name:"Absol",id:359,level:49,types:["Siniestro"],moves:["Danza Espada","Avalancha","Golpe A√©reo","Acuchillar"],item:"Baya Ziuela"}]},{name:"F√°tima",type:"Fantasma",strategy:"Los ataques tipo Siniestro o Fantasma son clave. Sableye no tiene debilidades en esta generaci√≥n.",pokemon:[{name:"Dusclops",id:356,level:48,types:["Fantasma"],moves:["Protecci√≥n","Maldici√≥n","Rayo Confuso","Pu√±o Sombra"]},{name:"Banette",id:354,level:49,types:["Fantasma"],moves:["Rabia","Fuego Fatuo","Finta","Bola Sombra"]},{name:"Sableye",id:302,level:50,types:["Siniestro","Fantasma"],moves:["Doble Equipo","Tinieblas","Finta","Bola Sombra"]},{name:"Banette",id:354,level:49,types:["Fantasma"],moves:["Bola Sombra","Rayo","Ps√≠quico","Imagen"]},{name:"Dusclops",id:356,level:51,types:["Fantasma"],moves:["Rayo Hielo","Bola Sombra","Avalancha","Terremoto"],item:"Baya Ziuela"}]},{name:"N√≠vea",type:"Hielo",strategy:"Tipos Lucha, Fuego, Roca o El√©ctrico. Walrein puede usar Fr√≠o Agudo, un movimiento que debilita de un golpe.",pokemon:[{name:"Sealeo",id:364,level:50,types:["Hielo","Agua"],moves:["Bola Hielo","Golpe Cuerpo","Rayo Aurora","Granizo"]},{name:"Glalie",id:362,level:50,types:["Hielo"],moves:["Rayo Hielo","Triturar","Pantalla Luz","Granizo"]},{name:"Sealeo",id:364,level:52,types:["Hielo","Agua"],moves:["Rayo Hielo","Ventisca","Atracci√≥n","Granizo"]},{name:"Glalie",id:362,level:52,types:["Hielo"],moves:["Rayo Hielo","Terremoto","Explosi√≥n","Granizo"]},{name:"Walrein",id:365,level:53,types:["Hielo","Agua"],moves:["Rayo Hielo","Surf","Golpe Cuerpo","Fr√≠o Agudo"],item:"Baya Ziuela"}]},{name:"Drac√≥n",type:"Drag√≥n",strategy:"Ataques de Hielo son x4 efectivos contra Altaria, Salamence y Flygon. Kingdra solo es d√©bil a Drag√≥n.",pokemon:[{name:"Shelgon",id:372,level:52,types:["Drag√≥n"],moves:["Garra Drag√≥n","Tumba Rocas","Protecci√≥n","Dragoaliento"]},{name:"Altaria",id:334,level:54,types:["Drag√≥n","Volador"],moves:["Danza Drag√≥n","Dragoaliento","Golpe A√©reo","Doble Filo"]},{name:"Kingdra",id:230,level:53,types:["Agua","Drag√≥n"],moves:["Surf","Golpe Cuerpo","Danza Drag√≥n","Pantalla Humo"]},{name:"Flygon",id:330,level:53,types:["Tierra","Drag√≥n"],moves:["Dragoaliento","Tormenta Arena","Terremoto","Triturar"]},{name:"Salamence",id:373,level:55,types:["Drag√≥n","Volador"],moves:["Garra Drag√≥n","Lanzallamas","Triturar","Avalancha"],item:"Baya Ziuela"}]},{name:"Plubio",type:"Campe√≥n / Agua",strategy:"Un equipo equilibrado con ataques el√©ctricos y de planta es vital. Milotic con Recuperaci√≥n y T√≥xico es muy resistente.",pokemon:[{name:"Wailord",id:321,level:57,types:["Agua"],moves:["Danza Lluvia","Salpicar","Doble Filo","Ventisca"]},{name:"Tentacruel",id:73,level:55,types:["Agua","Veneno"],moves:["Hidrobomba","Bomba Lodo","Rayo Hielo","T√≥xico"]},{name:"Ludicolo",id:272,level:56,types:["Agua","Planta"],moves:["Giga Drenado","Surf","Drenadoras","Doble Equipo"]},{name:"Whiscash",id:340,level:56,types:["Agua","Tierra"],moves:["Terremoto","Surf","Hiperrayo","Amnesia"]},{name:"Gyarados",id:130,level:56,types:["Agua","Volador"],moves:["Danza Drag√≥n","Hiperrayo","Terremoto","Surf"]},{name:"Milotic",id:350,level:58,types:["Agua"],moves:["Recuperaci√≥n","Surf","Rayo Hielo","T√≥xico"],item:"Baya Ziuela"}]}],lA=[{name:"Roco",city:"Ciudad Pirita",type:"Roca",badge:"Medalla Lignito",strategy:"Los ataques de Agua, Planta y Lucha son letales. Cranidos tiene un Ataque alt√≠simo para ser el primer gimnasio.",pokemon:[{name:"Geodude",id:74,level:12,types:["Roca","Tierra"],moves:["Trampa Rocas","Desenrollar","Empuj√≥n"]},{name:"Onix",id:95,level:12,types:["Roca","Tierra"],moves:["Trampa Rocas","Chirrido","Lanzarrocas"]},{name:"Cranidos",id:408,level:14,types:["Roca"],moves:["Golpe Cabeza","Malicioso","Persecuci√≥n"]}]},{name:"Gardenia",city:"Ciudad Eterna",type:"Planta",badge:"Medalla Bosque",strategy:"Usa tipos Fuego, Volador o Bicho. Su Roserade usa Hierba Lazo, que hace m√°s da√±o a Pok√©mon pesados.",pokemon:[{name:"Turtwig",id:387,level:20,types:["Planta"],moves:["Reflejo","Hoja Afilada","D√≠a Soleado"]},{name:"Cherrim",id:421,level:20,types:["Planta"],moves:["D√≠a Soleado","Bomba Germen","Drenadoras"]},{name:"Roserade",id:407,level:22,types:["Planta","Veneno"],moves:["Hierba Lazo","Hoja M√°gica","Paralizador","Ponzo√±a"]}]},{name:"Fantina",city:"Ciudad Coraz√≥n",type:"Fantasma",badge:"Medalla Reliquia",strategy:"El tipo Siniestro es tu mejor aliado. Su Mismagius es muy r√°pido y golpea fuerte por el lado especial.",pokemon:[{name:"Duskull",id:355,level:24,types:["Fantasma"],moves:["Sombra Nocturna","Fuego Fatuo","Rayo Confuso"]},{name:"Haunter",id:93,level:24,types:["Fantasma","Veneno"],moves:["Pu√±o Sombra","Rayo Confuso","Hipnosis"]},{name:"Mismagius",id:429,level:26,types:["Fantasma"],moves:["Bola Sombra","Psicorrayo","Hoja M√°gica","Rayo Confuso"]}]},{name:"Brega",city:"Ciudad Rocavelo",type:"Lucha",badge:"Medalla Cobalto",strategy:"Los tipos Volador y Ps√≠quico son claves. Lucario puede resistir mucho gracias a su tipo Acero secundario.",pokemon:[{name:"Meditite",id:307,level:28,types:["Lucha","Ps√≠quico"],moves:["Sorpresa","Confusi√≥n","Tumba Rocas","Pu√±o Drenaje"]},{name:"Machoke",id:67,level:29,types:["Lucha"],moves:["Foco Energ√≠a","Karate-choque","Tumba Rocas","Fuerza"]},{name:"Lucario",id:448,level:32,types:["Lucha","Acero"],moves:["Pu√±o Drenaje","Palmeo","Garra Metal","Ataque √ìseo"],item:"Baya Ziuela"}]},{name:"Mananti",city:"Ciudad Pradera",type:"Agua",badge:"Medalla Ci√©naga",strategy:"Tipo El√©ctrico y Planta son necesarios. Cuidado con Quagsire, que es inmune a la electricidad por ser tipo Tierra.",pokemon:[{name:"Gyarados",id:130,level:33,types:["Agua","Volador"],moves:["Cascada","Salmuera","Mordisco","Cicl√≥n"]},{name:"Quagsire",id:195,level:34,types:["Agua","Tierra"],moves:["Hidropulso","Tumba Rocas","Disparo Lodo","Bostezo"]},{name:"Floatzel",id:419,level:37,types:["Agua"],moves:["Salmuera","Triturar","Colmillo Hielo","Acua Jet"],item:"Baya Ziuela"}]},{name:"Acer√≥n",city:"Ciudad Canal",type:"Acero",badge:"Medalla Mina",strategy:"Tipo Fuego, Lucha y Tierra. Bastiodon tiene una defensa f√≠sica y especial inmensa, intenta desgastarlo.",pokemon:[{name:"Magneton",id:82,level:37,types:["El√©ctrico","Acero"],moves:["Foco Resplandor","Rayo","Triataque","Eco Met√°lico"]},{name:"Steelix",id:208,level:38,types:["Acero","Tierra"],moves:["Foco Resplandor","Terremoto","Colmillo Hielo","Tormenta Arena"]},{name:"Bastiodon",id:411,level:41,types:["Roca","Acero"],moves:["Represi√≥n Metal","Roca Afilada","Defensa F√©rrea","Mofa"],item:"Baya Ziuela"}]},{name:"Inverna",city:"Ciudad Puntaneva",type:"Hielo",badge:"Medalla Glaciar",strategy:"Fuego, Lucha, Acero y Roca. Su Abomasnow invoca Granizo nada m√°s salir.",pokemon:[{name:"Snover",id:459,level:38,types:["Planta","Hielo"],moves:["Alud","Arraigo","Ventisca","Hierba Lazo"]},{name:"Sneasel",id:215,level:38,types:["Siniestro","Hielo"],moves:["Alud","Ataque R√°pido","Chirrido","Canto Helado"]},{name:"Medicham",id:308,level:40,types:["Lucha","Ps√≠quico"],moves:["Pu√±o Hielo","Psicocorte","Detecci√≥n","Sorpresa"]},{name:"Abomasnow",id:460,level:42,types:["Planta","Hielo"],moves:["Alud","Mazazo","Onda Certera","Granizo"],item:"Baya Ziuela"}]},{name:"Lectro",city:"Ciudad Marina",type:"El√©ctrico",badge:"Medalla Faro",strategy:"Tipo Tierra es indispensable. Electivire tiene una cobertura de movimientos muy amplia con los Pu√±os Elementales.",pokemon:[{name:"Jolteon",id:135,level:46,types:["El√©ctrico"],moves:["Rayo Carga","Onda Trueno","Cola F√©rrea","Ataque R√°pido"]},{name:"Raichu",id:26,level:46,types:["El√©ctrico"],moves:["Rayo Carga","Doble Rayo","Onda Certera","Ataque R√°pido"]},{name:"Luxray",id:405,level:48,types:["El√©ctrico"],moves:["Colmillo Rayo","Colmillo Hielo","Colmillo √çgneo","Triturar"]},{name:"Electivire",id:466,level:50,types:["El√©ctrico"],moves:["Pu√±o Trueno","Pu√±o Fuego","Giga Impacto","Ataque R√°pido"],item:"Baya Ziuela"}]}],uA=[{name:"Alecr√°n",type:"Bicho",strategy:"Usa tipos Fuego, Volador o Roca. Drapion es su Pok√©mon m√°s peligroso y solo es d√©bil a Tierra.",pokemon:[{name:"Yanomega",id:469,level:49,types:["Bicho","Volador"],moves:["Tajo A√©reo","Zumbido","Ida y Vuelta","Doble Equipo"]},{name:"Scizor",id:212,level:49,types:["Bicho","Acero"],moves:["Cabeza de Hierro","Tajo X","Tajo Umbr√≠o","Ataque R√°pido"]},{name:"Vespiquen",id:416,level:50,types:["Bicho","Volador"],moves:["Al Ataque","A Defender","Auxilio","Gema Robusta"]},{name:"Heracross",id:214,level:51,types:["Bicho","Lucha"],moves:["Megacuerno","A Bocajarro","Tajo Umbr√≠o","Roca Afilada"]},{name:"Drapion",id:452,level:53,types:["Veneno","Siniestro"],moves:["Tajo X","Veneno X","Colmillo Hielo","Golpe A√©reo"]}]},{name:"Gaia",type:"Tierra",strategy:"Ataques de Agua y Planta (especialmente especial) destrozan a la mayor√≠a de su equipo.",pokemon:[{name:"Whiscash",id:340,level:50,types:["Agua","Tierra"],moves:["Tierra Viva","Tormenta Arena","Cabezazo Zen","Acua Cola"]},{name:"Gliscor",id:472,level:53,types:["Tierra","Volador"],moves:["Terremoto","Colmillo √çgneo","Colmillo Hielo","Colmillo Rayo"]},{name:"Hippowdon",id:450,level:52,types:["Tierra"],moves:["Terremoto","Piedra Afilada","Triturar","Bostezo"]},{name:"Golem",id:76,level:52,types:["Roca","Tierra"],moves:["Pu√±o Fuego","Pu√±o Trueno","Terremoto","Tormenta Arena"]},{name:"Rhyperior",id:464,level:55,types:["Tierra","Roca"],moves:["Alud","Megacuerno","Terremoto","Romperrocas"],item:"Baya Ziuela"}]},{name:"Fausto",type:"Fuego",strategy:"Tierra, Agua y Roca. Su Magmortar y su Infernape son atacantes mixtos muy peligrosos.",pokemon:[{name:"Houndoom",id:229,level:52,types:["Siniestro","Fuego"],moves:["Lanzallamas","Bomba Lodo","Pulso Umbr√≠o","D√≠a Soleado"]},{name:"Flareon",id:136,level:55,types:["Fuego"],moves:["Sofoco","Giga Impacto","Ataque R√°pido","Fuego Fatuo"]},{name:"Rapidash",id:78,level:53,types:["Fuego"],moves:["Envite √çgneo","Rayo Solar","Bote","D√≠a Soleado"]},{name:"Infernape",id:392,level:55,types:["Fuego","Lucha"],moves:["Envite √çgneo","Pu√±o Trueno","Ultrapu√±o","Terremoto"]},{name:"Magmortar",id:467,level:57,types:["Fuego"],moves:["Lanzallamas","Rayo","Rayo Solar","Hiperrayo"]}]},{name:"Delos",type:"Ps√≠quico",strategy:"Siniestro, Fantasma y Bicho. Gallade usa ataques f√≠sicos de lucha para cubrir sus debilidades.",pokemon:[{name:"Mr. Mime",id:122,level:53,types:["Ps√≠quico"],moves:["Ps√≠quico","Pantalla Luz","Reflejo","Rayo"]},{name:"Espeon",id:196,level:55,types:["Ps√≠quico"],moves:["Ps√≠quico","Ataque R√°pido","Bola Sombra","Doble Rayo"]},{name:"Bronzong",id:437,level:54,types:["Acero","Ps√≠quico"],moves:["Ps√≠quico","Giro Bola","Paz Mental","Terremoto"],item:"Refleluz"},{name:"Alakazam",id:65,level:56,types:["Ps√≠quico"],moves:["Ps√≠quico","Onda Certera","Recuperaci√≥n","Energibola"]},{name:"Gallade",id:475,level:59,types:["Ps√≠quico","Lucha"],moves:["Psicocorte","Pu√±o Drenaje","Hoja Aguda","Roca Afilada"],item:"Cinta Experto"}]},{name:"Cintia",type:"Campeona",strategy:"La campeona definitiva. Su Garchomp es legendariamente fuerte. Necesitas un ataque de Hielo s√≠ o s√≠.",pokemon:[{name:"Spiritomb",id:442,level:58,types:["Fantasma","Siniestro"],moves:["Pulso Umbr√≠o","Viento Plata","Bola Sombra","Ps√≠quico"]},{name:"Roserade",id:407,level:58,types:["Planta","Veneno"],moves:["Bomba Lodo","Energibola","T√≥xico","Extrasensorial"]},{name:"Togekiss",id:468,level:60,types:["Normal","Volador"],moves:["Tajo A√©reo","Esfera Aural","Hidropulso","Onda Voltio"]},{name:"Lucario",id:448,level:60,types:["Lucha","Acero"],moves:["Esfera Aural","Bola Sombra","Roca Afilada","Velocidad Extrema"]},{name:"Milotic",id:350,level:58,types:["Agua"],moves:["Surf","Rayo Hielo","Espejo Manto","Pulso Drag√≥n"]},{name:"Garchomp",id:445,level:62,types:["Drag√≥n","Tierra"],moves:["Carga Drag√≥n","Terremoto","Lanzallamas","Giga Impacto"],item:"Baya Ziuela"}]}],dA=[{name:"Ma√≠z, Zeo y Millo",city:"Ciudad Gres",type:"Fuego/Agua/Planta",badge:"Medalla Tr√≠o",strategy:"El l√≠der al que te enfrentes depender√° de tu inicial. Usar√° el tipo que tiene ventaja sobre ti. ¬°Usa tu mono elemental!",pokemon:[{id:506,name:"Lillipup",level:12,types:["Normal"],moves:["Placaje","Malicioso","Mordisco"]},{id:511,name:"Pansage",level:14,types:["Grass"],moves:["Ara√±azo","Malicioso","Lamer","L√°tigo Cepa"]}]},{name:"Aloe",city:"Ciudad Esmalte",type:"Normal",badge:"Medalla Base",strategy:"Sus Pok√©mon son Normales pero golpean duro. Usa Pok√©mon de tipo Lucha si tienes (Timburr/Sawk/Throh). Cuidado con la Hipnosis de Watchog.",pokemon:[{id:507,name:"Herdier",level:18,types:["Normal"],moves:["Derribo","Malicioso","Mordisco","Represalia"]},{id:505,name:"Watchog",level:20,types:["Normal"],moves:["Represalia","Triturar","Hipnosis","Mal de Ojo"]}]},{name:"Camus",city:"Ciudad Porcelana",type:"Bug",badge:"Medalla √âlitro",strategy:"L√≠der de tipo Bicho. Los ataques de Fuego (Darumaka/Pansear) y Volador (Pidove/Swoobat) son muy efectivos.",pokemon:[{id:543,name:"Whirlipede",level:21,types:["Bug","Poison"],moves:["Persecuci√≥n","Chirrido","Picadura","Defensa F√©rrea"]},{id:557,name:"Dwebble",level:21,types:["Bug","Rock"],moves:["Antia√©reo","Picadura","Finta","Pulimento"]},{id:542,name:"Leavanny",level:23,types:["Bug","Grass"],moves:["Hoja Afilada","Picadura","Disparo Demora","Protecci√≥n"]}]},{name:"Camila",city:"Ciudad May√≥lica",type:"Electric",badge:"Medalla Voltio",strategy:"Sus Emolga son molestos por el Voltiocambio. Usa Pok√©mon de tipo Roca o Tierra (Sandile/Drilbur) para bloquear sus ataques el√©ctricos.",pokemon:[{id:587,name:"Emolga",level:25,types:["Electric","Flying"],moves:["Voltiocambio","Golpe A√©reo","Persecuci√≥n","Ataque R√°pido"]},{id:587,name:"Emolga",level:25,types:["Electric","Flying"],moves:["Voltiocambio","Golpe A√©reo","Persecuci√≥n","Ataque R√°pido"]},{id:523,name:"Zebstrika",level:27,types:["Electric"],moves:["Voltiocambio","Nitrocarga","Persecuci√≥n","Ataque R√°pido"]}]},{name:"Yak√≥n",city:"Ciudad Fayenza",type:"Ground",badge:"Medalla Temblor",strategy:"L√≠der de Tierra. Su Excadrill es muy peligroso y r√°pido. Agua y Planta son tus mejores amigos aqu√≠.",pokemon:[{id:552,name:"Krokorok",level:29,types:["Ground","Dark"],moves:["Triturar","Terratemblor","Tormento","Contoneo"]},{id:536,name:"Palpitoad",level:29,types:["Water","Ground"],moves:["Agua Lodosa","Aqua Aro","Terratemblor","Onda Voltio"]},{id:530,name:"Excadrill",level:31,types:["Ground","Steel"],moves:["Terratemblor","Avalancha","Garra Metal","Afilagarras"]}]},{name:"Gerania",city:"Ciudad Loza",type:"Flying",badge:"Medalla Jet",strategy:"Usa Pok√©mon El√©ctricos (Zebstrika/Galvantula) o Roca. Cuidado con el Aqua Aro y Escaldar de Swanna.",pokemon:[{id:528,name:"Swoobat",level:33,types:["Psychic","Flying"],moves:["Acr√≥bata","Seducci√≥n","Amnesia","Garant√≠a"]},{id:520,name:"Unfezant",level:33,types:["Normal","Flying"],moves:["Aire Afilado","Acr√≥bata","Seducci√≥n","Detecci√≥n"]},{id:581,name:"Swanna",level:35,types:["Water","Flying"],moves:["Acr√≥bata","Rayo Burbuja","Seducci√≥n","Aqua Aro"]}]},{name:"Junco",city:"Ciudad Teja",type:"Ice",badge:"Medalla Candelizo",strategy:"El Hielo es d√©bil a Fuego, Lucha, Roca y Acero. Un buen tipo Lucha destrozar√° a sus Pok√©mon.",pokemon:[{id:583,name:"Vanillish",level:37,types:["Ice"],moves:["Vaho G√©lido","Impresionar","Armadura √Åcida","Espejo"]},{id:615,name:"Cryogonal",level:37,types:["Ice"],moves:["Vaho G√©lido","Rayo Aurora","Reflejo","Giro R√°pido"]},{id:614,name:"Beartic",level:39,types:["Ice"],moves:["Chuzos","Cuchillada","Salmuera","Contoneo"]}]},{name:"Iris",city:"Ciudad Caol√≠n",type:"Dragon",badge:"Medalla Leyenda",strategy:"L√≠der de Dragones. Los ataques de Hielo son devastadores. Un tipo Drag√≥n propio tambi√©n funciona, pero es arriesgado.",pokemon:[{id:611,name:"Fraxure",level:41,types:["Dragon"],moves:["Cola Drag√≥n","Danza Drag√≥n","Furia Drag√≥n","Garant√≠a"]},{id:621,name:"Druddigon",level:41,types:["Dragon"],moves:["Cola Drag√≥n","Venganza","Tajo Umbr√≠o","Guardia Baja"]},{id:612,name:"Haxorus",level:43,types:["Dragon"],moves:["Cola Drag√≥n","Danza Drag√≥n","Tajo Umbr√≠o","Falsotortazo"]}]}],mA=[{name:"An√≠s",type:"Ghost",strategy:"Maestra de Fantasmas. Cuidado con la cobertura de sus Pok√©mon. Siniestro es tu mejor opci√≥n.",pokemon:[{id:563,name:"Cofagrigus",level:48,types:["Ghost"],moves:["Bola Sombra","Ps√≠quico","Fuego Fatuo","Hierba Lazo"]},{id:593,name:"Jellicent",level:48,types:["Water","Ghost"],moves:["Surf","Bola Sombra","Energibola","Salmuera"]},{id:623,name:"Golurk",level:48,types:["Ground","Ghost"],moves:["Pu√±o Sombra","Terremoto","Maldici√≥n","Machada"]},{id:609,name:"Chandelure",level:50,types:["Ghost","Fire"],moves:["Llamarada","Bola Sombra","Ps√≠quico","Vendetta"]}]},{name:"Aza",type:"Dark",strategy:"Usa tipos Siniestros. Lucha y Bicho son muy efectivos. Cuidado con sus ataques Ps√≠quicos de cobertura.",pokemon:[{id:560,name:"Scrafty",level:48,types:["Dark","Fighting"],moves:["Triturar","Demolici√≥n","Puya Nociva","Ataque Arena"]},{id:553,name:"Krookodile",level:48,types:["Ground","Dark"],moves:["Triturar","Terremoto","Enfado","Juego Sucio"]},{id:510,name:"Liepard",level:48,types:["Dark"],moves:["Tajo Umbr√≠o","Golpe A√©reo","Sorpresa","Atracci√≥n"]},{id:625,name:"Bisharp",level:50,types:["Dark","Steel"],moves:["Tajo Umbr√≠o","Cabezahierro","Tijera X","Guillotina"]}]},{name:"Catleya",type:"Psychic",strategy:"Usa Pok√©mon Ps√≠quicos. Fantasma, Siniestro y Bicho son tus mejores armas.",pokemon:[{id:579,name:"Reuniclus",level:48,types:["Psychic"],moves:["Ps√≠quico","Onda Certera","Bola Sombra","Trueno"]},{id:561,name:"Sigilyph",level:48,types:["Psychic","Flying"],moves:["Ps√≠quico","Tajo A√©reo","Bola Sombra","Rayo Hielo"]},{id:518,name:"Musharna",level:48,types:["Psychic"],moves:["Ps√≠quico","Bola Sombra","Energibola","Reflejo"]},{id:576,name:"Gothitelle",level:50,types:["Psychic"],moves:["Ps√≠quico","Rayo","Bola Sombra","Paz Mental"]}]},{name:"Lotto",type:"Fighting",strategy:"Especialista en Lucha. Volador y Ps√≠quico son claves, pero cuidado con Roca Afilada.",pokemon:[{id:538,name:"Throh",level:48,types:["Fighting"],moves:["Llave Cors√©","Roca Afilada","Vendetta","Corpulencia"]},{id:539,name:"Sawk",level:48,types:["Fighting"],moves:["Golpe Karate","Roca Afilada","Represalia","Hierba Lazo"]},{id:620,name:"Mienshao",level:48,types:["Fighting"],moves:["Patada S. Alta","Avalancha","Ida y Vuelta","Represalia"]},{id:534,name:"Conkeldurr",level:50,types:["Fighting"],moves:["Machada","Roca Afilada","Represalia","Corpulencia"]}]},{name:"Mirto",type:"Bug",strategy:"El Campe√≥n de Teselia. Su equipo es variado pero con base en Bicho. Fuego, Volador y Roca son buenos.",pokemon:[{id:617,name:"Accelgor",level:75,types:["Bug"],moves:["Zumbido","Onda Certera","Energibola","Me First"]},{id:626,name:"Bouffalant",level:75,types:["Normal"],moves:["Ariete","Terremoto","Megacuerno","Roca Afilada"]},{id:621,name:"Druddigon",level:75,types:["Dragon"],moves:["Enfado","Fuerza Bruta","Tajo Umbr√≠o","Represalia"]},{id:584,name:"Vanilluxe",level:75,types:["Ice"],moves:["Ventisca","Foco Resplandor","Pantalla Luz","Liofilizaci√≥n"]},{id:589,name:"Escavalier",level:75,types:["Bug","Steel"],moves:["Megacuerno","Cabeza de Hierro","Tijera X","Golpe A√©reo"]},{id:637,name:"Volcarona",level:77,types:["Bug","Fire"],moves:["Danza Aleteo","Sofoco","Zumbido","Hiperrayo"]}]}];function _u(){const a=document.getElementById("guide");if(!a)return;const e=ve();let t,r;switch(e){case pe.PLATINUM:t=lA,r=uA;break;case pe.WHITE:t=dA,r=mA;break;default:t=sA,r=cA}const o="https://play.pokemonshowdown.com/sprites/trainers/",i="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/",s=I=>{const R=document.getElementById("item-dex-container");R&&(R.innerHTML=I.map(k=>`
         <div class="recommendation-card" style="border-left: 3px solid ${l(k.category)}">
            <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/${k.img}.png" 
                 onerror="this.src='https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png'"
                 style="width:48px; height:48px; image-rendering:pixelated; flex-shrink:0;">
            <div style="flex:1;">
              <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                  <h4 style="color:var(--text-main); margin-bottom:0.15rem; font-size:1rem;">${k.name}</h4>
                  <span class="type-pill" style="font-size:0.65rem; background:rgba(255,255,255,0.1); padding:2px 8px;">${k.category}</span>
              </div>
              <p style="font-size:0.85rem; color:var(--primary-color); margin-bottom:0.25rem;">üìç ${k.loc}</p>
              <p style="font-size:0.8rem; color:var(--text-muted); line-height:1.4;">${k.desc}</p>
            </div>
         </div>
      `).join(""),I.length===0&&(R.innerHTML='<p style="text-align:center; color:var(--text-muted); width:100%; padding:2rem;">No se encontraron objetos.</p>'))};function l(I){return I==="Evoluci√≥n"?"#f0932b":I==="Combate"?"#eb4d4b":I==="Utilidad"?"#48dbfb":I==="Clave"?"#f1c40f":I==="Baya"?"#7bed9f":I==="Concurso"?"#ff6b81":"#ccc"}const d={"Medalla Piedra":"/pokemon-emerald-companion/badges/stone_badge.png","Medalla Pu√±o":"/pokemon-emerald-companion/badges/knuckle_badge.png","Medalla Dinamo":"/pokemon-emerald-companion/badges/dynamo_badge.png","Medalla Calor":"/pokemon-emerald-companion/badges/heat_badge.png","Medalla Equilibrio":"/pokemon-emerald-companion/badges/balance_badge.png","Medalla Pluma":"/pokemon-emerald-companion/badges/feather_badge.png","Medalla Mente":"/pokemon-emerald-companion/badges/mind_badge.png","Medalla Lluvia":"/pokemon-emerald-companion/badges/rain_badge.png","Medalla Lignito":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/25.png","Medalla Bosque":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/26.png","Medalla Cobalto":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/27.png","Medalla Ci√©naga":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/28.png","Medalla Reliquia":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/29.png","Medalla Mina":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/30.png","Medalla Glaciar":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/31.png","Medalla Faro":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/32.png","Medalla Tr√≠o":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/33.png","Medalla Base":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/34.png","Medalla √âlitro":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/35.png","Medalla Voltio":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/36.png","Medalla Temblor":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/37.png","Medalla Jet":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/38.png","Medalla Candelizo":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/39.png","Medalla Leyenda":"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/badges/40.png"},m=I=>`
      <div class="leader-team">
        ${I.map(R=>`
          <div class="leader-poke-card clickable" onclick="openPokemonModal(${R.id})" title="Haz clic para ver detalles">
            <div style="display:flex; align-items:center; gap:0.75rem; margin-bottom: 0.75rem;">
                <img src="${i}${R.id}.png" class="leader-poke-img" alt="${R.name}">
                <div style="flex:1;">
                    <div class="leader-poke-name">${R.name}</div>
                    <div class="leader-poke-lvl">Nv. ${R.level}</div>
                    <div style="display:flex; gap:0.25rem; flex-wrap:wrap; margin-top:0.25rem;">
                      ${R.types.map(k=>`<span class="type-pill type-${k.toLowerCase()}" style="font-size:0.6rem; padding:2px 6px;">${k}</span>`).join("")}
                    </div>
                </div>
            </div>
            
            <div class="moves-section">
              <div class="moves-label">‚öîÔ∏è Movimientos</div>
              <div class="leader-moves">
                ${R.moves.map(k=>{const x=Pu[k]||{type:"Normal",category:"F√≠sico",desc:"Ataque normal.",power:null,accuracy:100},z=Tu(x.category);return`
                    <div class="move-wrapper">
                      <span class="leader-move-tag" style="${R.types.includes(x.type)?"border-color:var(--primary-color); background:rgba(var(--primary-rgb),0.15);":""}">
                         ${k}
                      </span>
                      <div class="move-tooltip">
                        <div class="tooltip-header">
                          <span class="tooltip-name">${k}</span>
                          <span class="type-pill type-${x.type.toLowerCase()}">${x.type}</span>
                        </div>
                        <div class="tooltip-category">${z} ${x.category} ¬∑ Pot: ${x.power||"-"} ¬∑ Pre: ${x.accuracy||"-"}%</div>
                        <p class="tooltip-desc">${x.desc}</p>
                      </div>
                    </div>
                  `}).join("")}
              </div>
            </div>
          </div>
        `).join("")}
      </div>
    `,p={Petra:"roxanne-gen3.png",Marcial:"brawly-gen3.png",Erico:"wattson-gen3.png",Candela:"flannery-gen3.png",Norman:"norman-gen3.png",Alana:"winona-gen3.png","Vito y Leti":"tateandliza-gen3.png",Juan:"juan-gen3.png",Sixto:"sidney-gen3.png",F√°tima:"phoebe-gen3.png",N√≠vea:"glacia-gen3.png",Drac√≥n:"drake-gen3.png",Plubio:"wallace-gen3.png",Roco:"roark.png",Gardenia:"gardenia.png",Fantina:"fantina.png",Brega:"maylene.png",Mananti:"crasherwake.png",Acer√≥n:"byron.png",Inverna:"candice.png",Lectro:"volkner.png",Alecr√°n:"aaron.png",Gaia:"bertha.png",Fausto:"flint.png",Delos:"lucian.png",Cintia:"cynthia.png","Ma√≠z, Zeo y Millo":"cilan.png",Aloe:"lenora.png",Camus:"burgh.png",Camila:"elesa.png",Yak√≥n:"clay.png",Gerania:"skyla.png",Junco:"brycen.png",Iris:"iris.png",An√≠s:"shauntal.png",Aza:"grimsley.png",Catleya:"caitlin.png",Lotto:"marshal.png",Mirto:"alder.png"};a.innerHTML=`
    <h2>Gu√≠a de Aventura</h2>
    
    <div class="guide-tabs">
      <div class="guide-tab active" data-tab="gyms">L√≠deres</div>
      <div class="guide-tab" data-tab="e4">Alto Mando</div>
      <div class="guide-tab" data-tab="items">MOs y MTs</div>
      <div class="guide-tab" data-tab="held">Objetos</div>
      <div class="guide-tab" id="scanner-btn" style="border-color:var(--primary-glow); color:var(--primary-glow);">üíæ Scanner</div>
    </div>

    <!-- GYMS GRID LAYOUT -->
    <div id="tab-gyms" class="tab-content" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap:2rem;">
       ${t.map((I,R)=>`
         <div class="emulator-box" style="display:flex; flex-direction:column; height:100%;">
             <div style="display:flex; gap:1.5rem; align-items:center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--glass-border); position: relative; z-index: 2;">
              <div style="position:relative;">
                 <img src="${o}${p[I.name]}" style="height:100px; filter:drop-shadow(0 4px 10px rgba(0,0,0,0.5)); transform: scale(1.1);">
              </div>
              <div style="flex:1;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h3 style="margin:0; font-size: 1.5rem; text-align:left;">${I.name}</h3>
                    <span style="font-size:3rem; font-weight:800; color:rgba(255,255,255,0.03); line-height:0;">${R+1}</span>
                </div>
                <div style="color:var(--text-secondary); font-size:0.9rem; margin-bottom:0.5rem;">${I.city}</div>
                <div style="display:flex; gap:0.5rem; align-items:center;">
                  <span class="type-pill type-${I.type.toLowerCase()}">${I.type}</span>
                  ${I.badge?`
                  <div style="display:flex; align-items:center; gap:0.4rem; background:rgba(0,0,0,0.2); padding:2px 8px; border-radius:100px;">
                    <img src="${d[I.badge]}" alt="${I.badge}" style="width:24px; height:24px;">
                    <span style="color:var(--ray-yellow); font-size:0.8rem; font-weight:600;">${I.badge}</span>
                  </div>`:""}
                </div>
              </div>
            </div>
            
            <!-- Strategy Popover/Text -->
            <div style="background:rgba(var(--primary-rgb), 0.05); border:1px solid rgba(var(--primary-rgb), 0.1); padding:1rem; border-radius:12px; margin-bottom:1.5rem;">
                <p style="font-size:0.9rem; color:var(--text-main); line-height: 1.5; font-style:italic;">"${I.strategy}"</p>
            </div>

            ${m(I.pokemon)}
         </div>
       `).join("")}
    </div>

    <!-- ELITE FOUR LAYOUT -->
    <div id="tab-e4" class="tab-content hidden" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap:2rem;">
       ${r.map((I,R)=>`
         <div class="emulator-box" style="border-color:${R===r.length-1?"var(--ray-yellow)":"var(--glass-border)"};">
             <div style="display:flex; gap:1.5rem; align-items:center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--glass-border); position: relative; z-index: 2;">
              <img src="${o}${p[I.name]}" style="height:100px; filter:drop-shadow(0 4px 10px rgba(0,0,0,0.5));">
              <div>
                <h3 style="margin:0; font-size: 1.5rem; text-align:left; color:${R===r.length-1?"var(--ray-yellow)":"white"};">
                    ${R===r.length-1?"CAMPE√ìN ":""}${I.name}
                </h3>
                <span class="type-pill type-${I.type.toLowerCase().includes("/")?"water":I.type.toLowerCase()}" style="margin-top:0.5rem; display:inline-block;">${I.type}</span>
              </div>
            </div>
            <p style="font-size:0.9rem; color:var(--text-muted); margin-bottom:1.5rem; padding:1rem; background:rgba(255,255,255,0.03); border-radius:12px; font-style:italic; position: relative; z-index: 2;">
                ${I.strategy}
            </p>
            ${m(I.pokemon)}
         </div>
       `).join("")}
    </div>

    <!-- MOs / MTs -->
    <div id="tab-items" class="tab-content hidden">
       <div class="emulator-box" style="margin-bottom:2rem;">
        <h3 style="margin-bottom:1.5rem;">üíø M√°quinas Ocultas (MO)</h3>
        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:1rem;">
          ${eA.map(I=>`
            <div class="recommendation-card" style="margin:0; cursor:default; border-left:3px solid var(--primary-color);">
              <div style="background:var(--primary-color); color:black; font-weight:bold; width:32px; height:32px; display:flex; align-items:center; justify-content:center; border-radius:8px;">HM</div>
              <div>
                  <div style="color:var(--text-main); font-weight:700; font-size:1rem;">${I.name}</div>
                  <div style="font-size:0.85rem; color:var(--text-muted);">üìç ${I.location}</div>
              </div>
            </div>
          `).join("")}
        </div>
      </div>

      <div class="emulator-box">
        <h3 style="margin-bottom:1.5rem;">üíø M√°quinas T√©cnicas (MT) Importantes</h3>
         <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:1rem;">
          ${tA.map(I=>`
            <div class="recommendation-card" style="margin:0; cursor:default; border-left:3px solid var(--ray-yellow);">
              <div style="background:var(--ray-yellow); color:black; font-weight:bold; width:32px; height:32px; display:flex; align-items:center; justify-content:center; border-radius:8px;">TM</div>
              <div>
                  <div style="color:var(--text-main); font-weight:700; font-size:1rem;">${I.name}</div>
                  <div style="font-size:0.85rem; color:var(--text-muted);">üìç ${I.location}</div>
              </div>
            </div>
          `).join("")}
        </div>
      </div>
    </div>

    <!-- ITEM DEX (SEARCHABLE) -->
    <div id="tab-held" class="tab-content hidden">
       <div style="max-width:600px; margin:0 auto 2rem auto; position:relative;">
          <input type="text" id="item-search" class="search-input" placeholder="Buscar objeto..." style="padding-left: 3.5rem; height:3.5rem; font-size:1.2rem;">
          <span style="position:absolute; left:1.2rem; top:50%; transform:translateY(-50%); font-size:1.4rem; opacity:0.5;">üîç</span>
       </div>
       <div id="item-dex-container" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap:1rem; padding-bottom:2rem;">
           <!-- Items Injected Here -->
       </div>
    </div>

    <!-- SAVE SCANNER -->
    <div id="tab-scanner" class="tab-content hidden">
        <div id="save-scanner-root"></div>
    </div>
  `;const g=document.getElementById("item-search");g&&(g.addEventListener("input",I=>{const R=I.target.value.toLowerCase(),k=Dr.filter(x=>x.name.toLowerCase().includes(R)||x.category.toLowerCase().includes(R)||x.desc.toLowerCase().includes(R)||x.loc.toLowerCase().includes(R));s(k)}),s(Dr));const E=document.querySelectorAll(".guide-tab"),C=document.querySelectorAll(".tab-content");E.forEach(I=>{I.addEventListener("click",()=>{if(I.id==="scanner-btn"){E.forEach(R=>R.classList.remove("active")),C.forEach(R=>R.classList.add("hidden")),I.classList.add("active"),document.getElementById("tab-scanner").classList.remove("hidden"),iA();return}E.forEach(R=>R.classList.remove("active")),C.forEach(R=>R.classList.add("hidden")),I.classList.add("active"),document.getElementById(`tab-${I.dataset.tab}`).classList.remove("hidden")})})}const Xe=["Normal","Fuego","Agua","El√©ctrico","Planta","Hielo","Lucha","Veneno","Tierra","Volador","Ps√≠quico","Bicho","Roca","Fantasma","Drag√≥n","Siniestro","Acero"],hi=[[1,1,1,1,1,1,1,1,1,1,1,1,.5,0,1,1,.5],[1,.5,.5,1,2,2,1,1,1,1,1,2,.5,1,.5,1,2],[1,2,.5,1,.5,1,1,1,2,1,1,1,2,1,.5,1,1],[1,1,2,.5,.5,1,1,1,0,2,1,1,1,1,.5,1,1],[1,.5,2,1,.5,1,1,.5,2,.5,1,.5,2,1,.5,1,.5],[1,.5,.5,1,2,.5,1,1,2,2,1,1,1,1,2,1,.5],[2,1,1,1,1,2,1,.5,1,.5,.5,.5,2,0,1,2,2],[1,1,1,1,2,1,1,.5,.5,1,1,1,.5,.5,1,1,0],[1,2,1,2,.5,1,1,2,1,0,1,.5,2,1,1,1,2],[1,1,1,.5,2,1,2,1,1,1,1,2,.5,1,1,1,.5],[1,1,1,1,1,1,2,2,1,1,.5,1,1,1,1,0,.5],[1,.5,1,1,2,1,.5,.5,1,.5,2,1,1,.5,1,2,.5],[1,2,1,1,1,2,.5,1,.5,2,1,2,1,1,1,1,.5],[0,1,1,1,1,1,1,1,1,1,2,1,1,2,1,.5,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,.5],[1,1,1,1,1,1,.5,1,1,1,2,1,1,2,1,.5,.5],[1,.5,.5,.5,1,2,1,1,1,1,1,1,2,1,1,1,.5]];let gi=[];function pA(){return xe().slots.filter(e=>e!==null)}let yp="search",Ze=[];async function bu(){const a=document.getElementById("calculator");if(!a)return;if(a.innerHTML=`
    <h2>Calculadora de Tipos</h2>
    
    <div class="calculator-container" style="max-width:1200px;">
      
      <!-- Mode Tabs -->
      <div class="calc-toggle-container" style="display:flex; justify-content:center; gap:1rem; margin-bottom:2rem;">
         <button id="mode-search" class="calc-tab active" onclick="switchCalcMode('search')">üîç Por Nombre</button>
         <button id="mode-manual" class="calc-tab" onclick="switchCalcMode('manual')">‚ö° Selector de Tipos</button>
      </div>

      <!-- SEARCH MODE -->
      <div id="calc-search-panel" style="max-width:600px; margin:0 auto 2rem auto; position:relative; z-index:50;">
        <div class="calc-search-box" style="position:relative;">
             <input type="text" id="poke-search" class="search-input" placeholder="Buscar Pok√©mon rival (ej. Milotic...)" autocomplete="off" style="padding-left: 3.5rem; height:3.5rem; font-size:1.2rem;">
             <span style="position:absolute; left:1.2rem; top:50%; transform:translateY(-50%); font-size:1.4rem; opacity:0.5;">üîç</span>
             <div id="search-suggestions" style="position:absolute; width:100%; top:110%; left:0; max-height:300px; overflow-y:auto; background:var(--ray-charcoal); border:1px solid var(--glass-border); display:none; border-radius: 12px; box-shadow:0 10px 40px rgba(0,0,0,0.5);"></div>
        </div>
      </div>

      <!-- MANUAL MODE -->
      <div id="calc-manual-panel" style="display:none; max-width:800px; margin:0 auto 2rem auto;">
         <div class="manual-type-selector" style="background:rgba(0,0,0,0.2); border-radius:16px; padding:1.5rem; border:1px solid var(--glass-border);">
            <h3 style="text-align:center; margin-bottom:1rem; color:var(--text-muted);">Selecciona los tipos del Defensor (M√°x 2)</h3>
            <div id="type-grid" style="display:flex; flex-wrap:wrap; gap:0.5rem; justify-content:center;">
               ${Xe.map(r=>`
                  <button class="type-pill type-${r.toLowerCase()} manual-type-btn" 
                          onclick="toggleManualType('${r}')"
                          style="opacity:0.6; filter:grayscale(0.4); transition:all 0.2s; border:2px solid transparent;">
                     ${Do(r)}
                  </button>
               `).join("")}
            </div>
            <div class="manual-actions" style="margin-top:1.5rem; text-align:center;">
               <button onclick="clearManualTypes()" style="background:rgba(255,255,255,0.1); border:none; color:var(--text-muted); padding:0.5rem 1rem; border-radius:8px; cursor:pointer;">Limpiar</button>
            </div>
         </div>
      </div>

      <!-- Results Area -->
      <div id="calc-results" class="results-panel" style="display:none; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap:2rem;">
        
        <!-- Left Col: Weakness Chart -->
        <div class="glass-panel" style="display:flex; flex-direction:column; gap:1.5rem;">
           <div id="enemy-header" style="text-align:center;"></div>
           <div id="weakness-info" style="display:flex; flex-direction:column; gap:1rem;"></div>
        </div>

        <!-- Right Col: Team Suggestions -->
        <div class="glass-panel" style="display:flex; flex-direction:column;">
          <h3 style="margin-bottom:1.5rem; padding-bottom:1rem; border-bottom:1px solid var(--glass-border); display:flex; align-items:center; gap:0.5rem;">
             <span>üõ°Ô∏è</span> An√°lisis de tu Equipo
          </h3>
          <div id="team-analysis" style="display:grid; gap:0.75rem;"></div>
        </div>

      </div>
    </div>
  `,switchCalcMode(yp),gi.length===0)try{gi=(await(await fetch("https://pokeapi.co/api/v2/pokemon?limit=1000")).json()).results}catch(r){console.error("Error fetching pokemon",r)}const e=document.getElementById("poke-search"),t=document.getElementById("search-suggestions");e.addEventListener("input",r=>{const o=r.target.value.toLowerCase();if(t.innerHTML="",o.length<2){t.style.display="none";return}const i=gi.filter(s=>s.name.includes(o)).slice(0,8);i.length>0?(t.style.display="block",t.innerHTML=i.map(s=>{const d=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${s.url.split("/")[6]}.png`;return`
                <div class="suggestion-item" data-url="${s.url}" style="padding:0.75rem 1rem; cursor:pointer; border-bottom:1px solid var(--glass-border); color:var(--text-main); transition:0.2s; font-size:1rem; display:flex; align-items:center; gap:1rem;">
                    <img src="${d}" alt="${s.name}" style="width:40px; height:40px; object-fit:contain;">
                    <span style="font-weight:600;">${s.name.charAt(0).toUpperCase()+s.name.slice(1)}</span>
                </div>
              `}).join(""),document.querySelectorAll(".suggestion-item").forEach(s=>{s.addEventListener("click",()=>{e.value=s.textContent.trim(),t.style.display="none",hA(s.dataset.url)}),s.addEventListener("mouseenter",()=>s.style.background="var(--glass-shine)"),s.addEventListener("mouseleave",()=>s.style.background="transparent")})):t.style.display="none"}),document.addEventListener("click",r=>{r.target.closest(".calc-search-box")||(t.style.display="none")})}window.switchCalcMode=a=>{yp=a,document.querySelectorAll(".calc-tab").forEach(o=>o.classList.remove("active")),document.getElementById(`mode-${a}`).classList.add("active");const e=document.getElementById("calc-search-panel"),t=document.getElementById("calc-manual-panel"),r=document.getElementById("calc-results");a==="search"?(e.style.display="block",t.style.display="none",r.style.display="none"):(e.style.display="none",t.style.display="block",r.style.display="none",clearManualTypes())};window.toggleManualType=a=>{if(Ze.includes(a))Ze=Ze.filter(e=>e!==a);else{if(Ze.length>=2)return;Ze.push(a)}vp()};window.clearManualTypes=()=>{Ze=[],vp()};function vp(){document.querySelectorAll(".manual-type-btn").forEach(a=>{const e=Array.from(a.classList).find(r=>r.startsWith("type-")&&r!=="type-pill"),t=Xe.find(r=>`type-${r.toLowerCase()}`===e);Ze.includes(t)?(a.style.opacity="1",a.style.filter="none",a.style.boxShadow="0 0 15px rgba(255,255,255,0.4)",a.style.transform="scale(1.1)",a.style.border="2px solid white"):(a.style.opacity="0.5",a.style.filter="grayscale(0.6)",a.style.boxShadow="none",a.style.transform="scale(1)",a.style.border="2px solid transparent")}),Ze.length>0?Ep(Ze,"Manual Selection",null):document.getElementById("calc-results").style.display="none"}async function hA(a){const e=document.getElementById("calc-results"),t=document.getElementById("enemy-header");e.style.display="grid",t.innerHTML='<div style="padding:2rem;">Cargando datos...</div>';try{const o=await(await fetch(a)).json(),i=o.id,s=o.types.map(l=>{const d=l.type.name.charAt(0).toUpperCase()+l.type.name.slice(1);return wu[d]||d});Ep(s,o.name.toUpperCase(),o.sprites.front_default,i)}catch(r){console.error(r),t.innerHTML="Error cargando detalles."}}function Ep(a,e,t,r=null){const o=document.getElementById("calc-results"),i=document.getElementById("enemy-header"),s=document.getElementById("weakness-info"),l=document.getElementById("team-analysis");o.style.display="grid";let d="";t?d+=`
          <div style="position:relative; width:120px; height:120px; margin:0 auto; cursor:pointer;" 
               class="clickable"
               onclick="openPokemonModal(${r})">
             <div style="position:absolute; inset:0; background:var(--primary-glow); filter:blur(40px); opacity:0.2; border-radius:50%;"></div>
             <img src="${t}" style="width:100%; height:100%; position:relative; z-index:1; image-rendering:pixelated; transform:scale(1.2);">
          </div>
          <h2 style="margin:0.5rem 0 1rem 0; color:var(--text-main); font-size:1.8rem; height: auto;">${e}</h2>
        `:d+='<h2 style="margin:0 0 1rem 0; color:var(--text-main); font-size:1.5rem;">Defensor</h2>',d+=`<div class="poke-types" style="justify-content:center; gap:0.5rem; margin-bottom:1rem;">
      ${a.map(I=>`<span class="type-pill type-${I.toLowerCase()}" style="padding:0.3rem 1rem; font-size:1rem;">${Do(I)}</span>`).join("")}
    </div>`,i.innerHTML=d;const m={};Xe.forEach(I=>{let R=1;a.forEach(k=>{const x=Xe.indexOf(I),z=Xe.indexOf(k);x!==-1&&z!==-1&&(R*=hi[x][z])}),m[I]=R});const p={4:[],2:[],1:[],"0.5":[],"0.25":[],0:[]};Object.entries(m).forEach(([I,R])=>{R===4?p[4].push(I):R===2?p[2].push(I):R===1?p[1].push(I):R===.5?p["0.5"].push(I):R===.25?p["0.25"].push(I):R===0&&p[0].push(I)});let g=`
      <div class="eff-grid" style="display:grid; gap:1rem;">
    `;const E=(I,R,k)=>k.length===0?"":`
         <div class="eff-row" style="background:rgba(255,255,255,0.03); border-radius:12px; padding:0.8rem; border-left:4px solid ${R};">
            <div style="font-weight:700; color:${R}; font-size:0.9rem; margin-bottom:0.5rem;">${I}</div>
            <div style="display:flex; flex-wrap:wrap; gap:0.5rem;">
               ${k.map(x=>`<span class="type-badge-modern type-${x.toLowerCase()}" style="font-size:0.8rem; padding:4px 8px; text-transform:uppercase;">${Do(x)}</span>`).join("")}
            </div>
         </div>
        `;p[4].length&&(g+=E("S√∫per eficaz (x4)","#ef4444",p[4])),p[2].length&&(g+=E("Eficaz (x2)","#f97316",p[2])),p["0.5"].length&&(g+=E("Poco eficaz (x0.5)","#3b82f6",p["0.5"])),p["0.25"].length&&(g+=E("Muy poco eficaz (x0.25)","#6366f1",p["0.25"])),p[0].length&&(g+=E("Inmune (x0)","#64748b",p[0])),g+="</div>",s.innerHTML=g;const C=pA();if(C.length===0)l.innerHTML='<div style="text-align:center; color:var(--text-muted); padding:2rem;">A√±ade Pok√©mon a tu equipo para ver sugerencias.</div>';else{const I={normal:"Normal",fire:"Fuego",water:"Agua",electric:"El√©ctrico",grass:"Planta",ice:"Hielo",fighting:"Lucha",poison:"Veneno",ground:"Tierra",flying:"Volador",psychic:"Ps√≠quico",bug:"Bicho",rock:"Roca",ghost:"Fantasma",dragon:"Drag√≥n",dark:"Siniestro",steel:"Acero",fairy:"Hada"},R=C.map(k=>{let x={name:"Ninguno",displayName:"Sin movimiento efectivo",mod:0,typeES:null};(k.moves?k.moves.filter(G=>G):[]).forEach(G=>{if(G.category==="Status"||G.damageClass==="status")return;const Q=I[G.type?.toLowerCase()]||G.type;let b=1;a.forEach(A=>{const _=Xe.indexOf(Q),w=Xe.indexOf(A);_!==-1&&w!==-1&&(b*=hi[_][w])});const v=k.types.map(A=>{const _=typeof A=="string"?A:A?.english||A?.spanish||"";return I[_?.toLowerCase()]||_}).includes(Q);v&&(b*=1.5),b>x.mod&&(x={name:G.name,displayName:G.displayName||G.name,mod:b,type:G.type,typeES:Q,typeTranslated:G.typeTranslated||Q,hasSTAB:v})});let j=0;const Y=k.types.map(G=>{const Q=typeof G=="string"?G:G?.english||G?.spanish||"";return I[Q?.toLowerCase()]||Q});return a.forEach(G=>{let Q=1;Y.forEach(b=>{const f=Xe.indexOf(G),v=Xe.indexOf(b);f!==-1&&v!==-1&&(Q*=hi[f][v])}),Q>j&&(j=Q)}),{member:k,bestMove:x,maxReceiveMod:j}});R.sort((k,x)=>x.bestMove.mod!==k.bestMove.mod?x.bestMove.mod-k.bestMove.mod:k.maxReceiveMod-x.maxReceiveMod),l.innerHTML=R.map((k,x)=>{let z="transparent",j="rgba(255,255,255,0.03)",Y="";x===0&&k.bestMove.mod>=2?(z="#22c55e",j="rgba(34, 197, 94, 0.15)",Y='<span style="background:#22c55e; color:#000; font-size:0.65rem; padding:0.15rem 0.5rem; border-radius:4px; font-weight:700; margin-left:0.5rem;">‚≠ê MEJOR</span>'):k.bestMove.mod>=2?(z="var(--primary-color)",j="rgba(var(--primary-rgb), 0.1)"):k.maxReceiveMod>=2&&(z="var(--ray-red)",j="rgba(244, 63, 94, 0.05)");const G=k.bestMove.typeTranslated||k.bestMove.typeES||"???",Q=k.bestMove.type?`type-${k.bestMove.type.toLowerCase()}`:"";return`
            <div class="recommendation-card clickable" 
                 style="border-left: 3px solid ${z}; background:${j}; padding:0.75rem 1rem; margin:0; display:flex; align-items:center; gap:1rem; cursor:pointer;"
                 onclick="openPokemonModal(${k.member.id})">
              <img src="${k.member.image}" style="width:48px; height:48px; object-fit:contain; filter:drop-shadow(0 2px 5px rgba(0,0,0,0.5)); transform:scale(1.1);">
              
              <div style="flex:1;">
                <div style="font-weight:700; font-size:1rem; color:var(--text-main); margin-bottom:0.2rem; display:flex; align-items:center;">
                    ${k.member.name}${Y}
                </div>
                ${k.bestMove.mod>=1?`<div style="font-size:0.85rem; color:var(--text-muted); display:flex; align-items:center; gap:0.4rem;">
                        Usa <span style="color:#fff; font-weight:600;">${k.bestMove.displayName}</span>
                        <span class="type-pill ${Q}" style="padding:0.1rem 0.4rem; font-size:0.65rem;">${G}</span>
                        <span style="background:rgba(0,0,0,0.3); padding:0 4px; border-radius:4px; font-size:0.75rem;">x${k.bestMove.mod.toFixed(1)}</span>
                       </div>`:'<div style="font-size:0.85rem; color:var(--text-muted);">Sin movimientos efectivos</div>'}
              </div>

              <div style="text-align:right;">
                 ${k.maxReceiveMod>=2?`<div style="color:var(--ray-red); font-size:0.8rem; font-weight:600; display:flex; flex-direction:column; align-items:flex-end;"><span>‚ö†Ô∏è Recibe</span><span>x${k.maxReceiveMod}</span></div>`:'<div style="color:var(--primary-color); font-size:0.8rem; font-weight:600;">üõ°Ô∏è Seguro</div>'}
              </div>
            </div>
          `}).join("")}}let $s=null,Gs=!1;function _p(){if(document.getElementById("pokemon-detail-modal"))return;const a=document.createElement("div");a.id="pokemon-detail-modal",a.className="pokemon-modal-container hidden",a.innerHTML=`
    <div class="pokemon-modal-backdrop"></div>
    <div class="pokemon-modal">
      <button class="pokemon-modal-close" aria-label="Cerrar">‚úï</button>
      <div class="pokemon-modal-content">
        <!-- Content loaded dynamically -->
      </div>
    </div>
  `,document.body.appendChild(a);const e=a.querySelector(".pokemon-modal-backdrop"),t=a.querySelector(".pokemon-modal-close");e.addEventListener("click",Ro),t.addEventListener("click",Ro),document.addEventListener("keydown",r=>{r.key==="Escape"&&Gs&&Ro()})}async function gA(a){if(!a)return;document.getElementById("pokemon-detail-modal")||_p();const t=document.getElementById("pokemon-detail-modal"),r=t.querySelector(".pokemon-modal-content");$s=a,Gs=!0,t.classList.remove("hidden"),document.body.style.overflow="hidden",r.innerHTML=fA();const i=ve()===pe.PLATINUM?Mo.platinum:Mo.emerald;try{const s=await Ru(a,i);r.innerHTML=await vA(s,i),wA()}catch(s){console.error("Error loading Pokemon details:",s),r.innerHTML=yA()}}function Ro(){const a=document.getElementById("pokemon-detail-modal");a&&(a.classList.add("hidden"),document.body.style.overflow="",Gs=!1,$s=null)}function fA(){return`
    <div class="pokemon-modal-loading">
      <div class="skeleton-header">
        <div class="skeleton skeleton-sprite"></div>
        <div class="skeleton-info">
          <div class="skeleton skeleton-title"></div>
          <div class="skeleton skeleton-types"></div>
        </div>
      </div>
      <div class="skeleton skeleton-stats"></div>
      <div class="skeleton skeleton-evolution"></div>
      <div class="skeleton skeleton-learnset"></div>
    </div>
  `}function yA(){return`
    <div class="pokemon-modal-error">
      <span class="error-icon">‚ö†Ô∏è</span>
      <h3>Error al cargar datos</h3>
      <p>No se pudo obtener la informaci√≥n del Pok√©mon. Verifica tu conexi√≥n a internet.</p>
      <button onclick="closePokemonModal()" class="retry-btn">Cerrar</button>
    </div>
  `}async function vA(a,e){const t=e==="platinum"?"Platino":"Esmeralda";return`
    <div class="pokemon-modal-header">
      <div class="pokemon-sprite-container">
        <img src="${a.spriteAnimated||a.sprite}" alt="${a.name}" class="pokemon-sprite-large">
        <span class="pokemon-id">#${String(a.id).padStart(3,"0")}</span>
      </div>
      <div class="pokemon-header-info">
        <h2 class="pokemon-modal-name">${a.name}</h2>
        <div class="pokemon-modal-types">
          ${a.types.map(o=>`
            <span class="type-pill type-${o}">${Va[o]||o}</span>
          `).join("")}
        </div>
        <p class="pokemon-flavor-text">${a.flavorText||"Sin descripci√≥n disponible."}</p>
      </div>
    </div>
    
    <div class="pokemon-modal-section">
      <h3 class="section-title">üìä Estad√≠sticas Base</h3>
      <div class="pokemon-stats-grid">
        ${da("PS",a.stats.hp,"#ff5555")}
        ${da("Ataque",a.stats.attack,"#f5ac78")}
        ${da("Defensa",a.stats.defense,"#fae078")}
        ${da("At. Esp.",a.stats.spAttack,"#9db7f5")}
        ${da("Def. Esp.",a.stats.spDefense,"#a7db8d")}
        ${da("Velocidad",a.stats.speed,"#fa92b2")}
      </div>
      <div class="stats-total">
        <span>Total:</span>
        <strong>${Object.values(a.stats).reduce((o,i)=>o+i,0)}</strong>
      </div>
    </div>
    
    <div class="pokemon-modal-section">
      <h3 class="section-title">üîÑ Cadena Evolutiva</h3>
      <div class="evolution-chain-container">
        ${EA(a.evolutionChain,a.id)}
      </div>
    </div>
    
    <div class="pokemon-modal-section">
      <h3 class="section-title">üìñ Movimientos por Nivel <span class="version-badge">${t}</span></h3>
      <div class="learnset-container">
        ${await bA(a.learnset)}
      </div>
    </div>
    
    <div class="pokemon-modal-section pokemon-details-extra">
      <div class="detail-item">
        <span class="detail-label">Altura</span>
        <span class="detail-value">${a.height} m</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Peso</span>
        <span class="detail-value">${a.weight} kg</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Habilidades</span>
        <span class="detail-value">${a.abilities.map(o=>lh(o.name)+(o.isHidden?" (oculta)":"")).join(", ")}</span>
      </div>
    </div>
  `}function da(a,e,t){const o=Math.min(e/255*100,100);return`
    <div class="stat-row">
      <span class="stat-label">${a}</span>
      <div class="stat-bar-container">
        <div class="stat-bar" style="width: ${o}%; background: ${t};"></div>
      </div>
      <span class="stat-value">${e}</span>
    </div>
  `}function EA(a,e){return!a||a.length===0?'<p class="no-evolution">Este Pok√©mon no evoluciona.</p>':a.length===1?'<p class="no-evolution">Este Pok√©mon no tiene evoluciones.</p>':`
    <div class="evolution-chain">
      ${a.map((t,r)=>{const o=t.id===e,i=fh(t.id),s=i?i.method:_A(t.evolutionDetails),l=i?i.explanation:"";return`
          ${r>0?`
            <div class="evolution-arrow" ${l?`title="${l}"`:""}>
              <span class="arrow-icon">‚Üí</span>
              <span class="evolution-method">${s}</span>
            </div>
          `:""}
          <div class="evolution-pokemon ${o?"active":""}" 
               onclick="openPokemonModal(${t.id})"
               data-pokemon-id="${t.id}"
               ${l?`title="${l}"`:""}>
            <img src="${t.sprite}" alt="${t.name}" class="evolution-sprite">
            <span class="evolution-name">${Je(t.name)}</span>
          </div>
        `}).join("")}
    </div>
  `}function _A(a){if(!a)return"";const e=[];if(a.trigger==="trade"?(e.push("üîÑ Intercambio"),a.heldItem&&e.push(`+ ${dh(a.heldItem)}`)):a.trigger==="use-item"&&a.item?e.push(`üíé ${uh(a.item)}`):a.minLevel&&e.push(`Nv. ${a.minLevel}`),a.minHappiness&&e.push("‚ù§Ô∏è Felicidad alta"),a.timeOfDay==="day"?e.push("‚òÄÔ∏è De d√≠a"):a.timeOfDay==="night"&&e.push("üåô De noche"),a.location&&e.push(`üìç ${mh(a.location)}`),a.knownMove&&e.push(`Saber ${Je(a.knownMove)}`),a.knownMoveType){const t=Va[a.knownMoveType]||a.knownMoveType;e.push(`Mov. tipo ${t}`)}return a.minAffection&&e.push("üíï Afecto alto"),e.length===0?a.trigger?ph(a.trigger):"Evoluciona":e.join(" ")}async function bA(a){if(!a||a.length===0)return'<p class="no-moves">No hay movimientos disponibles para esta versi√≥n.</p>';const e=a.slice(0,15),t=a.slice(15);return`
    <table class="learnset-table">
      <thead>
        <tr>
          <th>Nv.</th>
          <th>Movimiento</th>
          <th>Tipo</th>
          <th>Cat.</th>
          <th>Poder</th>
          <th>Prec.</th>
        </tr>
      </thead>
      <tbody>
        ${(await Promise.all(e.map(async o=>{const i=await nn(o.name);return{...o,details:i}}))).map(o=>bp(o)).join("")}
        ${t.length>0?`
          <tr class="load-more-row">
            <td colspan="6">
              <button class="load-more-btn" data-remaining='${JSON.stringify(t.map(o=>o.name))}'>
                Cargar ${t.length} movimientos m√°s...
              </button>
            </td>
          </tr>
        `:""}
      </tbody>
    </table>
  `}function bp(a){const e=hh(a.name);if(!a.details)return`
      <tr>
        <td>${a.level}</td>
        <td>${e}</td>
        <td colspan="4">-</td>
      </tr>
    `;const{details:t}=a,r=`type-${t.type}`,o=AA(t.damageClass);return`
    <tr class="move-row" title="${t.description}">
      <td class="move-level">${a.level}</td>
      <td class="move-name">${e}</td>
      <td><span class="type-mini ${r}">${Va[t.type]||t.type}</span></td>
      <td class="move-category">${o}</td>
      <td class="move-power">${t.power||"‚Äî"}</td>
      <td class="move-accuracy">${t.accuracy?t.accuracy+"%":"‚Äî"}</td>
    </tr>
  `}function AA(a){const e={physical:"üí•",special:"‚ú®",status:"üìä"};return`<span title="${Du[a]||a}">${e[a]||"?"}</span>`}function wA(){const a=document.querySelector(".load-more-btn");a&&a.addEventListener("click",async e=>{const t=e.target,r=JSON.parse(t.dataset.remaining);t.textContent="Cargando...",t.disabled=!0;try{const o=await Promise.all(r.map(async p=>{const g=await nn(p);return{name:p,level:"?",details:g}})),s=ve()===pe.PLATINUM?Mo.platinum:Mo.emerald,l=await Ru($s,s),d=o.map(p=>{const g=l.learnset.find(E=>E.name===p.name);return p.level=g?.level||"?",bp(p)}).join(""),m=document.querySelector(".load-more-row");m.insertAdjacentHTML("beforebegin",d),m.remove()}catch(o){console.error("Error loading more moves:",o),t.textContent="Error - Reintentar",t.disabled=!1}})}window.openPokemonModal=gA;window.closePokemonModal=Ro;let tn=!1;function PA(a="auth-container"){const e=document.getElementById(a);e&&(Ib(t=>{Au(e,t),t?TA(t):tn=!1}),Au(e,null))}async function TA(a){if(!tn){tn=!0;try{const e=await xs(a.uid),t=ve(),r=e.filter(o=>o.game===t);if(Os(),r.length===0)return;Ua(r),!Rn()&&r.length>0&&ja(r[0].id),window.dispatchEvent(new CustomEvent("teamListUpdated")),window.dispatchEvent(new CustomEvent("teamChanged"))}catch(e){console.warn("[Auth] Failed to sync teams from cloud:",e)}}}function Au(a,e){if(e){const t=kb(),r={uid:e.uid,displayName:e.displayName||t?.displayName||"Usuario",email:e.email||t?.email||"",photoURL:e.photoURL||t?.photoURL||null},o=r.displayName,i=r.email||"",s=r.photoURL;a.innerHTML=`
      <div class="auth-user-profile">
        <button class="auth-profile-btn" onclick="toggleAuthDropdown(event)">
          ${s?`<img src="${s}" alt="Avatar" class="auth-avatar" referrerpolicy="no-referrer">`:`<div class="auth-avatar-placeholder">${o.charAt(0).toUpperCase()}</div>`}
          <span class="auth-user-name">${o}</span>
          <svg class="auth-chevron" width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
            <path d="M2.5 4.5L6 8L9.5 4.5" stroke="currentColor" stroke-width="1.5" fill="none"/>
          </svg>
        </button>
        <div class="auth-dropdown hidden" id="auth-dropdown">
          <div class="auth-dropdown-header">
            <span class="auth-dropdown-email">${i}</span>
          </div>
          <div class="auth-dropdown-divider"></div>
          <button class="auth-dropdown-item" onclick="handleSignOut()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
              <polyline points="16 17 21 12 16 7"/>
              <line x1="21" y1="12" x2="9" y2="12"/>
            </svg>
            Cerrar sesi√≥n
          </button>
        </div>
      </div>
    `}else a.innerHTML=`
      <button class="auth-login-btn" onclick="handleGoogleLogin(event)">
        <svg class="google-icon" viewBox="0 0 24 24" width="18" height="18">
          <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
          <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
          <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
        </svg>
        <span>Iniciar sesi√≥n</span>
      </button>
    `}window.handleGoogleLogin=async function(a){a&&(a.preventDefault(),a.stopPropagation());const e=await Pb();if(e){console.log("[Auth] User logged in:",e.uid);const t=Nt(),r={selectedGame:ve()},o=await xs(e.uid),i=ve(),s=o.filter(l=>l.game===i);console.log("[Auth] Cloud teams:",s.length,"| Local teams:",t.length),s.length>0?(console.log("[Auth] Loading cloud teams:",s.length),Os(),Ua(s),s.length>0&&ja(s[0].id)):t.length>0&&(console.log("[Auth] Migrating local teams to cloud..."),await Rb(e.uid,t,r)),console.log("[Auth] Refreshing UI..."),window.dispatchEvent(new CustomEvent("teamListUpdated")),window.dispatchEvent(new CustomEvent("teamChanged")),window.location.reload()}};window.handleSignOut=async function(){await Tb(),tn=!1,Os(),window.location.reload();const a=document.getElementById("auth-dropdown");a&&a.classList.add("hidden")};window.toggleAuthDropdown=function(a){a.stopPropagation();const e=document.getElementById("auth-dropdown");e&&e.classList.toggle("hidden")};document.addEventListener("click",a=>{const e=document.getElementById("auth-dropdown");e&&!a.target.closest(".auth-user-profile")&&e.classList.add("hidden")});document.addEventListener("DOMContentLoaded",()=>{Iu(ve()),_p(),PA(),_r(),vu(),_u(),bu();const a=document.getElementById("page-title");if(a){const p=ve();p===pe.PLATINUM?a.textContent="Gu√≠a Pok√©mon Platino":p===pe.WHITE?a.textContent="Gu√≠a Pok√©mon Blanco":a.textContent="Gu√≠a Pok√©mon Esmeralda"}const e=document.querySelectorAll("header nav .nav-btn"),t=document.querySelectorAll(".section");e.forEach(p=>{p.addEventListener("click",()=>{e.forEach(E=>E.classList.remove("active")),t.forEach(E=>E.classList.remove("active")),p.classList.add("active");const g=p.getAttribute("data-target");document.getElementById(g).classList.add("active")})});const r=document.getElementById("game-selector"),o=document.getElementById("game-selector-icon"),i=document.getElementById("game-modal"),s=document.querySelector(".game-modal-backdrop"),l=document.querySelectorAll(".game-option-card"),d=ve(),m={emerald:"https://cdn2.steamgriddb.com/icon_thumb/5d12d5a76a9683536eb23a6a1c9767cc.png",platinum:"https://cdn2.steamgriddb.com/icon_thumb/691f73fdf1c5edeb3f600c515715a358.png",white:"https://cdn2.steamgriddb.com/icon/59cf35ec5effe5787749804bd77dfb45.png"};o&&(o.src=m[d],o.alt=d===pe.PLATINUM?"Pok√©mon Platino":"Pok√©mon Esmeralda"),r&&r.addEventListener("click",p=>{p.stopPropagation(),i.classList.remove("hidden")}),s&&s.addEventListener("click",()=>{i.classList.add("hidden")}),window.addEventListener("gameChanged",p=>{const g=p.detail,E=document.getElementById("page-title");if(E&&(g===pe.PLATINUM?E.textContent="Gu√≠a Pok√©mon Platino":g===pe.WHITE?E.textContent="Gu√≠a Pok√©mon Blanco":E.textContent="Gu√≠a Pok√©mon Esmeralda"),o){o.src=m[g];let C="Pok√©mon Esmeralda";g===pe.PLATINUM&&(C="Pok√©mon Platino"),g===pe.WHITE&&(C="Pok√©mon Blanco"),o.alt=C}_r(),vu(),_u(),bu()}),l.forEach(p=>{p.addEventListener("click",()=>{const g=p.getAttribute("data-game");eh(g),i.classList.add("hidden")})}),document.addEventListener("keydown",p=>{p.key==="Escape"&&!i.classList.contains("hidden")&&i.classList.add("hidden")})});
